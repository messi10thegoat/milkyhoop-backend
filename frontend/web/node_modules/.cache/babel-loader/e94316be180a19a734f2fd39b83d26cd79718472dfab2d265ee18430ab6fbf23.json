{"ast":null,"code":"import React,{useEffect}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import HomePage from'./components/HomePage';import SetupModeChat from'./components/SetupModeChat';import BCALanding from'./components/BCALanding';import BCAChat from'./components/BCAChat';import KonsultanPsikologiLanding from'./components/KonsultanPsikologiLanding';import KonsultanPsikologiChat from'./components/KonsultanPsikologiChat';import GenericTenantLanding from'./components/GenericTenantLanding';import GenericTenantChat from'./components/GenericTenantChat';import QRLoginPage from'./components/QRLoginPage';import{isDesktopBrowser}from'./utils/device';import{isAuthenticated,setupSessionEnforcement}from'./utils/auth';import'./App.css';// Desktop login guard - redirects desktop users to QR login if not authenticated\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const DesktopLoginGuard=_ref=>{let{children}=_ref;// Only enforce QR login for desktop browsers\nif(isDesktopBrowser()&&!isAuthenticated()){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}return/*#__PURE__*/_jsx(_Fragment,{children:children});};// Login page guard - redirects authenticated users away from login\nconst LoginPageGuard=_ref2=>{let{children}=_ref2;// If already authenticated, redirect to main app\nif(isAuthenticated()){return/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true});}// Only show QR login on desktop\nif(!isDesktopBrowser()){return/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true});}return/*#__PURE__*/_jsx(_Fragment,{children:children});};// Home route - shows dashboard for authenticated desktop users, landing for others\nconst HomeRoute=()=>{// Authenticated desktop users see dashboard directly\nif(isDesktopBrowser()&&isAuthenticated()){return/*#__PURE__*/_jsx(SetupModeChat,{});}// Non-authenticated desktop users get redirected to login\nif(isDesktopBrowser()&&!isAuthenticated()){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}// Mobile users see landing page\nreturn/*#__PURE__*/_jsx(HomePage,{});};function App(){// Setup session enforcement on app init\nuseEffect(()=>{const cleanup=setupSessionEnforcement();return cleanup;},[]);return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(LoginPageGuard,{children:/*#__PURE__*/_jsx(QRLoginPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(HomeRoute,{})}),/*#__PURE__*/_jsx(Route,{path:\"/chat\",element:/*#__PURE__*/_jsx(DesktopLoginGuard,{children:/*#__PURE__*/_jsx(SetupModeChat,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/bca\",element:/*#__PURE__*/_jsx(BCALanding,{})}),/*#__PURE__*/_jsx(Route,{path:\"/bca/chat\",element:/*#__PURE__*/_jsx(BCAChat,{})}),/*#__PURE__*/_jsx(Route,{path:\"/konsultanpsikologi\",element:/*#__PURE__*/_jsx(KonsultanPsikologiLanding,{})}),/*#__PURE__*/_jsx(Route,{path:\"/konsultanpsikologi/chat\",element:/*#__PURE__*/_jsx(KonsultanPsikologiChat,{})}),/*#__PURE__*/_jsx(Route,{path:\"/:tenantId\",element:/*#__PURE__*/_jsx(GenericTenantLanding,{})}),/*#__PURE__*/_jsx(Route,{path:\"/:tenantId/chat\",element:/*#__PURE__*/_jsx(GenericTenantChat,{})})]})})});}export default App;","map":{"version":3,"names":["React","useEffect","BrowserRouter","Router","Routes","Route","Navigate","HomePage","SetupModeChat","BCALanding","BCAChat","KonsultanPsikologiLanding","KonsultanPsikologiChat","GenericTenantLanding","GenericTenantChat","QRLoginPage","isDesktopBrowser","isAuthenticated","setupSessionEnforcement","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","DesktopLoginGuard","_ref","children","to","replace","LoginPageGuard","_ref2","HomeRoute","App","cleanup","className","path","element"],"sources":["/root/milkyhoop-dev/frontend/web/src/App.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\nimport HomePage from './components/HomePage';\nimport SetupModeChat from './components/SetupModeChat';\nimport BCALanding from './components/BCALanding';\nimport BCAChat from './components/BCAChat';\nimport KonsultanPsikologiLanding from './components/KonsultanPsikologiLanding';\nimport KonsultanPsikologiChat from './components/KonsultanPsikologiChat';\nimport GenericTenantLanding from './components/GenericTenantLanding';\nimport GenericTenantChat from './components/GenericTenantChat';\nimport QRLoginPage from './components/QRLoginPage';\nimport { isDesktopBrowser } from './utils/device';\nimport { isAuthenticated, setupSessionEnforcement } from './utils/auth';\nimport './App.css';\n\n// Desktop login guard - redirects desktop users to QR login if not authenticated\nconst DesktopLoginGuard: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  // Only enforce QR login for desktop browsers\n  if (isDesktopBrowser() && !isAuthenticated()) {\n    return <Navigate to=\"/login\" replace />;\n  }\n  return <>{children}</>;\n};\n\n// Login page guard - redirects authenticated users away from login\nconst LoginPageGuard: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  // If already authenticated, redirect to main app\n  if (isAuthenticated()) {\n    return <Navigate to=\"/\" replace />;\n  }\n  // Only show QR login on desktop\n  if (!isDesktopBrowser()) {\n    return <Navigate to=\"/\" replace />;\n  }\n  return <>{children}</>;\n};\n\n// Home route - shows dashboard for authenticated desktop users, landing for others\nconst HomeRoute: React.FC = () => {\n  // Authenticated desktop users see dashboard directly\n  if (isDesktopBrowser() && isAuthenticated()) {\n    return <SetupModeChat />;\n  }\n  // Non-authenticated desktop users get redirected to login\n  if (isDesktopBrowser() && !isAuthenticated()) {\n    return <Navigate to=\"/login\" replace />;\n  }\n  // Mobile users see landing page\n  return <HomePage />;\n};\n\nfunction App() {\n  // Setup session enforcement on app init\n  useEffect(() => {\n    const cleanup = setupSessionEnforcement();\n    return cleanup;\n  }, []);\n\n  return (\n    <Router>\n      <div className=\"App\">\n        <Routes>\n          {/* QR Login Page (desktop only) */}\n          <Route path=\"/login\" element={\n            <LoginPageGuard>\n              <QRLoginPage />\n            </LoginPageGuard>\n          } />\n\n          {/* Home - shows dashboard for authenticated desktop, landing for others */}\n          <Route path=\"/\" element={<HomeRoute />} />\n          <Route path=\"/chat\" element={\n            <DesktopLoginGuard>\n              <SetupModeChat />\n            </DesktopLoginGuard>\n          } />\n\n          {/* Specific tenants (priority routes) */}\n          <Route path=\"/bca\" element={<BCALanding />} />\n          <Route path=\"/bca/chat\" element={<BCAChat />} />\n          <Route path=\"/konsultanpsikologi\" element={<KonsultanPsikologiLanding />} />\n          <Route path=\"/konsultanpsikologi/chat\" element={<KonsultanPsikologiChat />} />\n\n          {/* Generic tenant routes (wildcard - must be last) */}\n          <Route path=\"/:tenantId\" element={<GenericTenantLanding />} />\n          <Route path=\"/:tenantId/chat\" element={<GenericTenantChat />} />\n        </Routes>\n      </div>\n    </Router>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
