{"ast":null,"code":"import _objectSpread from\"/root/milkyhoop-dev/frontend/web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{getToken}from'./auth';/**\n * Check if user has tenant access\n * Since backend doesn't have /access endpoint, we validate by:\n * 1. Check if token exists\n * 2. Make a test call to tenant chat endpoint\n * Backend will return 403 if user not authorized\n */export const checkTenantAccess=async tenantId=>{const token=getToken();if(!token)return false;try{// Test authorization with a lightweight query\nconst response=await fetch(\"/api/tenant/\".concat(tenantId,\"/chat\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify({message:'__check_access__'})});// If we get 200 or 201, user has access\n// If 401/403, user doesn't have access\nreturn response.ok;}catch(_unused){return false;}};/**\n * Send message to tenant chat endpoint\n * Automatically includes auth token if available\n */export const sendTenantMessage=async(tenantId,message)=>{const token=getToken();const response=await fetch(\"/api/tenant/\".concat(tenantId,\"/chat\"),{method:'POST',headers:_objectSpread({'Content-Type':'application/json'},token&&{'Authorization':\"Bearer \".concat(token)}),body:JSON.stringify({message})});if(!response.ok){throw new Error(\"API call failed: \".concat(response.status));}return response.json();};/**\n * Send message to customer (public) chat endpoint\n * No authentication required\n */export const sendCustomerMessage=async(tenantId,message)=>{const response=await fetch(\"/tenant/\".concat(tenantId,\"/chat\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message})});if(!response.ok){throw new Error(\"API call failed: \".concat(response.status));}return response.json();};","map":{"version":3,"names":["getToken","checkTenantAccess","tenantId","token","response","fetch","concat","method","headers","body","JSON","stringify","message","ok","_unused","sendTenantMessage","_objectSpread","Error","status","json","sendCustomerMessage"],"sources":["/root/milkyhoop-dev/frontend/web/src/utils/api.ts"],"sourcesContent":["import { getToken } from './auth';\n\n/**\n * Check if user has tenant access\n * Since backend doesn't have /access endpoint, we validate by:\n * 1. Check if token exists\n * 2. Make a test call to tenant chat endpoint\n * Backend will return 403 if user not authorized\n */\nexport const checkTenantAccess = async (tenantId: string): Promise<boolean> => {\n  const token = getToken();\n  if (!token) return false;\n\n  try {\n    // Test authorization with a lightweight query\n    const response = await fetch(`/api/tenant/${tenantId}/chat`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      },\n      body: JSON.stringify({ message: '__check_access__' })\n    });\n\n    // If we get 200 or 201, user has access\n    // If 401/403, user doesn't have access\n    return response.ok;\n  } catch {\n    return false;\n  }\n};\n\n/**\n * Send message to tenant chat endpoint\n * Automatically includes auth token if available\n */\nexport const sendTenantMessage = async (tenantId: string, message: string) => {\n  const token = getToken();\n  \n  const response = await fetch(`/api/tenant/${tenantId}/chat`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...(token && { 'Authorization': `Bearer ${token}` })\n    },\n    body: JSON.stringify({ message })\n  });\n  \n  if (!response.ok) {\n    throw new Error(`API call failed: ${response.status}`);\n  }\n  \n  return response.json();\n};\n\n/**\n * Send message to customer (public) chat endpoint\n * No authentication required\n */\nexport const sendCustomerMessage = async (tenantId: string, message: string) => {\n  const response = await fetch(`/tenant/${tenantId}/chat`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({ message })\n  });\n  \n  if (!response.ok) {\n    throw new Error(`API call failed: ${response.status}`);\n  }\n  \n  return response.json();\n};"],"mappings":"qHAAA,OAASA,QAAQ,KAAQ,QAAQ,CAEjC;AACA;AACA;AACA;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAC,iBAAiB,CAAG,KAAO,CAAAC,QAAgB,EAAuB,CAC7E,KAAM,CAAAC,KAAK,CAAGH,QAAQ,CAAC,CAAC,CACxB,GAAI,CAACG,KAAK,CAAE,MAAO,MAAK,CAExB,GAAI,CACF;AACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,gBAAAC,MAAA,CAAgBJ,QAAQ,UAAS,CAC3DK,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,eAAe,WAAAF,MAAA,CAAYH,KAAK,CAClC,CAAC,CACDM,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEC,OAAO,CAAE,kBAAmB,CAAC,CACtD,CAAC,CAAC,CAEF;AACA;AACA,MAAO,CAAAR,QAAQ,CAACS,EAAE,CACpB,CAAE,MAAAC,OAAA,CAAM,CACN,MAAO,MAAK,CACd,CACF,CAAC,CAED;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAC,iBAAiB,CAAG,KAAAA,CAAOb,QAAgB,CAAEU,OAAe,GAAK,CAC5E,KAAM,CAAAT,KAAK,CAAGH,QAAQ,CAAC,CAAC,CAExB,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAAC,KAAK,gBAAAC,MAAA,CAAgBJ,QAAQ,UAAS,CAC3DK,MAAM,CAAE,MAAM,CACdC,OAAO,CAAAQ,aAAA,EACL,cAAc,CAAE,kBAAkB,EAC9Bb,KAAK,EAAI,CAAE,eAAe,WAAAG,MAAA,CAAYH,KAAK,CAAG,CAAC,CACpD,CACDM,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEC,OAAQ,CAAC,CAClC,CAAC,CAAC,CAEF,GAAI,CAACR,QAAQ,CAACS,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAI,KAAK,qBAAAX,MAAA,CAAqBF,QAAQ,CAACc,MAAM,CAAE,CAAC,CACxD,CAEA,MAAO,CAAAd,QAAQ,CAACe,IAAI,CAAC,CAAC,CACxB,CAAC,CAED;AACA;AACA;AACA,GACA,MAAO,MAAM,CAAAC,mBAAmB,CAAG,KAAAA,CAAOlB,QAAgB,CAAEU,OAAe,GAAK,CAC9E,KAAM,CAAAR,QAAQ,CAAG,KAAM,CAAAC,KAAK,YAAAC,MAAA,CAAYJ,QAAQ,UAAS,CACvDK,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEC,OAAQ,CAAC,CAClC,CAAC,CAAC,CAEF,GAAI,CAACR,QAAQ,CAACS,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAI,KAAK,qBAAAX,MAAA,CAAqBF,QAAQ,CAACc,MAAM,CAAE,CAAC,CACxD,CAEA,MAAO,CAAAd,QAAQ,CAACe,IAAI,CAAC,CAAC,CACxB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}