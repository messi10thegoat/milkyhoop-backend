/*! For license information please see main.6a02fcc0.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:u,props:o,_owner:s.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=x.prototype;var b=v.prototype=new y;b.constructor=v,m(b,x.prototype),b.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,j={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,r){var a,o={},i=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)k.call(t,a)&&!C.hasOwnProperty(a)&&(o[a]=t[a]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===o[a]&&(o[a]=l[a]);return{$$typeof:n,type:e,key:i,ref:s,props:o,_owner:j.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var S=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,a,o,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return i=i(l=e),e=""===o?"."+E(l,0):o,w(i)?(a="",null!=e&&(a=e.replace(S,"$&/")+"/"),A(i,t,a,"",function(e){return e})):null!=i&&(_(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,a+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(S,"$&/")+"/")+e)),t.push(i)),1;if(l=0,o=""===o?".":o+":",w(e))for(var c=0;c<e.length;c++){var u=o+E(s=e[c],c);l+=A(s,t,a,u,i)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=A(s=s.value,t,a,u=o+E(s,c++),i);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,n){if(null==e)return e;var r=[],a=0;return A(e,r,"","",function(e){return t.call(n,e,a++)}),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},D={transition:null},M={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:D,ReactCurrentOwner:j};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=a,t.Profiler=i,t.PureComponent=v,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=R,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),o=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=j.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!C.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:n,type:e.type,key:o,ref:i,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=N,t.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<o(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,i=a>>>1;r<i;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,n))c<a&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<a&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(g=!1,b(e),!m)if(null!==r(c))m=!0,D(k);else{var t=r(u);null!==t&&M(w,t.startTime-e)}}function k(e,n){m=!1,g&&(g=!1,y(_),_=-1),f=!0;var o=p;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!A());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var s=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(c)&&a(c),b(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&M(w,d.startTime-n),l=!1}return l}finally{h=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var j,C=!1,N=null,_=-1,S=5,E=-1;function A(){return!(t.unstable_now()-E<S)}function I(){if(null!==N){var e=t.unstable_now();E=e;var n=!0;try{n=N(!0,e)}finally{n?j():(C=!1,N=null)}}else C=!1}if("function"===typeof v)j=function(){v(I)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,P=T.port2;T.port1.onmessage=I,j=function(){P.postMessage(null)}}else j=function(){x(I,0)};function D(e){N=e,C||(C=!0,j())}function M(e,n){_=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,D(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,o){var i=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?i+o:i:o=i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>i?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(g?(y(_),_=-1):g=!0,M(w,o-i))):(e.sortIndex=s,n(c,e),m||f||(m=!0,D(k))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),a=n(853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,a,o,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function v(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),S=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var F,O=Object.assign;function B(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var L=!1;function z(e,t){if(!e||L)return"";L=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),o=r.stack.split("\n"),i=a.length-1,s=o.length-1;1<=i&&0<=s&&a[i]!==o[s];)s--;for(;1<=i&&0<=s;i--,s--)if(a[i]!==o[s]){if(1!==i||1!==s)do{if(i--,0>--s||a[i]!==o[s]){var l="\n"+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=s);break}}}finally{L=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function W(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case j:return"Fragment";case k:return"Portal";case N:return"Profiler";case C:return"StrictMode";case A:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function U(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function q(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function Q(e,t){J(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function oe(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var xe=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,je=null,Ce=null;function Ne(e){if(e=va(e)){if("function"!==typeof ke)throw Error(o(280));var t=e.stateNode;t&&(t=wa(t),ke(e.stateNode,e.type,t))}}function _e(e){je?Ce?Ce.push(e):Ce=[e]:je=e}function Se(){if(je){var e=je,t=Ce;if(Ce=je=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function Ee(e,t){return e(t)}function Ae(){}var Ie=!1;function Te(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Ee(e,t,n)}finally{Ie=!1,(null!==je||null!==Ce)&&(Ae(),Se())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var De=!1;if(u)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){De=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(ue){De=!1}function Re(e,t,n,r,a,o,i,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Fe=!1,Oe=null,Be=!1,Le=null,ze={onError:function(e){Fe=!0,Oe=e}};function We(e,t,n,r,a,o,i,s,l){Fe=!1,Oe=null,Re.apply(ze,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ue(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ve(e)!==e)throw Error(o(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return He(a),e;if(i===r)return He(a),t;i=i.sibling}throw Error(o(188))}if(n.return!==r.return)n=a,r=i;else{for(var s=!1,l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Xe=a.unstable_scheduleCallback,Ye=a.unstable_cancelCallback,qe=a.unstable_shouldYield,Ze=a.unstable_requestPaint,Je=a.unstable_now,Qe=a.unstable_getCurrentPriorityLevel,$e=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,ot=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,o=e.pingedLanes,i=268435455&n;if(0!==i){var s=i&~a;0!==s?r=dt(s):0!==(o&=i)&&(r=dt(o))}else 0!==(i=n&~a)?r=dt(i):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(o=t&-t)||16===a&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-it(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var vt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,jt,Ct,Nt,_t=!1,St=[],Et=null,At=null,It=null,Tt=new Map,Pt=new Map,Dt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Ft(e,t,n,r,a,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[a]},null!==t&&(null!==(t=va(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ot(e){var t=ya(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ue(n)))return e.blockedOn=t,void Nt(e.priority,function(){jt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=va(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Lt(e,t,n){Bt(e)&&n.delete(t)}function zt(){_t=!1,null!==Et&&Bt(Et)&&(Et=null),null!==At&&Bt(At)&&(At=null),null!==It&&Bt(It)&&(It=null),Tt.forEach(Lt),Pt.forEach(Lt)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function Vt(e){function t(t){return Wt(t,e)}if(0<St.length){Wt(St[0],e);for(var n=1;n<St.length;n++){var r=St[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Wt(Et,e),null!==At&&Wt(At,e),null!==It&&Wt(It,e),Tt.forEach(t),Pt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ot(n),null===n.blockedOn&&Dt.shift()}var Ut=b.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var a=vt,o=Ut.transition;Ut.transition=null;try{vt=1,Xt(e,t,n,r)}finally{vt=a,Ut.transition=o}}function Kt(e,t,n,r){var a=vt,o=Ut.transition;Ut.transition=null;try{vt=4,Xt(e,t,n,r)}finally{vt=a,Ut.transition=o}}function Xt(e,t,n,r){if(Ht){var a=qt(e,t,n,r);if(null===a)Hr(e,t,r,Yt,n),Rt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Et=Ft(Et,e,t,n,r,a),!0;case"dragenter":return At=Ft(At,e,t,n,r,a),!0;case"mouseover":return It=Ft(It,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return Tt.set(o,Ft(Tt.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,Pt.set(o,Ft(Pt.get(o)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Rt(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==a;){var o=va(a);if(null!==o&&wt(o),null===(o=qt(e,t,n,r))&&Hr(e,t,r,Yt,n),o===a)break;a=o}null!==a&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Yt=null;function qt(e,t,n,r){if(Yt=null,null!==(e=ya(e=we(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ue(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,$t=null;function en(){if($t)return $t;var e,t,n=Qt,r=n.length,a="value"in Jt?Jt.value:Jt.textContent,o=a.length;for(e=0;e<r&&n[e]===a[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===a[o-t];t++);return $t=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,o){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),dn=O({},cn,{view:0,detail:0}),hn=an(dn),pn=O({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=an(pn),mn=an(O({},pn,{dataTransfer:0})),gn=an(O({},dn,{relatedTarget:0})),xn=an(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=an(yn),bn=an(O({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=jn[e])&&!!t[e]}function Nn(){return Cn}var _n=O({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sn=an(_n),En=an(O({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=an(O({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nn})),In=an(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=O({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(Tn),Dn=[9,13,27,32],Mn=u&&"CompositionEvent"in window,Rn=null;u&&"documentMode"in document&&(Rn=document.documentMode);var Fn=u&&"TextEvent"in window&&!Rn,On=u&&(!Mn||Rn&&8<Rn&&11>=Rn),Bn=String.fromCharCode(32),Ln=!1;function zn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Un={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Un[e.type]:"textarea"===t}function Gn(e,t,n,r){_e(r),0<(t=Kr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Xn=null;function Yn(e){Br(e,0)}function qn(e){if(X(ba(e)))return e}function Zn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Qn;if(u){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Qn=$n}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),Xn=Kn=null)}function nr(e){if("value"===e.propertyName&&qn(Xn)){var t=[];Gn(t,Xn,e,we(e)),Te(Yn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return qn(Xn)}function or(e,t){if("click"===e)return qn(t)}function ir(e,t){if("input"===e||"change"===e)return qn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,o=Math.min(r.start,a);r=void 0===r.end?o:Math.min(r.end,a),!e.extend&&o>r&&(a=r,r=o,o=a),a=ur(n,o);var i=ur(n,r);a&&i&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,xr=null,yr=null,vr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vr||null==gr||gr!==Y(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Kr(xr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},jr={},Cr={};function Nr(e){if(jr[e])return jr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return jr[e]=n[t];return e}u&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var _r=Nr("animationend"),Sr=Nr("animationiteration"),Er=Nr("animationstart"),Ar=Nr("transitionend"),Ir=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Ir.set(e,t),l(t,[e])}for(var Dr=0;Dr<Tr.length;Dr++){var Mr=Tr[Dr];Pr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Pr(_r,"onAnimationEnd"),Pr(Sr,"onAnimationIteration"),Pr(Er,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Ar,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Or(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,i,s,l,c){if(We.apply(this,arguments),Fe){if(!Fe)throw Error(o(198));var u=Oe;Fe=!1,Oe=null,Be||(Be=!0,Le=u)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var s=r[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&a.isPropagationStopped())break e;Or(a,s,c),o=l}else for(i=0;i<r.length;i++){if(l=(s=r[i]).instance,c=s.currentTarget,s=s.listener,l!==o&&a.isPropagationStopped())break e;Or(a,s,c),o=l}}}if(Be)throw e=Le,Be=!1,Le=null,e}function Lr(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(Ur(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Ur(n,e,r,t)}var Wr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Wr]){e[Wr]=!0,i.forEach(function(t){"selectionchange"!==t&&(Fr.has(t)||zr(t,!1,e),zr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wr]||(t[Wr]=!0,zr("selectionchange",!1,t))}}function Ur(e,t,n,r){switch(Zt(t)){case 1:var a=Gt;break;case 4:a=Kt;break;default:a=Xt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,a){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===i)for(i=r.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;i=i.return}for(;null!==s;){if(null===(i=ya(s)))return;if(5===(l=i.tag)||6===l){r=o=i;continue e}s=s.parentNode}}r=r.return}Te(function(){var r=o,a=we(n),i=[];e:{var s=Ir.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Sn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case _r:case Sr:case Er:l=xn;break;case Ar:l=In;break;case"scroll":l=hn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Pe(f,h))&&u.push(Gr(f,m,p)))),d)break;f=f.return}0<u.length&&(s=new l(s,c,null,n,a),i.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[fa])&&(l||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(d=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=En,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?s:ba(l),p=null==c?s:ba(c),(s=new u(m,f+"leave",l,n,a)).target=d,s.relatedTarget=p,m=null,ya(a)===r&&((u=new u(h,f+"enter",c,n,a)).target=p,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Xr(p))f++;for(p=0,m=h;m;m=Xr(m))p++;for(;0<f-p;)u=Xr(u),f--;for(;0<p-f;)h=Xr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Xr(u),h=Xr(h)}u=null}else u=null;null!==l&&Yr(i,s,l,u,!1),null!==c&&null!==d&&Yr(i,d,c,u,!0)}if("select"===(l=(s=r?ba(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Zn;else if(Hn(s))if(Jn)g=ir;else{g=ar;var x=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Gn(i,g,n,a):(x&&x(e,s,r),"focusout"===e&&(x=s._wrapperState)&&x.controlled&&"number"===s.type&&ee(s,"number",s.value)),x=r?ba(r):window,e){case"focusin":(Hn(x)||"true"===x.contentEditable)&&(gr=x,xr=r,yr=null);break;case"focusout":yr=xr=gr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,br(i,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":br(i,n,a)}var y;if(Mn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Vn?zn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(On&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==v?"onCompositionEnd"===v&&Vn&&(y=en()):(Qt="value"in(Jt=a)?Jt.value:Jt.textContent,Vn=!0)),0<(x=Kr(r,v)).length&&(v=new bn(v,e,null,n,a),i.push({event:v,listeners:x}),y?v.data=y:null!==(y=Wn(n))&&(v.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Ln=!0,Bn);case"textInput":return(e=t.data)===Bn&&Ln?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Mn&&zn(e,t)?(e=en(),$t=Qt=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(a=new bn("onBeforeInput","beforeinput",null,n,a),i.push({event:a,listeners:r}),a.data=y))}Br(i,t)})}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,o=a.stateNode;5===a.tag&&null!==o&&(a=o,null!=(o=Pe(e,n))&&r.unshift(Gr(e,o,a)),null!=(o=Pe(e,t))&&r.push(Gr(e,o,a))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,a){for(var o=t._reactName,i=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(l=Pe(n,o))&&i.unshift(Gr(n,l,s)):a||null!=(l=Pe(n,o))&&i.push(Gr(n,l,s))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var qr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(qr,"\n").replace(Zr,"")}function Qr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(o(425))}function $r(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,oa="function"===typeof Promise?Promise:void 0,ia="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oa?function(e){return oa.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout(function(){throw e})}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Vt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),ha="__reactFiber$"+da,pa="__reactProps$"+da,fa="__reactContainer$"+da,ma="__reactEvents$"+da,ga="__reactListeners$"+da,xa="__reactHandles$"+da;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[ha])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function va(e){return!(e=e[ha]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ba(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wa(e){return e[pa]||null}var ka=[],ja=-1;function Ca(e){return{current:e}}function Na(e){0>ja||(e.current=ka[ja],ka[ja]=null,ja--)}function _a(e,t){ja++,ka[ja]=e.current,e.current=t}var Sa={},Ea=Ca(Sa),Aa=Ca(!1),Ia=Sa;function Ta(e,t){var n=e.type.contextTypes;if(!n)return Sa;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,o={};for(a in n)o[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Pa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Na(Aa),Na(Ea)}function Ma(e,t,n){if(Ea.current!==Sa)throw Error(o(168));_a(Ea,t),_a(Aa,n)}function Ra(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(o(108,U(e)||"Unknown",a));return O({},n,r)}function Fa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sa,Ia=Ea.current,_a(Ea,e),_a(Aa,Aa.current),!0}function Oa(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Ra(e,t,Ia),r.__reactInternalMemoizedMergedChildContext=e,Na(Aa),Na(Ea),_a(Ea,e)):Na(Aa),_a(Aa,n)}var Ba=null,La=!1,za=!1;function Wa(e){null===Ba?Ba=[e]:Ba.push(e)}function Va(){if(!za&&null!==Ba){za=!0;var e=0,t=vt;try{var n=Ba;for(vt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ba=null,La=!1}catch(a){throw null!==Ba&&(Ba=Ba.slice(e+1)),Xe($e,Va),a}finally{vt=t,za=!1}}return null}var Ua=[],Ha=0,Ga=null,Ka=0,Xa=[],Ya=0,qa=null,Za=1,Ja="";function Qa(e,t){Ua[Ha++]=Ka,Ua[Ha++]=Ga,Ga=e,Ka=t}function $a(e,t,n){Xa[Ya++]=Za,Xa[Ya++]=Ja,Xa[Ya++]=qa,qa=e;var r=Za;e=Ja;var a=32-it(r)-1;r&=~(1<<a),n+=1;var o=32-it(t)+a;if(30<o){var i=a-a%5;o=(r&(1<<i)-1).toString(32),r>>=i,a-=i,Za=1<<32-it(t)+a|n<<a|r,Ja=o+e}else Za=1<<o|n<<a|r,Ja=e}function eo(e){null!==e.return&&(Qa(e,1),$a(e,1,0))}function to(e){for(;e===Ga;)Ga=Ua[--Ha],Ua[Ha]=null,Ka=Ua[--Ha],Ua[Ha]=null;for(;e===qa;)qa=Xa[--Ya],Xa[Ya]=null,Ja=Xa[--Ya],Xa[Ya]=null,Za=Xa[--Ya],Xa[Ya]=null}var no=null,ro=null,ao=!1,oo=null;function io(e,t){var n=Tc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==qa?{id:Za,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(ao){var t=ro;if(t){var n=t;if(!so(e,t)){if(lo(e))throw Error(o(418));t=ca(n.nextSibling);var r=no;t&&so(e,t)?io(r,n):(e.flags=-4097&e.flags|2,ao=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,ao=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!ao)return uo(e),ao=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw po(),Error(o(418));for(;t;)io(e,t),t=ca(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ca(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=ca(e.nextSibling)}function fo(){ro=no=null,ao=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=b.ReactCurrentBatchConfig;function xo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var a=r,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=a.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vo(e){return(0,e._init)(e._payload)}function bo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Oc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===j?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&vo(o)===t.type)?((r=a(t,n.props)).ref=xo(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=xo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Rc(n,e.mode,r,o)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=xo(e,null,t),n.return=e,n;case k:return(t=Bc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Rc(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case k:return n.key===a?u(e,t,n,r):null;case P:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||R(n))return null!==a?null:d(e,t,n,r,null);yo(e,n)}return null}function f(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case P:return f(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||R(r))return d(t,e=e.get(n)||null,r,a,null);yo(t,r)}return null}function m(a,o,s,l){for(var c=null,u=null,d=o,m=o=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var x=p(a,d,s[m],l);if(null===x){null===d&&(d=g);break}e&&d&&null===x.alternate&&t(a,d),o=i(x,o,m),null===u?c=x:u.sibling=x,u=x,d=g}if(m===s.length)return n(a,d),ao&&Qa(a,m),c;if(null===d){for(;m<s.length;m++)null!==(d=h(a,s[m],l))&&(o=i(d,o,m),null===u?c=d:u.sibling=d,u=d);return ao&&Qa(a,m),c}for(d=r(a,d);m<s.length;m++)null!==(g=f(d,a,m,s[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=i(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(a,e)}),ao&&Qa(a,m),c}function g(a,s,l,c){var u=R(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var d=u=null,m=s,g=s=0,x=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(x=m,m=null):x=m.sibling;var v=p(a,m,y.value,c);if(null===v){null===m&&(m=x);break}e&&m&&null===v.alternate&&t(a,m),s=i(v,s,g),null===d?u=v:d.sibling=v,d=v,m=x}if(y.done)return n(a,m),ao&&Qa(a,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(a,y.value,c))&&(s=i(y,s,g),null===d?u=y:d.sibling=y,d=y);return ao&&Qa(a,g),u}for(m=r(a,m);!y.done;g++,y=l.next())null!==(y=f(m,a,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=i(y,s,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(a,e)}),ao&&Qa(a,g),u}return function e(r,o,i,l){if("object"===typeof i&&null!==i&&i.type===j&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,u=o;null!==u;){if(u.key===c){if((c=i.type)===j){if(7===u.tag){n(r,u.sibling),(o=a(u,i.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&vo(c)===u.type){n(r,u.sibling),(o=a(u,i.props)).ref=xo(r,u,i),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}i.type===j?((o=Rc(i.props.children,r.mode,l,i.key)).return=r,r=o):((l=Mc(i.type,i.key,i.props,null,r.mode,l)).ref=xo(r,o,i),l.return=r,r=l)}return s(r);case k:e:{for(u=i.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===i.containerInfo&&o.stateNode.implementation===i.implementation){n(r,o.sibling),(o=a(o,i.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Bc(i,r.mode,l)).return=r,r=o}return s(r);case P:return e(r,o,(u=i._init)(i._payload),l)}if(te(i))return m(r,o,i,l);if(R(i))return g(r,o,i,l);yo(r,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==o&&6===o.tag?(n(r,o.sibling),(o=a(o,i)).return=r,r=o):(n(r,o),(o=Oc(i,r.mode,l)).return=r,r=o),s(r)):n(r,o)}}var wo=bo(!0),ko=bo(!1),jo=Ca(null),Co=null,No=null,_o=null;function So(){_o=No=Co=null}function Eo(e){var t=jo.current;Na(jo),e._currentValue=t}function Ao(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Io(e,t){Co=e,_o=No=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vs=!0),e.firstContext=null)}function To(e){var t=e._currentValue;if(_o!==e)if(e={context:e,memoizedValue:t,next:null},null===No){if(null===Co)throw Error(o(308));No=e,Co.dependencies={lanes:0,firstContext:e}}else No=No.next=e;return t}var Po=null;function Do(e){null===Po?Po=[e]:Po.push(e)}function Mo(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Do(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ro(e,r)}function Ro(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Fo=!1;function Oo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&El)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ro(e,n)}return null===(a=r.interleaved)?(t.next=t,Do(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ro(e,n)}function Wo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Vo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?a=o=i:o=o.next=i,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Uo(e,t,n,r){var a=e.updateQueue;Fo=!1;var o=a.firstBaseUpdate,i=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var l=s,c=l.next;l.next=null,null===i?o=c:i.next=c,i=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=a.baseState;for(i=0,u=c=l=null,s=o;;){var h=s.lane,p=s.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=O({},d,h);break e;case 2:Fo=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,i|=h;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(h=s).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{i|=a.lane,a=a.next}while(a!==t)}else null===o&&(a.shared.lanes=0);Fl|=i,e.lanes=i,e.memoizedState=d}}function Ho(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(o(191,a));a.call(r)}}}var Go={},Ko=Ca(Go),Xo=Ca(Go),Yo=Ca(Go);function qo(e){if(e===Go)throw Error(o(174));return e}function Zo(e,t){switch(_a(Yo,t),_a(Xo,e),_a(Ko,Go),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Na(Ko),_a(Ko,t)}function Jo(){Na(Ko),Na(Xo),Na(Yo)}function Qo(e){qo(Yo.current);var t=qo(Ko.current),n=le(t,e.type);t!==n&&(_a(Xo,e),_a(Ko,n))}function $o(e){Xo.current===e&&(Na(Ko),Na(Xo))}var ei=Ca(0);function ti(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ni=[];function ri(){for(var e=0;e<ni.length;e++)ni[e]._workInProgressVersionPrimary=null;ni.length=0}var ai=b.ReactCurrentDispatcher,oi=b.ReactCurrentBatchConfig,ii=0,si=null,li=null,ci=null,ui=!1,di=!1,hi=0,pi=0;function fi(){throw Error(o(321))}function mi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function gi(e,t,n,r,a,i){if(ii=i,si=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ai.current=null===e||null===e.memoizedState?$i:es,e=n(r,a),di){i=0;do{if(di=!1,hi=0,25<=i)throw Error(o(301));i+=1,ci=li=null,t.updateQueue=null,ai.current=ts,e=n(r,a)}while(di)}if(ai.current=Qi,t=null!==li&&null!==li.next,ii=0,ci=li=si=null,ui=!1,t)throw Error(o(300));return e}function xi(){var e=0!==hi;return hi=0,e}function yi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ci?si.memoizedState=ci=e:ci=ci.next=e,ci}function vi(){if(null===li){var e=si.alternate;e=null!==e?e.memoizedState:null}else e=li.next;var t=null===ci?si.memoizedState:ci.next;if(null!==t)ci=t,li=e;else{if(null===e)throw Error(o(310));e={memoizedState:(li=e).memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},null===ci?si.memoizedState=ci=e:ci=ci.next=e}return ci}function bi(e,t){return"function"===typeof t?t(e):t}function wi(e){var t=vi(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=li,a=r.baseQueue,i=n.pending;if(null!==i){if(null!==a){var s=a.next;a.next=i.next,i.next=s}r.baseQueue=a=i,n.pending=null}if(null!==a){i=a.next,r=r.baseState;var l=s=null,c=null,u=i;do{var d=u.lane;if((ii&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,s=r):c=c.next=h,si.lanes|=d,Fl|=d}u=u.next}while(null!==u&&u!==i);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(vs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{i=a.lane,si.lanes|=i,Fl|=i,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ki(e){var t=vi(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{i=e(i,s.action),s=s.next}while(s!==a);sr(i,t.memoizedState)||(vs=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ji(){}function Ci(e,t){var n=si,r=vi(),a=t(),i=!sr(r.memoizedState,a);if(i&&(r.memoizedState=a,vs=!0),r=r.queue,Fi(Si.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==ci&&1&ci.memoizedState.tag){if(n.flags|=2048,Ti(9,_i.bind(null,n,r,a,t),void 0,null),null===Al)throw Error(o(349));0!==(30&ii)||Ni(n,t,a)}return a}function Ni(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=si.updateQueue)?(t={lastEffect:null,stores:null},si.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _i(e,t,n,r){t.value=n,t.getSnapshot=r,Ei(t)&&Ai(e)}function Si(e,t,n){return n(function(){Ei(t)&&Ai(e)})}function Ei(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Ai(e){var t=Ro(e,1);null!==t&&nc(t,e,1,-1)}function Ii(e){var t=yi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=Yi.bind(null,si,e),[t.memoizedState,e]}function Ti(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=si.updateQueue)?(t={lastEffect:null,stores:null},si.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Pi(){return vi().memoizedState}function Di(e,t,n,r){var a=yi();si.flags|=e,a.memoizedState=Ti(1|t,n,void 0,void 0===r?null:r)}function Mi(e,t,n,r){var a=vi();r=void 0===r?null:r;var o=void 0;if(null!==li){var i=li.memoizedState;if(o=i.destroy,null!==r&&mi(r,i.deps))return void(a.memoizedState=Ti(t,n,o,r))}si.flags|=e,a.memoizedState=Ti(1|t,n,o,r)}function Ri(e,t){return Di(8390656,8,e,t)}function Fi(e,t){return Mi(2048,8,e,t)}function Oi(e,t){return Mi(4,2,e,t)}function Bi(e,t){return Mi(4,4,e,t)}function Li(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mi(4,4,Li.bind(null,t,e),n)}function Wi(){}function Vi(e,t){var n=vi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ui(e,t){var n=vi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mi(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Hi(e,t,n){return 0===(21&ii)?(e.baseState&&(e.baseState=!1,vs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),si.lanes|=n,Fl|=n,e.baseState=!0),t)}function Gi(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var r=oi.transition;oi.transition={};try{e(!1),t()}finally{vt=n,oi.transition=r}}function Ki(){return vi().memoizedState}function Xi(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},qi(e))Zi(t,n);else if(null!==(n=Mo(e,t,n,r))){nc(n,e,r,ec()),Ji(n,t,r)}}function Yi(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(qi(e))Zi(t,a);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var i=t.lastRenderedState,s=o(i,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,i)){var l=t.interleaved;return null===l?(a.next=a,Do(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Mo(e,t,a,r))&&(nc(n,e,r,a=ec()),Ji(n,t,r))}}function qi(e){var t=e.alternate;return e===si||null!==t&&t===si}function Zi(e,t){di=ui=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ji(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Qi={readContext:To,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},$i={readContext:To,useCallback:function(e,t){return yi().memoizedState=[e,void 0===t?null:t],e},useContext:To,useEffect:Ri,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Di(4194308,4,Li.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Di(4194308,4,e,t)},useInsertionEffect:function(e,t){return Di(4,2,e,t)},useMemo:function(e,t){var n=yi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yi();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Xi.bind(null,si,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yi().memoizedState=e},useState:Ii,useDebugValue:Wi,useDeferredValue:function(e){return yi().memoizedState=e},useTransition:function(){var e=Ii(!1),t=e[0];return e=Gi.bind(null,e[1]),yi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=si,a=yi();if(ao){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Al)throw Error(o(349));0!==(30&ii)||Ni(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Ri(Si.bind(null,r,i,e),[e]),r.flags|=2048,Ti(9,_i.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=yi(),t=Al.identifierPrefix;if(ao){var n=Ja;t=":"+t+"R"+(n=(Za&~(1<<32-it(Za)-1)).toString(32)+n),0<(n=hi++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:To,useCallback:Vi,useContext:To,useEffect:Fi,useImperativeHandle:zi,useInsertionEffect:Oi,useLayoutEffect:Bi,useMemo:Ui,useReducer:wi,useRef:Pi,useState:function(){return wi(bi)},useDebugValue:Wi,useDeferredValue:function(e){return Hi(vi(),li.memoizedState,e)},useTransition:function(){return[wi(bi)[0],vi().memoizedState]},useMutableSource:ji,useSyncExternalStore:Ci,useId:Ki,unstable_isNewReconciler:!1},ts={readContext:To,useCallback:Vi,useContext:To,useEffect:Fi,useImperativeHandle:zi,useInsertionEffect:Oi,useLayoutEffect:Bi,useMemo:Ui,useReducer:ki,useRef:Pi,useState:function(){return ki(bi)},useDebugValue:Wi,useDeferredValue:function(e){var t=vi();return null===li?t.memoizedState=e:Hi(t,li.memoizedState,e)},useTransition:function(){return[ki(bi)[0],vi().memoizedState]},useMutableSource:ji,useSyncExternalStore:Ci,useId:Ki,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var as={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),o=Lo(r,a);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,a))&&(nc(t,e,a,r),Wo(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),o=Lo(r,a);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=zo(e,o,a))&&(nc(t,e,a,r),Wo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Lo(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=zo(e,a,r))&&(nc(t,e,r,n),Wo(t,e,r))}};function os(e,t,n,r,a,o,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,i):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,o))}function is(e,t,n){var r=!1,a=Sa,o=t.contextType;return"object"===typeof o&&null!==o?o=To(o):(a=Pa(t)?Ia:Ea.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ta(e,a):Sa),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=as,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&as.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Oo(e);var o=t.contextType;"object"===typeof o&&null!==o?a.context=To(o):(o=Pa(t)?Ia:Ea.current,a.context=Ta(e,o)),a.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(rs(e,t,o,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&as.enqueueReplaceState(a,a.state,null),Uo(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do{n+=W(r),r=r.return}while(r);var a=n}catch(o){a="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:a,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Lo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Gl=r),ds(0,t)},n}function fs(e,t,n){(n=Lo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ds(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Nc.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xs(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Lo(-1,1)).tag=2,zo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var ys=b.ReactCurrentOwner,vs=!1;function bs(e,t,n,r){t.child=null===e?ko(t,null,n,r):wo(t,e.child,n,r)}function ws(e,t,n,r,a){n=n.render;var o=t.ref;return Io(t,a),r=gi(e,t,n,r,o,a),n=xi(),null===e||vs?(ao&&n&&eo(t),t.flags|=1,bs(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function ks(e,t,n,r,a){if(null===e){var o=n.type;return"function"!==typeof o||Pc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,js(e,t,o,r,a))}if(o=e.child,0===(e.lanes&a)){var i=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(i,r)&&e.ref===t.ref)return Hs(e,t,a)}return t.flags|=1,(e=Dc(o,r)).ref=t.ref,e.return=t,t.child=e}function js(e,t,n,r,a){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(vs=!1,t.pendingProps=r=o,0===(e.lanes&a))return t.lanes=e.lanes,Hs(e,t,a);0!==(131072&e.flags)&&(vs=!0)}}return _s(e,t,n,r,a)}function Cs(e,t,n){var r=t.pendingProps,a=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_a(Dl,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_a(Dl,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,_a(Dl,Pl),Pl|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,_a(Dl,Pl),Pl|=r;return bs(e,t,a,n),t.child}function Ns(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _s(e,t,n,r,a){var o=Pa(n)?Ia:Ea.current;return o=Ta(t,o),Io(t,a),n=gi(e,t,n,r,o,a),r=xi(),null===e||vs?(ao&&r&&eo(t),t.flags|=1,bs(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Ss(e,t,n,r,a){if(Pa(n)){var o=!0;Fa(t)}else o=!1;if(Io(t,a),null===t.stateNode)Us(e,t),is(t,n,r),ls(t,n,r,a),r=!0;else if(null===e){var i=t.stateNode,s=t.memoizedProps;i.props=s;var l=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=To(c):c=Ta(t,c=Pa(n)?Ia:Ea.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==r||l!==c)&&ss(t,i,r,c),Fo=!1;var h=t.memoizedState;i.state=h,Uo(t,r,i,a),l=t.memoizedState,s!==r||h!==l||Aa.current||Fo?("function"===typeof u&&(rs(t,n,u,r),l=t.memoizedState),(s=Fo||os(t,n,s,r,h,l,c))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=s):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Bo(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),i.props=c,d=t.pendingProps,h=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=To(l):l=Ta(t,l=Pa(n)?Ia:Ea.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==d||h!==l)&&ss(t,i,r,l),Fo=!1,h=t.memoizedState,i.state=h,Uo(t,r,i,a);var f=t.memoizedState;s!==d||h!==f||Aa.current||Fo?("function"===typeof p&&(rs(t,n,p,r),f=t.memoizedState),(c=Fo||os(t,n,c,r,h,f,l)||!1)?(u||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,f,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),i.props=r,i.state=f,i.context=l,r=c):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Es(e,t,n,r,o,a)}function Es(e,t,n,r,a,o){Ns(e,t);var i=0!==(128&t.flags);if(!r&&!i)return a&&Oa(t,n,!1),Hs(e,t,o);r=t.stateNode,ys.current=t;var s=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=wo(t,e.child,null,o),t.child=wo(t,null,s,o)):bs(e,t,s,o),t.memoizedState=r.state,a&&Oa(t,n,!0),t.child}function As(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),Zo(e,t.containerInfo)}function Is(e,t,n,r,a){return fo(),mo(a),t.flags|=256,bs(e,t,n,r),t.child}var Ts,Ps,Ds,Ms,Rs={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Os(e,t,n){var r,a=t.pendingProps,i=ei.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),_a(ei,1&i),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,s?(a=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Fc(l,a,0,null),e=Rc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(n),t.memoizedState=Rs,e):Bs(t,l));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,a,i,s){if(n)return 256&t.flags?(t.flags&=-257,Ls(e,t,s,r=us(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=Fc({mode:"visible",children:r.children},a,0,null),(i=Rc(i,a,s,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!==(1&t.mode)&&wo(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=Rs,i);if(0===(1&t.mode))return Ls(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Ls(e,t,s,r=us(i=Error(o(419)),r,void 0))}if(l=0!==(s&e.childLanes),vs||l){if(null!==(r=Al)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==i.retryLane&&(i.retryLane=a,Ro(e,a),nc(r,e,a,-1))}return mc(),Ls(e,t,s,r=us(Error(o(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ro=ca(a.nextSibling),no=t,ao=!0,oo=null,null!==e&&(Xa[Ya++]=Za,Xa[Ya++]=Ja,Xa[Ya++]=qa,Za=e.id,Ja=e.overflow,qa=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,i,n);if(s){s=a.fallback,l=t.mode,r=(i=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==i?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Dc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==r?s=Dc(r,s):(s=Rc(s,l,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,l=null===(l=e.child.memoizedState)?Fs(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Rs,a}return e=(s=e.child).sibling,a=Dc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bs(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ls(e,t,n,r){return null!==r&&mo(r),wo(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ao(e.return,t,n)}function Ws(e,t,n,r,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a)}function Vs(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(bs(e,t,r.children,n),0!==(2&(r=ei.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zs(e,n,t);else if(19===e.tag)zs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(_a(ei,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ti(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ws(t,!1,a,n,o);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ti(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ws(t,!0,n,null,o);break;case"together":Ws(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Us(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gs(e,t){if(!ao)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ks(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ks(t),null;case 1:case 17:return Pa(t.type)&&Da(),Ks(t),null;case 3:return r=t.stateNode,Jo(),Na(Aa),Na(Ea),ri(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(ic(oo),oo=null))),Ps(e,t),Ks(t),null;case 5:$o(t);var a=qo(Yo.current);if(n=t.type,null!==e&&null!=t.stateNode)Ds(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Ks(t),null}if(e=qo(Ko.current),ho(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[ha]=t,r[pa]=i,e=0!==(1&t.mode),n){case"dialog":Lr("cancel",r),Lr("close",r);break;case"iframe":case"object":case"embed":Lr("load",r);break;case"video":case"audio":for(a=0;a<Rr.length;a++)Lr(Rr[a],r);break;case"source":Lr("error",r);break;case"img":case"image":case"link":Lr("error",r),Lr("load",r);break;case"details":Lr("toggle",r);break;case"input":Z(r,i),Lr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Lr("invalid",r);break;case"textarea":ae(r,i),Lr("invalid",r)}for(var l in ye(n,i),a=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==i.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Lr("scroll",r)}switch(n){case"input":K(r),$(r,i,!0);break;case"textarea":K(r),ie(r);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(r.onclick=$r)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=r,Ts(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,r),n){case"dialog":Lr("cancel",e),Lr("close",e),a=r;break;case"iframe":case"object":case"embed":Lr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Rr.length;a++)Lr(Rr[a],e);a=r;break;case"source":Lr("error",e),a=r;break;case"img":case"image":case"link":Lr("error",e),Lr("load",e),a=r;break;case"details":Lr("toggle",e),a=r;break;case"input":Z(e,r),a=q(e,r),Lr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=O({},r,{value:void 0}),Lr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Lr("invalid",e)}for(i in ye(n,a),c=a)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?ge(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(s.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Lr("scroll",e):null!=u&&v(e,i,u,l))}switch(n){case"input":K(e),$(e,r,!1);break;case"textarea":K(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ks(t),null;case 6:if(e&&null!=t.stateNode)Ms(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=qo(Yo.current),qo(Ko.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(i=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return Ks(t),null;case 13:if(Na(ei),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ao&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,i=!1;else if(i=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[ha]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ks(t),i=!1}else null!==oo&&(ic(oo),oo=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ei.current)?0===Ml&&(Ml=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ks(t),null);case 4:return Jo(),Ps(e,t),null===e&&Vr(t.stateNode.containerInfo),Ks(t),null;case 10:return Eo(t.type._context),Ks(t),null;case 19:if(Na(ei),null===(i=t.memoizedState))return Ks(t),null;if(r=0!==(128&t.flags),null===(l=i.rendering))if(r)Gs(i,!1);else{if(0!==Ml||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ti(e))){for(t.flags|=128,Gs(i,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _a(ei,1&ei.current|2),t.child}e=e.sibling}null!==i.tail&&Je()>Vl&&(t.flags|=128,r=!0,Gs(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ti(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gs(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!ao)return Ks(t),null}else 2*Je()-i.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,r=!0,Gs(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,n=ei.current,_a(ei,r?1&n|2:1&n),t):(Ks(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Ks(t),6&t.subtreeFlags&&(t.flags|=8192)):Ks(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ys(e,t){switch(to(t),t.tag){case 1:return Pa(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Jo(),Na(Aa),Na(Ea),ri(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $o(t),null;case 13:if(Na(ei),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Na(ei),null;case 4:return Jo(),null;case 10:return Eo(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Ts=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(){},Ds=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,qo(Ko.current);var o,i=null;switch(n){case"input":a=q(e,a),r=q(e,r),i=[];break;case"select":a=O({},a,{value:void 0}),r=O({},r,{value:void 0}),i=[];break;case"textarea":a=re(e,a),r=re(e,r),i=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(u in ye(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Lr("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Ms=function(e,t,n,r){n!==r&&(t.flags|=4)};var qs=!1,Zs=!1,Js="function"===typeof WeakSet?WeakSet:Set,Qs=null;function $s(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Cc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var o=a.destroy;a.destroy=void 0,void 0!==o&&el(t,n,o)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[ma],delete t[ga],delete t[xa])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Zs||$s(n,t);case 6:var r=ul,a=dl;ul=null,hl(e,t,n),dl=a,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Vt(e)):la(ul,n.stateNode));break;case 4:r=ul,a=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=a;break;case 0:case 11:case 14:case 15:if(!Zs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var o=a,i=o.destroy;o=o.tag,void 0!==i&&(0!==(2&o)||0!==(4&o))&&el(n,t,i),a=a.next}while(a!==r)}hl(e,t,n);break;case 1:if(!Zs&&($s(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Cc(n,t,s)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Zs=(r=Zs)||null!==n.memoizedState,hl(e,t,n),Zs=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach(function(t){var r=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(o(160));pl(i,s,a),ul=null,dl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){Cc(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),xl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Cc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Cc(e,e.return,g)}}break;case 1:ml(t,e),xl(e),512&r&&null!==n&&$s(n,n.return);break;case 5:if(ml(t,e),xl(e),512&r&&null!==n&&$s(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Cc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var i=e.memoizedProps,s=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&J(a,i),ve(l,s);var u=ve(l,i);for(s=0;s<c.length;s+=2){var d=c[s],h=c[s+1];"style"===d?ge(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):v(a,d,h,u)}switch(l){case"input":Q(a,i);break;case"textarea":oe(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ne(a,!!i.multiple,f,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(a,!!i.multiple,i.defaultValue,!0):ne(a,!!i.multiple,i.multiple?[]:"",!1))}a[pa]=i}catch(g){Cc(e,e.return,g)}}break;case 6:if(ml(t,e),xl(e),4&r){if(null===e.stateNode)throw Error(o(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){Cc(e,e.return,g)}}break;case 3:if(ml(t,e),xl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Cc(e,e.return,g)}break;case 4:default:ml(t,e),xl(e);break;case 13:ml(t,e),xl(e),8192&(a=e.child).flags&&(i=null!==a.memoizedState,a.stateNode.isHidden=i,!i||null!==a.alternate&&null!==a.alternate.memoizedState||(Wl=Je())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Zs=(u=Zs)||d,ml(t,e),Zs=u):ml(t,e),xl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Qs=e,d=e.child;null!==d;){for(h=Qs=d;null!==Qs;){switch(f=(p=Qs).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:$s(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Cc(r,n,g)}}break;case 5:$s(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==f?(f.return=p,Qs=f):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,s=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",s))}catch(g){Cc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Cc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),xl(e),4&r&&fl(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cl(e,sl(e),a);break;case 3:case 4:var i=r.stateNode.containerInfo;ll(e,sl(e),i);break;default:throw Error(o(161))}}catch(s){Cc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Qs=e,vl(e,t,n)}function vl(e,t,n){for(var r=0!==(1&e.mode);null!==Qs;){var a=Qs,o=a.child;if(22===a.tag&&r){var i=null!==a.memoizedState||qs;if(!i){var s=a.alternate,l=null!==s&&null!==s.memoizedState||Zs;s=qs;var c=Zs;if(qs=i,(Zs=l)&&!c)for(Qs=a;null!==Qs;)l=(i=Qs).child,22===i.tag&&null!==i.memoizedState?kl(a):null!==l?(l.return=i,Qs=l):kl(a);for(;null!==o;)Qs=o,vl(o,t,n),o=o.sibling;Qs=a,qs=s,Zs=c}bl(e)}else 0!==(8772&a.subtreeFlags)&&null!==o?(o.return=a,Qs=o):bl(e)}}function bl(e){for(;null!==Qs;){var t=Qs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Zs||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Zs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ho(t,i,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ho(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(o(163))}Zs||512&t.flags&&al(t)}catch(p){Cc(t,t.return,p)}}if(t===e){Qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qs=n;break}Qs=t.return}}function wl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qs=n;break}Qs=t.return}}function kl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Cc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){Cc(t,a,l)}}var o=t.return;try{al(t)}catch(l){Cc(t,o,l)}break;case 5:var i=t.return;try{al(t)}catch(l){Cc(t,i,l)}}}catch(l){Cc(t,t.return,l)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var jl,Cl=Math.ceil,Nl=b.ReactCurrentDispatcher,_l=b.ReactCurrentOwner,Sl=b.ReactCurrentBatchConfig,El=0,Al=null,Il=null,Tl=0,Pl=0,Dl=Ca(0),Ml=0,Rl=null,Fl=0,Ol=0,Bl=0,Ll=null,zl=null,Wl=0,Vl=1/0,Ul=null,Hl=!1,Gl=null,Kl=null,Xl=!1,Yl=null,ql=0,Zl=0,Jl=null,Ql=-1,$l=0;function ec(){return 0!==(6&El)?Je():-1!==Ql?Ql:Ql=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&El)&&0!==Tl?Tl&-Tl:null!==go.transition?(0===$l&&($l=mt()),$l):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function nc(e,t,n,r){if(50<Zl)throw Zl=0,Jl=null,Error(o(185));xt(e,n,r),0!==(2&El)&&e===Al||(e===Al&&(0===(2&El)&&(Ol|=n),4===Ml&&sc(e,Tl)),rc(e,r),1===n&&0===El&&0===(1&t.mode)&&(Vl=Je()+500,La&&Va()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-it(o),s=1<<i,l=a[i];-1===l?0!==(s&n)&&0===(s&r)||(a[i]=pt(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=ht(e,e===Al?Tl:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){La=!0,Wa(e)}(lc.bind(null,e)):Wa(lc.bind(null,e)),ia(function(){0===(6&El)&&Va()}),n=null;else{switch(bt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ac(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Ql=-1,$l=0,0!==(6&El))throw Error(o(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var r=ht(e,e===Al?Tl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=El;El|=2;var i=fc();for(Al===e&&Tl===t||(Ul=null,Vl=Je()+500,hc(e,t));;)try{yc();break}catch(l){pc(e,l)}So(),Nl.current=i,El=a,null!==Il?t=0:(Al=null,Tl=0,t=Ml)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(r=a,t=oc(e,a))),1===t)throw n=Rl,hc(e,0),sc(e,r),rc(e,Je()),n;if(6===t)sc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],o=a.getSnapshot;a=a.value;try{if(!sr(o(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(i=ft(e))&&(r=i,t=oc(e,i))),1===t))throw n=Rl,hc(e,0),sc(e,r),rc(e,Je()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:wc(e,zl,Ul);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Wl+500-Je())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,zl,Ul),t);break}wc(e,zl,Ul);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-it(r);i=1<<s,(s=t[s])>a&&(a=s),r&=~i}if(r=a,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cl(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,zl,Ul),r);break}wc(e,zl,Ul);break;default:throw Error(o(329))}}}return rc(e,Je()),e.callbackNode===n?ac.bind(null,e):null}function oc(e,t){var n=Ll;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&ic(t)),e}function ic(e){null===zl?zl=e:zl.push.apply(zl,e)}function sc(e,t){for(t&=~Bl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&El))throw Error(o(327));kc();var t=ht(e,0);if(0===(1&t))return rc(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Rl,hc(e,0),sc(e,t),rc(e,Je()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Ul),rc(e,Je()),null}function cc(e,t){var n=El;El|=1;try{return e(t)}finally{0===(El=n)&&(Vl=Je()+500,La&&Va())}}function uc(e){null!==Yl&&0===Yl.tag&&0===(6&El)&&kc();var t=El;El|=1;var n=Sl.transition,r=vt;try{if(Sl.transition=null,vt=1,e)return e()}finally{vt=r,Sl.transition=n,0===(6&(El=t))&&Va()}}function dc(){Pl=Dl.current,Na(Dl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:Jo(),Na(Aa),Na(Ea),ri();break;case 5:$o(r);break;case 4:Jo();break;case 13:case 19:Na(ei);break;case 10:Eo(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Al=e,Il=e=Dc(e.current,null),Tl=Pl=t,Ml=0,Rl=null,Bl=Ol=Fl=0,zl=Ll=null,null!==Po){for(t=0;t<Po.length;t++)if(null!==(r=(n=Po[t]).interleaved)){n.interleaved=null;var a=r.next,o=n.pending;if(null!==o){var i=o.next;o.next=a,r.next=i}n.pending=r}Po=null}return e}function pc(e,t){for(;;){var n=Il;try{if(So(),ai.current=Qi,ui){for(var r=si.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}ui=!1}if(ii=0,ci=li=si=null,di=!1,hi=0,_l.current=null,null===n||null===n.return){Ml=1,Rl=t,Il=null;break}e:{var i=e,s=n.return,l=n,c=t;if(t=Tl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,xs(f,s,l,0,t),1&f.mode&&ms(i,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ms(i,u,t),mc();break e}c=Error(o(426))}else if(ao&&1&l.mode){var x=gs(s);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xs(x,s,l,0,t),mo(cs(c,l));break e}}i=c=cs(c,l),4!==Ml&&(Ml=2),null===Ll?Ll=[i]:Ll.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Vo(i,ps(0,c,t));break e;case 1:l=c;var y=i.type,v=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===Kl||!Kl.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t,Vo(i,fs(i,l,t));break e}}i=i.return}while(null!==i)}bc(n)}catch(b){t=b,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function fc(){var e=Nl.current;return Nl.current=Qi,null===e?Qi:e}function mc(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===Al||0===(268435455&Fl)&&0===(268435455&Ol)||sc(Al,Tl)}function gc(e,t){var n=El;El|=2;var r=fc();for(Al===e&&Tl===t||(Ul=null,hc(e,t));;)try{xc();break}catch(a){pc(e,a)}if(So(),El=n,Nl.current=r,null!==Il)throw Error(o(261));return Al=null,Tl=0,Ml}function xc(){for(;null!==Il;)vc(Il)}function yc(){for(;null!==Il&&!qe();)vc(Il)}function vc(e){var t=jl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?bc(e):Il=t,_l.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xs(n,t,Pl)))return void(Il=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Ml=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Ml&&(Ml=5)}function wc(e,t,n){var r=vt,a=Sl.transition;try{Sl.transition=null,vt=1,function(e,t,n,r){do{kc()}while(null!==Yl);if(0!==(6&El))throw Error(o(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-it(n),o=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~o}}(e,i),e===Al&&(Il=Al=null,Tl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,Ac(tt,function(){return kc(),null})),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Sl.transition,Sl.transition=null;var s=vt;vt=1;var l=El;El|=4,_l.current=null,function(e,t){if(ea=Ht,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==a&&3!==h.nodeType||(l=s+a),h!==i||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===a&&(l=s),p===i&&++d===r&&(c=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Ht=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,x=m.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),x);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(o(163))}}catch(w){Cc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ta),Ht=!!ea,ta=ea=null,e.current=n,yl(n,e,a),Ze(),El=l,vt=s,Sl.transition=i}else e.current=n;if(Xl&&(Xl=!1,Yl=e,ql=a),i=e.pendingLanes,0===i&&(Kl=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Hl)throw Hl=!1,e=Gl,Gl=null,e;0!==(1&ql)&&0!==e.tag&&kc(),i=e.pendingLanes,0!==(1&i)?e===Jl?Zl++:(Zl=0,Jl=e):Zl=0,Va()}(e,t,n,r)}finally{Sl.transition=a,vt=r}return null}function kc(){if(null!==Yl){var e=bt(ql),t=Sl.transition,n=vt;try{if(Sl.transition=null,vt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,ql=0,0!==(6&El))throw Error(o(331));var a=El;for(El|=4,Qs=e.current;null!==Qs;){var i=Qs,s=i.child;if(0!==(16&Qs.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qs=u;null!==Qs;){var d=Qs;switch(d.tag){case 0:case 11:case 15:nl(8,d,i)}var h=d.child;if(null!==h)h.return=d,Qs=h;else for(;null!==Qs;){var p=(d=Qs).sibling,f=d.return;if(ol(d),d===u){Qs=null;break}if(null!==p){p.return=f,Qs=p;break}Qs=f}}}var m=i.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}Qs=i}}if(0!==(2064&i.subtreeFlags)&&null!==s)s.return=i,Qs=s;else e:for(;null!==Qs;){if(0!==(2048&(i=Qs).flags))switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Qs=y;break e}Qs=i.return}}var v=e.current;for(Qs=v;null!==Qs;){var b=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Qs=b;else e:for(s=v;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(k){Cc(l,l.return,k)}if(l===s){Qs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qs=w;break e}Qs=l.return}}if(El=a,Va(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(at,e)}catch(k){}r=!0}return r}finally{vt=n,Sl.transition=t}}return!1}function jc(e,t,n){e=zo(e,t=ps(0,t=cs(n,t),1),1),t=ec(),null!==e&&(xt(e,1,t),rc(e,t))}function Cc(e,t,n){if(3===e.tag)jc(e,e,n);else for(;null!==t;){if(3===t.tag){jc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=zo(t,e=fs(t,e=cs(n,e),1),1),e=ec(),null!==t&&(xt(t,1,e),rc(t,e));break}}t=t.return}}function Nc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(Tl&n)===n&&(4===Ml||3===Ml&&(130023424&Tl)===Tl&&500>Je()-Wl?hc(e,0):Bl|=n),rc(e,t)}function _c(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ro(e,t))&&(xt(e,t,n),rc(e,n))}function Sc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),_c(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),_c(e,n)}function Ac(e,t){return Xe(e,t)}function Ic(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,n,r){return new Ic(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,a,i){var s=2;if(r=e,"function"===typeof e)Pc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case j:return Rc(n.children,a,i,t);case C:s=8,a|=8;break;case N:return(e=Tc(12,n,t,2|a)).elementType=N,e.lanes=i,e;case A:return(e=Tc(13,n,t,a)).elementType=A,e.lanes=i,e;case I:return(e=Tc(19,n,t,a)).elementType=I,e.lanes=i,e;case D:return Fc(n,a,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:s=10;break e;case S:s=9;break e;case E:s=11;break e;case T:s=14;break e;case P:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Tc(s,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function Rc(e,t,n,r){return(e=Tc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Tc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Oc(e,t,n){return(e=Tc(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,a,o,i,s,l){return e=new Lc(e,t,n,s,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Tc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oo(o),e}function Wc(e){if(!e)return Sa;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Pa(n))return Ra(e,n,t)}return t}function Vc(e,t,n,r,a,o,i,s,l){return(e=zc(n,r,!0,e,0,o,0,s,l)).context=Wc(null),n=e.current,(o=Lo(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,zo(n,o,a),e.current.lanes=a,xt(e,a,r),rc(e,r),e}function Uc(e,t,n,r){var a=t.current,o=ec(),i=tc(a);return n=Wc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Lo(o,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zo(a,t,i))&&(nc(e,a,i,o),Wo(e,a,i)),i}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}jl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Aa.current)vs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return vs=!1,function(e,t,n){switch(t.tag){case 3:As(t),fo();break;case 5:Qo(t);break;case 1:Pa(t.type)&&Fa(t);break;case 4:Zo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;_a(jo,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(_a(ei,1&ei.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Os(e,t,n):(_a(ei,1&ei.current),null!==(e=Hs(e,t,n))?e.sibling:null);_a(ei,1&ei.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vs(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),_a(ei,ei.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Hs(e,t,n)}(e,t,n);vs=0!==(131072&e.flags)}else vs=!1,ao&&0!==(1048576&t.flags)&&$a(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Us(e,t),e=t.pendingProps;var a=Ta(t,Ea.current);Io(t,n),a=gi(null,t,r,e,a,n);var i=xi();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pa(r)?(i=!0,Fa(t)):i=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Oo(t),a.updater=as,t.stateNode=a,a._reactInternals=t,ls(t,r,e,n),t=Es(null,t,r,!0,i,n)):(t.tag=0,ao&&i&&eo(t),bs(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Us(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===T)return 14}return 2}(r),e=ns(r,e),a){case 0:t=_s(null,t,r,e,n);break e;case 1:t=Ss(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=ks(null,t,r,ns(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,_s(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 1:return r=t.type,a=t.pendingProps,Ss(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 3:e:{if(As(t),null===e)throw Error(o(387));r=t.pendingProps,a=(i=t.memoizedState).element,Bo(e,t),Uo(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Is(e,t,r,n,a=cs(Error(o(423)),t));break e}if(r!==a){t=Is(e,t,r,n,a=cs(Error(o(424)),t));break e}for(ro=ca(t.stateNode.containerInfo.firstChild),no=t,ao=!0,oo=null,n=ko(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===a){t=Hs(e,t,n);break e}bs(e,t,r,n)}t=t.child}return t;case 5:return Qo(t),null===e&&co(t),r=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==i&&na(r,i)&&(t.flags|=32),Ns(e,t),bs(e,t,s,n),t.child;case 6:return null===e&&co(t),null;case 13:return Os(e,t,n);case 4:return Zo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wo(t,null,r,n):bs(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ws(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 7:return bs(e,t,t.pendingProps,n),t.child;case 8:case 12:return bs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,_a(jo,r._currentValue),r._currentValue=s,null!==i)if(sr(i.value,s)){if(i.children===a.children&&!Aa.current){t=Hs(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){s=i.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===i.tag){(c=Lo(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Ao(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ao(s,n,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}bs(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Io(t,n),r=r(a=To(a)),t.flags|=1,bs(e,t,r,n),t.child;case 14:return a=ns(r=t.type,t.pendingProps),ks(e,t,r,a=ns(r.type,a),n);case 15:return js(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ns(r,a),Us(e,t),t.tag=1,Pa(r)?(e=!0,Fa(t)):e=!1,Io(t,n),is(t,r,a),ls(t,r,a,n),Es(null,t,r,!0,e,n);case 19:return Vs(e,t,n);case 22:return Cs(e,t,n)}throw Error(o(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function qc(e){this._internalRoot=e}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function $c(e,t,n,r,a){var o=n._reactRootContainer;if(o){var i=o;if("function"===typeof a){var s=a;a=function(){var e=Hc(i);s.call(e)}}Uc(t,i,e,a)}else i=function(e,t,n,r,a){if(a){if("function"===typeof r){var o=r;r=function(){var e=Hc(i);o.call(e)}}var i=Vc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=i,e[fa]=i.current,Vr(8===e.nodeType?e.parentNode:e),uc(),i}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Hc(l);s.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[fa]=l.current,Vr(8===e.nodeType?e.parentNode:e),uc(function(){Uc(t,l,n,r)}),l}(n,t,e,a,r);return Hc(i)}qc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Uc(e,t,null,null)},qc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Uc(null,e,null,null)}),t[fa]=null}},qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Je()),0===(6&El)&&(Vl=Je()+500,Va()))}break;case 13:uc(function(){var t=Ro(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Kc(e,1)}},kt=function(e){if(13===e.tag){var t=Ro(e,134217728);if(null!==t)nc(t,e,134217728,ec());Kc(e,134217728)}},jt=function(e){if(13===e.tag){var t=tc(e),n=Ro(e,t);if(null!==n)nc(n,e,t,ec());Kc(e,t)}},Ct=function(){return vt},Nt=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},ke=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(o(90));X(r),Q(r,a)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=cc,Ae=uc;var eu={usingClientEntryPoint:!1,Events:[va,ba,wa,_e,Se,cc]},tu={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{at=ru.inject(nu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zc(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zc(e))throw Error(o(299));var n=!1,r="",a=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,a),e[fa]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(o(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zc(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,a=!1,i="",s=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,a,0,i,s),e[fa]=t.current,Vr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new qc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(o(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return $c(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>i[e]=()=>r[e]);return i.default=()=>r,n.d(o,i),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r,a=n(43),o=n.t(a,2),i=n(391);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function d(e,t){return{usr:e.state,key:e.key,idx:t}}function h(e,t,n,r){return void 0===n&&(n=null),s({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function f(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function m(e,t,n,a){void 0===a&&(a={});let{window:o=document.defaultView,v5Compat:i=!1}=a,u=o.history,f=r.Pop,m=null,g=x();function x(){return(u.state||{idx:null}).idx}function y(){f=r.Pop;let e=x(),t=null==e?null:e-g;g=e,m&&m({action:f,location:b.location,delta:t})}function v(e){let t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"===typeof e?e:p(e);return n=n.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,u.replaceState(s({},u.state,{idx:g}),""));let b={get action(){return f},get location(){return e(o,u)},listen(e){if(m)throw new Error("A history only accepts one active listener");return o.addEventListener(l,y),m=e,()=>{o.removeEventListener(l,y),m=null}},createHref:e=>t(o,e),createURL:v,encodeLocation(e){let t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){f=r.Push;let a=h(b.location,e,t);n&&n(a,e),g=x()+1;let s=d(a,g),l=b.createHref(a);try{u.pushState(s,"",l)}catch(c){if(c instanceof DOMException&&"DataCloneError"===c.name)throw c;o.location.assign(l)}i&&m&&m({action:f,location:b.location,delta:1})},replace:function(e,t){f=r.Replace;let a=h(b.location,e,t);n&&n(a,e),g=x();let o=d(a,g),s=b.createHref(a);u.replaceState(o,"",s),i&&m&&m({action:f,location:b.location,delta:0})},go:e=>u.go(e)};return b}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function x(e,t,n){return void 0===n&&(n="/"),y(e,t,n,!1)}function y(e,t,n,r){let a=P(("string"===typeof t?f(t):t).pathname||"/",n);if(null==a)return null;let o=v(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let i=null;for(let s=0;null==i&&s<o.length;++s){let e=T(a);i=A(o[s],e,r)}return i}function v(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(e,a,o)=>{let i={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};i.relativePath.startsWith("/")&&(c(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(r.length));let s=O([r,i.relativePath]),l=n.concat(i);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),v(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:E(s,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of b(e.path))a(e,t,r);else a(e,t)}),t}function b(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return a?[o,""]:[o];let i=b(r.join("/")),s=[];return s.push(...i.map(e=>""===e?o:[o,e].join("/"))),a&&s.push(...i),s.map(t=>e.startsWith("/")&&""===t?"/":t)}const w=/^:[\w-]+$/,k=3,j=2,C=1,N=10,_=-2,S=e=>"*"===e;function E(e,t){let n=e.split("/"),r=n.length;return n.some(S)&&(r+=_),t&&(r+=j),n.filter(e=>!S(e)).reduce((e,t)=>e+(w.test(t)?k:""===t?C:N),r)}function A(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,a={},o="/",i=[];for(let s=0;s<r.length;++s){let e=r[s],l=s===r.length-1,c="/"===o?t:t.slice(o.length)||"/",u=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),i.push({params:a,pathname:O([o,u.pathname]),pathnameBase:B(O([o,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(o=O([o,u.pathnameBase]))}return i}function I(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);u("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let o=new RegExp(a,t?void 0:"i");return[o,r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),s=a.slice(1),l=r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=s[n]||"";i=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:o,pathnameBase:i,pattern:e}}function T(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return u(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function D(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function M(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function R(e,t){let n=M(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function F(e,t,n,r){let a;void 0===r&&(r=!1),"string"===typeof e?a=f(e):(a=s({},e),c(!a.pathname||!a.pathname.includes("?"),D("?","pathname","search",a)),c(!a.pathname||!a.pathname.includes("#"),D("#","pathname","hash",a)),c(!a.search||!a.search.includes("#"),D("#","search","hash",a)));let o,i=""===e||""===a.pathname,l=i?"/":a.pathname;if(null==l)o=n;else{let e=t.length-1;if(!r&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}o=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:a=""}="string"===typeof e?f(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:L(r),hash:z(a)}}(a,o),d=l&&"/"!==l&&l.endsWith("/"),h=(i||"."===l)&&n.endsWith("/");return u.pathname.endsWith("/")||!d&&!h||(u.pathname+="/"),u}const O=e=>e.join("/").replace(/\/\/+/g,"/"),B=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),L=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",z=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const V=["post","put","patch","delete"],U=(new Set(V),["get",...V]);new Set(U),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(this,arguments)}const G=a.createContext(null);const K=a.createContext(null);const X=a.createContext(null);const Y=a.createContext(null);const q=a.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=a.createContext(null);function J(){return null!=a.useContext(Y)}function Q(){return J()||c(!1),a.useContext(Y).location}function $(e){a.useContext(X).static||a.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=a.useContext(q);return e?function(){let{router:e}=ue(le.UseNavigateStable),t=he(ce.UseNavigateStable),n=a.useRef(!1);$(()=>{n.current=!0});let r=a.useCallback(function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,H({fromRouteId:t},a)))},[e,t]);return r}():function(){J()||c(!1);let e=a.useContext(G),{basename:t,future:n,navigator:r}=a.useContext(X),{matches:o}=a.useContext(q),{pathname:i}=Q(),s=JSON.stringify(R(o,n.v7_relativeSplatPath)),l=a.useRef(!1);return $(()=>{l.current=!0}),a.useCallback(function(n,a){if(void 0===a&&(a={}),!l.current)return;if("number"===typeof n)return void r.go(n);let o=F(n,JSON.parse(s),i,"path"===a.relative);null==e&&"/"!==t&&(o.pathname="/"===o.pathname?t:O([t,o.pathname])),(a.replace?r.replace:r.push)(o,a.state,a)},[t,r,s,i,e])}()}function te(){let{matches:e}=a.useContext(q),t=e[e.length-1];return t?t.params:{}}function ne(e,t,n,o){J()||c(!1);let{navigator:i}=a.useContext(X),{matches:s}=a.useContext(q),l=s[s.length-1],u=l?l.params:{},d=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let h,p=Q();if(t){var m;let e="string"===typeof t?f(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||c(!1),h=e}else h=p;let g=h.pathname||"/",y=g;if("/"!==d){let e=d.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=x(e,{pathname:y});let b=se(v&&v.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:O([d,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:O([d,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),s,n,o);return t&&b?a.createElement(Y.Provider,{value:{location:H({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:r.Pop}},b):b}function re(){let e=function(){var e;let t=a.useContext(Z),n=de(ce.UseRouteError),r=he(ce.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:o},n):null,null)}const ae=a.createElement(re,null);class oe extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(q.Provider,{value:this.props.routeContext},a.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ie(e){let{routeContext:t,match:n,children:r}=e,o=a.useContext(G);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(q.Provider,{value:t},r)}function se(e,t,n,r){var o;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var i;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(i=r)&&i.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let s=e,l=null==(o=n)?void 0:o.errors;if(null!=l){let e=s.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||c(!1),s=s.slice(0,Math.min(s.length,e+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let a=0;a<s.length;a++){let e=s[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=a),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){u=!0,s=d>=0?s.slice(0,d+1):[s[0]];break}}}return s.reduceRight((e,r,o)=>{let i,c=!1,h=null,p=null;var f;n&&(i=l&&r.route.id?l[r.route.id]:void 0,h=r.route.errorElement||ae,u&&(d<0&&0===o?(f="route-fallback",!1||pe[f]||(pe[f]=!0),c=!0,p=null):d===o&&(c=!0,p=r.route.hydrateFallbackElement||null)));let m=t.concat(s.slice(0,o+1)),g=()=>{let t;return t=i?h:c?p:r.route.Component?a.createElement(r.route.Component,null):r.route.element?r.route.element:e,a.createElement(ie,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===o)?a.createElement(oe,{location:n.location,revalidation:n.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}var le=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(le||{}),ce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ce||{});function ue(e){let t=a.useContext(G);return t||c(!1),t}function de(e){let t=a.useContext(K);return t||c(!1),t}function he(e){let t=function(){let e=a.useContext(q);return e||c(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||c(!1),n.route.id}const pe={};function fe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}o.startTransition;function me(e){let{to:t,replace:n,state:r,relative:o}=e;J()||c(!1);let{future:i,static:s}=a.useContext(X),{matches:l}=a.useContext(q),{pathname:u}=Q(),d=ee(),h=F(t,R(l,i.v7_relativeSplatPath),u,"path"===o),p=JSON.stringify(h);return a.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:o}),[d,p,o,n,r]),null}function ge(e){c(!1)}function xe(e){let{basename:t="/",children:n=null,location:o,navigationType:i=r.Pop,navigator:s,static:l=!1,future:u}=e;J()&&c(!1);let d=t.replace(/^\/*/,"/"),h=a.useMemo(()=>({basename:d,navigator:s,static:l,future:H({v7_relativeSplatPath:!1},u)}),[d,u,s,l]);"string"===typeof o&&(o=f(o));let{pathname:p="/",search:m="",hash:g="",state:x=null,key:y="default"}=o,v=a.useMemo(()=>{let e=P(p,d);return null==e?null:{location:{pathname:e,search:m,hash:g,state:x,key:y},navigationType:i}},[d,p,m,g,x,y,i]);return null==v?null:a.createElement(X.Provider,{value:h},a.createElement(Y.Provider,{children:n,value:v}))}function ye(e){let{children:t,location:n}=e;return ne(ve(t),n)}new Promise(()=>{});a.Component;function ve(e,t){void 0===t&&(t=[]);let n=[];return a.Children.forEach(e,(e,r)=>{if(!a.isValidElement(e))return;let o=[...t,r];if(e.type===a.Fragment)return void n.push.apply(n,ve(e.props.children,o));e.type!==ge&&c(!1),e.props.index&&e.props.children&&c(!1);let i={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=ve(e.props.children,o)),n.push(i)}),n}var be=n(950),we=n.t(be,2);function ke(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(e=>[n,e]):[[n,r]])},[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(Z_){}new Map;const je=o.startTransition;we.flushSync,o.useId;function Ce(e){let{basename:t,children:n,future:r,window:o}=e,i=a.useRef();var s;null==i.current&&(i.current=(void 0===(s={window:o,v5Compat:!0})&&(s={}),m(function(e,t){let{pathname:n,search:r,hash:a}=e.location;return h("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:p(t)},null,s)));let l=i.current,[c,u]=a.useState({action:l.action,location:l.location}),{v7_startTransition:d}=r||{},f=a.useCallback(e=>{d&&je?je(()=>u(e)):u(e)},[u,d]);return a.useLayoutEffect(()=>l.listen(f),[l,f]),a.useEffect(()=>fe(r),[r]),a.createElement(xe,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Ne,_e;function Se(e){let t=a.useRef(ke(e)),n=a.useRef(!1),r=Q(),o=a.useMemo(()=>function(e,t){let n=ke(e);return t&&t.forEach((e,r)=>{n.has(r)||t.getAll(r).forEach(e=>{n.append(r,e)})}),n}(r.search,n.current?null:t.current),[r.search]),i=ee(),s=a.useCallback((e,t)=>{const r=ke("function"===typeof e?e(o):e);n.current=!0,i("?"+r,t)},[i,o]);return[o,s]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ne||(Ne={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(_e||(_e={}));const Ee=()=>localStorage.getItem("access_token"),Ae=()=>localStorage.getItem("refresh_token"),Ie=(e,t)=>{localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",t),localStorage.setItem("token_timestamp",Date.now().toString())},Te=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=[1e3,2e3,4e3],n=Ae();if(!n)return Me("no_refresh_token"),!1;try{const a=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:n})});if(401===a.status||403===a.status){try{const e=await a.clone().json();if("SESSION_REPLACED"===e.code||e.force_logout)return console.warn("[refreshAccessToken] SESSION_REPLACED detected - forcing logout"),window.dispatchEvent(new CustomEvent("deviceForceLogout",{detail:{reason:e.error||"Session digantikan oleh login baru"}})),Me("force_logout"),!1}catch(r){}return console.error("[refreshAccessToken] Token invalid/expired, logging out"),Me("token_expired"),!1}if(!a.ok){if(e<3){const n=t[e];return console.warn("[refreshAccessToken] Server error (".concat(a.status,"), retrying in ").concat(n,"ms... (").concat(e+1,"/").concat(3,")")),await new Promise(e=>setTimeout(e,n)),Te(e+1)}return console.error("[refreshAccessToken] Max retries reached, logging out"),Me("refresh_failed"),!1}const o=await a.json();return o.success&&o.data.access_token?(Ie(o.data.access_token,o.data.refresh_token),console.log("[refreshAccessToken] Token refreshed successfully"),!0):(console.error("[refreshAccessToken] Unexpected response format"),Me("refresh_failed"),!1)}catch(a){if(e<3){const n=t[e];return console.warn("[refreshAccessToken] Network error, retrying in ".concat(n,"ms... (").concat(e+1,"/").concat(3,")"),a),await new Promise(e=>setTimeout(e,n)),Te(e+1)}return console.error("[refreshAccessToken] Max retries reached after network errors, logging out"),Me("network_error"),!1}},Pe=()=>{const e=Ee();if(!e)return null;try{return JSON.parse(atob(e.split(".")[1])).user_id||null}catch(t){return null}},De=()=>!!Ee(),Me=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"manual";const t=Ae(),n=Ee();if(t&&n&&"manual"===e)try{const e=JSON.parse(atob(n.split(".")[1])).user_id;await fetch("/api/auth/logout?user_id=".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:t,logout_all_devices:!1})})}catch(r){console.error("[logout] Backend logout API call failed:",r)}localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_timestamp"),localStorage.removeItem("device_id"),window.dispatchEvent(new CustomEvent("logout",{detail:{reason:e}})),console.log("[logout] User logged out, reason: ".concat(e))},Re=()=>{if("undefined"===typeof window)return!0;const e=navigator.userAgent.toLowerCase(),t=["android","webos","iphone","ipad","ipod","blackberry","iemobile","opera mini","mobile","tablet"].some(t=>e.includes(t)),n=window.innerWidth<768;return!t&&!n},Fe=()=>{var e;if("undefined"===typeof window)return"unknown";const t=[navigator.userAgent,navigator.language,window.screen.colorDepth.toString(),"".concat(window.screen.width,"x").concat(window.screen.height),(new Date).getTimezoneOffset().toString(),(null===(e=navigator.hardwareConcurrency)||void 0===e?void 0:e.toString())||"unknown"].join("|");let n=0;for(let r=0;r<t.length;r++){n=(n<<5)-n+t.charCodeAt(r),n&=n}return Math.abs(n).toString(36)},Oe=()=>{if("undefined"===typeof window)return"ssr-default";const e="milkyhoop_browser_id";let t=localStorage.getItem(e);return t||(t="undefined"!==typeof crypto&&crypto.randomUUID?crypto.randomUUID():"browser_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,15)),localStorage.setItem(e,t),console.log("[Device] Created new browser_id:",t)),t};class Be{constructor(e){this.ws=null,this.deviceId=null,this.tabId=void 0,this.handler=null,this.reconnectAttempts=0,this.maxReconnect=10,this.baseBackoff=1e3,this.keepAliveTimer=null,this.tabId=e}static getInstance(e){return Be.instance||(Be.instance=new Be(e)),Be.instance}setHandler(e){this.handler=e}connect(e){if(!e)return;if(this.ws&&this.deviceId===e&&this.ws.readyState===WebSocket.OPEN)return void console.log("[DeviceWS] Already connected to",e.slice(0,8));if(this.ws){console.log("[DeviceWS] Closing existing connection for reconnect");try{this.ws.close(1e3,"reconnect")}catch(r){}this.cleanup()}this.deviceId=e;const t="https:"===window.location.protocol?"wss:":"ws:",n="".concat(t,"//").concat(window.location.host,"/api/devices/ws/").concat(encodeURIComponent(e),"?tab_id=").concat(encodeURIComponent(this.tabId));console.log("[DeviceWS] Connecting to:",n),this.ws=new WebSocket(n),this.ws.onopen=()=>{this.reconnectAttempts=0,this.startKeepAlive(),console.log("[DeviceWS] Connected successfully")},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);console.log("[DeviceWS] Message received:",t.event||t.type),this.handler&&this.handler(t)}catch(Z_){console.warn("[DeviceWS] Malformed message:",e.data)}},this.ws.onclose=e=>{console.warn("[DeviceWS] Closed - code:",e.code,"reason:",e.reason),this.cleanup(),1e3!==e.code&&4001!==e.code&&this.reconnectWithBackoff()},this.ws.onerror=e=>{console.error("[DeviceWS] Error:",e)}}reconnectWithBackoff(){if(this.reconnectAttempts>=this.maxReconnect)return void console.warn("[DeviceWS] Max reconnect attempts reached");const e=this.baseBackoff*Math.pow(1.5,this.reconnectAttempts);this.reconnectAttempts++,console.log("[DeviceWS] Reconnecting in ".concat(e,"ms (attempt ").concat(this.reconnectAttempts,")")),setTimeout(()=>{this.deviceId&&this.connect(this.deviceId)},e)}startKeepAlive(){this.stopKeepAlive(),this.keepAliveTimer=window.setInterval(()=>{var e;(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&this.ws.send(JSON.stringify({event:"ping"}))},3e4)}stopKeepAlive(){this.keepAliveTimer&&(clearInterval(this.keepAliveTimer),this.keepAliveTimer=null)}close(){if(console.log("[DeviceWS] Closing connection (explicit)"),this.ws){try{this.ws.close(1e3,"client_close")}catch(e){}this.cleanup(),this.ws=null,this.deviceId=null}}cleanup(){this.stopKeepAlive()}isConnected(){var e;return(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN}getDeviceId(){return this.deviceId}}Be.instance=null;const Le="milky_tab_id",ze="milky_browser_id";function We(){let e=sessionStorage.getItem(Le);return e||(e="tab_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,11)),sessionStorage.setItem(Le,e),console.log("[Identifiers] Created new tab_id:",e)),e}function Ve(){let e=localStorage.getItem(ze);return e||(e="undefined"!==typeof crypto&&crypto.randomUUID?crypto.randomUUID():"browser_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,11)),localStorage.setItem(ze,e),console.log("[Identifiers] Created new browser_id:",e)),e}var Ue=n(579);const He=e=>{let{isOpen:t,onStayHere:n,onGoToBlog:r}=e;return t?(0,Ue.jsx)("div",{className:"fixed inset-0 bg-white z-[99999] flex items-center justify-center p-4",children:(0,Ue.jsxs)("div",{className:"max-w-sm w-full text-center",children:[(0,Ue.jsx)("div",{className:"w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,Ue.jsx)("svg",{className:"w-10 h-10 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Milkyhoop dibuka di tab lain"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-8",children:"Kamu ingin tetap buka di sini?"}),(0,Ue.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Ue.jsx)("button",{onClick:n,className:"w-full py-3 bg-orange-500 text-white font-semibold rounded-lg hover:bg-orange-600 transition-colors",children:"Ya, buka di sini"}),(0,Ue.jsx)("button",{onClick:r,className:"w-full py-3 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors",children:"Tidak, tutup tab ini"})]})]})}):null},Ge=e=>{let{isOpen:t,onClose:n,onLoginSuccess:r}=e;const[o,i]=(0,a.useState)(""),[s,l]=(0,a.useState)(""),[c,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)("");if(!t)return null;return(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Login"}),(0,Ue.jsx)("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0),h("");try{const e=Oe(),a=Fe(),i=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,password:s,browser_id:e,device_fingerprint:a})}),l=await i.json();l.success&&l.data.access_token?(Ie(l.data.access_token,l.data.refresh_token),l.data.device_id&&(t=l.data.device_id,localStorage.setItem("device_id",t),console.log("[LoginModal] Device ID stored:",l.data.device_id.substring(0,8))),r(l.data.access_token),n()):h(l.message||"Login gagal")}catch(a){h("Terjadi kesalahan. Silakan coba lagi.")}finally{u(!1)}var t},className:"space-y-4",children:[d&&(0,Ue.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:d}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,Ue.jsx)("input",{type:"email",value:o,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"nama@email.com",required:!0})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,Ue.jsx)("input",{type:"password",value:s,onChange:e=>l(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:!0})]}),(0,Ue.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 disabled:bg-gray-400 transition-colors",children:c?"Loading...":"Login"})]}),(0,Ue.jsx)("p",{className:"mt-4 text-sm text-gray-500 text-center",children:"Login untuk mengakses dashboard dan kelola tenant Anda"})]})})},Ke=()=>{const e=ee(),[t,n]=(0,a.useState)(""),[r,o]=(0,a.useState)(!1),i=()=>{t.trim()&&o(!0)};return(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"min-h-screen bg-white flex flex-col",children:[(0,Ue.jsxs)("header",{className:"w-full py-5 px-6 flex items-center justify-between",children:[(0,Ue.jsx)("h1",{className:"text-2xl font-medium text-gray-900",children:"milkyhoop"}),(0,Ue.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),(0,Ue.jsx)("main",{className:"flex-1 flex items-center justify-center px-4 py-8",children:(0,Ue.jsxs)("div",{className:"w-full max-w-sm",children:[(0,Ue.jsxs)("div",{className:"mb-10 text-center",children:[(0,Ue.jsxs)("h2",{className:"text-5xl sm:text-6xl font-semibold text-gray-900 mb-3 leading-tight",children:["Financial",(0,Ue.jsx)("br",{}),"Automation Tools"]}),(0,Ue.jsx)("p",{className:"text-lg text-gray-600 font-light",children:"No Pain Still Gain"})]}),(0,Ue.jsxs)("div",{className:"space-y-2.5 mx-auto",style:{maxWidth:"70%"},children:[(0,Ue.jsxs)("button",{onClick:()=>{console.log("Google login clicked")},className:"w-full flex items-center justify-center gap-2.5 px-4 py-2 bg-white border border-gray-300 rounded-lg text-[15px] text-gray-900 font-normal hover:bg-gray-50 transition-colors duration-200",children:[(0,Ue.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,Ue.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,Ue.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,Ue.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),(0,Ue.jsx)("span",{children:"Continue with Google"})]}),(0,Ue.jsxs)("div",{className:"flex items-center gap-3 my-3",children:[(0,Ue.jsx)("div",{className:"flex-1 h-px bg-gray-200"}),(0,Ue.jsx)("span",{className:"text-sm text-gray-500 font-normal",children:"OR"}),(0,Ue.jsx)("div",{className:"flex-1 h-px bg-gray-200"})]}),(0,Ue.jsx)("input",{type:"email",value:t,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),i())},placeholder:"Enter your email",className:"w-full px-3.5 py-2 bg-white border border-gray-300 rounded-lg text-[15px] text-gray-900 placeholder-gray-400 focus:outline-none focus:border-gray-400 focus:ring-1 focus:ring-gray-400 transition-all duration-200"}),(0,Ue.jsx)("button",{onClick:i,disabled:!t.trim(),className:"w-full px-4 py-2 bg-gray-900 hover:bg-black disabled:bg-gray-300 disabled:cursor-not-allowed text-white text-[15px] font-normal rounded-lg transition-all duration-200",children:"Continue with email"}),(0,Ue.jsxs)("p",{className:"text-xs text-gray-500 text-center mt-2.5 leading-relaxed",children:["By continuing, you acknowledge",(0,Ue.jsx)("br",{}),"MilkyHoop's Privacy Policy."]})]})]})}),(0,Ue.jsx)("footer",{className:"w-full py-4 text-center",children:(0,Ue.jsx)("p",{className:"text-xs text-gray-400",children:"\xa9 2025 MilkyHoop. Financial Automation Tools."})})]}),(0,Ue.jsx)(Ge,{isOpen:r,onClose:()=>o(!1),onLoginSuccess:t=>{console.log("Login successful, redirecting to dashboard..."),e("/"),window.location.reload()}})]})},Xe=(0,a.createContext)({});function Ye(e){const t=(0,a.useRef)(null);return null===t.current&&(t.current=e()),t.current}const qe="undefined"!==typeof window,Ze=qe?a.useLayoutEffect:a.useEffect;function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function Qe(e){var t=function(e,t){if("object"!=Je(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Je(t)?t:t+""}function $e(e,t,n){return(t=Qe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach(function(t){$e(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const nt=(0,a.createContext)(null);function rt(e){return"object"===typeof e&&null!==e}function at(e){return rt(e)&&"offsetHeight"in e}const ot=(0,a.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function it(e,t){if("function"===typeof e)return e(t);null!==e&&void 0!==e&&(e.current=t)}function st(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useCallback(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{let n=!1;const r=t.map(t=>{const r=it(t,e);return n||"function"!==typeof r||(n=!0),r});if(n)return()=>{for(let e=0;e<r.length;e++){const n=r[e];"function"===typeof n?n():it(t[e],null)}}}}(...t),t)}class lt extends a.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,n=at(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=n-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function ct(e){let{children:t,isPresent:n,anchorX:r,root:o}=e;const i=(0,a.useId)(),s=(0,a.useRef)(null),l=(0,a.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=(0,a.useContext)(ot),u=st(s,null===t||void 0===t?void 0:t.ref);return(0,a.useInsertionEffect)(()=>{const{width:e,height:t,top:a,left:u,right:d}=l.current;if(n||!s.current||!e||!t)return;const h="left"===r?"left: ".concat(u):"right: ".concat(d);s.current.dataset.motionPopId=i;const p=document.createElement("style");c&&(p.nonce=c);const f=null!==o&&void 0!==o?o:document.head;return f.appendChild(p),p.sheet&&p.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat(h,"px !important;\n            top: ").concat(a,"px !important;\n          }\n        ")),()=>{f.contains(p)&&f.removeChild(p)}},[n]),(0,Ue.jsx)(lt,{isPresent:n,childRef:s,sizeRef:l,children:a.cloneElement(t,{ref:u})})}const ut=e=>{let{children:t,initial:n,isPresent:r,onExitComplete:o,custom:i,presenceAffectsLayout:s,mode:l,anchorX:c,root:u}=e;const d=Ye(dt),h=(0,a.useId)();let p=!0,f=(0,a.useMemo)(()=>(p=!1,{id:h,initial:n,isPresent:r,custom:i,onExitComplete:e=>{d.set(e,!0);for(const t of d.values())if(!t)return;o&&o()},register:e=>(d.set(e,!1),()=>d.delete(e))}),[r,d,o]);return s&&p&&(f=tt({},f)),(0,a.useMemo)(()=>{d.forEach((e,t)=>d.set(t,!1))},[r]),a.useEffect(()=>{!r&&!d.size&&o&&o()},[r]),"popLayout"===l&&(t=(0,Ue.jsx)(ct,{isPresent:r,anchorX:c,root:u,children:t})),(0,Ue.jsx)(nt.Provider,{value:f,children:t})};function dt(){return new Map}function ht(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=(0,a.useContext)(nt);if(null===t)return[!0,null];const{isPresent:n,onExitComplete:r,register:o}=t,i=(0,a.useId)();(0,a.useEffect)(()=>{if(e)return o(i)},[e]);const s=(0,a.useCallback)(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,s]:[!0]}const pt=e=>e.key||"";function ft(e){const t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}const mt=e=>{let{children:t,custom:n,initial:r=!0,onExitComplete:o,presenceAffectsLayout:i=!0,mode:s="sync",propagate:l=!1,anchorX:c="left",root:u}=e;const[d,h]=ht(l),p=(0,a.useMemo)(()=>ft(t),[t]),f=l&&!d?[]:p.map(pt),m=(0,a.useRef)(!0),g=(0,a.useRef)(p),x=Ye(()=>new Map),[y,v]=(0,a.useState)(p),[b,w]=(0,a.useState)(p);Ze(()=>{m.current=!1,g.current=p;for(let e=0;e<b.length;e++){const t=pt(b[e]);f.includes(t)?x.delete(t):!0!==x.get(t)&&x.set(t,!1)}},[b,f.length,f.join("-")]);const k=[];if(p!==y){let e=[...p];for(let t=0;t<b.length;t++){const n=b[t],r=pt(n);f.includes(r)||(e.splice(t,0,n),k.push(n))}return"wait"===s&&k.length&&(e=k),w(ft(e)),v(p),null}const{forceRender:j}=(0,a.useContext)(Xe);return(0,Ue.jsx)(Ue.Fragment,{children:b.map(e=>{const t=pt(e),a=!(l&&!d)&&(p===b||f.includes(t));return(0,Ue.jsx)(ut,{isPresent:a,initial:!(m.current&&!r)&&void 0,custom:n,presenceAffectsLayout:i,mode:s,root:u,onExitComplete:a?void 0:()=>{if(!x.has(t))return;x.set(t,!0);let e=!0;x.forEach(t=>{t||(e=!1)}),e&&(null===j||void 0===j||j(),w(g.current),l&&(null===h||void 0===h||h()),o&&o())},anchorX:c,children:e},t)})})},gt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],xt=(()=>new Set(gt))(),yt=e=>180*e/Math.PI,vt=e=>{const t=yt(Math.atan2(e[1],e[0]));return wt(t)},bt={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:vt,rotateZ:vt,skewX:e=>yt(Math.atan(e[1])),skewY:e=>yt(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},wt=e=>((e%=360)<0&&(e+=360),e),kt=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),jt=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Ct={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:kt,scaleY:jt,scale:e=>(kt(e)+jt(e))/2,rotateX:e=>wt(yt(Math.atan2(e[6],e[5]))),rotateY:e=>wt(yt(Math.atan2(-e[2],e[0]))),rotateZ:vt,rotate:vt,skewX:e=>yt(Math.atan(e[4])),skewY:e=>yt(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Nt(e){return e.includes("scale")?1:0}function _t(e,t){if(!e||"none"===e)return Nt(t);const n=e.match(/^matrix3d\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);let r,a;if(n)r=Ct,a=n;else{const t=e.match(/^matrix\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);r=bt,a=t}if(!a)return Nt(t);const o=r[t],i=a[1].split(",").map(St);return"function"===typeof o?o(i):i[o]}function St(e){return parseFloat(e.trim())}const Et=e=>t=>"string"===typeof t&&t.startsWith(e),At=Et("--"),It=Et("var(--"),Tt=e=>!!It(e)&&Pt.test(e.split("/*")[0].trim()),Pt=/var\(--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)$/i;function Dt(e){let{top:t,left:n,right:r,bottom:a}=e;return{x:{min:n,max:r},y:{min:t,max:a}}}const Mt=(e,t,n)=>e+(t-e)*n;function Rt(e){return void 0===e||1===e}function Ft(e){let{scale:t,scaleX:n,scaleY:r}=e;return!Rt(t)||!Rt(n)||!Rt(r)}function Ot(e){return Ft(e)||Bt(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Bt(e){return Lt(e.x)||Lt(e.y)}function Lt(e){return e&&"0%"!==e}function zt(e,t,n){return n+t*(e-n)}function Wt(e,t,n,r,a){return void 0!==a&&(e=zt(e,a,r)),zt(e,n,r)+t}function Vt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;e.min=Wt(e.min,t,n,r,a),e.max=Wt(e.max,t,n,r,a)}function Ut(e,t){let{x:n,y:r}=t;Vt(e.x,n.translate,n.scale,n.originPoint),Vt(e.y,r.translate,r.scale,r.originPoint)}const Ht=.999999999999,Gt=1.0000000000001;function Kt(e,t){e.min=e.min+t,e.max=e.max+t}function Xt(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;Vt(e,t,n,Mt(e.min,e.max,a),r)}function Yt(e,t){Xt(e.x,t.x,t.scaleX,t.scale,t.originX),Xt(e.y,t.y,t.scaleY,t.scale,t.originY)}function qt(e,t){return Dt(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}const Zt=new Set(["width","height","top","left","right","bottom",...gt]),Jt=(e,t,n)=>n>t?t:n<e?e:n,Qt={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},$t=tt(tt({},Qt),{},{transform:e=>Jt(0,1,e)}),en=tt(tt({},Qt),{},{default:1}),tn=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),nn=tn("deg"),rn=tn("%"),an=tn("px"),on=tn("vh"),sn=tn("vw"),ln=(()=>tt(tt({},rn),{},{parse:e=>rn.parse(e)/100,transform:e=>rn.transform(100*e)}))(),cn=e=>t=>t.test(e),un=[Qt,an,rn,nn,sn,on,{test:e=>"auto"===e,parse:e=>e}],dn=e=>un.find(cn(e));let hn=()=>{};const pn=e=>/^-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$/.test(e),fn=/^var\(--(?:([\x2D0-9A-Z_a-z]+)|([\x2D0-9A-Z_a-z]+), ?([ #%\(\),-\.0-9A-Za-z]+))\)/;function mn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.');const[r,a]=function(e){const t=fn.exec(e);if(!t)return[,];const[,n,r,a]=t;return["--".concat(null!==n&&void 0!==n?n:r),a]}(e);if(!r)return;const o=window.getComputedStyle(t).getPropertyValue(r);if(o){const e=o.trim();return pn(e)?parseFloat(e):e}return Tt(a)?mn(a,t,n+1):a}const gn=e=>e===Qt||e===an,xn=new Set(["x","y","z"]),yn=gt.filter(e=>!xn.has(e));const vn={width:(e,t)=>{let{x:n}=e,{paddingLeft:r="0",paddingRight:a="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(a)},height:(e,t)=>{let{y:n}=e,{paddingTop:r="0",paddingBottom:a="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(a)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:r}=t;return parseFloat(r)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:r}=t;return parseFloat(r)+(n.max-n.min)},x:(e,t)=>{let{transform:n}=t;return _t(n,"x")},y:(e,t)=>{let{transform:n}=t;return _t(n,"y")}};vn.translateX=vn.x,vn.translateY=vn.y;const bn=e=>e,wn={},kn=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],jn={value:null,addProjectionMetrics:null};function Cn(e,t){let n=!1,r=!0;const a={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,i=kn.reduce((e,n)=>(e[n]=function(e,t){let n=new Set,r=new Set,a=!1,o=!1;const i=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1},l=0;function c(t){i.has(t)&&(u.schedule(t),e()),l++,t(s)}const u={schedule:function(e){const t=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&a?n:r;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&i.add(e),t.has(e)||t.add(e),e},cancel:e=>{r.delete(e),i.delete(e)},process:e=>{s=e,a?o=!0:(a=!0,[n,r]=[r,n],n.forEach(c),t&&jn.value&&jn.value.frameloop[t].push(l),l=0,n.clear(),a=!1,o&&(o=!1,u.process(e)))}};return u}(o,t?n:void 0),e),{}),{setup:s,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:p,postRender:f}=i,m=()=>{const o=wn.useManualTiming?a.timestamp:performance.now();n=!1,wn.useManualTiming||(a.delta=r?1e3/60:Math.max(Math.min(o-a.timestamp,40),1)),a.timestamp=o,a.isProcessing=!0,s.process(a),l.process(a),c.process(a),u.process(a),d.process(a),h.process(a),p.process(a),f.process(a),a.isProcessing=!1,n&&t&&(r=!1,e(m))},g=kn.reduce((t,o)=>{const s=i[o];return t[o]=function(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,r=!0,a.isProcessing||e(m)),s.schedule(t,o,i)},t},{});return{schedule:g,cancel:e=>{for(let t=0;t<kn.length;t++)i[kn[t]].cancel(e)},state:a,steps:i}}const{schedule:Nn,cancel:_n,state:Sn,steps:En}=Cn("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:bn,!0),An=new Set;let In=!1,Tn=!1,Pn=!1;function Dn(){if(Tn){const e=Array.from(An).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{const t=function(e){const t=[];return yn.forEach(n=>{const r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=n.get(e);t&&t.forEach(t=>{var n;let[r,a]=t;null===(n=e.getValue(r))||void 0===n||n.set(a)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}Tn=!1,In=!1,An.forEach(e=>e.complete(Pn)),An.clear()}function Mn(){An.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Tn=!0)})}class Rn{constructor(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(An.add(this),In||(In=!0,Nn.read(Mn),Nn.resolveKeyframes(Dn))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;if(null===e[0]){const a=null===r||void 0===r?void 0:r.get(),o=e[e.length-1];if(void 0!==a)e[0]=a;else if(n&&t){const r=n.readValue(t,o);void 0!==r&&null!==r&&(e[0]=r)}void 0===e[0]&&(e[0]=o),r&&void 0===a&&r.set(e[0])}!function(e){for(let n=1;n<e.length;n++){var t;null!==(t=e[n])&&void 0!==t||(e[n]=e[n-1])}}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),An.delete(this)}cancel(){"scheduled"===this.state&&(An.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const Fn=e=>/^0(?:[\0-\x08\x0E-\x1F!-\x2D\/-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/.test(e);function On(e){return"number"===typeof e?0===e:null===e||("none"===e||"0"===e||Fn(e))}const Bn=e=>Math.round(1e5*e)/1e5,Ln=/-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/g;const zn=/^(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))$/i,Wn=(e,t)=>n=>Boolean("string"===typeof n&&zn.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),Vn=(e,t,n)=>r=>{if("string"!==typeof r)return r;const[a,o,i,s]=r.match(Ln);return{[e]:parseFloat(a),[t]:parseFloat(o),[n]:parseFloat(i),alpha:void 0!==s?parseFloat(s):1}},Un=tt(tt({},Qt),{},{transform:e=>Math.round((e=>Jt(0,255,e))(e))}),Hn={test:Wn("rgb","red"),parse:Vn("red","green","blue"),transform:e=>{let{red:t,green:n,blue:r,alpha:a=1}=e;return"rgba("+Un.transform(t)+", "+Un.transform(n)+", "+Un.transform(r)+", "+Bn($t.transform(a))+")"}};const Gn={test:Wn("#"),parse:function(e){let t="",n="",r="",a="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),a=e.substring(4,5),t+=t,n+=n,r+=r,a+=a),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:a?parseInt(a,16)/255:1}},transform:Hn.transform},Kn={test:Wn("hsl","hue"),parse:Vn("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:r,alpha:a=1}=e;return"hsla("+Math.round(t)+", "+rn.transform(Bn(n))+", "+rn.transform(Bn(r))+", "+Bn($t.transform(a))+")"}},Xn={test:e=>Hn.test(e)||Gn.test(e)||Kn.test(e),parse:e=>Hn.test(e)?Hn.parse(e):Kn.test(e)?Kn.parse(e):Gn.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?Hn.transform(e):Kn.transform(e),getAnimatableNone:e=>{const t=Xn.parse(e);return t.alpha=0,Xn.transform(t)}},Yn=/(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))/gi;const qn="number",Zn="color",Jn=/var[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)|#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\)|-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/gi;function Qn(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},a=[];let o=0;const i=t.replace(Jn,e=>(Xn.test(e)?(r.color.push(o),a.push(Zn),n.push(Xn.parse(e))):e.startsWith("var(")?(r.var.push(o),a.push("var"),n.push(e)):(r.number.push(o),a.push(qn),n.push(parseFloat(e))),++o,"${}")).split("${}");return{values:n,split:i,indexes:r,types:a}}function $n(e){return Qn(e).values}function er(e){const{split:t,types:n}=Qn(e),r=t.length;return e=>{let a="";for(let o=0;o<r;o++)if(a+=t[o],void 0!==e[o]){const t=n[o];a+=t===qn?Bn(e[o]):t===Zn?Xn.transform(e[o]):e[o]}return a}}const tr=e=>"number"===typeof e?0:Xn.test(e)?Xn.getAnimatableNone(e):e;const nr={test:function(e){var t,n;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(Ln))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(Yn))||void 0===n?void 0:n.length)||0)>0},parse:$n,createTransformer:er,getAnimatableNone:function(e){const t=$n(e);return er(e)(t.map(tr))}},rr=new Set(["brightness","contrast","saturate","opacity"]);function ar(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[r]=n.match(Ln)||[];if(!r)return e;const a=n.replace(r,"");let o=rr.has(t)?1:0;return r!==n&&(o*=100),t+"("+o+a+")"}const or=/\b([\x2Da-z]*)\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\)/g,ir=tt(tt({},nr),{},{getAnimatableNone:e=>{const t=e.match(or);return t?t.map(ar).join(" "):e}}),sr=tt(tt({},Qt),{},{transform:Math.round}),lr=tt(tt({borderWidth:an,borderTopWidth:an,borderRightWidth:an,borderBottomWidth:an,borderLeftWidth:an,borderRadius:an,radius:an,borderTopLeftRadius:an,borderTopRightRadius:an,borderBottomRightRadius:an,borderBottomLeftRadius:an,width:an,maxWidth:an,height:an,maxHeight:an,top:an,right:an,bottom:an,left:an,padding:an,paddingTop:an,paddingRight:an,paddingBottom:an,paddingLeft:an,margin:an,marginTop:an,marginRight:an,marginBottom:an,marginLeft:an,backgroundPositionX:an,backgroundPositionY:an},{rotate:nn,rotateX:nn,rotateY:nn,rotateZ:nn,scale:en,scaleX:en,scaleY:en,scaleZ:en,skew:nn,skewX:nn,skewY:nn,distance:an,translateX:an,translateY:an,translateZ:an,x:an,y:an,z:an,perspective:an,transformPerspective:an,opacity:$t,originX:ln,originY:ln,originZ:an}),{},{zIndex:sr,fillOpacity:$t,strokeOpacity:$t,numOctaves:sr}),cr=tt(tt({},lr),{},{color:Xn,backgroundColor:Xn,outlineColor:Xn,fill:Xn,stroke:Xn,borderColor:Xn,borderTopColor:Xn,borderRightColor:Xn,borderBottomColor:Xn,borderLeftColor:Xn,filter:ir,WebkitFilter:ir}),ur=e=>cr[e];function dr(e,t){let n=ur(e);return n!==ir&&(n=nr),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const hr=new Set(["auto","none","0"]);class pr extends Rn{constructor(e,t,n,r,a){super(e,t,n,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let s=0;s<e.length;s++){let n=e[s];if("string"===typeof n&&(n=n.trim(),Tt(n))){const r=mn(n,t.current);void 0!==r&&(e[s]=r),s===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!Zt.has(n)||2!==e.length)return;const[r,a]=e,o=dn(r),i=dn(a);if(o!==i)if(gn(o)&&gn(i))for(let s=0;s<e.length;s++){const t=e[s];"string"===typeof t&&(e[s]=parseFloat(t))}else vn[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let r=0;r<e.length;r++)(null===e[r]||On(e[r]))&&n.push(r);n.length&&function(e,t,n){let r,a=0;for(;a<e.length&&!r;){const t=e[a];"string"===typeof t&&!hr.has(t)&&Qn(t).values.length&&(r=e[a]),a++}if(r&&n)for(const o of t)e[o]=dr(n,r)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=vn[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];void 0!==r&&e.getValue(n,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const a=t.getValue(n);a&&a.jump(this.measuredOrigin,!1);const o=r.length-1,i=r[o];r[o]=vn[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==i&&void 0===this.finalKeyframe&&(this.finalKeyframe=i),null!==(e=this.removedTransforms)&&void 0!==e&&e.length&&this.removedTransforms.forEach(e=>{let[n,r]=e;t.getValue(n).set(r)}),this.resolveNoneKeyframes()}}const fr=e=>Boolean(e&&e.getVelocity);function mr(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}let gr;function xr(){gr=void 0}const yr={now:()=>(void 0===gr&&yr.set(Sn.isProcessing||wn.useManualTiming?Sn.timestamp:performance.now()),gr),set:e=>{gr=e,queueMicrotask(xr)}};function vr(e,t){-1===e.indexOf(t)&&e.push(t)}function br(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class wr{constructor(){this.subscriptions=[]}add(e){return vr(this.subscriptions,e),()=>br(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let a=0;a<r;a++){const r=this.subscriptions[a];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function kr(e,t){return t?e*(1e3/t):0}const jr={current:void 0};class Cr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{const t=yr.now();var n;if((this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev)&&(null===(n=this.events.change)||void 0===n||n.notify(this.current),this.dependents))for(const r of this.dependents)r.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){var t;this.current=e,this.updatedAt=yr.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t))))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new wr);const n=this.events[e].add(t);return"change"===e?()=>{n(),Nn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null===(e=this.events.change)||void 0===e||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return jr.current&&jr.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=yr.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return kr(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null===(e=this.dependents)||void 0===e||e.clear(),null===(t=this.events.destroy)||void 0===t||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Nr(e,t){return new Cr(e,t)}const _r=[...un,Xn,nr],{schedule:Sr,cancel:Er}=Cn(queueMicrotask,!1),Ar={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ir={};for(const Q_ in Ar)Ir[Q_]={isEnabled:e=>Ar[Q_].some(t=>!!e[t])};const Tr=()=>({x:{min:0,max:0},y:{min:0,max:0}}),Pr={current:null},Dr={current:!1};const Mr=new WeakMap;function Rr(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}function Fr(e){return"string"===typeof e||Array.isArray(e)}const Or=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Br=["initial",...Or];function Lr(e){return Rr(e.animate)||Br.some(t=>Fr(e[t]))}function zr(e){return Boolean(Lr(e)||e.variants)}function Wr(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function Vr(e,t,n,r){if("function"===typeof t){const[a,o]=Wr(r);t=t(void 0!==n?n:e.custom,a,o)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[a,o]=Wr(r);t=t(void 0!==n?n:e.custom,a,o)}return t}const Ur=["willChange"],Hr=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Gr{scrapeMotionValuesFromProps(e,t,n){return{}}constructor(e){let{parent:t,props:n,presenceContext:r,reducedMotionConfig:a,blockInitialAnimation:o,visualState:i}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Rn,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=yr.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,Nn.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget=tt({},l),this.initialValues=n.initial?tt({},l):{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=s,this.blockInitialAnimation=Boolean(o),this.isControllingVariants=Lr(n),this.isVariantNode=zr(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const u=this.scrapeMotionValuesFromProps(n,{},this),{willChange:d}=u,h=mr(u,Ur);for(const p in h){const e=h[p];void 0!==l[p]&&fr(e)&&e.set(l[p])}}mount(e){var t;this.current=e,Mr.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),Dr.current||function(){if(Dr.current=!0,qe)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Pr.current=e.matches;e.addEventListener("change",t),t()}else Pr.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||Pr.current),null===(t=this.parent)||void 0===t||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),_n(this.notifyUpdate),_n(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null===(e=this.parent)||void 0===e||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(e){var t;this.children.add(e),null!==(t=this.enteringChildren)&&void 0!==t||(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=xt.has(e);n&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&Nn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in Ir){const t=Ir[e];if(!t)continue;const{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<Hr.length;n++){const t=Hr[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const r=e["on"+t];r&&(this.propEventSubscriptions[t]=this.on(t,r))}this.prevMotionValues=function(e,t,n){for(const r in t){const a=t[r],o=n[r];if(fr(a))e.addValue(r,a);else if(fr(o))e.addValue(r,Nr(a,{owner:e}));else if(o!==a)if(e.hasValue(r)){const t=e.getValue(r);!0===t.liveStyle?t.jump(a):t.hasAnimated||t.set(a)}else{const t=e.getStaticValue(r);e.addValue(r,Nr(void 0!==t?t:a,{owner:e}))}}for(const r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=Nr(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let r=void 0===this.latestValues[e]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,e))&&void 0!==n?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var a;return void 0!==r&&null!==r&&("string"===typeof r&&(pn(r)||Fn(r))?r=parseFloat(r):(a=r,!_r.find(cn(a))&&nr.test(t)&&(r=dr(e,t))),this.setBaseTarget(e,fr(r)?r.get():r)),fr(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if("string"===typeof t||"object"===typeof t){var r;const a=Vr(this.props,t,null===(r=this.presenceContext)||void 0===r?void 0:r.custom);a&&(n=a[e])}if(t&&void 0!==n)return n;const a=this.getBaseTargetFromProps(this.props,e);return void 0===a||fr(a)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:a}on(e,t){return this.events[e]||(this.events[e]=new wr),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events[e].notify(...n)}}scheduleRenderMicrotask(){Sr.render(this.render)}}class Kr extends Gr{constructor(){super(...arguments),this.KeyframeResolver=pr}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:r}=t;delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;fr(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent="".concat(e))}))}}const Xr=(e,t)=>t&&"number"===typeof e?t.transform(e):e,Yr={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qr=gt.length;function Zr(e,t,n){const{style:r,vars:a,transformOrigin:o}=e;let i=!1,s=!1;for(const l in t){const e=t[l];if(xt.has(l))i=!0;else if(At(l))a[l]=e;else{const t=Xr(e,lr[l]);l.startsWith("origin")?(s=!0,o[l]=t):r[l]=t}}if(t.transform||(i||n?r.transform=function(e,t,n){let r="",a=!0;for(let o=0;o<qr;o++){const i=gt[o],s=e[i];if(void 0===s)continue;let l=!0;if(l="number"===typeof s?s===(i.startsWith("scale")?1:0):0===parseFloat(s),!l||n){const e=Xr(s,lr[i]);l||(a=!1,r+="".concat(Yr[i]||i,"(").concat(e,") ")),n&&(t[i]=e)}}return r=r.trim(),n?r=n(t,a?"":r):a&&(r="none"),r}(t,e.transform,n):r.transform&&(r.transform="none")),s){const{originX:e="50%",originY:t="50%",originZ:n=0}=o;r.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}function Jr(e,t,n,r){let{style:a,vars:o}=t;const i=e.style;let s;for(s in a)i[s]=a[s];for(s in null===r||void 0===r||r.applyProjectionStyles(i,n),o)i.setProperty(s,o[s])}const Qr={};function $r(e,t){let{layout:n,layoutId:r}=t;return xt.has(e)||e.startsWith("origin")||(n||void 0!==r)&&(!!Qr[e]||"opacity"===e)}function ea(e,t,n){const{style:r}=e,a={};for(const i in r){var o;(fr(r[i])||t.style&&fr(t.style[i])||$r(i,e)||void 0!==(null===n||void 0===n||null===(o=n.getValue(i))||void 0===o?void 0:o.liveStyle))&&(a[i]=r[i])}return a}class ta extends Kr{constructor(){super(...arguments),this.type="html",this.renderInstance=Jr}readValueFromInstance(e,t){var n,r;if(xt.has(t))return null!==(n=this.projection)&&void 0!==n&&n.isProjecting?Nt(t):((e,t)=>{const{transform:n="none"}=getComputedStyle(e);return _t(n,t)})(e,t);{const n=(r=e,window.getComputedStyle(r)),a=(At(t)?n.getPropertyValue(t):n[t])||0;return"string"===typeof a?a.trim():a}}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return qt(e,n)}build(e,t,n){Zr(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return ea(e,t,n)}}const na=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ra={offset:"stroke-dashoffset",array:"stroke-dasharray"},aa={offset:"strokeDashoffset",array:"strokeDasharray"};const oa=["attrX","attrY","attrScale","pathLength","pathSpacing","pathOffset"];function ia(e,t,n,r,a){let{attrX:o,attrY:i,attrScale:s,pathLength:l,pathSpacing:c=1,pathOffset:u=0}=t;if(Zr(e,mr(t,oa),r),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;var p,f;(d.transform&&(h.transform=d.transform,delete d.transform),h.transform||d.transformOrigin)&&(h.transformOrigin=null!==(p=d.transformOrigin)&&void 0!==p?p:"50% 50%",delete d.transformOrigin);h.transform&&(h.transformBox=null!==(f=null===a||void 0===a?void 0:a.transformBox)&&void 0!==f?f:"fill-box",delete d.transformBox);void 0!==o&&(d.x=o),void 0!==i&&(d.y=i),void 0!==s&&(d.scale=s),void 0!==l&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const o=a?ra:aa;e[o.offset]=an.transform(-r);const i=an.transform(t),s=an.transform(n);e[o.array]="".concat(i," ").concat(s)}(d,l,c,u,!1)}const sa=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),la=e=>"string"===typeof e&&"svg"===e.toLowerCase();function ca(e,t,n){const r=ea(e,t,n);for(const a in e)if(fr(e[a])||fr(t[a])){r[-1!==gt.indexOf(a)?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a]=e[a]}return r}class ua extends Kr{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Tr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(xt.has(t)){const e=ur(t);return e&&e.default||0}return t=sa.has(t)?t:na(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return ca(e,t,n)}build(e,t,n){ia(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,r){!function(e,t,n,r){Jr(e,t,void 0,r);for(const a in t.attrs)e.setAttribute(sa.has(a)?a:na(a),t.attrs[a])}(e,t,0,r)}mount(e){this.isSVGTag=la(e.tagName),super.mount(e)}}const da=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ha(e){return"string"===typeof e&&!e.includes("-")&&!!(da.indexOf(e)>-1||/[A-Z]/.test(e))}const pa=(e,t)=>ha(e)?new ua(t):new ta(t,{allowProjection:e!==a.Fragment}),fa=(0,a.createContext)({strict:!1}),ma=(0,a.createContext)({});function ga(e){const{initial:t,animate:n}=function(e,t){if(Lr(e)){const{initial:t,animate:n}=e;return{initial:!1===t||Fr(t)?t:void 0,animate:Fr(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,a.useContext)(ma));return(0,a.useMemo)(()=>({initial:t,animate:n}),[xa(t),xa(n)])}function xa(e){return Array.isArray(e)?e.join(" "):e}const ya=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function va(e,t,n){for(const r in t)fr(t[r])||$r(r,n)||(e[r]=t[r])}function ba(e,t){const n={};return va(n,e.style||{},e),Object.assign(n,function(e,t){let{transformTemplate:n}=e;return(0,a.useMemo)(()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return Zr(e,t,n),Object.assign({},e.vars,e.style)},[t])}(e,t)),n}function wa(e,t){const n={},r=ba(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const ka=()=>tt(tt({},{style:{},transform:{},transformOrigin:{},vars:{}}),{},{attrs:{}});function ja(e,t,n,r){const o=(0,a.useMemo)(()=>{const n=ka();return ia(n,t,la(r),e.transformTemplate,e.style),tt(tt({},n.attrs),{},{style:tt({},n.style)})},[t]);if(e.style){const t={};va(t,e.style,e),o.style=tt(tt({},t),o.style)}return o}const Ca=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Na(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Ca.has(e)}let _a=e=>!Na(e);try{"function"===typeof(Sa=require("@emotion/is-prop-valid").default)&&(_a=e=>e.startsWith("on")?!Na(e):Sa(e))}catch(J_){}var Sa;function Ea(e,t,n,r,o){let{latestValues:i}=r,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const l=(ha(e)?ja:wa)(t,i,o,e),c=function(e,t,n){const r={};for(const a in e)"values"===a&&"object"===typeof e.values||(_a(a)||!0===n&&Na(a)||!t&&!Na(a)||e.draggable&&a.startsWith("onDrag"))&&(r[a]=e[a]);return r}(t,"string"===typeof e,s),u=e!==a.Fragment?tt(tt(tt({},c),l),{},{ref:n}):{},{children:d}=t,h=(0,a.useMemo)(()=>fr(d)?d.get():d,[d]);return(0,a.createElement)(e,tt(tt({},u),{},{children:h}))}function Aa(e){return fr(e)?e.get():e}const Ia=["transitionEnd","transition"];function Ta(e,t,n,r){const a={},o=r(e,{});for(const h in o)a[h]=Aa(o[h]);let{initial:i,animate:s}=e;const l=Lr(e),c=zr(e);t&&c&&!l&&!1!==e.inherit&&(void 0===i&&(i=t.initial),void 0===s&&(s=t.animate));let u=!!n&&!1===n.initial;u=u||!1===i;const d=u?s:i;if(d&&"boolean"!==typeof d&&!Rr(d)){const t=Array.isArray(d)?d:[d];for(let n=0;n<t.length;n++){const r=Vr(e,t[n]);if(r){const{transitionEnd:e,transition:t}=r,n=mr(r,Ia);for(const r in n){let e=n[r];if(Array.isArray(e)){e=e[u?e.length-1:0]}null!==e&&(a[r]=e)}for(const r in e)a[r]=e[r]}}}return a}const Pa=e=>(t,n)=>{const r=(0,a.useContext)(ma),o=(0,a.useContext)(nt),i=()=>function(e,t,n,r){let{scrapeMotionValuesFromProps:a,createRenderState:o}=e;return{latestValues:Ta(t,n,r,a),renderState:o()}}(e,t,r,o);return n?i():Ye(i)},Da=Pa({scrapeMotionValuesFromProps:ea,createRenderState:ya}),Ma=Pa({scrapeMotionValuesFromProps:ca,createRenderState:ka});const Ra=Symbol.for("motionComponentSymbol");function Fa(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function Oa(e,t,n){return(0,a.useCallback)(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&("function"===typeof n?n(r):Fa(n)&&(n.current=r))},[t])}const Ba="data-"+na("framerAppearId"),La=(0,a.createContext)({});function za(e,t,n,r,o){var i,s,l,c;const{visualElement:u}=(0,a.useContext)(ma),d=(0,a.useContext)(fa),h=(0,a.useContext)(nt),p=(0,a.useContext)(ot).reducedMotion,f=(0,a.useRef)(null);r=r||d.renderer,!f.current&&r&&(f.current=r(e,{visualState:t,parent:u,props:n,presenceContext:h,blockInitialAnimation:!!h&&!1===h.initial,reducedMotionConfig:p}));const m=f.current,g=(0,a.useContext)(La);!m||m.projection||!o||"html"!==m.type&&"svg"!==m.type||function(e,t,n,r){const{layoutId:a,layout:o,drag:i,dragConstraints:s,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Wa(e.parent)),e.projection.setOptions({layoutId:a,layout:o,alwaysMeasureLayout:Boolean(i)||s&&Fa(s),visualElement:e,animationType:"string"===typeof o?o:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}(f.current,n,o,g);const x=(0,a.useRef)(!1);(0,a.useInsertionEffect)(()=>{m&&x.current&&m.update(n,h)});const y=n[Ba],v=(0,a.useRef)(Boolean(y)&&!(null!==(i=(s=window).MotionHandoffIsComplete)&&void 0!==i&&i.call(s,y))&&(null===(l=(c=window).MotionHasOptimisedAnimation)||void 0===l?void 0:l.call(c,y)));return Ze(()=>{m&&(x.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),v.current&&m.animationState&&m.animationState.animateChanges())}),(0,a.useEffect)(()=>{m&&(!v.current&&m.animationState&&m.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var e,t;null===(e=(t=window).MotionHandoffMarkAsComplete)||void 0===e||e.call(t,y)}),v.current=!1),m.enteringChildren=void 0)}),m}function Wa(e){if(e)return!1!==e.options.allowProjection?e.projection:Wa(e.parent)}function Va(e){var t,n;let{forwardMotionProps:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;o&&function(e){for(const t in e)Ir[t]=tt(tt({},Ir[t]),e[t])}(o);const s=ha(e)?Ma:Da;function l(t,n){let o;const l=tt(tt(tt({},(0,a.useContext)(ot)),t),{},{layoutId:Ua(t)}),{isStatic:c}=l,u=ga(t),d=s(t,c);if(!c&&qe){!function(){(0,a.useContext)(fa).strict;0}();const t=function(e){const{drag:t,layout:n}=Ir;if(!t&&!n)return{};const r=tt(tt({},t),n);return{MeasureLayout:null!==t&&void 0!==t&&t.isEnabled(e)||null!==n&&void 0!==n&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(l);o=t.MeasureLayout,u.visualElement=za(e,d,l,i,t.ProjectionNode)}return(0,Ue.jsxs)(ma.Provider,{value:u,children:[o&&u.visualElement?(0,Ue.jsx)(o,tt({visualElement:u.visualElement},l)):null,Ea(e,t,Oa(d,u.visualElement,n),d,c,r)]})}l.displayName="motion.".concat("string"===typeof e?e:"create(".concat(null!==(t=null!==(n=e.displayName)&&void 0!==n?n:e.name)&&void 0!==t?t:"",")"));const c=(0,a.forwardRef)(l);return c[Ra]=e,c}function Ua(e){let{layoutId:t}=e;const n=(0,a.useContext)(Xe).id;return n&&void 0!==t?n+"-"+t:t}function Ha(e,t){if("undefined"===typeof Proxy)return Va;const n=new Map,r=(n,r)=>Va(n,r,e,t);return new Proxy((e,t)=>r(e,t),{get:(a,o)=>"create"===o?r:(n.has(o)||n.set(o,Va(o,void 0,e,t)),n.get(o))})}function Ga(e,t,n){const r=e.getProps();return Vr(r,t,void 0!==n?n:r.custom,e)}function Ka(e,t){var n,r;return null!==(n=null!==(r=null===e||void 0===e?void 0:e[t])&&void 0!==r?r:null===e||void 0===e?void 0:e.default)&&void 0!==n?n:e}const Xa=e=>Array.isArray(e),Ya=["transitionEnd","transition"];function qa(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Nr(n))}function Za(e){return Xa(e)?e[e.length-1]||0:e}function Ja(e,t){const n=e.getValue("willChange");if(r=n,Boolean(fr(r)&&r.add))return n.add(t);if(!n&&wn.WillChange){const n=new wn.WillChange("auto");e.addValue("willChange",n),n.add(t)}var r}function Qa(e){return e.props[Ba]}function $a(e){e.duration=0,e.type="keyframes"}const eo=(e,t)=>n=>t(e(n)),to=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(eo)},no=e=>1e3*e,ro=e=>e/1e3,ao={layout:0,mainThread:0,waapi:0};function oo(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function io(e,t){return n=>n>0?t:e}const so=(e,t,n)=>{const r=e*e,a=n*(t*t-r)+r;return a<0?0:Math.sqrt(a)},lo=[Gn,Hn,Kn];function co(e){const t=(n=e,lo.find(e=>e.test(n)));var n;if(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead."),!Boolean(t))return!1;let r=t.parse(e);return t===Kn&&(r=function(e){let{hue:t,saturation:n,lightness:r,alpha:a}=e;t/=360,n/=100,r/=100;let o=0,i=0,s=0;if(n){const e=r<.5?r*(1+n):r+n-r*n,a=2*r-e;o=oo(a,e,t+1/3),i=oo(a,e,t),s=oo(a,e,t-1/3)}else o=i=s=r;return{red:Math.round(255*o),green:Math.round(255*i),blue:Math.round(255*s),alpha:a}}(r)),r}const uo=(e,t)=>{const n=co(e),r=co(t);if(!n||!r)return io(e,t);const a=tt({},n);return e=>(a.red=so(n.red,r.red,e),a.green=so(n.green,r.green,e),a.blue=so(n.blue,r.blue,e),a.alpha=Mt(n.alpha,r.alpha,e),Hn.transform(a))},ho=new Set(["none","hidden"]);function po(e,t){return n=>Mt(e,t,n)}function fo(e){return"number"===typeof e?po:"string"===typeof e?Tt(e)?io:Xn.test(e)?uo:xo:Array.isArray(e)?mo:"object"===typeof e?Xn.test(e)?uo:go:io}function mo(e,t){const n=[...e],r=n.length,a=e.map((e,n)=>fo(e)(e,t[n]));return e=>{for(let t=0;t<r;t++)n[t]=a[t](e);return n}}function go(e,t){const n=tt(tt({},e),t),r={};for(const a in n)void 0!==e[a]&&void 0!==t[a]&&(r[a]=fo(e[a])(e[a],t[a]));return e=>{for(const t in r)n[t]=r[t](e);return n}}const xo=(e,t)=>{const n=nr.createTransformer(t),r=Qn(e),a=Qn(t);return r.indexes.var.length===a.indexes.var.length&&r.indexes.color.length===a.indexes.color.length&&r.indexes.number.length>=a.indexes.number.length?ho.has(e)&&!a.values.length||ho.has(t)&&!r.values.length?function(e,t){return ho.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):to(mo(function(e,t){const n=[],r={color:0,var:0,number:0};for(let o=0;o<t.values.length;o++){var a;const i=t.types[o],s=e.indexes[i][r[i]],l=null!==(a=e.values[s])&&void 0!==a?a:0;n[o]=l,r[i]++}return n}(r,a),a.values),n):("Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition."),io(e,t))};function yo(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return Mt(e,t,n);return fo(e)(e,t)}const vo=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Nn.update(t,e)},stop:()=>_n(t),now:()=>Sn.isProcessing?Sn.timestamp:yr.now()}},bo=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r="";const a=Math.max(Math.round(t/n),2);for(let o=0;o<a;o++)r+=Math.round(1e4*e(o/(a-1)))/1e4+", ";return"linear(".concat(r.substring(0,r.length-2),")")},wo=2e4;function ko(e){let t=0;let n=e.next(t);for(;!n.done&&t<wo;)t+=50,n=e.next(t);return t>=wo?1/0:t}function jo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const n=(arguments.length>2?arguments[2]:void 0)(tt(tt({},e),{},{keyframes:[0,t]})),r=Math.min(ko(n),wo);return{type:"keyframes",ease:e=>n.next(r*e).value/t,duration:ro(r)}}function Co(e,t,n){const r=Math.max(t-5,0);return kr(n-e(r),t-r)}const No={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},_o=.001;function So(e){let t,n,{duration:r=No.duration,bounce:a=No.bounce,velocity:o=No.velocity,mass:i=No.mass}=e;no(No.maxDuration);let s=1-a;s=Jt(No.minDamping,No.maxDamping,s),r=Jt(No.minDuration,No.maxDuration,ro(r)),s<1?(t=e=>{const t=e*s,n=t*r,a=t-o,i=Ao(e,s),l=Math.exp(-n);return _o-a/i*l},n=e=>{const n=e*s*r,a=n*o+o,i=Math.pow(s,2)*Math.pow(e,2)*r,l=Math.exp(-n),c=Ao(Math.pow(e,2),s);return(-t(e)+_o>0?-1:1)*((a-i)*l)/c}):(t=e=>Math.exp(-e*r)*((e-o)*r+1)-.001,n=e=>Math.exp(-e*r)*(r*r*(o-e)));const l=function(e,t,n){let r=n;for(let a=1;a<Eo;a++)r-=e(r)/t(r);return r}(t,n,5/r);if(r=no(r),isNaN(l))return{stiffness:No.stiffness,damping:No.damping,duration:r};{const e=Math.pow(l,2)*i;return{stiffness:e,damping:2*s*Math.sqrt(i*e),duration:r}}}const Eo=12;function Ao(e,t){return e*Math.sqrt(1-t*t)}const Io=["duration","bounce"],To=["stiffness","damping","mass"];function Po(e,t){return t.some(t=>void 0!==e[t])}function Do(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:No.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:No.bounce;const n="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:a}=n;const o=n.keyframes[0],i=n.keyframes[n.keyframes.length-1],s={done:!1,value:o},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:p}=function(e){let t=tt({velocity:No.velocity,stiffness:No.stiffness,damping:No.damping,mass:No.mass,isResolvedFromDuration:!1},e);if(!Po(e,To)&&Po(e,Io))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(1.2*n),a=r*r,o=2*Jt(.05,1,1-(e.bounce||0))*Math.sqrt(a);t=tt(tt({},t),{},{mass:No.mass,stiffness:a,damping:o})}else{const n=So(e);t=tt(tt(tt({},t),n),{},{mass:No.mass}),t.isResolvedFromDuration=!0}return t}(tt(tt({},n),{},{velocity:-ro(n.velocity||0)})),f=h||0,m=c/(2*Math.sqrt(l*u)),g=i-o,x=ro(Math.sqrt(l/u)),y=Math.abs(g)<5;let v;if(r||(r=y?No.restSpeed.granular:No.restSpeed.default),a||(a=y?No.restDelta.granular:No.restDelta.default),m<1){const e=Ao(x,m);v=t=>{const n=Math.exp(-m*x*t);return i-n*((f+m*x*g)/e*Math.sin(e*t)+g*Math.cos(e*t))}}else if(1===m)v=e=>i-Math.exp(-x*e)*(g+(f+x*g)*e);else{const e=x*Math.sqrt(m*m-1);v=t=>{const n=Math.exp(-m*x*t),r=Math.min(e*t,300);return i-n*((f+m*x*g)*Math.sinh(r)+e*g*Math.cosh(r))/e}}const b={calculatedDuration:p&&d||null,next:e=>{const t=v(e);if(p)s.done=e>=d;else{let n=0===e?f:0;m<1&&(n=0===e?no(f):Co(v,e,t));const o=Math.abs(n)<=r,l=Math.abs(i-t)<=a;s.done=o&&l}return s.value=s.done?i:t,s},toString:()=>{const e=Math.min(ko(b),wo),t=bo(t=>b.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return b}function Mo(e){let{keyframes:t,velocity:n=0,power:r=.8,timeConstant:a=325,bounceDamping:o=10,bounceStiffness:i=500,modifyTarget:s,min:l,max:c,restDelta:u=.5,restSpeed:d}=e;const h=t[0],p={done:!1,value:h},f=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let m=r*n;const g=h+m,x=void 0===s?g:s(g);x!==g&&(m=x-h);const y=e=>-m*Math.exp(-e/a),v=e=>x+y(e),b=e=>{const t=y(e),n=v(e);p.done=Math.abs(t)<=u,p.value=p.done?x:n};let w,k;const j=e=>{var t;(t=p.value,void 0!==l&&t<l||void 0!==c&&t>c)&&(w=e,k=Do({keyframes:[p.value,f(p.value)],velocity:Co(v,e,p.value),damping:o,stiffness:i,restDelta:u,restSpeed:d}))};return j(0),{calculatedDuration:null,next:e=>{let t=!1;return k||void 0!==w||(t=!0,b(e),j(e)),void 0!==w&&e>=w?k.next(e-w):(!t&&b(e),p)}}}Do.applyToOptions=e=>{const t=jo(e,100,Do);return e.ease=t.ease,e.duration=no(t.duration),e.type="keyframes",e};const Ro=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function Fo(e,t,n,r){if(e===t&&n===r)return bn;const a=t=>function(e,t,n,r,a){let o,i,s=0;do{i=t+(n-t)/2,o=Ro(i,r,a)-e,o>0?n=i:t=i}while(Math.abs(o)>1e-7&&++s<12);return i}(t,0,1,e,n);return e=>0===e||1===e?e:Ro(a(e),t,r)}const Oo=Fo(.42,0,1,1),Bo=Fo(0,0,.58,1),Lo=Fo(.42,0,.58,1),zo=e=>Array.isArray(e)&&"number"!==typeof e[0],Wo=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Vo=e=>t=>1-e(1-t),Uo=Fo(.33,1.53,.69,.99),Ho=Vo(Uo),Go=Wo(Ho),Ko=e=>(e*=2)<1?.5*Ho(e):.5*(2-Math.pow(2,-10*(e-1))),Xo=e=>1-Math.sin(Math.acos(e)),Yo=Vo(Xo),qo=Wo(Xo),Zo=e=>Array.isArray(e)&&"number"===typeof e[0],Jo={linear:bn,easeIn:Oo,easeInOut:Lo,easeOut:Bo,circIn:Xo,circInOut:qo,circOut:Yo,backIn:Ho,backInOut:Go,backOut:Uo,anticipate:Ko},Qo=e=>{if(Zo(e)){e.length;const[t,n,r,a]=e;return Fo(t,n,r,a)}return"string"===typeof e?("Invalid easing type '".concat(e,"'"),Jo[e]):e},$o=(e,t,n)=>{const r=t-e;return 0===r?1:(n-e)/r};function ei(e,t){let{clamp:n=!0,ease:r,mixer:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=e.length;if(t.length,1===o)return()=>t[0];if(2===o&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=function(e,t,n){const r=[],a=n||wn.mix||yo,o=e.length-1;for(let i=0;i<o;i++){let n=a(e[i],e[i+1]);if(t){const e=Array.isArray(t)?t[i]||bn:t;n=to(e,n)}r.push(n)}return r}(t,r,a),l=s.length,c=n=>{if(i&&n<e[0])return t[0];let r=0;if(l>1)for(;r<e.length-2&&!(n<e[r+1]);r++);const a=$o(e[r],e[r+1],n);return s[r](a)};return n?t=>c(Jt(e[0],e[o-1],t)):c}function ti(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const a=$o(0,t,r);e.push(Mt(n,1,a))}}function ni(e){const t=[0];return ti(t,e.length-1),t}function ri(e){let{duration:t=300,keyframes:n,times:r,ease:a="easeInOut"}=e;const o=zo(a)?a.map(Qo):Qo(a),i={done:!1,value:n[0]},s=function(e,t){return e.map(e=>e*t)}(r&&r.length===n.length?r:ni(n),t),l=ei(s,n,{ease:Array.isArray(o)?o:(c=n,u=o,c.map(()=>u||Lo).splice(0,c.length-1))});var c,u;return{calculatedDuration:t,next:e=>(i.value=l(e),i.done=e>=t,i)}}const ai=e=>null!==e;function oi(e,t,n){let{repeat:r,repeatType:a="loop"}=t,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=e.filter(ai),s=o<0||r&&"loop"!==a&&r%2===1?0:i.length-1;return s&&void 0!==n?n:i[s]}const ii={decay:Mo,inertia:Mo,tween:ri,keyframes:ri,spring:Do};function si(e){"string"===typeof e.type&&(e.type=ii[e.type])}class li{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const ci=e=>e/100;class ui extends li{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;const{motionValue:n}=this.options;n&&n.updatedAt!==yr.now()&&this.tick(yr.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null===(e=(t=this.options).onStop)||void 0===e||e.call(t))},ao.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;si(e);const{type:t=ri,repeat:n=0,repeatDelay:r=0,repeatType:a,velocity:o=0}=e;let{keyframes:i}=e;const s=t||ri;s!==ri&&"number"!==typeof i[0]&&(this.mixKeyframes=to(ci,yo(i[0],i[1])),i=[0,100]);const l=s(tt(tt({},e),{},{keyframes:i}));"mirror"===a&&(this.mirroredGenerator=s(tt(tt({},e),{},{keyframes:[...i].reverse(),velocity:-o}))),null===l.calculatedDuration&&(l.calculatedDuration=ko(l));const{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+r,this.totalDuration=this.resolvedDuration*(n+1)-r,this.generator=l}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{generator:n,totalDuration:r,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:i,calculatedDuration:s}=this;if(null===this.startTime)return n.next(0);const{delay:l=0,keyframes:c,repeat:u,repeatType:d,repeatDelay:h,type:p,onUpdate:f,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?g<0:g>r;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=r);let y=this.currentTime,v=n;if(u){const e=Math.min(this.currentTime,r)/i;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,u+1);Boolean(t%2)&&("reverse"===d?(n=1-n,h&&(n-=h/i)):"mirror"===d&&(v=o)),y=Jt(0,1,n)*i}const b=x?{done:!1,value:c[0]}:v.next(y);a&&(b.value=a(b.value));let{done:w}=b;x||null===s||(w=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const k=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return k&&p!==Mo&&(b.value=oi(c,this.options,m,this.speed)),f&&f(b.value),k&&this.finish(),b}then(e,t){return this.finished.then(e,t)}get duration(){return ro(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+ro(e)}get time(){return ro(this.currentTime)}set time(e){var t;e=no(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null===(t=this.driver)||void 0===t||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(yr.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ro(this.currentTime))}play(){var e,t;if(this.isStopped)return;const{driver:n=vo,startTime:r}=this.options;this.driver||(this.driver=n(e=>this.tick(e))),null===(e=(t=this.options).onPlay)||void 0===e||e.call(t);const a=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=a):null!==this.holdTime?this.startTime=a-this.holdTime:this.startTime||(this.startTime=null!==r&&void 0!==r?r:a),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(yr.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null===(e=(t=this.options).onComplete)||void 0===e||e.call(t)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null===(e=(t=this.options).onCancel)||void 0===e||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,ao.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null===(t=this.driver)||void 0===t||t.stop(),e.observe(this)}}function di(e){let t;return()=>(void 0===t&&(t=e()),t)}const hi=di(()=>void 0!==window.ScrollTimeline),pi={};function fi(e,t){const n=di(e);return()=>{var e;return null!==(e=pi[t])&&void 0!==e?e:n()}}const mi=fi(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(Z_){return!1}return!0},"linearEasing"),gi=e=>{let[t,n,r,a]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(r,", ").concat(a,")")},xi={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:gi([0,.65,.55,1]),circOut:gi([.55,0,1,.45]),backIn:gi([.31,.01,.66,-.59]),backOut:gi([.33,1.53,.69,.99])};function yi(e,t){return e?"function"===typeof e?mi()?bo(e,t):"ease-out":Zo(e)?gi(e):Array.isArray(e)?e.map(e=>yi(e,t)||xi.easeOut):xi[e]:void 0}function vi(e,t,n){let{delay:r=0,duration:a=300,repeat:o=0,repeatType:i="loop",ease:s="easeOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const u={[t]:n};l&&(u.offset=l);const d=yi(s,a);Array.isArray(d)&&(u.easing=d),jn.value&&ao.waapi++;const h={delay:r,duration:a,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:o+1,direction:"reverse"===i?"alternate":"normal"};c&&(h.pseudoElement=c);const p=e.animate(u,h);return jn.value&&p.finished.finally(()=>{ao.waapi--}),p}function bi(e){return"function"===typeof e&&"applyToOptions"in e}const wi=["type"];class ki extends li{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:r,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:i,onComplete:s}=e;this.isPseudoElement=Boolean(a),this.allowFlatten=o,this.options=e,e.type;const l=function(e){let{type:t}=e,n=mr(e,wi);return bi(t)&&mi()?t.applyToOptions(n):(null!==(r=n.duration)&&void 0!==r||(n.duration=300),null!==(a=n.ease)&&void 0!==a||(n.ease="easeOut"),n);var r,a}(e);this.animation=vi(t,n,r,l,a),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const e=oi(r,this.options,i,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,n){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,n):e.style[t]=n}(t,n,e),this.animation.cancel()}null===s||void 0===s||s(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null===(e=(t=this.animation).finish)||void 0===e||e.call(t)}cancel(){try{this.animation.cancel()}catch(Z_){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(null===(e=(t=this.animation).commitStyles)||void 0===e||e.call(t))}get duration(){var e,t;const n=(null===(e=this.animation.effect)||void 0===e||null===(t=e.getComputedTiming)||void 0===t?void 0:t.call(e).duration)||0;return ro(Number(n))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+ro(e)}get time(){return ro(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=no(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline(e){let{timeline:t,observe:n}=e;var r;this.allowFlatten&&(null===(r=this.animation.effect)||void 0===r||r.updateTiming({easing:"linear"}));return this.animation.onfinish=null,t&&hi()?(this.animation.timeline=t,bn):n(this)}}const ji={anticipate:Ko,backInOut:Go,circInOut:qo};function Ci(e){"string"===typeof e.ease&&e.ease in ji&&(e.ease=ji[e.ease])}const Ni=["motionValue","onUpdate","onComplete","element"];class _i extends ki{constructor(e){Ci(e),si(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){var t;const n=this.options,{motionValue:r,onUpdate:a,onComplete:o,element:i}=n,s=mr(n,Ni);if(!r)return;if(void 0!==e)return void r.set(e);const l=new ui(tt(tt({},s),{},{autoplay:!1})),c=no(null!==(t=this.finishedTime)&&void 0!==t?t:this.time);r.setWithVelocity(l.sample(c-10).value,l.sample(c).value,10),l.stop()}}const Si=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!nr.test(e)&&"0"!==e||e.startsWith("url(")));const Ei=new Set(["opacity","clipPath","filter","transform"]),Ai=di(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));const Ii=["autoplay","delay","type","repeat","repeatDelay","repeatType","keyframes","name","motionValue","element"];class Ti extends li{constructor(e){var t;let{autoplay:n=!0,delay:r=0,type:a="keyframes",repeat:o=0,repeatDelay:i=0,repeatType:s="loop",keyframes:l,name:c,motionValue:u,element:d}=e,h=mr(e,Ii);super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null===(t=this.stopTimeline)||void 0===t||t.call(this));null===(e=this.keyframeResolver)||void 0===e||e.cancel()},this.createdAt=yr.now();const p=tt({autoplay:n,delay:r,type:a,repeat:o,repeatDelay:i,repeatType:s,name:c,motionValue:u,element:d},h),f=(null===d||void 0===d?void 0:d.KeyframeResolver)||Rn;this.keyframeResolver=new f(l,(e,t,n)=>this.onKeyframesResolved(e,t,p,!n),c,u,d),null===(t=this.keyframeResolver)||void 0===t||t.scheduleResolve()}onKeyframesResolved(e,t,n,r){this.keyframeResolver=void 0;const{name:a,type:o,velocity:i,delay:s,isHandoff:l,onUpdate:c}=n;this.resolvedAt=yr.now(),function(e,t,n,r){const a=e[0];if(null===a)return!1;if("display"===t||"visibility"===t)return!0;const o=e[e.length-1],i=Si(a,t),s=Si(o,t);return"You are trying to animate ".concat(t,' from "').concat(a,'" to "').concat(o,'". "').concat(i?o:a,'" is not an animatable value.'),!(!i||!s)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||bi(n))&&r)}(e,a,o,i)||(!wn.instantAnimations&&s||null===c||void 0===c||c(oi(e,n,t)),e[0]=e[e.length-1],$a(n),n.repeat=0);const u=tt(tt({startTime:r?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t},n),{},{keyframes:e}),d=!l&&function(e){var t;const{motionValue:n,name:r,repeatDelay:a,repeatType:o,damping:i,type:s}=e;if(!((null===n||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return Ai()&&r&&Ei.has(r)&&("transform"!==r||!c)&&!l&&!a&&"mirror"!==o&&0!==i&&"inertia"!==s}(u)?new _i(tt(tt({},u),{},{element:u.motionValue.owner.current})):new ui(u);d.finished.then(()=>this.notifyFinished()).catch(bn),this.pendingTimeline&&(this.stopTimeline=d.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=d}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;this._animation||(null===(e=this.keyframeResolver)||void 0===e||e.resume(),Pn=!0,Mn(),Dn(),Pn=!1);return this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null===(e=this.keyframeResolver)||void 0===e||e.cancel()}}const Pi=e=>null!==e;const Di={type:"spring",stiffness:500,damping:25,restSpeed:10},Mi={type:"keyframes",duration:.8},Ri={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Fi=(e,t)=>{let{keyframes:n}=t;return n.length>2?Mi:xt.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:Di:Ri},Oi=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];const Bi=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;return i=>{const s=Ka(r,e)||{},l=s.delay||r.delay||0;let{elapsed:c=0}=r;c-=no(l);const u=tt(tt({keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity()},s),{},{delay:-c,onUpdate:e=>{t.set(e),s.onUpdate&&s.onUpdate(e)},onComplete:()=>{i(),s.onComplete&&s.onComplete()},name:e,motionValue:t,element:o?void 0:a});(function(e){let{when:t,delay:n,delayChildren:r,staggerChildren:a,staggerDirection:o,repeat:i,repeatType:s,repeatDelay:l,from:c,elapsed:u}=e,d=mr(e,Oi);return!!Object.keys(d).length})(s)||Object.assign(u,Fi(e,u)),u.duration&&(u.duration=no(u.duration)),u.repeatDelay&&(u.repeatDelay=no(u.repeatDelay)),void 0!==u.from&&(u.keyframes[0]=u.from);let d=!1;if((!1===u.type||0===u.duration&&!u.repeatDelay)&&($a(u),0===u.delay&&(d=!0)),(wn.instantAnimations||wn.skipAnimations)&&(d=!0,$a(u),u.delay=0),u.allowFlatten=!s.type&&!s.ease,d&&!o&&void 0!==t.get()){const e=function(e,t,n){let{repeat:r,repeatType:a="loop"}=t;const o=e.filter(Pi),i=r&&"loop"!==a&&r%2===1?0:o.length-1;return i&&void 0!==n?n:o[i]}(u.keyframes,s);if(void 0!==e)return void Nn.update(()=>{u.onUpdate(e),u.onComplete()})}return s.isSync?new ui(u):new Ti(u)}},Li=["transition","transitionEnd"];function zi(e,t){let{protectedKeys:n,needsAnimating:r}=e;const a=n.hasOwnProperty(t)&&!0!==r[t];return r[t]=!1,a}function Wi(e,t){let{delay:n=0,transitionOverride:r,type:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:o=e.getDefaultTransition(),transitionEnd:i}=t,s=mr(t,Li);r&&(o=r);const l=[],c=a&&e.animationState&&e.animationState.getState()[a];for(const d in s){var u;const t=e.getValue(d,null!==(u=e.latestValues[d])&&void 0!==u?u:null),r=s[d];if(void 0===r||c&&zi(c,d))continue;const a=tt({delay:n},Ka(o||{},d)),i=t.get();if(void 0!==i&&!t.isAnimating&&!Array.isArray(r)&&r===i&&!a.velocity)continue;let h=!1;if(window.MotionHandoffAnimation){const t=Qa(e);if(t){const e=window.MotionHandoffAnimation(t,d,Nn);null!==e&&(a.startTime=e,h=!0)}}Ja(e,d),t.start(Bi(d,t,r,e.shouldReduceMotion&&Zt.has(d)?{type:!1}:a,e,h));const p=t.animation;p&&l.push(p)}return i&&Promise.all(l).then(()=>{Nn.update(()=>{i&&function(e,t){let n=Ga(e,t)||{},{transitionEnd:r={},transition:a={}}=n,o=mr(n,Ya);o=tt(tt({},o),r);for(const i in o)qa(e,i,Za(o[i]))}(e,i)})}),l}function Vi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const o=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),i=e.size,s=(i-1)*r;return"function"===typeof n?n(o,i):1===a?o*r:s-o*r}function Ui(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=Ga(e,t,"exit"===r.type?null===(n=e.presenceContext)||void 0===n?void 0:n.custom:void 0);let{transition:o=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(o=r.transitionOverride);const i=a?()=>Promise.all(Wi(e,a,r)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:a=0,staggerChildren:i,staggerDirection:s}=o;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6?arguments[6]:void 0;const s=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),s.push(Ui(l,t,tt(tt({},i),{},{delay:n+("function"===typeof r?0:r)+Vi(e.variantChildren,l,r,a,o)})).then(()=>l.notify("AnimationComplete",t)));return Promise.all(s)}(e,t,n,a,i,s,r)}:()=>Promise.resolve(),{when:l}=o;if(l){const[e,t]="beforeChildren"===l?[i,s]:[s,i];return e().then(()=>t())}return Promise.all([i(),s(r.delay)])}function Hi(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const Gi=Br.length;function Ki(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&Ki(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<Gi;n++){const r=Br[n],a=e.props[r];(Fr(a)||!1===a)&&(t[r]=a)}return t}const Xi=["transition","transitionEnd"],Yi=[...Or].reverse(),qi=Or.length;function Zi(e){return t=>Promise.all(t.map(t=>{let{animation:n,options:r}=t;return function(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const a=t.map(t=>Ui(e,t,r));n=Promise.all(a)}else if("string"===typeof t)n=Ui(e,t,r);else{const a="function"===typeof t?Ga(e,t,r.custom):t;n=Promise.all(Wi(e,a,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}(e,n,r)}))}function Ji(e){let t=Zi(e),n=es(),r=!0;const a=t=>(n,r)=>{var a;const o=Ga(e,r,"exit"===t?null===(a=e.presenceContext)||void 0===a?void 0:a.custom:void 0);if(o){const{transition:e,transitionEnd:t}=o,r=mr(o,Xi);n=tt(tt(tt({},n),r),t)}return n};function o(o){const{props:i}=e,s=Ki(e.parent)||{},l=[],c=new Set;let u={},d=1/0;for(let t=0;t<qi;t++){const h=Yi[t],p=n[h],f=void 0!==i[h]?i[h]:s[h],m=Fr(f),g=h===o?p.isActive:null;!1===g&&(d=t);let x=f===s[h]&&f!==i[h]&&m;if(x&&r&&e.manuallyAnimateOnMount&&(x=!1),p.protectedKeys=tt({},u),!p.isActive&&null===g||!f&&!p.prevProp||Rr(f)||"boolean"===typeof f)continue;const y=Qi(p.prevProp,f);let v=y||h===o&&p.isActive&&!x&&m||t>d&&m,b=!1;const w=Array.isArray(f)?f:[f];let k=w.reduce(a(h),{});!1===g&&(k={});const{prevResolvedValues:j={}}=p,C=tt(tt({},j),k),N=t=>{v=!0,c.has(t)&&(b=!0,c.delete(t)),p.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in C){const t=k[e],n=j[e];if(u.hasOwnProperty(e))continue;let r=!1;r=Xa(t)&&Xa(n)?!Hi(t,n):t!==n,r?void 0!==t&&null!==t?N(e):c.add(e):void 0!==t&&c.has(e)?N(e):p.protectedKeys[e]=!0}p.prevProp=f,p.prevResolvedValues=k,p.isActive&&(u=tt(tt({},u),k)),r&&e.blockInitialAnimation&&(v=!1);const _=x&&y;v&&(!_||b)&&l.push(...w.map(t=>{const n={type:h};if("string"===typeof t&&r&&!_&&e.manuallyAnimateOnMount&&e.parent){const{parent:r}=e,a=Ga(r,t);if(r.enteringChildren&&a){const{delayChildren:t}=a.transition||{};n.delay=Vi(r.enteringChildren,e,t)}}return{animation:t,options:n}}))}if(c.size){const t={};if("boolean"!==typeof i.initial){const n=Ga(e,Array.isArray(i.initial)?i.initial[0]:i.initial);n&&n.transition&&(t.transition=n.transition)}c.forEach(n=>{const r=e.getBaseTarget(n),a=e.getValue(n);a&&(a.liveStyle=!0),t[n]=null!==r&&void 0!==r?r:null}),l.push({animation:t})}let h=Boolean(l.length);return!r||!1!==i.initial&&i.initial!==i.animate||e.manuallyAnimateOnMount||(h=!1),r=!1,h?t(l):Promise.resolve()}return{animateChanges:o,setActive:function(t,r){var a;if(n[t].isActive===r)return Promise.resolve();null===(a=e.variantChildren)||void 0===a||a.forEach(e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,r)}),n[t].isActive=r;const i=o(t);for(const e in n)n[e].protectedKeys={};return i},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=es()}}}function Qi(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!Hi(t,e)}function $i(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function es(){return{animate:$i(!0),whileInView:$i(),whileHover:$i(),whileTap:$i(),whileDrag:$i(),whileFocus:$i(),exit:$i()}}class ts{constructor(e){this.isMounted=!1,this.node=e}update(){}}let ns=0;const rs={animation:{Feature:class extends ts{constructor(e){super(e),e.animationState||(e.animationState=Ji(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Rr(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}},exit:{Feature:class extends ts{constructor(){super(...arguments),this.id=ns++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}},as={x:!1,y:!1};function os(){return as.x||as.y}function is(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const ss=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function ls(e){return{point:{x:e.pageX,y:e.pageY}}}function cs(e,t,n,r){return is(e,t,(e=>t=>ss(t)&&e(t,ls(t)))(n),r)}function us(e){return e.max-e.min}function ds(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=r,e.originPoint=Mt(t.min,t.max,e.origin),e.scale=us(n)/us(t),e.translate=Mt(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function hs(e,t,n,r){ds(e.x,t.x,n.x,r?r.originX:void 0),ds(e.y,t.y,n.y,r?r.originY:void 0)}function ps(e,t,n){e.min=n.min+t.min,e.max=e.min+us(t)}function fs(e,t,n){e.min=t.min-n.min,e.max=e.min+us(t)}function ms(e,t,n){fs(e.x,t.x,n.x),fs(e.y,t.y,n.y)}function gs(e){return[e("x"),e("y")]}const xs=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},ys=(e,t)=>Math.abs(e-t);class vs{constructor(e,t){let{transformPagePoint:n,contextWindow:r=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=ks(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=ys(e.x,t.x),r=ys(e.y,t.y);return Math.sqrt(n**2+r**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!n)return;const{point:r}=e,{timestamp:a}=Sn;this.history.push(tt(tt({},r),{},{timestamp:a}));const{onStart:o,onMove:i}=this.handlers;t||(o&&o(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),i&&i(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=bs(t,this.transformPagePoint),Nn.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:r,resumeAnimation:a}=this.handlers;if(this.dragSnapToOrigin&&a&&a(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const o=ks("pointercancel"===e.type?this.lastMoveEventInfo:bs(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,o),r&&r(e,o)},!ss(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=o,this.contextWindow=r||window;const i=bs(ls(e),this.transformPagePoint),{point:s}=i,{timestamp:l}=Sn;this.history=[tt(tt({},s),{},{timestamp:l})];const{onSessionStart:c}=t;c&&c(e,ks(i,this.history)),this.removeListeners=to(cs(this.contextWindow,"pointermove",this.handlePointerMove),cs(this.contextWindow,"pointerup",this.handlePointerUp),cs(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),_n(this.updatePoint)}}function bs(e,t){return t?{point:t(e.point)}:e}function ws(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ks(e,t){let{point:n}=e;return{point:n,delta:ws(n,Cs(t)),offset:ws(n,js(t)),velocity:Ns(t,.1)}}function js(e){return e[0]}function Cs(e){return e[e.length-1]}function Ns(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const a=Cs(e);for(;n>=0&&(r=e[n],!(a.timestamp-r.timestamp>no(t)));)n--;if(!r)return{x:0,y:0};const o=ro(a.timestamp-r.timestamp);if(0===o)return{x:0,y:0};const i={x:(a.x-r.x)/o,y:(a.y-r.y)/o};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function _s(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function Ss(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}const Es=.35;function As(e,t,n){return{min:Is(e,t),max:Is(e,n)}}function Is(e,t){return"number"===typeof e?e:e[t]||0}const Ts=new WeakMap;class Ps{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e){let{snapToCursor:t=!1,distanceThreshold:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:r}=this.visualElement;if(r&&!1===r.isPresent)return;const{dragSnapToOrigin:a}=this.getProps();this.panSession=new vs(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(ls(e).point)},onStart:(e,t)=>{const{drag:n,dragPropagation:r,onDragStart:a}=this.getProps();if(n&&!r&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(o=n)||"y"===o?as[o]?null:(as[o]=!0,()=>{as[o]=!1}):as.x||as.y?null:(as.x=as.y=!0,()=>{as.x=as.y=!1}),!this.openDragLock))return;var o;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),gs(e=>{let t=this.getAxisMotionValue(e).get()||0;if(rn.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const r=n.layout.layoutBox[e];if(r){t=us(r)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),a&&Nn.postRender(()=>a(e,t)),Ja(this.visualElement,"transform");const{animationState:i}=this.visualElement;i&&i.setActive("whileDrag",!0)},onMove:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;const{dragPropagation:n,dragDirectionLock:r,onDirectionLock:a,onDrag:o}=this.getProps();if(!n&&!this.openDragLock)return;const{offset:i}=t;if(r&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(i),void(null!==this.currentDirection&&a&&a(this.currentDirection));this.updateAxis("x",t.point,i),this.updateAxis("y",t.point,i),this.visualElement.render(),o&&o(e,t)},onSessionEnd:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>gs(e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:a,distanceThreshold:n,contextWindow:xs(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,r=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!r||!n)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:i}=this.getProps();i&&Nn.postRender(()=>i(n,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:r}=this.getProps();if(!n||!Ds(e,r,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=function(e,t,n){let{min:r,max:a}=t;return void 0!==r&&e<r?e=n?Mt(r,e,n.min):Math.max(e,r):void 0!==a&&e>a&&(e=n?Mt(a,e,n.max):Math.min(e,a)),e}(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,a=this.constraints;t&&Fa(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!r)&&function(e,t){let{top:n,left:r,bottom:a,right:o}=t;return{x:_s(e.x,r,o),y:_s(e.y,n,a)}}(r.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Es;return!1===e?e=0:!0===e&&(e=Es),{x:As(e,"left","right"),y:As(e,"top","bottom")}}(n),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&gs(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(r.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Fa(e))return!1;const n=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=function(e,t,n){const r=qt(e,n),{scroll:a}=t;return a&&(Kt(r.x,a.offset.x),Kt(r.y,a.offset.y)),r}(n,r.root,this.visualElement.getTransformPagePoint());let o=function(e,t){return{x:Ss(e.x,t.x),y:Ss(e.y,t.y)}}(r.layout.layoutBox,a);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(o));this.hasMutatedConstraints=!!e,e&&(o=Dt(e))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:r,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:i}=this.getProps(),s=this.constraints||{},l=gs(i=>{if(!Ds(i,t,this.currentDirection))return;let l=s&&s[i]||{};o&&(l={min:0,max:0});const c=r?200:1e6,u=r?40:1e7,d=tt(tt({type:"inertia",velocity:n?e[i]:0,bounceStiffness:c,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10},a),l);return this.startAxisValueAnimation(i,d)});return Promise.all(l).then(i)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return Ja(this.visualElement,e),n.start(Bi(e,n,0,t,this.visualElement,!1))}stopAnimation(){gs(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){gs(e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()})}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag".concat(e.toUpperCase()),n=this.visualElement.getProps(),r=n[t];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){gs(t=>{const{drag:n}=this.getProps();if(!Ds(t,n,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(t);if(r&&r.layout){const{min:n,max:o}=r.layout.layoutBox[t];a.set(e[t]-Mt(n,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!Fa(t)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};gs(e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const n=t.get();r[e]=function(e,t){let n=.5;const r=us(e),a=us(t);return a>r?n=$o(t.min,t.max-r,e.min):r>a&&(n=$o(e.min,e.max-a,t.min)),Jt(0,1,n)}({min:n,max:n},this.constraints[e])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),gs(t=>{if(!Ds(t,e,null))return;const n=this.getAxisMotionValue(t),{min:a,max:o}=this.constraints[t];n.set(Mt(a,o,r[t]))})}addListeners(){if(!this.visualElement.current)return;Ts.set(this.visualElement,this);const e=cs(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();Fa(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Nn.read(t);const a=is(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(gs(e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))}),this.visualElement.render())});return()=>{a(),e(),r(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:o=Es,dragMomentum:i=!0}=e;return tt(tt({},e),{},{drag:t,dragDirectionLock:n,dragPropagation:r,dragConstraints:a,dragElastic:o,dragMomentum:i})}}function Ds(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const Ms=e=>(t,n)=>{e&&Nn.postRender(()=>e(t,n))};const Rs={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Fs(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Os={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!an.test(e))return e;e=parseFloat(e)}const n=Fs(e,t.target.x),r=Fs(e,t.target.y);return"".concat(n,"% ").concat(r,"%")}},Bs={correct:(e,t)=>{let{treeScale:n,projectionDelta:r}=t;const a=e,o=nr.parse(e);if(o.length>5)return a;const i=nr.createTransformer(e),s="number"!==typeof o[0]?1:0,l=r.x.scale*n.x,c=r.y.scale*n.y;o[0+s]/=l,o[1+s]/=c;const u=Mt(l,c,.5);return"number"===typeof o[2+s]&&(o[2+s]/=u),"number"===typeof o[3+s]&&(o[3+s]/=u),i(o)}};let Ls=!1;class zs extends a.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:r}=this.props,{projection:a}=e;!function(e){for(const t in e)Qr[t]=e[t],At(t)&&(Qr[t].isCSSVariable=!0)}(Vs),a&&(t.group&&t.group.add(a),n&&n.register&&r&&n.register(a),Ls&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions(tt(tt({},a.options),{},{onExitComplete:()=>this.safeToRemove()}))),Rs.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:r,isPresent:a}=this.props,{projection:o}=n;return o?(o.isPresent=a,Ls=!0,r||e.layoutDependency!==t||void 0===t||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||Nn.postRender(()=>{const e=o.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Sr.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:r}=e;Ls=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ws(e){const[t,n]=ht(),r=(0,a.useContext)(Xe);return(0,Ue.jsx)(zs,tt(tt({},e),{},{layoutGroup:r,switchLayoutGroup:(0,a.useContext)(La),isPresent:t,safeToRemove:n}))}const Vs={borderRadius:tt(tt({},Os),{},{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:Os,borderTopRightRadius:Os,borderBottomLeftRadius:Os,borderBottomRightRadius:Os,boxShadow:Bs};function Us(e){return rt(e)&&"ownerSVGElement"in e}function Hs(e){return Us(e)&&"svg"===e.tagName}function Gs(e,t,n){const r=fr(e)?e:Nr(e);return r.start(Bi("",r,t,n)),r.animation}const Ks=(e,t)=>e.depth-t.depth;class Xs{constructor(){this.children=[],this.isDirty=!1}add(e){vr(this.children,e),this.isDirty=!0}remove(e){br(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Ks),this.isDirty=!1,this.children.forEach(e)}}function Ys(e,t){const n=yr.now(),r=a=>{let{timestamp:o}=a;const i=o-n;i>=t&&(_n(r),e(i-t))};return Nn.setup(r,!0),()=>_n(r)}const qs=["TopLeft","TopRight","BottomLeft","BottomRight"],Zs=qs.length,Js=e=>"string"===typeof e?parseFloat(e):e,Qs=e=>"number"===typeof e||an.test(e);function $s(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const el=nl(0,.5,Yo),tl=nl(.5,.95,bn);function nl(e,t,n){return r=>r<e?0:r>t?1:n($o(e,t,r))}function rl(e,t){e.min=t.min,e.max=t.max}function al(e,t){rl(e.x,t.x),rl(e.y,t.y)}function ol(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function il(e,t,n,r,a){return e=zt(e-=t,1/n,r),void 0!==a&&(e=zt(e,1/a,r)),e}function sl(e,t,n,r,a){let[o,i,s]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;rn.test(t)&&(t=parseFloat(t),t=Mt(i.min,i.max,t/100)-i.min);if("number"!==typeof t)return;let s=Mt(o.min,o.max,r);e===o&&(s-=t),e.min=il(e.min,t,n,s,a),e.max=il(e.max,t,n,s,a)}(e,t[o],t[i],t[s],t.scale,r,a)}const ll=["x","scaleX","originX"],cl=["y","scaleY","originY"];function ul(e,t,n,r){sl(e.x,t,ll,n?n.x:void 0,r?r.x:void 0),sl(e.y,t,cl,n?n.y:void 0,r?r.y:void 0)}function dl(e){return 0===e.translate&&1===e.scale}function hl(e){return dl(e.x)&&dl(e.y)}function pl(e,t){return e.min===t.min&&e.max===t.max}function fl(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function ml(e,t){return fl(e.x,t.x)&&fl(e.y,t.y)}function gl(e){return us(e.x)/us(e.y)}function xl(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class yl{constructor(){this.members=[]}add(e){vr(this.members,e),e.scheduleRender()}remove(e){if(br(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let n;for(let r=t;r>=0;r--){const e=this.members[r];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;!1===r&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const vl={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},bl=["","X","Y","Z"];let wl=0;function kl(e,t,n,r){const{latestValues:a}=t;a[e]&&(n[e]=a[e],t.setStaticValue(e,0),r&&(r[e]=0))}function jl(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=Qa(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:t,layoutId:r}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",Nn,!(t||r))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&jl(r)}function Cl(e){let{attachResizeListener:t,defaultParent:n,measureScroll:r,checkIsScrollRoot:a,resetTransform:o}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=wl++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,jn.value&&(vl.nodes=vl.calculatedTargetDeltas=vl.calculatedProjections=0),this.nodes.forEach(Sl),this.nodes.forEach(Ml),this.nodes.forEach(Rl),this.nodes.forEach(El),jn.addProjectionMetrics&&jn.addProjectionMetrics(vl)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new Xs)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new wr),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];t&&t.notify(...r)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){if(this.instance)return;this.isSVG=Us(e)&&!Hs(e),this.instance=e;const{layoutId:n,layout:r,visualElement:a}=this.options;if(a&&!a.current&&a.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(r||n)&&(this.isLayoutDirty=!0),t){let n,r=0;const a=()=>this.root.updateBlockedByResize=!1;Nn.read(()=>{r=window.innerWidth}),t(e,()=>{const e=window.innerWidth;e!==r&&(r=e,this.root.updateBlockedByResize=!0,n&&n(),n=Ys(a,250),Rs.hasAnimatedSinceResize&&(Rs.hasAnimatedSinceResize=!1,this.nodes.forEach(Dl)))})}n&&this.root.registerSharedNode(n,this),!1!==this.options.animate&&a&&(n||r)&&this.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n,hasRelativeLayoutChanged:r,layout:o}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const i=this.options.transition||a.getDefaultTransition()||Wl,{onLayoutAnimationStart:s,onLayoutAnimationComplete:l}=a.getProps(),c=!this.targetLayout||!ml(this.targetLayout,o),u=!n&&r;if(this.options.layoutRoot||this.resumeFrom||u||n&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const e=tt(tt({},Ka(i,"layout")),{},{onPlay:s,onComplete:l});(a.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e),this.setAnimationOrigin(t,u)}else n||Dl(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=o})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),_n(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Fl),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&jl(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let a=0;a<this.path.length;a++){const e=this.path[a];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(Il);if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(Tl);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Pl),this.nodes.forEach(Nl),this.nodes.forEach(_l)):this.nodes.forEach(Tl),this.clearAllSnapshots();const e=yr.now();Sn.delta=Jt(0,1e3/60,e-Sn.timestamp),Sn.timestamp=e,Sn.isProcessing=!0,En.update.process(Sn),En.preRender.process(Sn),En.render.process(Sn),Sn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Sr.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Al),this.sharedNodes.forEach(Ol)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Nn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Nn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||us(this.snapshot.measuredBox.x)||us(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){const t=a(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!o)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!hl(this.projectionDelta),n=this.getTransformTemplate(),r=n?n(this.latestValues,""):void 0,a=r!==this.prevTransformTemplateValue;e&&this.instance&&(t||Ot(this.latestValues)||a)&&(o(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);var r;return e&&(n=this.removeTransform(n)),Hl((r=n).x),Hl(r.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const n=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(Kl))){const{scroll:e}=this.root;e&&(Kt(n.x,e.offset.x),Kt(n.y,e.offset.y))}return n}removeElementScroll(e){var t;const n={x:{min:0,max:0},y:{min:0,max:0}};if(al(n,e),null!==(t=this.scroll)&&void 0!==t&&t.wasRoot)return n;for(let r=0;r<this.path.length;r++){const t=this.path[r],{scroll:a,options:o}=t;t!==this.root&&a&&o.layoutScroll&&(a.wasRoot&&al(n,e),Kt(n.x,a.offset.x),Kt(n.y,a.offset.y))}return n}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};al(n,e);for(let r=0;r<this.path.length;r++){const e=this.path[r];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&Yt(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),Ot(e.latestValues)&&Yt(n,e.latestValues)}return Ot(this.latestValues)&&Yt(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};al(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!Ot(e.latestValues))continue;Ft(e.latestValues)&&e.updateSnapshot();const r=Tr();al(r,e.measurePageBox()),ul(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,r)}return Ot(this.latestValues)&&ul(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=tt(tt(tt({},this.options),e),{},{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Sn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const r=Boolean(this.resumingFrom)||this!==n;if(!(t||r&&this.isSharedProjectionDirty||this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:a,layoutId:o}=this.options;if(!this.layout||!a&&!o)return;this.resolvedRelativeTargetAt=Sn.timestamp;const i=this.getClosestProjectingParent();var s,l,c;(i&&this.linkedParentVersion!==i.layoutVersion&&!i.options.layoutRoot&&this.removeRelativeTarget(),this.targetDelta||this.relativeTarget||(i&&i.layout?this.createRelativeTarget(i,this.layout.layoutBox,i.layout.layoutBox):this.removeRelativeTarget()),this.relativeTarget||this.targetDelta)&&(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),s=this.target,l=this.relativeTarget,c=this.relativeParent.target,ps(s.x,l.x,c.x),ps(s.y,l.y,c.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):al(this.target,this.layout.layoutBox),Ut(this.target,this.targetDelta)):al(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,i&&Boolean(i.resumingFrom)===Boolean(this.resumingFrom)&&!i.options.layoutScroll&&i.target&&1!==this.animationProgress?this.createRelativeTarget(i,this.target,i.target):this.relativeParent=this.relativeTarget=void 0),jn.value&&vl.calculatedTargetDeltas++)}getClosestProjectingParent(){if(this.parent&&!Ft(this.parent.latestValues)&&!Bt(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(e,t,n){this.relativeParent=e,this.linkedParentVersion=e.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},ms(this.relativeTargetOrigin,t,n),al(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let r=!0;if((this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty)&&(r=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===Sn.timestamp&&(r=!1),r)return;const{layout:a,layoutId:o}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!a&&!o)return;al(this.layoutCorrected,this.layout.layoutBox);const i=this.treeScale.x,s=this.treeScale.y;!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=n.length;if(!a)return;let o,i;t.x=t.y=1;for(let s=0;s<a;s++){o=n[s],i=o.projectionDelta;const{visualElement:a}=o.options;a&&a.props.style&&"contents"===a.props.style.display||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Yt(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,Ut(e,i)),r&&Ot(o.latestValues)&&Yt(e,o.latestValues))}t.x<Gt&&t.x>Ht&&(t.x=1),t.y<Gt&&t.y>Ht&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(ol(this.prevProjectionDelta.x,this.projectionDelta.x),ol(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),hs(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===i&&this.treeScale.y===s&&xl(this.projectionDelta.x,this.prevProjectionDelta.x)&&xl(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),jn.value&&vl.calculatedProjections++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===(e=this.options.visualElement)||void 0===e||e.scheduleRender(),t){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,r=n?n.latestValues:{},a=tt({},this.latestValues),o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const i={x:{min:0,max:0},y:{min:0,max:0}},s=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,u=Boolean(s&&!c&&!0===this.options.crossfade&&!this.path.some(zl));let d;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;var l,h,p,f,m,g;Bl(o.x,e.x,n),Bl(o.y,e.y,n),this.setTargetDelta(o),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ms(i,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,f=this.relativeTargetOrigin,m=i,g=n,Ll(p.x,f.x,m.x,g),Ll(p.y,f.y,m.y,g),d&&(l=this.relativeTarget,h=d,pl(l.x,h.x)&&pl(l.y,h.y))&&(this.isProjectionDirty=!1),d||(d={x:{min:0,max:0},y:{min:0,max:0}}),al(d,this.relativeTarget)),s&&(this.animationValues=a,function(e,t,n,r,a,o){var i,s;if(a)e.opacity=Mt(0,null!==(i=n.opacity)&&void 0!==i?i:1,el(r)),e.opacityExit=Mt(null!==(s=t.opacity)&&void 0!==s?s:1,0,tl(r));else if(o){var l,c;e.opacity=Mt(null!==(l=t.opacity)&&void 0!==l?l:1,null!==(c=n.opacity)&&void 0!==c?c:1,r)}for(let u=0;u<Zs;u++){const a="border".concat(qs[u],"Radius");let o=$s(t,a),i=$s(n,a);void 0===o&&void 0===i||(o||(o=0),i||(i=0),0===o||0===i||Qs(o)===Qs(i)?(e[a]=Math.max(Mt(Js(o),Js(i),r),0),(rn.test(i)||rn.test(o))&&(e[a]+="%")):e[a]=i)}(t.rotate||n.rotate)&&(e.rotate=Mt(t.rotate||0,n.rotate||0,r))}(a,r,this.latestValues,n,u,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){var t,n;this.notifyListeners("animationStart"),null===(t=this.currentAnimation)||void 0===t||t.stop(),null===(n=this.resumingFrom)||void 0===n||null===(n=n.currentAnimation)||void 0===n||n.stop(),this.pendingAnimation&&(_n(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Nn.update(()=>{Rs.hasAnimatedSinceResize=!0,ao.layout++,this.motionValue||(this.motionValue=Nr(0)),this.currentAnimation=Gs(this.motionValue,[0,1e3],tt(tt({},e),{},{velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{ao.layout--},onComplete:()=>{ao.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:r,latestValues:a}=e;if(t&&n&&r){if(this!==e&&this.layout&&r&&Gl(this.options.animationType,this.layout.layoutBox,r.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=us(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const r=us(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+r}al(t,n),Yt(t,a),hs(this.projectionDeltaWithTransform,this.layoutCorrected,t,a)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new yl);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this.getStack();r&&r.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;const r={};n.z&&kl("z",e,r,this.animationValues);for(let a=0;a<bl.length;a++)kl("rotate".concat(bl[a]),e,r,this.animationValues),kl("skew".concat(bl[a]),e,r,this.animationValues);e.render();for(const a in r)e.setStaticValue(a,r[a]),this.animationValues&&(this.animationValues[a]=r[a]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible)return void(e.visibility="hidden");const n=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=Aa(null===t||void 0===t?void 0:t.pointerEvents)||"",void(e.transform=n?n(this.latestValues,""):"none");const r=this.getLead();if(!this.projectionDelta||!this.layout||!r.target)return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=Aa(null===t||void 0===t?void 0:t.pointerEvents)||""),void(this.hasProjected&&!Ot(this.latestValues)&&(e.transform=n?n({},""):"none",this.hasProjected=!1));e.visibility="";const a=r.animationValues||r.latestValues;this.applyTransformsToTarget();let o=function(e,t,n){let r="";const a=e.x.translate/t.x,o=e.y.translate/t.y,i=(null===n||void 0===n?void 0:n.z)||0;if((a||o||i)&&(r="translate3d(".concat(a,"px, ").concat(o,"px, ").concat(i,"px) ")),1===t.x&&1===t.y||(r+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),n){const{transformPerspective:e,rotate:t,rotateX:a,rotateY:o,skewX:i,skewY:s}=n;e&&(r="perspective(".concat(e,"px) ").concat(r)),t&&(r+="rotate(".concat(t,"deg) ")),a&&(r+="rotateX(".concat(a,"deg) ")),o&&(r+="rotateY(".concat(o,"deg) ")),i&&(r+="skewX(".concat(i,"deg) ")),s&&(r+="skewY(".concat(s,"deg) "))}const s=e.x.scale*t.x,l=e.y.scale*t.y;return 1===s&&1===l||(r+="scale(".concat(s,", ").concat(l,")")),r||"none"}(this.projectionDeltaWithTransform,this.treeScale,a);n&&(o=n(a,o)),e.transform=o;const{x:i,y:s}=this.projectionDelta;var l,c;(e.transformOrigin="".concat(100*i.origin,"% ").concat(100*s.origin,"% 0"),r.animationValues)?e.opacity=r===this?null!==(l=null!==(c=a.opacity)&&void 0!==c?c:this.latestValues.opacity)&&void 0!==l?l:1:this.preserveOpacity?this.latestValues.opacity:a.opacityExit:e.opacity=r===this?void 0!==a.opacity?a.opacity:"":void 0!==a.opacityExit?a.opacityExit:0;for(const u in Qr){if(void 0===a[u])continue;const{correct:t,applyTo:n,isCSSVariable:i}=Qr[u],s="none"===o?a[u]:t(a[u],r);if(n){const t=n.length;for(let r=0;r<t;r++)e[n[r]]=s}else i?this.options.visualElement.renderState.vars[u]=s:e[u]=s}this.options.layoutId&&(e.pointerEvents=r===this?Aa(null===t||void 0===t?void 0:t.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(Il),this.root.sharedNodes.clear()}}}function Nl(e){e.updateLayout()}function _l(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=e.layout,{animationType:a}=e.options,o=n.source!==e.layout.source;"size"===a?gs(e=>{const r=o?n.measuredBox[e]:n.layoutBox[e],a=us(r);r.min=t[e].min,r.max=r.min+a}):Gl(a,n.layoutBox,t)&&gs(r=>{const a=o?n.measuredBox[r]:n.layoutBox[r],i=us(t[r]);a.max=a.min+i,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+i)});const i={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};hs(i,t,n.layoutBox);const s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};o?hs(s,e.applyTransform(r,!0),n.measuredBox):hs(s,t,n.layoutBox);const l=!hl(i);let c=!1;if(!e.resumeFrom){const r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){const{snapshot:a,layout:o}=r;if(a&&o){const i={x:{min:0,max:0},y:{min:0,max:0}};ms(i,n.layoutBox,a.layoutBox);const s={x:{min:0,max:0},y:{min:0,max:0}};ms(s,t,o.layoutBox),ml(i,s)||(c=!0),r.options.layoutRoot&&(e.relativeTarget=s,e.relativeTargetOrigin=i,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:s,layoutDelta:i,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function Sl(e){jn.value&&vl.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function El(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Al(e){e.clearSnapshot()}function Il(e){e.clearMeasurements()}function Tl(e){e.isLayoutDirty=!1}function Pl(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Dl(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Ml(e){e.resolveTargetDelta()}function Rl(e){e.calcProjection()}function Fl(e){e.resetSkewAndRotation()}function Ol(e){e.removeLeadSnapshot()}function Bl(e,t,n){e.translate=Mt(t.translate,0,n),e.scale=Mt(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Ll(e,t,n,r){e.min=Mt(t.min,n.min,r),e.max=Mt(t.max,n.max,r)}function zl(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const Wl={duration:.45,ease:[.4,0,.1,1]},Vl=e=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Ul=Vl("applewebkit/")&&!Vl("chrome/")?Math.round:bn;function Hl(e){e.min=Ul(e.min),e.max=Ul(e.max)}function Gl(e,t,n){return"position"===e||"preserve-aspect"===e&&(r=gl(t),a=gl(n),o=.2,!(Math.abs(r-a)<=o));var r,a,o}function Kl(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}const Xl=Cl({attachResizeListener:(e,t)=>is(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Yl={current:void 0},ql=Cl({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Yl.current){const e=new Xl({});e.mount(window),e.setOptions({layoutScroll:!0}),Yl.current=e}return Yl.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),Zl={pan:{Feature:class extends ts{constructor(){super(...arguments),this.removePointerDownListener=bn}onPointerDown(e){this.session=new vs(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:xs(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:Ms(e),onStart:Ms(t),onMove:n,onEnd:(e,t)=>{delete this.session,r&&Nn.postRender(()=>r(e,t))}}}mount(){this.removePointerDownListener=cs(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends ts{constructor(e){super(e),this.removeGroupControls=bn,this.removeListeners=bn,this.controls=new Ps(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||bn}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:ql,MeasureLayout:Ws}};function Jl(e,t,n){if(e instanceof EventTarget)return[e];if("string"===typeof e){var r;let a=document;t&&(a=t.current);const o=null!==(r=null===n||void 0===n?void 0:n[e])&&void 0!==r?r:a.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}function Ql(e,t){const n=Jl(e),r=new AbortController;return[n,tt(tt({passive:!0},t),{},{signal:r.signal}),()=>r.abort()]}function $l(e){return!("touch"===e.pointerType||os())}function ec(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover","Start"===n);const a=r["onHover"+n];a&&Nn.postRender(()=>a(t,ls(t)))}const tc=(e,t)=>!!t&&(e===t||tc(e,t.parentElement)),nc=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const rc=new WeakSet;function ac(e){return t=>{"Enter"===t.key&&e(t)}}function oc(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function ic(e){return ss(e)&&!os()}function sc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[r,a,o]=Ql(e,n),i=e=>{const r=e.currentTarget;if(!ic(e))return;rc.add(r);const o=t(r,e),i=(e,t)=>{window.removeEventListener("pointerup",s),window.removeEventListener("pointercancel",l),rc.has(r)&&rc.delete(r),ic(e)&&"function"===typeof o&&o(e,{success:t})},s=e=>{i(e,r===window||r===document||n.useGlobalTarget||tc(r,e.target))},l=e=>{i(e,!1)};window.addEventListener("pointerup",s,a),window.addEventListener("pointercancel",l,a)};return r.forEach(e=>{var t;(n.useGlobalTarget?window:e).addEventListener("pointerdown",i,a),at(e)&&(e.addEventListener("focus",e=>((e,t)=>{const n=e.currentTarget;if(!n)return;const r=ac(()=>{if(rc.has(n))return;oc(n,"down");const e=ac(()=>{oc(n,"up")});n.addEventListener("keyup",e,t),n.addEventListener("blur",()=>oc(n,"cancel"),t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)})(e,a)),t=e,nc.has(t.tagName)||-1!==t.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),o}function lc(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap","Start"===n);const a=r["onTap"+("End"===n?"":n)];a&&Nn.postRender(()=>a(t,ls(t)))}const cc=["root"],uc=new WeakMap,dc=new WeakMap,hc=e=>{const t=uc.get(e.target);t&&t(e)},pc=e=>{e.forEach(hc)};function fc(e,t,n){const r=function(e){let{root:t}=e,n=mr(e,cc);const r=t||document;dc.has(r)||dc.set(r,{});const a=dc.get(r),o=JSON.stringify(n);return a[o]||(a[o]=new IntersectionObserver(pc,tt({root:t},n))),a[o]}(t);return uc.set(e,n),r.observe(e),()=>{uc.delete(e),r.unobserve(e)}}const mc={some:0,all:1};const gc={inView:{Feature:class extends ts{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof r?r:mc[r]};return fc(this.node.current,o,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,a&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),o=t?n:r;o&&o(e)})}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends ts{mount(){const{current:e}=this.node;e&&(this.unmount=sc(e,(e,t)=>(lc(this.node,t,"Start"),(e,t)=>{let{success:n}=t;return lc(this.node,e,n?"End":"Cancel")}),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends ts{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(Z_){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=to(is(this.node.current,"focus",()=>this.onFocus()),is(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends ts{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[r,a,o]=Ql(e,n),i=e=>{if(!$l(e))return;const{target:n}=e,r=t(n,e);if("function"!==typeof r||!n)return;const o=e=>{$l(e)&&(r(e),n.removeEventListener("pointerleave",o))};n.addEventListener("pointerleave",o,a)};return r.forEach(e=>{e.addEventListener("pointerenter",i,a)}),o}(e,(e,t)=>(ec(this.node,t,"Start"),e=>ec(this.node,e,"End"))))}unmount(){}}}},xc={layout:{ProjectionNode:ql,MeasureLayout:Ws}},yc=Ha(tt(tt(tt(tt({},rs),gc),Zl),xc),pa),vc="#F97316",bc="#E5E5E5",wc="#737373",kc="#FFFFFF",jc="#262626",Cc="#22C55E",Nc="#EF4444",_c="#FAFAFA",Sc="#FFF7ED",Ec="#FFFFFF",Ac="#F5F5F5",Ic="0 12px",Tc="8px 12px",Pc="8px",Dc="16px",Mc="12px",Rc="14px",Fc="16px",Oc="18px",Bc=600,Lc=700,zc=1.3,Wc=1.2,Vc="12px",Uc="0 1px 3px rgba(0,0,0,0.1)",Hc=("1px solid ".concat(bc),()=>(0,Ue.jsxs)("div",{className:"flex flex-col items-center py-6 w-full h-full border-r",style:{backgroundColor:bc,borderColor:bc},children:[(0,Ue.jsx)("button",{className:"p-3 mb-6 rounded-lg bg-gray-200 hover:bg-gray-400 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,Ue.jsx)("div",{className:"flex-1"}),(0,Ue.jsx)("button",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-700 font-medium hover:bg-gray-400 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]})),Gc={bg:["#E5E7EB","#FECACA","#FED7AA","#FEF08A","#BBF7D0","#99F6E4","#BAE6FD","#BFDBFE","#DDD6FE","#FBCFE8"],text:["#4B5563","#DC2626","#EA580C","#CA8A04","#16A34A","#0D9488","#0284C7","#2563EB","#7C3AED","#DB2777"]},Kc=e=>{let t=0;for(let r=0;r<e.length;r++)t=e.charCodeAt(r)+((t<<5)-t);const n=Math.abs(t)%Gc.bg.length;return{bg:Gc.bg[n],text:Gc.text[n]}},Xc=[{id:"evlogia",name:"Evlogia Apparel",role:"Owner",avatarColor:"#6B7280"},{id:"apotik-sawangan",name:"Apotik Sawangan",role:"Collaborator",avatarColor:"#22C55E"},{id:"toko-garuda",name:"Toko Garuda",role:"Collaborator",avatarColor:"#EAB308"},{id:"dnd",name:"DnD",role:"Collaborator",avatarColor:"#EF4444"},{id:"personal-finance",name:"Personal Finance",role:"Main Account",avatarColor:"#3B82F6"},{id:"dummy-1",name:"Dummy 1",role:"Collaborator",avatarColor:"#14B8A6"},{id:"dummy-2",name:"Dummy 2",role:"Collaborator",avatarColor:"#0EA5E9"},{id:"dummy-3",name:"Dummy 3",role:"Collaborator",avatarColor:"#8B5CF6"},{id:"dummy-4",name:"Dummy 4",role:"Collaborator",avatarColor:"#EC4899"},{id:"dummy-5",name:"Dummy 5",role:"Collaborator",avatarColor:"#F97316"}],Yc=e=>{let{tenants:t,activeTenant:n,onSelectTenant:r,isLoading:o=!1}=e;const[i,s]=(0,a.useState)(""),[l,c]=(0,a.useState)("all"),[u,d]=(0,a.useState)(!1),h=(0,a.useRef)(null),p=(0,a.useMemo)(()=>Xc.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())),[i]);return(0,Ue.jsxs)("div",{className:"w-full h-full bg-white",children:[(0,Ue.jsxs)("div",{className:"md:hidden",style:{position:"fixed",top:0,left:0,right:0,bottom:0,height:"100dvh",width:"100vw",backgroundColor:"#FFFFFF",overflow:"hidden",zIndex:40},children:[(0,Ue.jsx)("div",{className:"bg-neutral-50/70 backdrop-blur-md",style:{position:"fixed",top:0,left:0,right:0,zIndex:50,paddingTop:"env(safe-area-inset-top)"},children:(0,Ue.jsxs)("header",{className:"flex items-center justify-between px-4 h-14",style:{borderBottom:u?"1px solid rgba(0,0,0,0.1)":"none"},children:[(0,Ue.jsx)("button",{className:"w-10 h-10 flex items-center justify-center text-gray-700",children:(0,Ue.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,Ue.jsx)("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),(0,Ue.jsx)("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),(0,Ue.jsx)("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),(0,Ue.jsx)("h1",{className:"text-xl font-semibold text-gray-900 transition-opacity duration-200",style:{opacity:u?1:0},children:"Workspace"}),(0,Ue.jsx)("button",{className:"w-10 h-10 flex items-center justify-center text-gray-700",children:(0,Ue.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,Ue.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,Ue.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})}),(0,Ue.jsxs)("div",{ref:h,onScroll:e=>{const t=e.currentTarget.scrollTop;d(t>100)},style:{position:"absolute",top:0,bottom:0,left:0,right:0,paddingTop:"calc(56px + env(safe-area-inset-top))",paddingBottom:"calc(80px + env(safe-area-inset-bottom))",overflowY:"auto",WebkitOverflowScrolling:"touch",overscrollBehavior:"contain"},children:[(0,Ue.jsx)("div",{className:"px-4 pt-2 pb-3",children:(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Workspace"})}),(0,Ue.jsx)("div",{className:"px-4 pb-3",children:(0,Ue.jsx)("div",{className:"relative",children:(0,Ue.jsx)("input",{type:"text",value:i,onChange:e=>s(e.target.value),placeholder:"Search",className:"w-full pl-4 pr-3 py-3 text-sm bg-neutral-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-300 transition-all",style:{border:"none"}})})}),(0,Ue.jsxs)("div",{className:"px-4 pb-3 flex gap-2",children:[(0,Ue.jsx)("button",{onClick:()=>c("all"),className:"px-4 py-1.5 text-sm font-medium rounded-full transition-colors ".concat("all"===l?"bg-neutral-800 text-white":"bg-white text-neutral-600 border border-neutral-300 hover:bg-neutral-50 active:bg-neutral-200"),children:"all chat"}),(0,Ue.jsx)("button",{onClick:()=>c("unread"),className:"px-4 py-1.5 text-sm font-medium rounded-full transition-colors ".concat("unread"===l?"bg-neutral-800 text-white":"bg-white text-neutral-600 border border-neutral-300 hover:bg-neutral-50 active:bg-neutral-200"),children:"unread"}),(0,Ue.jsx)("button",{onClick:()=>c("favourite"),className:"px-4 py-1.5 text-sm font-medium rounded-full transition-colors ".concat("favourite"===l?"bg-neutral-800 text-white":"bg-white text-neutral-600 border border-neutral-300 hover:bg-neutral-50 active:bg-neutral-200"),children:"favourite"})]}),o&&(0,Ue.jsx)("div",{className:"px-6 py-4 text-center text-gray-500 text-sm",children:"Loading tenants..."}),p.map(e=>(0,Ue.jsxs)("div",{onClick:()=>r(e.id),className:"px-4 pt-3 cursor-pointer transition-colors ".concat((null===n||void 0===n?void 0:n.id)===e.id?"bg-gray-100":"hover:bg-gray-50 active:bg-neutral-200"),children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(()=>{const t=Kc(e.name);return(0,Ue.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-semibold flex-shrink-0 text-lg",style:{backgroundColor:t.bg,color:t.text},children:e.avatar||e.name.charAt(0).toUpperCase()})})(),(0,Ue.jsxs)("div",{className:"flex-1 min-w-0 text-left",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.name}),(0,Ue.jsx)("p",{className:"text-base text-gray-500 truncate",children:e.role||"Member"})]})]}),(0,Ue.jsx)("div",{className:"ml-[60px] border-b border-gray-300 mt-3"})]},e.id)),0===p.length&&i&&(0,Ue.jsxs)("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:['No tenants found for "',i,'"']})]})]}),(0,Ue.jsxs)("div",{className:"hidden md:flex md:flex-col md:h-full",children:[(0,Ue.jsxs)("div",{className:"px-4 py-4 border-b border-gray-200 bg-white",children:[(0,Ue.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Milkyhoop"}),(0,Ue.jsx)("div",{className:"relative mb-3",children:(0,Ue.jsx)("input",{type:"text",value:i,onChange:e=>s(e.target.value),placeholder:"Search",className:"w-full pl-4 pr-3 py-2.5 text-sm bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-200 transition-colors"})}),(0,Ue.jsxs)("div",{className:"flex gap-2",children:[(0,Ue.jsx)("button",{onClick:()=>c("all"),className:"px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",style:{backgroundColor:"all"===l?"#262626":"transparent",color:"all"===l?"#ffffff":"#525252"},onMouseEnter:e=>{"all"!==l&&(e.currentTarget.style.backgroundColor="#F5F5F5")},onMouseLeave:e=>{"all"!==l&&(e.currentTarget.style.backgroundColor="transparent")},children:"All"}),(0,Ue.jsx)("button",{onClick:()=>c("unread"),className:"px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",style:{backgroundColor:"unread"===l?"#262626":"transparent",color:"unread"===l?"#ffffff":"#525252"},onMouseEnter:e=>{"unread"!==l&&(e.currentTarget.style.backgroundColor="#F5F5F5")},onMouseLeave:e=>{"unread"!==l&&(e.currentTarget.style.backgroundColor="transparent")},children:"Unread"})]})]}),(0,Ue.jsxs)("div",{className:"flex-1 overflow-y-auto bg-white",children:[o&&(0,Ue.jsx)("div",{className:"px-6 py-4 text-center text-gray-500 text-sm",children:"Loading tenants..."}),p.map(e=>(0,Ue.jsxs)("div",{onClick:()=>r(e.id),className:"px-4 pt-3 cursor-pointer transition-colors ".concat((null===n||void 0===n?void 0:n.id)===e.id?"bg-gray-100":"hover:bg-gray-50 active:bg-neutral-200"),children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(()=>{const t=Kc(e.name);return(0,Ue.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-semibold flex-shrink-0 text-lg",style:{backgroundColor:t.bg,color:t.text},children:e.avatar||e.name.charAt(0).toUpperCase()})})(),(0,Ue.jsxs)("div",{className:"flex-1 min-w-0 text-left",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.name}),(0,Ue.jsx)("p",{className:"text-base text-gray-500 truncate",children:e.role||"Member"})]})]}),(0,Ue.jsx)("div",{className:"ml-[60px] border-b border-gray-300 mt-3"})]},e.id)),0===p.length&&i&&(0,Ue.jsxs)("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:['No tenants found for "',i,'"']})]})]})]})},qc={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"",Zc=e=>e.startsWith("http")?e:qc?"".concat(qc).concat(e):e,Jc=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((()=>{const e=Ee();if(!e)return!0;try{const t=1e3*JSON.parse(atob(e.split(".")[1])).exp;return t-Date.now()<3e5}catch(J_){return!0}})()){console.log("[fetchWithAuth] Token expiring soon, refreshing...");if(!await Te())throw new Error("Token refresh failed - user logged out")}const r=Ee(),a=Zc(e),o=await fetch(a,tt(tt({},t),{},{headers:tt(tt({},t.headers),r&&{Authorization:"Bearer ".concat(r)})}));if(401===o.status){const r=o.clone();try{const e=await r.json();if("SESSION_REPLACED"===e.code||e.force_logout)throw console.warn("[fetchWithAuth] SESSION_REPLACED detected - forcing logout"),window.dispatchEvent(new CustomEvent("deviceForceLogout",{detail:{reason:e.error||"Session digantikan oleh login baru"}})),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_timestamp"),localStorage.removeItem("device_id"),new Error("SESSION_REPLACED")}catch(Z_){if(Z_ instanceof Error&&"SESSION_REPLACED"===Z_.message)throw Z_}if(n<2){console.log("[fetchWithAuth] Got 401, attempting token refresh (retry ".concat(n+1,"/").concat(2,")..."));if(await Te()){const n=Ee(),r=Zc(e);return fetch(r,tt(tt({},t),{},{headers:tt(tt({},t.headers),n&&{Authorization:"Bearer ".concat(n)})}))}throw new Error("Authentication failed - please login again")}throw console.error("[fetchWithAuth] Max retries reached for 401"),new Error("Authentication failed after retries")}return o},Qc=async e=>{if(!Ee())return!1;try{return(await Jc("/api/tenant/".concat(e,"/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"__check_access__"})})).ok}catch(t){return console.error("[checkTenantAccess] Failed:",t),!1}},$c=async(e,t)=>{const n=await Jc("/api/tenant/".concat(e,"/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t})});if(!n.ok)throw new Error("API call failed: ".concat(n.status));return n.json()},eu=async()=>{const e=(()=>{const e=Ee();if(!e)return null;try{return JSON.parse(atob(e.split(".")[1])).tenant_id||null}catch(J_){return null}})();if(!e)return[];try{const t=await(async e=>{const t="/api/tenant/".concat(e,"/info"),n=Zc(t),r=await fetch(n);if(!r.ok)throw new Error("Failed to fetch tenant info: ".concat(r.status));return r.json()})(e);return[{id:e,name:t.display_name||t.name||e.charAt(0).toUpperCase()+e.slice(1),avatar:t.avatar||"\ud83c\udfea",status:"online",lastMessage:"",lastMessageTime:"Now",role:"Owner",isPrivate:!0}]}catch(t){return[{id:e,name:e.charAt(0).toUpperCase()+e.slice(1),avatar:"\ud83c\udfea",status:"online",lastMessage:"",lastMessageTime:"Now",role:"Owner",isPrivate:!0}]}},tu=[{id:"sales_product",label:"POS",icon:"/icons/POS.png",disabled:!1},{id:"purchase_goods",label:"Pembelian",icon:"/icons/PEMBELIAN.png",disabled:!1},{id:"expense",label:"Beban",icon:"/icons/BEBAN.png",disabled:!1},{id:"inventory_update",label:"Inventory",icon:"/icons/INVENTORY.png",disabled:!1},{id:"cash_bank",label:"Kas & Bank",icon:"/icons/KASBANK.png",disabled:!1},{id:"debt_receivable",label:"Hutang/\nPiutang",icon:"/icons/HUTANGPIUTANG.png",disabled:!1},{id:"customer",label:"Pelanggan",icon:"/icons/PELANGGAN.png",disabled:!1},{id:"insight",label:"Insight",icon:"/icons/INSIGHT.png",disabled:!1}],nu=e=>{let{isMobile:t=!1,onMenuItemClick:n,useIconImage:r=!1,isOpen:o,onOpenChange:i}=e;const[s,l]=(0,a.useState)(!1),c=(0,a.useRef)(null),u=void 0!==o?o:s,d=e=>{i&&i(e),void 0===o&&l(e)};(0,a.useEffect)(()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&d(!1)};return u&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[u]);const h=e=>{console.log("[ActionMenuButton] Menu item clicked:",e),d(!1),null===n||void 0===n||n(e)};return(0,Ue.jsxs)("div",{ref:c,className:"relative",children:[(0,Ue.jsx)("button",{onClick:()=>d(!u),className:"w-5 h-5 flex items-center justify-center bg-transparent hover:opacity-80 rounded-full transition-all flex-shrink-0","aria-label":"Open action menu",children:r?(0,Ue.jsx)("img",{src:"/icons/plusbutton.png",alt:"Add",className:"w-full h-full object-contain"}):(0,Ue.jsx)("svg",{className:"w-4 h-4 text-amber-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),u&&(0,Ue.jsx)(Ue.Fragment,{children:t?(0,Ue.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-end",children:[(0,Ue.jsx)("div",{className:"absolute inset-0 bg-black/20",onClick:()=>d(!1)}),(0,Ue.jsxs)("div",{className:"relative w-full bg-white rounded-t-2xl shadow-2xl animate-slide-up",style:{maxHeight:"70vh",paddingBottom:"env(safe-area-inset-bottom, 16px)"},children:[(0,Ue.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,Ue.jsx)("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),(0,Ue.jsx)("div",{className:"px-4 pb-6 pt-2",children:(0,Ue.jsx)("div",{className:"grid grid-cols-4 gap-3",children:tu.map(e=>(0,Ue.jsxs)("button",{onClick:()=>h(e.id),disabled:e.disabled,className:"flex flex-col items-center justify-start text-center disabled:opacity-40 disabled:cursor-not-allowed",style:{minHeight:"80px"},children:[(0,Ue.jsx)("div",{className:"w-12 h-12 mb-2 flex items-center justify-center",children:(0,Ue.jsx)("img",{src:e.icon,alt:e.label,className:"w-full h-full object-contain"})}),(0,Ue.jsx)("div",{className:"text-xs font-normal text-gray-800 leading-tight px-1 whitespace-pre-line",children:e.label})]},e.id))})})]})]}):(0,Ue.jsx)("div",{className:"absolute bottom-full left-0 mb-2 bg-white rounded-2xl py-1 z-50 animate-popup-slide",style:{minWidth:"220px",maxWidth:"220px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15)"},children:tu.map((e,t)=>(0,Ue.jsxs)("button",{onClick:()=>h(e.id),disabled:e.disabled,className:"w-full flex items-center gap-3 px-5 py-3 hover:bg-gray-50 transition-colors text-left disabled:opacity-40 disabled:cursor-not-allowed ".concat(0===t?"rounded-t-2xl":""," ").concat(t===tu.length-1?"rounded-b-2xl":""),children:[(0,Ue.jsx)("div",{className:"w-6 h-6 flex-shrink-0",children:(0,Ue.jsx)("img",{src:e.icon,alt:e.label,className:"w-full h-full object-contain"})}),(0,Ue.jsx)("span",{className:"text-[15px] font-normal text-gray-800",children:e.label})]},e.id))})})]})};function ru(){let{edgeThreshold:e=30,swipeThreshold:t=50,verticalTolerance:n=30,onSwipe:r,enabled:o=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=(0,a.useRef)(null);return{handleTouchStart:(0,a.useCallback)(t=>{if(!o)return;const n=t.touches[0],r=window.innerWidth-n.clientX;i.current=r<=e?{startX:n.clientX,startY:n.clientY,isValidStart:!0}:null},[o,e]),handleTouchMove:(0,a.useCallback)(e=>{var t;if(!o||null===(t=i.current)||void 0===t||!t.isValidStart)return;const r=e.touches[0];Math.abs(r.clientY-i.current.startY)>n&&(i.current.isValidStart=!1)},[o,n]),handleTouchEnd:(0,a.useCallback)(e=>{var a;if(!o||null===(a=i.current)||void 0===a||!a.isValidStart)return void(i.current=null);const s=e.changedTouches[0],l=i.current.startX-s.clientX,c=Math.abs(s.clientY-i.current.startY);l>t&&c<=n&&(null===r||void 0===r||r()),i.current=null},[o,t,n,r])}}function au(e,t){void 0===t&&(t=e.constructor);var n=Error.captureStackTrace;n&&n(e,t)}var ou=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),iu=function(e){function t(t,n){var r=this.constructor,a=e.call(this,t,n)||this;return Object.defineProperty(a,"name",{value:r.name,enumerable:!1,configurable:!0}),function(e,t){var n=Object.setPrototypeOf;n?n(e,t):e.__proto__=t}(a,r.prototype),au(a),a}return ou(t,e),t}(Error);var su=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const lu=function(e){function t(t){void 0===t&&(t=void 0);var n=e.call(this,t)||this;return n.message=t,n}return su(t,e),t.prototype.getKind=function(){return this.constructor.kind},t.kind="Exception",t}(iu);var cu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const uu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cu(t,e),t.kind="ArgumentException",t}(lu);var du=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const hu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return du(t,e),t.kind="IllegalArgumentException",t}(lu);const pu=function(){function e(e){if(this.binarizer=e,null===e)throw new hu("Binarizer must be non-null.")}return e.prototype.getWidth=function(){return this.binarizer.getWidth()},e.prototype.getHeight=function(){return this.binarizer.getHeight()},e.prototype.getBlackRow=function(e,t){return this.binarizer.getBlackRow(e,t)},e.prototype.getBlackMatrix=function(){return null!==this.matrix&&void 0!==this.matrix||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},e.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},e.prototype.crop=function(t,n,r,a){var o=this.binarizer.getLuminanceSource().crop(t,n,r,a);return new e(this.binarizer.createBinarizer(o))},e.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},e.prototype.rotateCounterClockwise=function(){var t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new e(this.binarizer.createBinarizer(t))},e.prototype.rotateCounterClockwise45=function(){var t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new e(this.binarizer.createBinarizer(t))},e.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch(Z_){return""}},e}();var fu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const mu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fu(t,e),t.getChecksumInstance=function(){return new t},t.kind="ChecksumException",t}(lu);const gu=function(){function e(e){this.source=e}return e.prototype.getLuminanceSource=function(){return this.source},e.prototype.getWidth=function(){return this.source.getWidth()},e.prototype.getHeight=function(){return this.source.getHeight()},e}();var xu=function(){function e(){}return e.arraycopy=function(e,t,n,r,a){for(;a--;)n[r++]=e[t++]},e.currentTimeMillis=function(){return Date.now()},e}();const yu=xu;var vu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const bu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vu(t,e),t.kind="IndexOutOfBoundsException",t}(lu);var wu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const ku=function(e){function t(t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0);var r=e.call(this,n)||this;return r.index=t,r.message=n,r}return wu(t,e),t.kind="ArrayIndexOutOfBoundsException",t}(bu);var ju=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Cu=function(){function e(){}return e.fill=function(e,t){for(var n=0,r=e.length;n<r;n++)e[n]=t},e.fillWithin=function(t,n,r,a){e.rangeCheck(t.length,n,r);for(var o=n;o<r;o++)t[o]=a},e.rangeCheck=function(e,t,n){if(t>n)throw new hu("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new ku(t);if(n>e)throw new ku(n)},e.asList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},e.create=function(e,t,n){return Array.from({length:e}).map(function(e){return Array.from({length:t}).fill(n)})},e.createInt32Array=function(e,t,n){return Array.from({length:e}).map(function(e){return Int32Array.from({length:t}).fill(n)})},e.equals=function(e,t){if(!e)return!1;if(!t)return!1;if(!e.length)return!1;if(!t.length)return!1;if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0},e.hashCode=function(e){var t,n;if(null===e)return 0;var r=1;try{for(var a=ju(e),o=a.next();!o.done;o=a.next()){r=31*r+o.value}}catch(i){t={error:i}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r},e.fillUint8Array=function(e,t){for(var n=0;n!==e.length;n++)e[n]=t},e.copyOf=function(e,t){return e.slice(0,t)},e.copyOfUint8Array=function(e,t){if(e.length<=t){var n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)},e.copyOfRange=function(e,t,n){var r=n-t,a=new Int32Array(r);return yu.arraycopy(e,t,a,0,r),a},e.binarySearch=function(t,n,r){void 0===r&&(r=e.numberComparator);for(var a=0,o=t.length-1;a<=o;){var i=o+a>>1,s=r(n,t[i]);if(s>0)a=i+1;else{if(!(s<0))return i;o=i-1}}return-a-1},e.numberComparator=function(e,t){return e-t},e}();const Nu=Cu;const _u=function(){function e(){}return e.numberOfTrailingZeros=function(e){var t;if(0===e)return 32;var n=31;return 0!==(t=e<<16)&&(n-=16,e=t),0!==(t=e<<8)&&(n-=8,e=t),0!==(t=e<<4)&&(n-=4,e=t),0!==(t=e<<2)&&(n-=2,e=t),n-(e<<1>>>31)},e.numberOfLeadingZeros=function(e){if(0===e)return 32;var t=1;return e>>>16===0&&(t+=16,e<<=16),e>>>24===0&&(t+=8,e<<=8),e>>>28===0&&(t+=4,e<<=4),e>>>30===0&&(t+=2,e<<=2),t-=e>>>31},e.toHexString=function(e){return e.toString(16)},e.toBinaryString=function(e){return String(parseInt(String(e),2))},e.bitCount=function(e){return e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135,e+=e>>>8,63&(e+=e>>>16)},e.truncDivision=function(e,t){return Math.trunc(e/t)},e.parseInt=function(e,t){return void 0===t&&(t=void 0),parseInt(e,t)},e.MIN_VALUE_32_BITS=-2147483648,e.MAX_VALUE=Number.MAX_SAFE_INTEGER,e}();const Su=function(){function e(t,n){void 0===t?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,this.bits=void 0===n||null===n?e.makeArray(t):n)}return e.prototype.getSize=function(){return this.size},e.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},e.prototype.ensureCapacity=function(t){if(t>32*this.bits.length){var n=e.makeArray(t);yu.arraycopy(this.bits,0,n,0,this.bits.length),this.bits=n}},e.prototype.get=function(e){return 0!==(this.bits[Math.floor(e/32)]&1<<(31&e))},e.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(31&e)},e.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(31&e)},e.prototype.getNextSet=function(e){var t=this.size;if(e>=t)return t;var n=this.bits,r=Math.floor(e/32),a=n[r];a&=~((1<<(31&e))-1);for(var o=n.length;0===a;){if(++r===o)return t;a=n[r]}var i=32*r+_u.numberOfTrailingZeros(a);return i>t?t:i},e.prototype.getNextUnset=function(e){var t=this.size;if(e>=t)return t;var n=this.bits,r=Math.floor(e/32),a=~n[r];a&=~((1<<(31&e))-1);for(var o=n.length;0===a;){if(++r===o)return t;a=~n[r]}var i=32*r+_u.numberOfTrailingZeros(a);return i>t?t:i},e.prototype.setBulk=function(e,t){this.bits[Math.floor(e/32)]=t},e.prototype.setRange=function(e,t){if(t<e||e<0||t>this.size)throw new hu;if(t!==e){t--;for(var n=Math.floor(e/32),r=Math.floor(t/32),a=this.bits,o=n;o<=r;o++){var i=(2<<(o<r?31:31&t))-(1<<(o>n?0:31&e));a[o]|=i}}},e.prototype.clear=function(){for(var e=this.bits.length,t=this.bits,n=0;n<e;n++)t[n]=0},e.prototype.isRange=function(e,t,n){if(t<e||e<0||t>this.size)throw new hu;if(t===e)return!0;t--;for(var r=Math.floor(e/32),a=Math.floor(t/32),o=this.bits,i=r;i<=a;i++){var s=(2<<(i<a?31:31&t))-(1<<(i>r?0:31&e))&4294967295;if((o[i]&s)!==(n?s:0))return!1}return!0},e.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++},e.prototype.appendBits=function(e,t){if(t<0||t>32)throw new hu("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(var n=t;n>0;n--)this.appendBit(1===(e>>n-1&1))},e.prototype.appendBitArray=function(e){var t=e.size;this.ensureCapacity(this.size+t);for(var n=0;n<t;n++)this.appendBit(e.get(n))},e.prototype.xor=function(e){if(this.size!==e.size)throw new hu("Sizes don't match");for(var t=this.bits,n=0,r=t.length;n<r;n++)t[n]^=e.bits[n]},e.prototype.toBytes=function(e,t,n,r){for(var a=0;a<r;a++){for(var o=0,i=0;i<8;i++)this.get(e)&&(o|=1<<7-i),e++;t[n+a]=o}},e.prototype.getBitArray=function(){return this.bits},e.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,r=this.bits,a=0;a<n;a++){var o=r[a];o=(o=(o=(o=(o=o>>1&1431655765|(1431655765&o)<<1)>>2&858993459|(858993459&o)<<2)>>4&252645135|(252645135&o)<<4)>>8&16711935|(16711935&o)<<8)>>16&65535|(65535&o)<<16,e[t-a]=o}if(this.size!==32*n){var i=32*n-this.size,s=e[0]>>>i;for(a=1;a<n;a++){var l=e[a];s|=l<<32-i,e[a-1]=s,s=l>>>i}e[n-1]=s}this.bits=e},e.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;return this.size===n.size&&Nu.equals(this.bits,n.bits)},e.prototype.hashCode=function(){return 31*this.size+Nu.hashCode(this.bits)},e.prototype.toString=function(){for(var e="",t=0,n=this.size;t<n;t++)0===(7&t)&&(e+=" "),e+=this.get(t)?"X":".";return e},e.prototype.clone=function(){return new e(this.size,this.bits.slice())},e.prototype.toArray=function(){for(var e=[],t=0,n=this.size;t<n;t++)e.push(this.get(t));return e},e}();var Eu;!function(e){e[e.OTHER=0]="OTHER",e[e.PURE_BARCODE=1]="PURE_BARCODE",e[e.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",e[e.TRY_HARDER=3]="TRY_HARDER",e[e.CHARACTER_SET=4]="CHARACTER_SET",e[e.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",e[e.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",e[e.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",e[e.ASSUME_GS1=8]="ASSUME_GS1",e[e.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",e[e.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",e[e.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"}(Eu||(Eu={}));const Au=Eu;var Iu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Tu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Iu(t,e),t.getFormatInstance=function(){return new t},t.kind="FormatException",t}(lu);var Pu,Du=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(e){e[e.Cp437=0]="Cp437",e[e.ISO8859_1=1]="ISO8859_1",e[e.ISO8859_2=2]="ISO8859_2",e[e.ISO8859_3=3]="ISO8859_3",e[e.ISO8859_4=4]="ISO8859_4",e[e.ISO8859_5=5]="ISO8859_5",e[e.ISO8859_6=6]="ISO8859_6",e[e.ISO8859_7=7]="ISO8859_7",e[e.ISO8859_8=8]="ISO8859_8",e[e.ISO8859_9=9]="ISO8859_9",e[e.ISO8859_10=10]="ISO8859_10",e[e.ISO8859_11=11]="ISO8859_11",e[e.ISO8859_13=12]="ISO8859_13",e[e.ISO8859_14=13]="ISO8859_14",e[e.ISO8859_15=14]="ISO8859_15",e[e.ISO8859_16=15]="ISO8859_16",e[e.SJIS=16]="SJIS",e[e.Cp1250=17]="Cp1250",e[e.Cp1251=18]="Cp1251",e[e.Cp1252=19]="Cp1252",e[e.Cp1256=20]="Cp1256",e[e.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",e[e.UTF8=22]="UTF8",e[e.ASCII=23]="ASCII",e[e.Big5=24]="Big5",e[e.GB18030=25]="GB18030",e[e.EUC_KR=26]="EUC_KR"}(Pu||(Pu={}));var Mu=function(){function e(t,n,r){for(var a,o,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];this.valueIdentifier=t,this.name=r,this.values="number"===typeof n?Int32Array.from([n]):n,this.otherEncodingNames=i,e.VALUE_IDENTIFIER_TO_ECI.set(t,this),e.NAME_TO_ECI.set(r,this);for(var l=this.values,c=0,u=l.length;c!==u;c++){var d=l[c];e.VALUES_TO_ECI.set(d,this)}try{for(var h=Du(i),p=h.next();!p.done;p=h.next()){var f=p.value;e.NAME_TO_ECI.set(f,this)}}catch(m){a={error:m}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}}return e.prototype.getValueIdentifier=function(){return this.valueIdentifier},e.prototype.getName=function(){return this.name},e.prototype.getValue=function(){return this.values[0]},e.getCharacterSetECIByValue=function(t){if(t<0||t>=900)throw new Tu("incorect value");var n=e.VALUES_TO_ECI.get(t);if(void 0===n)throw new Tu("incorect value");return n},e.getCharacterSetECIByName=function(t){var n=e.NAME_TO_ECI.get(t);if(void 0===n)throw new Tu("incorect value");return n},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;return this.getName()===n.getName()},e.VALUE_IDENTIFIER_TO_ECI=new Map,e.VALUES_TO_ECI=new Map,e.NAME_TO_ECI=new Map,e.Cp437=new e(Pu.Cp437,Int32Array.from([0,2]),"Cp437"),e.ISO8859_1=new e(Pu.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),e.ISO8859_2=new e(Pu.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),e.ISO8859_3=new e(Pu.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),e.ISO8859_4=new e(Pu.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),e.ISO8859_5=new e(Pu.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),e.ISO8859_6=new e(Pu.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),e.ISO8859_7=new e(Pu.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),e.ISO8859_8=new e(Pu.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),e.ISO8859_9=new e(Pu.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),e.ISO8859_10=new e(Pu.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),e.ISO8859_11=new e(Pu.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),e.ISO8859_13=new e(Pu.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),e.ISO8859_14=new e(Pu.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),e.ISO8859_15=new e(Pu.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),e.ISO8859_16=new e(Pu.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),e.SJIS=new e(Pu.SJIS,20,"SJIS","Shift_JIS"),e.Cp1250=new e(Pu.Cp1250,21,"Cp1250","windows-1250"),e.Cp1251=new e(Pu.Cp1251,22,"Cp1251","windows-1251"),e.Cp1252=new e(Pu.Cp1252,23,"Cp1252","windows-1252"),e.Cp1256=new e(Pu.Cp1256,24,"Cp1256","windows-1256"),e.UnicodeBigUnmarked=new e(Pu.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),e.UTF8=new e(Pu.UTF8,26,"UTF8","UTF-8"),e.ASCII=new e(Pu.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),e.Big5=new e(Pu.Big5,28,"Big5"),e.GB18030=new e(Pu.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),e.EUC_KR=new e(Pu.EUC_KR,30,"EUC_KR","EUC-KR"),e}();const Ru=Mu;var Fu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Ou=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fu(t,e),t.kind="UnsupportedOperationException",t}(lu);const Bu=function(){function e(){}return e.decode=function(e,t){var n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):"undefined"===typeof TextDecoder||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},e.shouldDecodeOnFallback=function(t){return!e.isBrowser()&&"ISO-8859-1"===t},e.encode=function(e,t){var n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):"undefined"===typeof TextEncoder?this.encodeFallback(e):(new TextEncoder).encode(e)},e.isBrowser=function(){return"undefined"!==typeof window&&"[object Window]"==={}.toString.call(window)},e.encodingName=function(e){return"string"===typeof e?e:e.getName()},e.encodingCharacterSet=function(e){return e instanceof Ru?e:Ru.getCharacterSetECIByName(e)},e.decodeFallback=function(t,n){var r=this.encodingCharacterSet(n);if(e.isDecodeFallbackSupported(r)){for(var a="",o=0,i=t.length;o<i;o++){var s=t[o].toString(16);s.length<2&&(s="0"+s),a+="%"+s}return decodeURIComponent(a)}if(r.equals(Ru.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new Ou("Encoding "+this.encodingName(n)+" not supported by fallback.")},e.isDecodeFallbackSupported=function(e){return e.equals(Ru.UTF8)||e.equals(Ru.ISO8859_1)||e.equals(Ru.ASCII)},e.encodeFallback=function(e){for(var t=btoa(unescape(encodeURIComponent(e))).split(""),n=[],r=0;r<t.length;r++)n.push(t[r].charCodeAt(0));return new Uint8Array(n)},e}();const Lu=function(){function e(){}return e.castAsNonUtf8Char=function(e,t){void 0===t&&(t=null);var n=t?t.getName():this.ISO88591;return Bu.decode(new Uint8Array([e]),n)},e.guessEncoding=function(t,n){if(null!==n&&void 0!==n&&void 0!==n.get(Au.CHARACTER_SET))return n.get(Au.CHARACTER_SET).toString();for(var r=t.length,a=!0,o=!0,i=!0,s=0,l=0,c=0,u=0,d=0,h=0,p=0,f=0,m=0,g=0,x=0,y=t.length>3&&239===t[0]&&187===t[1]&&191===t[2],v=0;v<r&&(a||o||i);v++){var b=255&t[v];i&&(s>0?0===(128&b)?i=!1:s--:0!==(128&b)&&(0===(64&b)?i=!1:(s++,0===(32&b)?l++:(s++,0===(16&b)?c++:(s++,0===(8&b)?u++:i=!1))))),a&&(b>127&&b<160?a=!1:b>159&&(b<192||215===b||247===b)&&x++),o&&(d>0?b<64||127===b||b>252?o=!1:d--:128===b||160===b||b>239?o=!1:b>160&&b<224?(h++,f=0,++p>m&&(m=p)):b>127?(d++,p=0,++f>g&&(g=f)):(p=0,f=0))}return i&&s>0&&(i=!1),o&&d>0&&(o=!1),i&&(y||l+c+u>0)?e.UTF8:o&&(e.ASSUME_SHIFT_JIS||m>=3||g>=3)?e.SHIFT_JIS:a&&o?2===m&&2===h||10*x>=r?e.SHIFT_JIS:e.ISO88591:a?e.ISO88591:o?e.SHIFT_JIS:i?e.UTF8:e.PLATFORM_DEFAULT_ENCODING},e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=-1;return e.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(e,n,a,o,i,s){if("%%"===e)return"%";if(void 0!==t[++r]){e=o?parseInt(o.substr(1)):void 0;var l,c=i?parseInt(i.substr(1)):void 0;switch(s){case"s":l=t[r];break;case"c":l=t[r][0];break;case"f":l=parseFloat(t[r]).toFixed(e);break;case"p":l=parseFloat(t[r]).toPrecision(e);break;case"e":l=parseFloat(t[r]).toExponential(e);break;case"x":l=parseInt(t[r]).toString(c||16);break;case"d":l=parseFloat(parseInt(t[r],c||10).toPrecision(e)).toFixed(0)}l="object"===typeof l?JSON.stringify(l):(+l).toString(c);for(var u=parseInt(a),d=a&&a[0]+""==="0"?"0":" ";l.length<u;)l=void 0!==n?l+d:d+l;return l}})},e.getBytes=function(e,t){return Bu.encode(e,t)},e.getCharCode=function(e,t){return void 0===t&&(t=0),e.charCodeAt(t)},e.getCharAt=function(e){return String.fromCharCode(e)},e.SHIFT_JIS=Ru.SJIS.getName(),e.GB2312="GB2312",e.ISO88591=Ru.ISO8859_1.getName(),e.EUC_JP="EUC_JP",e.UTF8=Ru.UTF8.getName(),e.PLATFORM_DEFAULT_ENCODING=e.UTF8,e.ASSUME_SHIFT_JIS=!1,e}();const zu=function(){function e(e){void 0===e&&(e=""),this.value=e}return e.prototype.enableDecoding=function(e){return this.encoding=e,this},e.prototype.append=function(e){return"string"===typeof e?this.value+=e.toString():this.encoding?this.value+=Lu.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},e.prototype.appendChars=function(e,t,n){for(var r=t;t<t+n;r++)this.append(e[r]);return this},e.prototype.length=function(){return this.value.length},e.prototype.charAt=function(e){return this.value.charAt(e)},e.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},e.prototype.setCharAt=function(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)},e.prototype.substring=function(e,t){return this.value.substring(e,t)},e.prototype.setLengthToZero=function(){this.value=""},e.prototype.toString=function(){return this.value},e.prototype.insert=function(e,t){this.value=this.value.substring(0,e)+t+this.value.substring(e)},e}();const Wu=function(){function e(e,t,n,r){if(this.width=e,this.height=t,this.rowSize=n,this.bits=r,void 0!==t&&null!==t||(t=e),this.height=t,e<1||t<1)throw new hu("Both dimensions must be greater than 0");void 0!==n&&null!==n||(n=Math.floor((e+31)/32)),this.rowSize=n,void 0!==r&&null!==r||(this.bits=new Int32Array(this.rowSize*this.height))}return e.parseFromBooleanArray=function(t){for(var n=t.length,r=t[0].length,a=new e(r,n),o=0;o<n;o++)for(var i=t[o],s=0;s<r;s++)i[s]&&a.set(s,o);return a},e.parseFromString=function(t,n,r){if(null===t)throw new hu("stringRepresentation cannot be null");for(var a=new Array(t.length),o=0,i=0,s=-1,l=0,c=0;c<t.length;)if("\n"===t.charAt(c)||"\r"===t.charAt(c)){if(o>i){if(-1===s)s=o-i;else if(o-i!==s)throw new hu("row lengths do not match");i=o,l++}c++}else if(t.substring(c,c+n.length)===n)c+=n.length,a[o]=!0,o++;else{if(t.substring(c,c+r.length)!==r)throw new hu("illegal character encountered: "+t.substring(c));c+=r.length,a[o]=!1,o++}if(o>i){if(-1===s)s=o-i;else if(o-i!==s)throw new hu("row lengths do not match");l++}for(var u=new e(s,l),d=0;d<o;d++)a[d]&&u.set(Math.floor(d%s),Math.floor(d/s));return u},e.prototype.get=function(e,t){var n=t*this.rowSize+Math.floor(e/32);return 0!==(this.bits[n]>>>(31&e)&1)},e.prototype.set=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(31&e)&4294967295},e.prototype.unset=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(31&e)&4294967295)},e.prototype.flip=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(31&e)&4294967295},e.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new hu("input matrix dimensions do not match");for(var t=new Su(Math.floor(this.width/32)+1),n=this.rowSize,r=this.bits,a=0,o=this.height;a<o;a++)for(var i=a*n,s=e.getRow(a,t).getBitArray(),l=0;l<n;l++)r[i+l]^=s[l]},e.prototype.clear=function(){for(var e=this.bits,t=e.length,n=0;n<t;n++)e[n]=0},e.prototype.setRegion=function(e,t,n,r){if(t<0||e<0)throw new hu("Left and top must be nonnegative");if(r<1||n<1)throw new hu("Height and width must be at least 1");var a=e+n,o=t+r;if(o>this.height||a>this.width)throw new hu("The region must fit inside the matrix");for(var i=this.rowSize,s=this.bits,l=t;l<o;l++)for(var c=l*i,u=e;u<a;u++)s[c+Math.floor(u/32)]|=1<<(31&u)&4294967295},e.prototype.getRow=function(e,t){null===t||void 0===t||t.getSize()<this.width?t=new Su(this.width):t.clear();for(var n=this.rowSize,r=this.bits,a=e*n,o=0;o<n;o++)t.setBulk(32*o,r[a+o]);return t},e.prototype.setRow=function(e,t){yu.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},e.prototype.rotate180=function(){for(var e=this.getWidth(),t=this.getHeight(),n=new Su(e),r=new Su(e),a=0,o=Math.floor((t+1)/2);a<o;a++)n=this.getRow(a,n),r=this.getRow(t-1-a,r),n.reverse(),r.reverse(),this.setRow(a,r),this.setRow(t-1-a,n)},e.prototype.getEnclosingRectangle=function(){for(var e=this.width,t=this.height,n=this.rowSize,r=this.bits,a=e,o=t,i=-1,s=-1,l=0;l<t;l++)for(var c=0;c<n;c++){var u=r[l*n+c];if(0!==u){if(l<o&&(o=l),l>s&&(s=l),32*c<a){for(var d=0;0===(u<<31-d&4294967295);)d++;32*c+d<a&&(a=32*c+d)}if(32*c+31>i){for(d=31;u>>>d===0;)d--;32*c+d>i&&(i=32*c+d)}}}return i<a||s<o?null:Int32Array.from([a,o,i-a+1,s-o+1])},e.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,t=this.bits,n=0;n<t.length&&0===t[n];)n++;if(n===t.length)return null;for(var r=n/e,a=n%e*32,o=t[n],i=0;0===(o<<31-i&4294967295);)i++;return a+=i,Int32Array.from([a,r])},e.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,t=this.bits,n=t.length-1;n>=0&&0===t[n];)n--;if(n<0)return null;for(var r=Math.floor(n/e),a=32*Math.floor(n%e),o=t[n],i=31;o>>>i===0;)i--;return a+=i,Int32Array.from([a,r])},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.getRowSize=function(){return this.rowSize},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;return this.width===n.width&&this.height===n.height&&this.rowSize===n.rowSize&&Nu.equals(this.bits,n.bits)},e.prototype.hashCode=function(){var e=this.width;return e=31*(e=31*(e=31*(e=31*e+this.width)+this.height)+this.rowSize)+Nu.hashCode(this.bits)},e.prototype.toString=function(e,t,n){return void 0===e&&(e="X "),void 0===t&&(t="  "),void 0===n&&(n="\n"),this.buildToString(e,t,n)},e.prototype.buildToString=function(e,t,n){for(var r=new zu,a=0,o=this.height;a<o;a++){for(var i=0,s=this.width;i<s;i++)r.append(this.get(i,a)?e:t);r.append(n)}return r.toString()},e.prototype.clone=function(){return new e(this.width,this.height,this.rowSize,this.bits.slice())},e}();var Vu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Uu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Vu(t,e),t.getNotFoundInstance=function(){return new t},t.kind="NotFoundException",t}(lu);var Hu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Gu=function(e){function t(n){var r=e.call(this,n)||this;return r.luminances=t.EMPTY,r.buckets=new Int32Array(t.LUMINANCE_BUCKETS),r}return Hu(t,e),t.prototype.getBlackRow=function(e,n){var r=this.getLuminanceSource(),a=r.getWidth();void 0===n||null===n||n.getSize()<a?n=new Su(a):n.clear(),this.initArrays(a);for(var o=r.getRow(e,this.luminances),i=this.buckets,s=0;s<a;s++)i[(255&o[s])>>t.LUMINANCE_SHIFT]++;var l=t.estimateBlackPoint(i);if(a<3)for(s=0;s<a;s++)(255&o[s])<l&&n.set(s);else{var c=255&o[0],u=255&o[1];for(s=1;s<a-1;s++){var d=255&o[s+1];(4*u-c-d)/2<l&&n.set(s),c=u,u=d}}return n},t.prototype.getBlackMatrix=function(){var e=this.getLuminanceSource(),n=e.getWidth(),r=e.getHeight(),a=new Wu(n,r);this.initArrays(n);for(var o=this.buckets,i=1;i<5;i++)for(var s=Math.floor(r*i/5),l=e.getRow(s,this.luminances),c=Math.floor(4*n/5),u=Math.floor(n/5);u<c;u++){o[(255&l[u])>>t.LUMINANCE_SHIFT]++}var d=t.estimateBlackPoint(o),h=e.getMatrix();for(i=0;i<r;i++){var p=i*n;for(u=0;u<n;u++){(255&h[p+u])<d&&a.set(u,i)}}return a},t.prototype.createBinarizer=function(e){return new t(e)},t.prototype.initArrays=function(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));for(var n=this.buckets,r=0;r<t.LUMINANCE_BUCKETS;r++)n[r]=0},t.estimateBlackPoint=function(e){for(var n=e.length,r=0,a=0,o=0,i=0;i<n;i++)e[i]>o&&(a=i,o=e[i]),e[i]>r&&(r=e[i]);var s=0,l=0;for(i=0;i<n;i++){var c=i-a;(p=e[i]*c*c)>l&&(s=i,l=p)}if(a>s){var u=a;a=s,s=u}if(s-a<=n/16)throw new Uu;var d=s-1,h=-1;for(i=s-1;i>a;i--){var p,f=i-a;(p=f*f*(s-i)*(r-e[i]))>h&&(d=i,h=p)}return d<<t.LUMINANCE_SHIFT},t.LUMINANCE_BITS=5,t.LUMINANCE_SHIFT=8-t.LUMINANCE_BITS,t.LUMINANCE_BUCKETS=1<<t.LUMINANCE_BITS,t.EMPTY=Uint8ClampedArray.from([0]),t}(gu);var Ku=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Xu=function(e){function t(t){var n=e.call(this,t)||this;return n.matrix=null,n}return Ku(t,e),t.prototype.getBlackMatrix=function(){if(null!==this.matrix)return this.matrix;var n=this.getLuminanceSource(),r=n.getWidth(),a=n.getHeight();if(r>=t.MINIMUM_DIMENSION&&a>=t.MINIMUM_DIMENSION){var o=n.getMatrix(),i=r>>t.BLOCK_SIZE_POWER;0!==(r&t.BLOCK_SIZE_MASK)&&i++;var s=a>>t.BLOCK_SIZE_POWER;0!==(a&t.BLOCK_SIZE_MASK)&&s++;var l=t.calculateBlackPoints(o,i,s,r,a),c=new Wu(r,a);t.calculateThresholdForBlock(o,i,s,r,a,l,c),this.matrix=c}else this.matrix=e.prototype.getBlackMatrix.call(this);return this.matrix},t.prototype.createBinarizer=function(e){return new t(e)},t.calculateThresholdForBlock=function(e,n,r,a,o,i,s){for(var l=o-t.BLOCK_SIZE,c=a-t.BLOCK_SIZE,u=0;u<r;u++){var d=u<<t.BLOCK_SIZE_POWER;d>l&&(d=l);for(var h=t.cap(u,2,r-3),p=0;p<n;p++){var f=p<<t.BLOCK_SIZE_POWER;f>c&&(f=c);for(var m=t.cap(p,2,n-3),g=0,x=-2;x<=2;x++){var y=i[h+x];g+=y[m-2]+y[m-1]+y[m]+y[m+1]+y[m+2]}var v=g/25;t.thresholdBlock(e,f,d,v,a,s)}}},t.cap=function(e,t,n){return e<t?t:e>n?n:e},t.thresholdBlock=function(e,n,r,a,o,i){for(var s=0,l=r*o+n;s<t.BLOCK_SIZE;s++,l+=o)for(var c=0;c<t.BLOCK_SIZE;c++)(255&e[l+c])<=a&&i.set(n+c,r+s)},t.calculateBlackPoints=function(e,n,r,a,o){for(var i=o-t.BLOCK_SIZE,s=a-t.BLOCK_SIZE,l=new Array(r),c=0;c<r;c++){l[c]=new Int32Array(n);var u=c<<t.BLOCK_SIZE_POWER;u>i&&(u=i);for(var d=0;d<n;d++){var h=d<<t.BLOCK_SIZE_POWER;h>s&&(h=s);for(var p=0,f=255,m=0,g=0,x=u*a+h;g<t.BLOCK_SIZE;g++,x+=a){for(var y=0;y<t.BLOCK_SIZE;y++){var v=255&e[x+y];p+=v,v<f&&(f=v),v>m&&(m=v)}if(m-f>t.MIN_DYNAMIC_RANGE)for(g++,x+=a;g<t.BLOCK_SIZE;g++,x+=a)for(y=0;y<t.BLOCK_SIZE;y++)p+=255&e[x+y]}var b=p>>2*t.BLOCK_SIZE_POWER;if(m-f<=t.MIN_DYNAMIC_RANGE&&(b=f/2,c>0&&d>0)){var w=(l[c-1][d]+2*l[c][d-1]+l[c-1][d-1])/4;f<w&&(b=w)}l[c][d]=b}}return l},t.BLOCK_SIZE_POWER=3,t.BLOCK_SIZE=1<<t.BLOCK_SIZE_POWER,t.BLOCK_SIZE_MASK=t.BLOCK_SIZE-1,t.MINIMUM_DIMENSION=5*t.BLOCK_SIZE,t.MIN_DYNAMIC_RANGE=24,t}(Gu);const Yu=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.isCropSupported=function(){return!1},e.prototype.crop=function(e,t,n,r){throw new Ou("This luminance source does not support cropping.")},e.prototype.isRotateSupported=function(){return!1},e.prototype.rotateCounterClockwise=function(){throw new Ou("This luminance source does not support rotation by 90 degrees.")},e.prototype.rotateCounterClockwise45=function(){throw new Ou("This luminance source does not support rotation by 45 degrees.")},e.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),t=new zu,n=0;n<this.height;n++){for(var r=this.getRow(n,e),a=0;a<this.width;a++){var o=255&r[a],i=void 0;i=o<64?"#":o<128?"+":o<192?".":" ",t.append(i)}t.append("\n")}return t.toString()},e}();var qu=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Zu=function(e){function t(t){var n=e.call(this,t.getWidth(),t.getHeight())||this;return n.delegate=t,n}return qu(t,e),t.prototype.getRow=function(e,t){for(var n=this.delegate.getRow(e,t),r=this.getWidth(),a=0;a<r;a++)n[a]=255-(255&n[a]);return n},t.prototype.getMatrix=function(){for(var e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(t),r=0;r<t;r++)n[r]=255-(255&e[r]);return n},t.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},t.prototype.crop=function(e,n,r,a){return new t(this.delegate.crop(e,n,r,a))},t.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},t.prototype.invert=function(){return this.delegate},t.prototype.rotateCounterClockwise=function(){return new t(this.delegate.rotateCounterClockwise())},t.prototype.rotateCounterClockwise45=function(){return new t(this.delegate.rotateCounterClockwise45())},t}(Yu);var Ju=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qu=function(e){function t(n,r){void 0===r&&(r=!1);var a=e.call(this,n.width,n.height)||this;return a.canvas=n,a.tempCanvasElement=null,a.buffer=t.makeBufferFromCanvasImageData(n,r),a}return Ju(t,e),t.makeBufferFromCanvasImageData=function(e,n){void 0===n&&(n=!1);var r=e.getContext("2d").getImageData(0,0,e.width,e.height);return t.toGrayscaleBuffer(r.data,e.width,e.height,n)},t.toGrayscaleBuffer=function(e,n,r,a){void 0===a&&(a=!1);var o=new Uint8ClampedArray(n*r);if(t.FRAME_INDEX=!t.FRAME_INDEX,t.FRAME_INDEX||!a)for(var i=0,s=0,l=e.length;i<l;i+=4,s++){var c=void 0;if(0===e[i+3])c=255;else c=306*e[i]+601*e[i+1]+117*e[i+2]+512>>10;o[s]=c}else{i=0,s=0;for(var u=e.length;i<u;i+=4,s++){c=void 0;if(0===e[i+3])c=255;else c=306*e[i]+601*e[i+1]+117*e[i+2]+512>>10;o[s]=255-c}}return o},t.prototype.getRow=function(e,t){if(e<0||e>=this.getHeight())throw new hu("Requested row is outside the image: "+e);var n=this.getWidth(),r=e*n;return null===t?t=this.buffer.slice(r,r+n):(t.length<n&&(t=new Uint8ClampedArray(n)),t.set(this.buffer.slice(r,r+n))),t},t.prototype.getMatrix=function(){return this.buffer},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(t,n,r,a){return e.prototype.crop.call(this,t,n,r,a),this},t.prototype.isRotateSupported=function(){return!0},t.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},t.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},t.prototype.getTempCanvasElement=function(){if(null===this.tempCanvasElement){var e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement},t.prototype.rotate=function(e){var n=this.getTempCanvasElement(),r=n.getContext("2d"),a=e*t.DEGREE_TO_RADIANS,o=this.canvas.width,i=this.canvas.height,s=Math.ceil(Math.abs(Math.cos(a))*o+Math.abs(Math.sin(a))*i),l=Math.ceil(Math.abs(Math.sin(a))*o+Math.abs(Math.cos(a))*i);return n.width=s,n.height=l,r.translate(s/2,l/2),r.rotate(a),r.drawImage(this.canvas,o/-2,i/-2),this.buffer=t.makeBufferFromCanvasImageData(n),this},t.prototype.invert=function(){return new Zu(this)},t.DEGREE_TO_RADIANS=Math.PI/180,t.FRAME_INDEX=!0,t}(Yu),$u=function(){function e(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}return e.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},e}(),ed=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{l(r.next(e))}catch(Z_){o(Z_)}}function s(e){try{l(r.throw(e))}catch(Z_){o(Z_)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,s)}l((r=r.apply(e,t||[])).next())})},td=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(Z_){o=[6,Z_],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},nd=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},rd=function(){function e(e,t,n){void 0===t&&(t=500),this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(e.prototype,"hasNavigator",{get:function(){return"undefined"!==typeof navigator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canEnumerateDevices",{get:function(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),e.prototype.listVideoInputDevices=function(){return ed(this,void 0,void 0,function(){var e,t,n,r,a,o,i,s,l,c,u,d;return td(this,function(h){switch(h.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),t=[];try{for(n=nd(e),r=n.next();!r.done;r=n.next())a=r.value,"videoinput"===(o="video"===a.kind?"videoinput":a.kind)&&(i=a.deviceId||a.id,s=a.label||"Video device "+(t.length+1),l=a.groupId,c={deviceId:i,label:s,kind:o,groupId:l},t.push(c))}catch(p){u={error:p}}finally{try{r&&!r.done&&(d=n.return)&&d.call(n)}finally{if(u)throw u.error}}return[2,t]}})})},e.prototype.getVideoInputDevices=function(){return ed(this,void 0,void 0,function(){return td(this,function(e){switch(e.label){case 0:return[4,this.listVideoInputDevices()];case 1:return[2,e.sent().map(function(e){return new $u(e.deviceId,e.label)})]}})})},e.prototype.findDeviceById=function(e){return ed(this,void 0,void 0,function(){var t;return td(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return(t=n.sent())?[2,t.find(function(t){return t.deviceId===e})]:[2,null]}})})},e.prototype.decodeFromInputVideoDevice=function(e,t){return ed(this,void 0,void 0,function(){return td(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,t)];case 1:return[2,n.sent()]}})})},e.prototype.decodeOnceFromVideoDevice=function(e,t){return ed(this,void 0,void 0,function(){var n;return td(this,function(r){switch(r.label){case 0:return this.reset(),n={video:e?{deviceId:{exact:e}}:{facingMode:"environment"}},[4,this.decodeOnceFromConstraints(n,t)];case 1:return[2,r.sent()]}})})},e.prototype.decodeOnceFromConstraints=function(e,t){return ed(this,void 0,void 0,function(){var n;return td(this,function(r){switch(r.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=r.sent(),[4,this.decodeOnceFromStream(n,t)];case 2:return[2,r.sent()]}})})},e.prototype.decodeOnceFromStream=function(e,t){return ed(this,void 0,void 0,function(){var n;return td(this,function(r){switch(r.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return n=r.sent(),[4,this.decodeOnce(n)];case 2:return[2,r.sent()]}})})},e.prototype.decodeFromInputVideoDeviceContinuously=function(e,t,n){return ed(this,void 0,void 0,function(){return td(this,function(r){switch(r.label){case 0:return[4,this.decodeFromVideoDevice(e,t,n)];case 1:return[2,r.sent()]}})})},e.prototype.decodeFromVideoDevice=function(e,t,n){return ed(this,void 0,void 0,function(){var r;return td(this,function(a){switch(a.label){case 0:return r={video:e?{deviceId:{exact:e}}:{facingMode:"environment"}},[4,this.decodeFromConstraints(r,t,n)];case 1:return[2,a.sent()]}})})},e.prototype.decodeFromConstraints=function(e,t,n){return ed(this,void 0,void 0,function(){var r;return td(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return r=a.sent(),[4,this.decodeFromStream(r,t,n)];case 2:return[2,a.sent()]}})})},e.prototype.decodeFromStream=function(e,t,n){return ed(this,void 0,void 0,function(){var r;return td(this,function(a){switch(a.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return r=a.sent(),[4,this.decodeContinuously(r,n)];case 2:return[2,a.sent()]}})})},e.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},e.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},e.prototype.attachStreamToVideo=function(e,t){return ed(this,void 0,void 0,function(){var n;return td(this,function(r){switch(r.label){case 0:return n=this.prepareVideoElement(t),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return r.sent(),[2,n]}})})},e.prototype.playVideoOnLoadAsync=function(e){var t=this;return new Promise(function(n,r){return t.playVideoOnLoad(e,function(){return n()})})},e.prototype.playVideoOnLoad=function(e,t){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)},e.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},e.prototype.tryPlayVideo=function(e){return ed(this,void 0,void 0,function(){return td(this,function(t){switch(t.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.play()];case 2:return t.sent(),[3,4];case 3:return t.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},e.prototype.getMediaElement=function(e,t){var n=document.getElementById(e);if(!n)throw new uu("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new uu("element with id '"+e+"' must be an "+t+" element");return n},e.prototype.decodeFromImage=function(e,t){if(!e&&!t)throw new uu("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)},e.prototype.decodeFromVideo=function(e,t){if(!e&&!t)throw new uu("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)},e.prototype.decodeFromVideoContinuously=function(e,t,n){if(void 0===e&&void 0===t)throw new uu("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)},e.prototype.decodeFromImageElement=function(e){if(!e)throw new uu("An image element must be provided.");this.reset();var t=this.prepareImageElement(e);return this.imageElement=t,this.isImageLoaded(t)?this.decodeOnce(t,!1,!0):this._decodeOnLoadImage(t)},e.prototype.decodeFromVideoElement=function(e){var t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)},e.prototype.decodeFromVideoElementContinuously=function(e,t){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)},e.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new uu("A video element must be provided.");this.reset();var t=this.prepareVideoElement(e);return this.videoElement=t,t},e.prototype.decodeFromImageUrl=function(e){if(!e)throw new uu("An URL must be provided.");this.reset();var t=this.prepareImageElement();this.imageElement=t;var n=this._decodeOnLoadImage(t);return t.src=e,n},e.prototype.decodeFromVideoUrl=function(e){if(!e)throw new uu("An URL must be provided.");this.reset();var t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n},e.prototype.decodeFromVideoUrlContinuously=function(e,t){if(!e)throw new uu("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),r=this.decodeFromVideoElementContinuously(n,t);return n.src=e,r},e.prototype._decodeOnLoadImage=function(e){var t=this;return new Promise(function(n,r){t.imageLoadedListener=function(){return t.decodeOnce(e,!1,!0).then(n,r)},e.addEventListener("load",t.imageLoadedListener)})},e.prototype._decodeOnLoadVideo=function(e){return ed(this,void 0,void 0,function(){return td(this,function(t){switch(t.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return t.sent(),[4,this.decodeOnce(e)];case 2:return[2,t.sent()]}})})},e.prototype._decodeOnLoadVideoContinuously=function(e,t){return ed(this,void 0,void 0,function(){return td(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,t),[2]}})})},e.prototype.isImageLoaded=function(e){return!!e.complete&&0!==e.naturalWidth},e.prototype.prepareImageElement=function(e){var t;return"undefined"===typeof e&&((t=document.createElement("img")).width=200,t.height=200),"string"===typeof e&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t},e.prototype.prepareVideoElement=function(e){var t;return e||"undefined"===typeof document||((t=document.createElement("video")).width=200,t.height=200),"string"===typeof e&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t},e.prototype.decodeOnce=function(e,t,n){var r=this;void 0===t&&(t=!0),void 0===n&&(n=!0),this._stopAsyncDecode=!1;var a=function(o,i){if(r._stopAsyncDecode)return i(new Uu("Video stream has ended before any code could be detected.")),void(r._stopAsyncDecode=void 0);try{o(r.decode(e))}catch(Z_){if(t&&Z_ instanceof Uu||(Z_ instanceof mu||Z_ instanceof Tu)&&n)return setTimeout(a,r._timeBetweenDecodingAttempts,o,i);i(Z_)}};return new Promise(function(e,t){return a(e,t)})},e.prototype.decodeContinuously=function(e,t){var n=this;this._stopContinuousDecode=!1;var r=function(){if(n._stopContinuousDecode)n._stopContinuousDecode=void 0;else try{var a=n.decode(e);t(a,null),setTimeout(r,n.timeBetweenScansMillis)}catch(Z_){t(null,Z_),(Z_ instanceof mu||Z_ instanceof Tu||Z_ instanceof Uu)&&setTimeout(r,n._timeBetweenDecodingAttempts)}};r()},e.prototype.decode=function(e){var t=this.createBinaryBitmap(e);return this.decodeBitmap(t)},e.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var t=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),t=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),r=new Qu(n,t),a=new Xu(r);return new pu(a)},e.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var t=this.getCaptureCanvas(e),n=void 0;try{n=t.getContext("2d",{willReadFrequently:!0})}catch(Z_){n=t.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},e.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas},e.prototype.drawFrameOnCanvas=function(e,t,n){void 0===t&&(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),void 0===n&&(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},e.prototype.drawImageOnCanvas=function(e,t,n){void 0===t&&(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),void 0===n&&(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},e.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},e.prototype.createCaptureCanvas=function(e){if("undefined"===typeof document)return this._destroyCaptureCanvas(),null;var t,n,r=document.createElement("canvas");return"undefined"!==typeof e&&(e instanceof HTMLVideoElement?(t=e.videoWidth,n=e.videoHeight):e instanceof HTMLImageElement&&(t=e.naturalWidth||e.width,n=e.naturalHeight||e.height)),r.style.width=t+"px",r.style.height=n+"px",r.width=t,r.height=n,r},e.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),!1===this._stopAsyncDecode&&this.stopAsyncDecode(),!1===this._stopContinuousDecode&&this.stopContinuousDecode()},e.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},e.prototype._destroyVideoElement=function(){this.videoElement&&("undefined"!==typeof this.videoEndedListener&&this.videoElement.removeEventListener("ended",this.videoEndedListener),"undefined"!==typeof this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),"undefined"!==typeof this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},e.prototype._destroyImageElement=function(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},e.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},e.prototype.addVideoSource=function(e,t){try{e.srcObject=t}catch(n){e.src=URL.createObjectURL(t)}},e.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch(t){e.src=""}this.videoElement.removeAttribute("src")},e}(),ad=function(){function e(e,t,n,r,a,o){void 0===n&&(n=null==t?0:8*t.length),void 0===o&&(o=yu.currentTimeMillis()),this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=r,this.format=a,this.timestamp=o,this.text=e,this.rawBytes=t,this.numBits=void 0===n||null===n?null===t||void 0===t?0:8*t.length:n,this.resultPoints=r,this.format=a,this.resultMetadata=null,this.timestamp=void 0===o||null===o?yu.currentTimeMillis():o}return e.prototype.getText=function(){return this.text},e.prototype.getRawBytes=function(){return this.rawBytes},e.prototype.getNumBits=function(){return this.numBits},e.prototype.getResultPoints=function(){return this.resultPoints},e.prototype.getBarcodeFormat=function(){return this.format},e.prototype.getResultMetadata=function(){return this.resultMetadata},e.prototype.putMetadata=function(e,t){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)},e.prototype.putAllMetadata=function(e){null!==e&&(null===this.resultMetadata?this.resultMetadata=e:this.resultMetadata=new Map(e))},e.prototype.addResultPoints=function(e){var t=this.resultPoints;if(null===t)this.resultPoints=e;else if(null!==e&&e.length>0){var n=new Array(t.length+e.length);yu.arraycopy(t,0,n,0,t.length),yu.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}},e.prototype.getTimestamp=function(){return this.timestamp},e.prototype.toString=function(){return this.text},e}();const od=ad;var id;!function(e){e[e.AZTEC=0]="AZTEC",e[e.CODABAR=1]="CODABAR",e[e.CODE_39=2]="CODE_39",e[e.CODE_93=3]="CODE_93",e[e.CODE_128=4]="CODE_128",e[e.DATA_MATRIX=5]="DATA_MATRIX",e[e.EAN_8=6]="EAN_8",e[e.EAN_13=7]="EAN_13",e[e.ITF=8]="ITF",e[e.MAXICODE=9]="MAXICODE",e[e.PDF_417=10]="PDF_417",e[e.QR_CODE=11]="QR_CODE",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"}(id||(id={}));const sd=id;var ld;!function(e){e[e.OTHER=0]="OTHER",e[e.ORIENTATION=1]="ORIENTATION",e[e.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",e[e.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",e[e.ISSUE_NUMBER=4]="ISSUE_NUMBER",e[e.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",e[e.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",e[e.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",e[e.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",e[e.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",e[e.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"}(ld||(ld={}));const cd=ld;const ud=function(){function e(e,t,n,r,a,o){void 0===a&&(a=-1),void 0===o&&(o=-1),this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=r,this.structuredAppendSequenceNumber=a,this.structuredAppendParity=o,this.numBits=void 0===e||null===e?0:8*e.length}return e.prototype.getRawBytes=function(){return this.rawBytes},e.prototype.getNumBits=function(){return this.numBits},e.prototype.setNumBits=function(e){this.numBits=e},e.prototype.getText=function(){return this.text},e.prototype.getByteSegments=function(){return this.byteSegments},e.prototype.getECLevel=function(){return this.ecLevel},e.prototype.getErrorsCorrected=function(){return this.errorsCorrected},e.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},e.prototype.getErasures=function(){return this.erasures},e.prototype.setErasures=function(e){this.erasures=e},e.prototype.getOther=function(){return this.other},e.prototype.setOther=function(e){this.other=e},e.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},e.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},e.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},e}();const dd=function(){function e(){}return e.prototype.exp=function(e){return this.expTable[e]},e.prototype.log=function(e){if(0===e)throw new hu;return this.logTable[e]},e.addOrSubtract=function(e,t){return e^t},e}();var hd=function(){function e(e,t){if(0===t.length)throw new hu;this.field=e;var n=t.length;if(n>1&&0===t[0]){for(var r=1;r<n&&0===t[r];)r++;r===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-r),yu.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return e.prototype.getCoefficients=function(){return this.coefficients},e.prototype.getDegree=function(){return this.coefficients.length-1},e.prototype.isZero=function(){return 0===this.coefficients[0]},e.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},e.prototype.evaluateAt=function(e){if(0===e)return this.getCoefficient(0);var t,n=this.coefficients;if(1===e){t=0;for(var r=0,a=n.length;r!==a;r++){var o=n[r];t=dd.addOrSubtract(t,o)}return t}t=n[0];var i=n.length,s=this.field;for(r=1;r<i;r++)t=dd.addOrSubtract(s.multiply(e,t),n[r]);return t},e.prototype.addOrSubtract=function(t){if(!this.field.equals(t.field))throw new hu("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;var n=this.coefficients,r=t.coefficients;if(n.length>r.length){var a=n;n=r,r=a}var o=new Int32Array(r.length),i=r.length-n.length;yu.arraycopy(r,0,o,0,i);for(var s=i;s<r.length;s++)o[s]=dd.addOrSubtract(n[s-i],r[s]);return new e(this.field,o)},e.prototype.multiply=function(t){if(!this.field.equals(t.field))throw new hu("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();for(var n=this.coefficients,r=n.length,a=t.coefficients,o=a.length,i=new Int32Array(r+o-1),s=this.field,l=0;l<r;l++)for(var c=n[l],u=0;u<o;u++)i[l+u]=dd.addOrSubtract(i[l+u],s.multiply(c,a[u]));return new e(s,i)},e.prototype.multiplyScalar=function(t){if(0===t)return this.field.getZero();if(1===t)return this;for(var n=this.coefficients.length,r=this.field,a=new Int32Array(n),o=this.coefficients,i=0;i<n;i++)a[i]=r.multiply(o[i],t);return new e(r,a)},e.prototype.multiplyByMonomial=function(t,n){if(t<0)throw new hu;if(0===n)return this.field.getZero();for(var r=this.coefficients,a=r.length,o=new Int32Array(a+t),i=this.field,s=0;s<a;s++)o[s]=i.multiply(r[s],n);return new e(i,o)},e.prototype.divide=function(e){if(!this.field.equals(e.field))throw new hu("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new hu("Divide by 0");for(var t=this.field,n=t.getZero(),r=this,a=e.getCoefficient(e.getDegree()),o=t.inverse(a);r.getDegree()>=e.getDegree()&&!r.isZero();){var i=r.getDegree()-e.getDegree(),s=t.multiply(r.getCoefficient(r.getDegree()),o),l=e.multiplyByMonomial(i,s),c=t.buildMonomial(i,s);n=n.addOrSubtract(c),r=r.addOrSubtract(l)}return[n,r]},e.prototype.toString=function(){for(var e="",t=this.getDegree();t>=0;t--){var n=this.getCoefficient(t);if(0!==n){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),0===t||1!==n){var r=this.field.log(n);0===r?e+="1":1===r?e+="a":(e+="a^",e+=r)}0!==t&&(1===t?e+="x":(e+="x^",e+=t))}}return e},e}();const pd=hd;var fd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const md=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fd(t,e),t.kind="ArithmeticException",t}(lu);var gd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const xd=function(e){function t(t,n,r){var a=e.call(this)||this;a.primitive=t,a.size=n,a.generatorBase=r;for(var o=new Int32Array(n),i=1,s=0;s<n;s++)o[s]=i,(i*=2)>=n&&(i^=t,i&=n-1);a.expTable=o;var l=new Int32Array(n);for(s=0;s<n-1;s++)l[o[s]]=s;return a.logTable=l,a.zero=new pd(a,Int32Array.from([0])),a.one=new pd(a,Int32Array.from([1])),a}return gd(t,e),t.prototype.getZero=function(){return this.zero},t.prototype.getOne=function(){return this.one},t.prototype.buildMonomial=function(e,t){if(e<0)throw new hu;if(0===t)return this.zero;var n=new Int32Array(e+1);return n[0]=t,new pd(this,n)},t.prototype.inverse=function(e){if(0===e)throw new md;return this.expTable[this.size-this.logTable[e]-1]},t.prototype.multiply=function(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]},t.prototype.getSize=function(){return this.size},t.prototype.getGeneratorBase=function(){return this.generatorBase},t.prototype.toString=function(){return"GF(0x"+_u.toHexString(this.primitive)+","+this.size+")"},t.prototype.equals=function(e){return e===this},t.AZTEC_DATA_12=new t(4201,4096,1),t.AZTEC_DATA_10=new t(1033,1024,1),t.AZTEC_DATA_6=new t(67,64,1),t.AZTEC_PARAM=new t(19,16,1),t.QR_CODE_FIELD_256=new t(285,256,0),t.DATA_MATRIX_FIELD_256=new t(301,256,1),t.AZTEC_DATA_8=t.DATA_MATRIX_FIELD_256,t.MAXICODE_FIELD_64=t.AZTEC_DATA_6,t}(dd);var yd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const vd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yd(t,e),t.kind="ReedSolomonException",t}(lu);var bd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const wd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return bd(t,e),t.kind="IllegalStateException",t}(lu);var kd=function(){function e(e){this.field=e}return e.prototype.decode=function(e,t){for(var n=this.field,r=new pd(n,e),a=new Int32Array(t),o=!0,i=0;i<t;i++){var s=r.evaluateAt(n.exp(i+n.getGeneratorBase()));a[a.length-1-i]=s,0!==s&&(o=!1)}if(!o){var l=new pd(n,a),c=this.runEuclideanAlgorithm(n.buildMonomial(t,1),l,t),u=c[0],d=c[1],h=this.findErrorLocations(u),p=this.findErrorMagnitudes(d,h);for(i=0;i<h.length;i++){var f=e.length-1-n.log(h[i]);if(f<0)throw new vd("Bad error location");e[f]=xd.addOrSubtract(e[f],p[i])}}},e.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.getDegree()<t.getDegree()){var r=e;e=t,t=r}for(var a=this.field,o=e,i=t,s=a.getZero(),l=a.getOne();i.getDegree()>=(n/2|0);){var c=o,u=s;if(s=l,(o=i).isZero())throw new vd("r_{i-1} was zero");i=c;for(var d=a.getZero(),h=o.getCoefficient(o.getDegree()),p=a.inverse(h);i.getDegree()>=o.getDegree()&&!i.isZero();){var f=i.getDegree()-o.getDegree(),m=a.multiply(i.getCoefficient(i.getDegree()),p);d=d.addOrSubtract(a.buildMonomial(f,m)),i=i.addOrSubtract(o.multiplyByMonomial(f,m))}if(l=d.multiply(s).addOrSubtract(u),i.getDegree()>=o.getDegree())throw new wd("Division algorithm failed to reduce polynomial?")}var g=l.getCoefficient(0);if(0===g)throw new vd("sigmaTilde(0) was zero");var x=a.inverse(g);return[l.multiplyScalar(x),i.multiplyScalar(x)]},e.prototype.findErrorLocations=function(e){var t=e.getDegree();if(1===t)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(t),r=0,a=this.field,o=1;o<a.getSize()&&r<t;o++)0===e.evaluateAt(o)&&(n[r]=a.inverse(o),r++);if(r!==t)throw new vd("Error locator degree does not match number of roots");return n},e.prototype.findErrorMagnitudes=function(e,t){for(var n=t.length,r=new Int32Array(n),a=this.field,o=0;o<n;o++){for(var i=a.inverse(t[o]),s=1,l=0;l<n;l++)if(o!==l){var c=a.multiply(t[l],i),u=0===(1&c)?1|c:-2&c;s=a.multiply(s,u)}r[o]=a.multiply(e.evaluateAt(i),a.inverse(s)),0!==a.getGeneratorBase()&&(r[o]=a.multiply(r[o],i))}return r},e}();const jd=kd;var Cd;!function(e){e[e.UPPER=0]="UPPER",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.DIGIT=3]="DIGIT",e[e.PUNCT=4]="PUNCT",e[e.BINARY=5]="BINARY"}(Cd||(Cd={}));const Nd=function(){function e(){}return e.prototype.decode=function(t){this.ddata=t;var n=t.getBits(),r=this.extractBits(n),a=this.correctBits(r),o=e.convertBoolArrayToByteArray(a),i=e.getEncodedData(a),s=new ud(o,i,null,null);return s.setNumBits(a.length),s},e.highLevelDecode=function(e){return this.getEncodedData(e)},e.getEncodedData=function(t){for(var n=t.length,r=Cd.UPPER,a=Cd.UPPER,o="",i=0;i<n;)if(a===Cd.BINARY){if(n-i<5)break;var s=e.readCode(t,i,5);if(i+=5,0===s){if(n-i<11)break;s=e.readCode(t,i,11)+31,i+=11}for(var l=0;l<s;l++){if(n-i<8){i=n;break}var c=e.readCode(t,i,8);o+=Lu.castAsNonUtf8Char(c),i+=8}a=r}else{var u=a===Cd.DIGIT?4:5;if(n-i<u)break;c=e.readCode(t,i,u);i+=u;var d=e.getCharacter(a,c);d.startsWith("CTRL_")?(r=a,a=e.getTable(d.charAt(5)),"L"===d.charAt(6)&&(r=a)):(o+=d,a=r)}return o},e.getTable=function(e){switch(e){case"L":return Cd.LOWER;case"P":return Cd.PUNCT;case"M":return Cd.MIXED;case"D":return Cd.DIGIT;case"B":return Cd.BINARY;default:return Cd.UPPER}},e.getCharacter=function(t,n){switch(t){case Cd.UPPER:return e.UPPER_TABLE[n];case Cd.LOWER:return e.LOWER_TABLE[n];case Cd.MIXED:return e.MIXED_TABLE[n];case Cd.PUNCT:return e.PUNCT_TABLE[n];case Cd.DIGIT:return e.DIGIT_TABLE[n];default:throw new wd("Bad table")}},e.prototype.correctBits=function(t){var n,r;this.ddata.getNbLayers()<=2?(r=6,n=xd.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,n=xd.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,n=xd.AZTEC_DATA_10):(r=12,n=xd.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),o=t.length/r;if(o<a)throw new Tu;for(var i=t.length%r,s=new Int32Array(o),l=0;l<o;l++,i+=r)s[l]=e.readCode(t,i,r);try{new jd(n).decode(s,o-a)}catch(m){throw new Tu(m)}var c=(1<<r)-1,u=0;for(l=0;l<a;l++){if(0===(p=s[l])||p===c)throw new Tu;1!==p&&p!==c-1||u++}var d=new Array(a*r-u),h=0;for(l=0;l<a;l++){var p;if(1===(p=s[l])||p===c-1)d.fill(p>1,h,h+r-1),h+=r-1;else for(var f=r-1;f>=0;--f)d[h++]=0!==(p&1<<f)}return d},e.prototype.extractBits=function(e){var t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),r=(t?11:14)+4*n,a=new Int32Array(r),o=new Array(this.totalBitsInLayer(n,t));if(t)for(var i=0;i<a.length;i++)a[i]=i;else{var s=r+1+2*_u.truncDivision(_u.truncDivision(r,2)-1,15),l=r/2,c=_u.truncDivision(s,2);for(i=0;i<l;i++){var u=i+_u.truncDivision(i,15);a[l-i-1]=c-u-1,a[l+i]=c+u+1}}i=0;for(var d=0;i<n;i++){for(var h=4*(n-i)+(t?9:12),p=2*i,f=r-1-p,m=0;m<h;m++)for(var g=2*m,x=0;x<2;x++)o[d+g+x]=e.get(a[p+x],a[p+m]),o[d+2*h+g+x]=e.get(a[p+m],a[f-x]),o[d+4*h+g+x]=e.get(a[f-x],a[f-m]),o[d+6*h+g+x]=e.get(a[f-m],a[p+x]);d+=8*h}return o},e.readCode=function(e,t,n){for(var r=0,a=t;a<t+n;a++)r<<=1,e[a]&&(r|=1);return r},e.readByte=function(t,n){var r=t.length-n;return r>=8?e.readCode(t,n,8):e.readCode(t,n,r)<<8-r},e.convertBoolArrayToByteArray=function(t){for(var n=new Uint8Array((t.length+7)/8),r=0;r<n.length;r++)n[r]=e.readByte(t,8*r);return n},e.prototype.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},e.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],e.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],e.MIXED_TABLE=["CTRL_PS"," ","\x01","\x02","\x03","\x04","\x05","\x06","\x07","\b","\t","\n","\v","\f","\r","\x1b","\x1c","\x1d","\x1e","\x1f","@","\\","^","_","`","|","~","\x7f","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],e.PUNCT_TABLE=["","\r","\r\n",". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],e.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],e}();const _d=function(){function e(){}return e.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},e.distance=function(e,t,n,r){var a=e-n,o=t-r;return Math.sqrt(a*a+o*o)},e.sum=function(e){for(var t=0,n=0,r=e.length;n!==r;n++){t+=e[n]}return t},e}();const Sd=function(){function e(){}return e.floatToIntBits=function(e){return e},e.MAX_VALUE=Number.MAX_SAFE_INTEGER,e}();const Ed=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.getX=function(){return this.x},e.prototype.getY=function(){return this.y},e.prototype.equals=function(t){if(t instanceof e){var n=t;return this.x===n.x&&this.y===n.y}return!1},e.prototype.hashCode=function(){return 31*Sd.floatToIntBits(this.x)+Sd.floatToIntBits(this.y)},e.prototype.toString=function(){return"("+this.x+","+this.y+")"},e.orderBestPatterns=function(e){var t,n,r,a=this.distance(e[0],e[1]),o=this.distance(e[1],e[2]),i=this.distance(e[0],e[2]);if(o>=a&&o>=i?(n=e[0],t=e[1],r=e[2]):i>=o&&i>=a?(n=e[1],t=e[0],r=e[2]):(n=e[2],t=e[0],r=e[1]),this.crossProductZ(t,n,r)<0){var s=t;t=r,r=s}e[0]=t,e[1]=n,e[2]=r},e.distance=function(e,t){return _d.distance(e.x,e.y,t.x,t.y)},e.crossProductZ=function(e,t,n){var r=t.x,a=t.y;return(n.x-r)*(e.y-a)-(n.y-a)*(e.x-r)},e}();const Ad=function(){function e(e,t){this.bits=e,this.points=t}return e.prototype.getBits=function(){return this.bits},e.prototype.getPoints=function(){return this.points},e}();var Id=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Td=function(e){function t(t,n,r,a,o){var i=e.call(this,t,n)||this;return i.compact=r,i.nbDatablocks=a,i.nbLayers=o,i}return Id(t,e),t.prototype.getNbLayers=function(){return this.nbLayers},t.prototype.getNbDatablocks=function(){return this.nbDatablocks},t.prototype.isCompact=function(){return this.compact},t}(Ad);const Pd=function(){function e(t,n,r,a){this.image=t,this.height=t.getHeight(),this.width=t.getWidth(),void 0!==n&&null!==n||(n=e.INIT_SIZE),void 0!==r&&null!==r||(r=t.getWidth()/2|0),void 0!==a&&null!==a||(a=t.getHeight()/2|0);var o=n/2|0;if(this.leftInit=r-o,this.rightInit=r+o,this.upInit=a-o,this.downInit=a+o,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Uu}return e.prototype.detect=function(){for(var e=this.leftInit,t=this.rightInit,n=this.upInit,r=this.downInit,a=!1,o=!0,i=!1,s=!1,l=!1,c=!1,u=!1,d=this.width,h=this.height;o;){o=!1;for(var p=!0;(p||!s)&&t<d;)(p=this.containsBlackPoint(n,r,t,!1))?(t++,o=!0,s=!0):s||t++;if(t>=d){a=!0;break}for(var f=!0;(f||!l)&&r<h;)(f=this.containsBlackPoint(e,t,r,!0))?(r++,o=!0,l=!0):l||r++;if(r>=h){a=!0;break}for(var m=!0;(m||!c)&&e>=0;)(m=this.containsBlackPoint(n,r,e,!1))?(e--,o=!0,c=!0):c||e--;if(e<0){a=!0;break}for(var g=!0;(g||!u)&&n>=0;)(g=this.containsBlackPoint(e,t,n,!0))?(n--,o=!0,u=!0):u||n--;if(n<0){a=!0;break}o&&(i=!0)}if(!a&&i){for(var x=t-e,y=null,v=1;null===y&&v<x;v++)y=this.getBlackPointOnSegment(e,r-v,e+v,r);if(null==y)throw new Uu;var b=null;for(v=1;null===b&&v<x;v++)b=this.getBlackPointOnSegment(e,n+v,e+v,n);if(null==b)throw new Uu;var w=null;for(v=1;null===w&&v<x;v++)w=this.getBlackPointOnSegment(t,n+v,t-v,n);if(null==w)throw new Uu;var k=null;for(v=1;null===k&&v<x;v++)k=this.getBlackPointOnSegment(t,r-v,t-v,r);if(null==k)throw new Uu;return this.centerEdges(k,y,w,b)}throw new Uu},e.prototype.getBlackPointOnSegment=function(e,t,n,r){for(var a=_d.round(_d.distance(e,t,n,r)),o=(n-e)/a,i=(r-t)/a,s=this.image,l=0;l<a;l++){var c=_d.round(e+l*o),u=_d.round(t+l*i);if(s.get(c,u))return new Ed(c,u)}return null},e.prototype.centerEdges=function(t,n,r,a){var o=t.getX(),i=t.getY(),s=n.getX(),l=n.getY(),c=r.getX(),u=r.getY(),d=a.getX(),h=a.getY(),p=e.CORR;return o<this.width/2?[new Ed(d-p,h+p),new Ed(s+p,l+p),new Ed(c-p,u-p),new Ed(o+p,i-p)]:[new Ed(d+p,h+p),new Ed(s+p,l-p),new Ed(c-p,u+p),new Ed(o-p,i-p)]},e.prototype.containsBlackPoint=function(e,t,n,r){var a=this.image;if(r){for(var o=e;o<=t;o++)if(a.get(o,n))return!0}else for(var i=e;i<=t;i++)if(a.get(n,i))return!0;return!1},e.INIT_SIZE=10,e.CORR=1,e}();const Dd=function(){function e(){}return e.checkAndNudgePoints=function(e,t){for(var n=e.getWidth(),r=e.getHeight(),a=!0,o=0;o<t.length&&a;o+=2){var i=Math.floor(t[o]),s=Math.floor(t[o+1]);if(i<-1||i>n||s<-1||s>r)throw new Uu;a=!1,-1===i?(t[o]=0,a=!0):i===n&&(t[o]=n-1,a=!0),-1===s?(t[o+1]=0,a=!0):s===r&&(t[o+1]=r-1,a=!0)}a=!0;for(o=t.length-2;o>=0&&a;o-=2){i=Math.floor(t[o]),s=Math.floor(t[o+1]);if(i<-1||i>n||s<-1||s>r)throw new Uu;a=!1,-1===i?(t[o]=0,a=!0):i===n&&(t[o]=n-1,a=!0),-1===s?(t[o+1]=0,a=!0):s===r&&(t[o+1]=r-1,a=!0)}},e}();const Md=function(){function e(e,t,n,r,a,o,i,s,l){this.a11=e,this.a21=t,this.a31=n,this.a12=r,this.a22=a,this.a32=o,this.a13=i,this.a23=s,this.a33=l}return e.quadrilateralToQuadrilateral=function(t,n,r,a,o,i,s,l,c,u,d,h,p,f,m,g){var x=e.quadrilateralToSquare(t,n,r,a,o,i,s,l);return e.squareToQuadrilateral(c,u,d,h,p,f,m,g).times(x)},e.prototype.transformPoints=function(e){for(var t=e.length,n=this.a11,r=this.a12,a=this.a13,o=this.a21,i=this.a22,s=this.a23,l=this.a31,c=this.a32,u=this.a33,d=0;d<t;d+=2){var h=e[d],p=e[d+1],f=a*h+s*p+u;e[d]=(n*h+o*p+l)/f,e[d+1]=(r*h+i*p+c)/f}},e.prototype.transformPointsWithValues=function(e,t){for(var n=this.a11,r=this.a12,a=this.a13,o=this.a21,i=this.a22,s=this.a23,l=this.a31,c=this.a32,u=this.a33,d=e.length,h=0;h<d;h++){var p=e[h],f=t[h],m=a*p+s*f+u;e[h]=(n*p+o*f+l)/m,t[h]=(r*p+i*f+c)/m}},e.squareToQuadrilateral=function(t,n,r,a,o,i,s,l){var c=t-r+o-s,u=n-a+i-l;if(0===c&&0===u)return new e(r-t,o-r,t,a-n,i-a,n,0,0,1);var d=r-o,h=s-o,p=a-i,f=l-i,m=d*f-h*p,g=(c*f-h*u)/m,x=(d*u-c*p)/m;return new e(r-t+g*r,s-t+x*s,t,a-n+g*a,l-n+x*l,n,g,x,1)},e.quadrilateralToSquare=function(t,n,r,a,o,i,s,l){return e.squareToQuadrilateral(t,n,r,a,o,i,s,l).buildAdjoint()},e.prototype.buildAdjoint=function(){return new e(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},e.prototype.times=function(t){return new e(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)},e}();var Rd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Fd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Rd(t,e),t.prototype.sampleGrid=function(e,t,n,r,a,o,i,s,l,c,u,d,h,p,f,m,g,x,y){var v=Md.quadrilateralToQuadrilateral(r,a,o,i,s,l,c,u,d,h,p,f,m,g,x,y);return this.sampleGridWithTransform(e,t,n,v)},t.prototype.sampleGridWithTransform=function(e,t,n,r){if(t<=0||n<=0)throw new Uu;for(var a=new Wu(t,n),o=new Float32Array(2*t),i=0;i<n;i++){for(var s=o.length,l=i+.5,c=0;c<s;c+=2)o[c]=c/2+.5,o[c+1]=l;r.transformPoints(o),Dd.checkAndNudgePoints(e,o);try{for(c=0;c<s;c+=2)e.get(Math.floor(o[c]),Math.floor(o[c+1]))&&a.set(c/2,i)}catch(u){throw new Uu}}return a},t}(Dd);const Od=function(){function e(){}return e.setGridSampler=function(t){e.gridSampler=t},e.getInstance=function(){return e.gridSampler},e.gridSampler=new Fd,e}();var Bd=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.toResultPoint=function(){return new Ed(this.getX(),this.getY())},e.prototype.getX=function(){return this.x},e.prototype.getY=function(){return this.y},e}(),Ld=function(){function e(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return e.prototype.detect=function(){return this.detectMirror(!1)},e.prototype.detectMirror=function(e){var t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){var r=n[0];n[0]=n[2],n[2]=r}this.extractParameters(n);var a=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new Td(a,o,this.compact,this.nbDataBlocks,this.nbLayers)},e.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new Uu;var t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);for(var r=0,a=0;a<4;a++){var o=n[(this.shift+a)%4];this.compact?(r<<=7,r+=o>>1&127):(r<<=10,r+=(o>>2&992)+(o>>1&31))}var i=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=1+(i>>6),this.nbDataBlocks=1+(63&i)):(this.nbLayers=1+(i>>11),this.nbDataBlocks=1+(2047&i))},e.prototype.getRotation=function(e,t){var n=0;e.forEach(function(e,r,a){n=(n<<3)+((e>>t-2<<1)+(1&e))}),n=((1&n)<<11)+(n>>1);for(var r=0;r<4;r++)if(_u.bitCount(n^this.EXPECTED_CORNER_BITS[r])<=2)return r;throw new Uu},e.prototype.getCorrectedParameterData=function(e,t){var n,r;t?(n=7,r=2):(n=10,r=4);for(var a=n-r,o=new Int32Array(n),i=n-1;i>=0;--i)o[i]=15&e,e>>=4;try{new jd(xd.AZTEC_PARAM).decode(o,a)}catch(l){throw new Uu}var s=0;for(i=0;i<r;i++)s=(s<<4)+o[i];return s},e.prototype.getBullsEyeCorners=function(e){var t=e,n=e,r=e,a=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var i=this.getFirstDifferent(t,o,1,-1),s=this.getFirstDifferent(n,o,1,1),l=this.getFirstDifferent(r,o,-1,1),c=this.getFirstDifferent(a,o,-1,-1);if(this.nbCenterLayers>2){var u=this.distancePoint(c,i)*this.nbCenterLayers/(this.distancePoint(a,t)*(this.nbCenterLayers+2));if(u<.75||u>1.25||!this.isWhiteOrBlackRectangle(i,s,l,c))break}t=i,n=s,r=l,a=c,o=!o}if(5!==this.nbCenterLayers&&7!==this.nbCenterLayers)throw new Uu;this.compact=5===this.nbCenterLayers;var d=new Ed(t.getX()+.5,t.getY()-.5),h=new Ed(n.getX()+.5,n.getY()+.5),p=new Ed(r.getX()-.5,r.getY()+.5),f=new Ed(a.getX()-.5,a.getY()-.5);return this.expandSquare([d,h,p,f],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},e.prototype.getMatrixCenter=function(){var e,t,n,r;try{e=(l=new Pd(this.image).detect())[0],t=l[1],n=l[2],r=l[3]}catch(Z_){var a=this.image.getWidth()/2,o=this.image.getHeight()/2;e=this.getFirstDifferent(new Bd(a+7,o-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Bd(a+7,o+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Bd(a-7,o+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new Bd(a-7,o-7),!1,-1,-1).toResultPoint()}var i=_d.round((e.getX()+r.getX()+t.getX()+n.getX())/4),s=_d.round((e.getY()+r.getY()+t.getY()+n.getY())/4);try{var l;e=(l=new Pd(this.image,15,i,s).detect())[0],t=l[1],n=l[2],r=l[3]}catch(Z_){e=this.getFirstDifferent(new Bd(i+7,s-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Bd(i+7,s+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Bd(i-7,s+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new Bd(i-7,s-7),!1,-1,-1).toResultPoint()}return i=_d.round((e.getX()+r.getX()+t.getX()+n.getX())/4),s=_d.round((e.getY()+r.getY()+t.getY()+n.getY())/4),new Bd(i,s)},e.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},e.prototype.sampleGrid=function(e,t,n,r,a){var o=Od.getInstance(),i=this.getDimension(),s=i/2-this.nbCenterLayers,l=i/2+this.nbCenterLayers;return o.sampleGrid(e,i,i,s,s,l,s,l,l,s,l,t.getX(),t.getY(),n.getX(),n.getY(),r.getX(),r.getY(),a.getX(),a.getY())},e.prototype.sampleLine=function(e,t,n){for(var r=0,a=this.distanceResultPoint(e,t),o=a/n,i=e.getX(),s=e.getY(),l=o*(t.getX()-e.getX())/a,c=o*(t.getY()-e.getY())/a,u=0;u<n;u++)this.image.get(_d.round(i+u*l),_d.round(s+u*c))&&(r|=1<<n-u-1);return r},e.prototype.isWhiteOrBlackRectangle=function(e,t,n,r){e=new Bd(e.getX()-3,e.getY()+3),t=new Bd(t.getX()-3,t.getY()-3),n=new Bd(n.getX()+3,n.getY()-3),r=new Bd(r.getX()+3,r.getY()+3);var a=this.getColor(r,e);if(0===a)return!1;var o=this.getColor(e,t);return o===a&&((o=this.getColor(t,n))===a&&(o=this.getColor(n,r))===a)},e.prototype.getColor=function(e,t){for(var n=this.distancePoint(e,t),r=(t.getX()-e.getX())/n,a=(t.getY()-e.getY())/n,o=0,i=e.getX(),s=e.getY(),l=this.image.get(e.getX(),e.getY()),c=Math.ceil(n),u=0;u<c;u++)i+=r,s+=a,this.image.get(_d.round(i),_d.round(s))!==l&&o++;var d=o/n;return d>.1&&d<.9?0:d<=.1===l?1:-1},e.prototype.getFirstDifferent=function(e,t,n,r){for(var a=e.getX()+n,o=e.getY()+r;this.isValid(a,o)&&this.image.get(a,o)===t;)a+=n,o+=r;for(a-=n,o-=r;this.isValid(a,o)&&this.image.get(a,o)===t;)a+=n;for(a-=n;this.isValid(a,o)&&this.image.get(a,o)===t;)o+=r;return new Bd(a,o-=r)},e.prototype.expandSquare=function(e,t,n){var r=n/(2*t),a=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),i=(e[0].getX()+e[2].getX())/2,s=(e[0].getY()+e[2].getY())/2,l=new Ed(i+r*a,s+r*o),c=new Ed(i-r*a,s-r*o);return a=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),i=(e[1].getX()+e[3].getX())/2,s=(e[1].getY()+e[3].getY())/2,[l,new Ed(i+r*a,s+r*o),c,new Ed(i-r*a,s-r*o)]},e.prototype.isValid=function(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()},e.prototype.isValidPoint=function(e){var t=_d.round(e.getX()),n=_d.round(e.getY());return this.isValid(t,n)},e.prototype.distancePoint=function(e,t){return _d.distance(e.getX(),e.getY(),t.getX(),t.getY())},e.prototype.distanceResultPoint=function(e,t){return _d.distance(e.getX(),e.getY(),t.getX(),t.getY())},e.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(_u.truncDivision(this.nbLayers-4,8)+1)+15},e}();const zd=Ld;const Wd=function(){function e(){}return e.prototype.decode=function(e,t){void 0===t&&(t=null);var n=null,r=new zd(e.getBlackMatrix()),a=null,o=null;try{a=(i=r.detectMirror(!1)).getPoints(),this.reportFoundResultPoints(t,a),o=(new Nd).decode(i)}catch(Z_){n=Z_}if(null==o)try{var i;a=(i=r.detectMirror(!0)).getPoints(),this.reportFoundResultPoints(t,a),o=(new Nd).decode(i)}catch(Z_){if(null!=n)throw n;throw Z_}var s=new od(o.getText(),o.getRawBytes(),o.getNumBits(),a,sd.AZTEC,yu.currentTimeMillis()),l=o.getByteSegments();null!=l&&s.putMetadata(cd.BYTE_SEGMENTS,l);var c=o.getECLevel();return null!=c&&s.putMetadata(cd.ERROR_CORRECTION_LEVEL,c),s},e.prototype.reportFoundResultPoints=function(e,t){if(null!=e){var n=e.get(Au.NEED_RESULT_POINT_CALLBACK);null!=n&&t.forEach(function(e,t,r){n.foundPossibleResultPoint(e)})}},e.prototype.reset=function(){},e}();var Vd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){function t(t){return void 0===t&&(t=500),e.call(this,new Wd,t)||this}Vd(t,e)}(rd);const Ud=function(){function e(){}return e.prototype.decode=function(e,t){try{return this.doDecode(e,t)}catch(c){if(t&&!0===t.get(Au.TRY_HARDER)&&e.isRotateSupported()){var n=e.rotateCounterClockwise(),r=this.doDecode(n,t),a=r.getResultMetadata(),o=270;null!==a&&!0===a.get(cd.ORIENTATION)&&(o+=a.get(cd.ORIENTATION)%360),r.putMetadata(cd.ORIENTATION,o);var i=r.getResultPoints();if(null!==i)for(var s=n.getHeight(),l=0;l<i.length;l++)i[l]=new Ed(s-i[l].getY()-1,i[l].getX());return r}throw new Uu}},e.prototype.reset=function(){},e.prototype.doDecode=function(e,t){var n,r=e.getWidth(),a=e.getHeight(),o=new Su(r),i=t&&!0===t.get(Au.TRY_HARDER),s=Math.max(1,a>>(i?8:5));n=i?a:15;for(var l=Math.trunc(a/2),c=0;c<n;c++){var u=Math.trunc((c+1)/2),d=l+s*(0===(1&c)?u:-u);if(d<0||d>=a)break;try{o=e.getBlackRow(d,o)}catch(g){continue}for(var h=function(e){if(1===e&&(o.reverse(),t&&!0===t.get(Au.NEED_RESULT_POINT_CALLBACK))){var n=new Map;t.forEach(function(e,t){return n.set(t,e)}),n.delete(Au.NEED_RESULT_POINT_CALLBACK),t=n}try{var a=p.decodeRow(d,o,t);if(1===e){a.putMetadata(cd.ORIENTATION,180);var i=a.getResultPoints();null!==i&&(i[0]=new Ed(r-i[0].getX()-1,i[0].getY()),i[1]=new Ed(r-i[1].getX()-1,i[1].getY()))}return{value:a}}catch(s){}},p=this,f=0;f<2;f++){var m=h(f);if("object"===typeof m)return m.value}}throw new Uu},e.recordPattern=function(e,t,n){for(var r=n.length,a=0;a<r;a++)n[a]=0;var o=e.getSize();if(t>=o)throw new Uu;for(var i=!e.get(t),s=0,l=t;l<o;){if(e.get(l)!==i)n[s]++;else{if(++s===r)break;n[s]=1,i=!i}l++}if(s!==r&&(s!==r-1||l!==o))throw new Uu},e.recordPatternInReverse=function(t,n,r){for(var a=r.length,o=t.get(n);n>0&&a>=0;)t.get(--n)!==o&&(a--,o=!o);if(a>=0)throw new Uu;e.recordPattern(t,n+1,r)},e.patternMatchVariance=function(e,t,n){for(var r=e.length,a=0,o=0,i=0;i<r;i++)a+=e[i],o+=t[i];if(a<o)return Number.POSITIVE_INFINITY;var s=a/o;n*=s;for(var l=0,c=0;c<r;c++){var u=e[c],d=t[c]*s,h=u>d?u-d:d-u;if(h>n)return Number.POSITIVE_INFINITY;l+=h}return l/a},e}();var Hd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Gd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Hd(t,e),t.findStartPattern=function(e){for(var n=e.getSize(),r=e.getNextSet(0),a=0,o=Int32Array.from([0,0,0,0,0,0]),i=r,s=!1,l=r;l<n;l++)if(e.get(l)!==s)o[a]++;else{if(5===a){for(var c=t.MAX_AVG_VARIANCE,u=-1,d=t.CODE_START_A;d<=t.CODE_START_C;d++){var h=Ud.patternMatchVariance(o,t.CODE_PATTERNS[d],t.MAX_INDIVIDUAL_VARIANCE);h<c&&(c=h,u=d)}if(u>=0&&e.isRange(Math.max(0,i-(l-i)/2),i,!1))return Int32Array.from([i,l,u]);i+=o[0]+o[1],(o=o.slice(2,o.length))[a-1]=0,o[a]=0,a--}else a++;o[a]=1,s=!s}throw new Uu},t.decodeCode=function(e,n,r){Ud.recordPattern(e,r,n);for(var a=t.MAX_AVG_VARIANCE,o=-1,i=0;i<t.CODE_PATTERNS.length;i++){var s=t.CODE_PATTERNS[i],l=this.patternMatchVariance(n,s,t.MAX_INDIVIDUAL_VARIANCE);l<a&&(a=l,o=i)}if(o>=0)return o;throw new Uu},t.prototype.decodeRow=function(e,n,r){var a,o=r&&!0===r.get(Au.ASSUME_GS1),i=t.findStartPattern(n),s=i[2],l=0,c=new Uint8Array(20);switch(c[l++]=s,s){case t.CODE_START_A:a=t.CODE_CODE_A;break;case t.CODE_START_B:a=t.CODE_CODE_B;break;case t.CODE_START_C:a=t.CODE_CODE_C;break;default:throw new Tu}for(var u=!1,d=!1,h="",p=i[0],f=i[1],m=Int32Array.from([0,0,0,0,0,0]),g=0,x=0,y=s,v=0,b=!0,w=!1,k=!1;!u;){var j=d;switch(d=!1,g=x,x=t.decodeCode(n,m,f),c[l++]=x,x!==t.CODE_STOP&&(b=!0),x!==t.CODE_STOP&&(y+=++v*x),p=f,f+=m.reduce(function(e,t){return e+t},0),x){case t.CODE_START_A:case t.CODE_START_B:case t.CODE_START_C:throw new Tu}switch(a){case t.CODE_CODE_A:if(x<64)h+=k===w?String.fromCharCode(" ".charCodeAt(0)+x):String.fromCharCode(" ".charCodeAt(0)+x+128),k=!1;else if(x<96)h+=k===w?String.fromCharCode(x-64):String.fromCharCode(x+64),k=!1;else switch(x!==t.CODE_STOP&&(b=!1),x){case t.CODE_FNC_1:o&&(0===h.length?h+="]C1":h+=String.fromCharCode(29));break;case t.CODE_FNC_2:case t.CODE_FNC_3:break;case t.CODE_FNC_4_A:!w&&k?(w=!0,k=!1):w&&k?(w=!1,k=!1):k=!0;break;case t.CODE_SHIFT:d=!0,a=t.CODE_CODE_B;break;case t.CODE_CODE_B:a=t.CODE_CODE_B;break;case t.CODE_CODE_C:a=t.CODE_CODE_C;break;case t.CODE_STOP:u=!0}break;case t.CODE_CODE_B:if(x<96)h+=k===w?String.fromCharCode(" ".charCodeAt(0)+x):String.fromCharCode(" ".charCodeAt(0)+x+128),k=!1;else switch(x!==t.CODE_STOP&&(b=!1),x){case t.CODE_FNC_1:o&&(0===h.length?h+="]C1":h+=String.fromCharCode(29));break;case t.CODE_FNC_2:case t.CODE_FNC_3:break;case t.CODE_FNC_4_B:!w&&k?(w=!0,k=!1):w&&k?(w=!1,k=!1):k=!0;break;case t.CODE_SHIFT:d=!0,a=t.CODE_CODE_A;break;case t.CODE_CODE_A:a=t.CODE_CODE_A;break;case t.CODE_CODE_C:a=t.CODE_CODE_C;break;case t.CODE_STOP:u=!0}break;case t.CODE_CODE_C:if(x<100)x<10&&(h+="0"),h+=x;else switch(x!==t.CODE_STOP&&(b=!1),x){case t.CODE_FNC_1:o&&(0===h.length?h+="]C1":h+=String.fromCharCode(29));break;case t.CODE_CODE_A:a=t.CODE_CODE_A;break;case t.CODE_CODE_B:a=t.CODE_CODE_B;break;case t.CODE_STOP:u=!0}}j&&(a=a===t.CODE_CODE_A?t.CODE_CODE_B:t.CODE_CODE_A)}var C=f-p;if(f=n.getNextUnset(f),!n.isRange(f,Math.min(n.getSize(),f+(f-p)/2),!1))throw new Uu;if((y-=v*g)%103!==g)throw new mu;var N=h.length;if(0===N)throw new Uu;N>0&&b&&(h=a===t.CODE_CODE_C?h.substring(0,N-2):h.substring(0,N-1));for(var _=(i[1]+i[0])/2,S=p+C/2,E=c.length,A=new Uint8Array(E),I=0;I<E;I++)A[I]=c[I];var T=[new Ed(_,e),new Ed(S,e)];return new od(h,A,0,T,sd.CODE_128,(new Date).getTime())},t.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],t.MAX_AVG_VARIANCE=.25,t.MAX_INDIVIDUAL_VARIANCE=.7,t.CODE_SHIFT=98,t.CODE_CODE_C=99,t.CODE_CODE_B=100,t.CODE_CODE_A=101,t.CODE_FNC_1=102,t.CODE_FNC_2=97,t.CODE_FNC_3=96,t.CODE_FNC_4_A=101,t.CODE_FNC_4_B=100,t.CODE_START_A=103,t.CODE_START_B=104,t.CODE_START_C=105,t.CODE_STOP=106,t}(Ud);var Kd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xd=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Yd=function(e){function t(t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.call(this)||this;return r.usingCheckDigit=t,r.extendedMode=n,r.decodeRowResult="",r.counters=new Int32Array(9),r}return Kd(t,e),t.prototype.decodeRow=function(e,n,r){var a,o,i,s,l=this.counters;l.fill(0),this.decodeRowResult="";var c,u,d=t.findAsteriskPattern(n,l),h=n.getNextSet(d[1]),p=n.getSize();do{t.recordPattern(n,h,l);var f=t.toNarrowWidePattern(l);if(f<0)throw new Uu;c=t.patternToChar(f),this.decodeRowResult+=c,u=h;try{for(var m=(a=void 0,Xd(l)),g=m.next();!g.done;g=m.next()){h+=g.value}}catch(_){a={error:_}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(a)throw a.error}}h=n.getNextSet(h)}while("*"!==c);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var x,y=0;try{for(var v=Xd(l),b=v.next();!b.done;b=v.next()){y+=b.value}}catch(S){i={error:S}}finally{try{b&&!b.done&&(s=v.return)&&s.call(v)}finally{if(i)throw i.error}}if(h!==p&&2*(h-u-y)<y)throw new Uu;if(this.usingCheckDigit){for(var w=this.decodeRowResult.length-1,k=0,j=0;j<w;j++)k+=t.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(j));if(this.decodeRowResult.charAt(w)!==t.ALPHABET_STRING.charAt(k%43))throw new mu;this.decodeRowResult=this.decodeRowResult.substring(0,w)}if(0===this.decodeRowResult.length)throw new Uu;x=this.extendedMode?t.decodeExtended(this.decodeRowResult):this.decodeRowResult;var C=(d[1]+d[0])/2,N=u+y/2;return new od(x,null,0,[new Ed(C,e),new Ed(N,e)],sd.CODE_39,(new Date).getTime())},t.findAsteriskPattern=function(e,n){for(var r=e.getSize(),a=e.getNextSet(0),o=0,i=a,s=!1,l=n.length,c=a;c<r;c++)if(e.get(c)!==s)n[o]++;else{if(o===l-1){if(this.toNarrowWidePattern(n)===t.ASTERISK_ENCODING&&e.isRange(Math.max(0,i-Math.floor((c-i)/2)),i,!1))return[i,c];i+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,s=!s}throw new Uu},t.toNarrowWidePattern=function(e){var t,n,r,a=e.length,o=0;do{var i=2147483647;try{for(var s=(t=void 0,Xd(e)),l=s.next();!l.done;l=s.next()){(h=l.value)<i&&h>o&&(i=h)}}catch(p){t={error:p}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}o=i,r=0;for(var c=0,u=0,d=0;d<a;d++){(h=e[d])>o&&(u|=1<<a-1-d,r++,c+=h)}if(3===r){for(d=0;d<a&&r>0;d++){var h;if((h=e[d])>o&&(r--,2*h>=c))return-1}return u}}while(r>3);return-1},t.patternToChar=function(e){for(var n=0;n<t.CHARACTER_ENCODINGS.length;n++)if(t.CHARACTER_ENCODINGS[n]===e)return t.ALPHABET_STRING.charAt(n);if(e===t.ASTERISK_ENCODING)return"*";throw new Uu},t.decodeExtended=function(e){for(var t=e.length,n="",r=0;r<t;r++){var a=e.charAt(r);if("+"===a||"$"===a||"%"===a||"/"===a){var o=e.charAt(r+1),i="\0";switch(a){case"+":if(!(o>="A"&&o<="Z"))throw new Tu;i=String.fromCharCode(o.charCodeAt(0)+32);break;case"$":if(!(o>="A"&&o<="Z"))throw new Tu;i=String.fromCharCode(o.charCodeAt(0)-64);break;case"%":if(o>="A"&&o<="E")i=String.fromCharCode(o.charCodeAt(0)-38);else if(o>="F"&&o<="J")i=String.fromCharCode(o.charCodeAt(0)-11);else if(o>="K"&&o<="O")i=String.fromCharCode(o.charCodeAt(0)+16);else if(o>="P"&&o<="T")i=String.fromCharCode(o.charCodeAt(0)+43);else if("U"===o)i="\0";else if("V"===o)i="@";else if("W"===o)i="`";else{if("X"!==o&&"Y"!==o&&"Z"!==o)throw new Tu;i="\x7f"}break;case"/":if(o>="A"&&o<="O")i=String.fromCharCode(o.charCodeAt(0)-32);else{if("Z"!==o)throw new Tu;i=":"}}n+=i,r++}else n+=a}return n},t.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",t.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],t.ASTERISK_ENCODING=148,t}(Ud);const qd=Yd;var Zd=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jd=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Qd=function(e){function t(){var t=e.call(this)||this;return t.decodeRowResult="",t.counters=new Int32Array(6),t}return Zd(t,e),t.prototype.decodeRow=function(e,n,r){var a,o,i,s,l,c,u=this.findAsteriskPattern(n),d=n.getNextSet(u[1]),h=n.getSize(),p=this.counters;p.fill(0),this.decodeRowResult="";do{t.recordPattern(n,d,p);var f=this.toPattern(p);if(f<0)throw new Uu;l=this.patternToChar(f),this.decodeRowResult+=l,c=d;try{for(var m=(a=void 0,Jd(p)),g=m.next();!g.done;g=m.next()){d+=g.value}}catch(j){a={error:j}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(a)throw a.error}}d=n.getNextSet(d)}while("*"!==l);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var x=0;try{for(var y=Jd(p),v=y.next();!v.done;v=y.next()){x+=v.value}}catch(C){i={error:C}}finally{try{v&&!v.done&&(s=y.return)&&s.call(y)}finally{if(i)throw i.error}}if(d===h||!n.get(d))throw new Uu;if(this.decodeRowResult.length<2)throw new Uu;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var b=this.decodeExtended(this.decodeRowResult),w=(u[1]+u[0])/2,k=c+x/2;return new od(b,null,0,[new Ed(w,e),new Ed(k,e)],sd.CODE_93,(new Date).getTime())},t.prototype.findAsteriskPattern=function(e){var n=e.getSize(),r=e.getNextSet(0);this.counters.fill(0);for(var a=this.counters,o=r,i=!1,s=a.length,l=0,c=r;c<n;c++)if(e.get(c)!==i)a[l]++;else{if(l===s-1){if(this.toPattern(a)===t.ASTERISK_ENCODING)return new Int32Array([o,c]);o+=a[0]+a[1],a.copyWithin(0,2,2+l-1),a[l-1]=0,a[l]=0,l--}else l++;a[l]=1,i=!i}throw new Uu},t.prototype.toPattern=function(e){var t,n,r=0;try{for(var a=Jd(e),o=a.next();!o.done;o=a.next()){r+=o.value}}catch(d){t={error:d}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}for(var i=0,s=e.length,l=0;l<s;l++){var c=Math.round(9*e[l]/r);if(c<1||c>4)return-1;if(0===(1&l))for(var u=0;u<c;u++)i=i<<1|1;else i<<=c}return i},t.prototype.patternToChar=function(e){for(var n=0;n<t.CHARACTER_ENCODINGS.length;n++)if(t.CHARACTER_ENCODINGS[n]===e)return t.ALPHABET_STRING.charAt(n);throw new Uu},t.prototype.decodeExtended=function(e){for(var t=e.length,n="",r=0;r<t;r++){var a=e.charAt(r);if(a>="a"&&a<="d"){if(r>=t-1)throw new Tu;var o=e.charAt(r+1),i="\0";switch(a){case"d":if(!(o>="A"&&o<="Z"))throw new Tu;i=String.fromCharCode(o.charCodeAt(0)+32);break;case"a":if(!(o>="A"&&o<="Z"))throw new Tu;i=String.fromCharCode(o.charCodeAt(0)-64);break;case"b":if(o>="A"&&o<="E")i=String.fromCharCode(o.charCodeAt(0)-38);else if(o>="F"&&o<="J")i=String.fromCharCode(o.charCodeAt(0)-11);else if(o>="K"&&o<="O")i=String.fromCharCode(o.charCodeAt(0)+16);else if(o>="P"&&o<="T")i=String.fromCharCode(o.charCodeAt(0)+43);else if("U"===o)i="\0";else if("V"===o)i="@";else if("W"===o)i="`";else{if(!(o>="X"&&o<="Z"))throw new Tu;i=String.fromCharCode(127)}break;case"c":if(o>="A"&&o<="O")i=String.fromCharCode(o.charCodeAt(0)-32);else{if("Z"!==o)throw new Tu;i=":"}}n+=i,r++}else n+=a}return n},t.prototype.checkChecksums=function(e){var t=e.length;this.checkOneChecksum(e,t-2,20),this.checkOneChecksum(e,t-1,15)},t.prototype.checkOneChecksum=function(e,n,r){for(var a=1,o=0,i=n-1;i>=0;i--)o+=a*t.ALPHABET_STRING.indexOf(e.charAt(i)),++a>r&&(a=1);if(e.charAt(n)!==t.ALPHABET_STRING[o%47])throw new mu},t.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",t.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],t.ASTERISK_ENCODING=t.CHARACTER_ENCODINGS[47],t}(Ud);const $d=Qd;var eh=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),th=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},nh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.narrowLineWidth=-1,t}return eh(t,e),t.prototype.decodeRow=function(e,n,r){var a,o,i=this.decodeStart(n),s=this.decodeEnd(n),l=new zu;t.decodeMiddle(n,i[1],s[0],l);var c=l.toString(),u=null;null!=r&&(u=r.get(Au.ALLOWED_LENGTHS)),null==u&&(u=t.DEFAULT_ALLOWED_LENGTHS);var d=c.length,h=!1,p=0;try{for(var f=th(u),m=f.next();!m.done;m=f.next()){var g=m.value;if(d===g){h=!0;break}g>p&&(p=g)}}catch(y){a={error:y}}finally{try{m&&!m.done&&(o=f.return)&&o.call(f)}finally{if(a)throw a.error}}if(!h&&d>p&&(h=!0),!h)throw new Tu;var x=[new Ed(i[1],e),new Ed(s[0],e)];return new od(c,null,0,x,sd.ITF,(new Date).getTime())},t.decodeMiddle=function(e,n,r,a){var o=new Int32Array(10),i=new Int32Array(5),s=new Int32Array(5);for(o.fill(0),i.fill(0),s.fill(0);n<r;){Ud.recordPattern(e,n,o);for(var l=0;l<5;l++){var c=2*l;i[l]=o[c],s[l]=o[c+1]}var u=t.decodeDigit(i);a.append(u.toString()),u=this.decodeDigit(s),a.append(u.toString()),o.forEach(function(e){n+=e})}},t.prototype.decodeStart=function(e){var n=t.skipWhiteSpace(e),r=t.findGuardPattern(e,n,t.START_PATTERN);return this.narrowLineWidth=(r[1]-r[0])/4,this.validateQuietZone(e,r[0]),r},t.prototype.validateQuietZone=function(e,t){var n=10*this.narrowLineWidth;n=n<t?n:t;for(var r=t-1;n>0&&r>=0&&!e.get(r);r--)n--;if(0!==n)throw new Uu},t.skipWhiteSpace=function(e){var t=e.getSize(),n=e.getNextSet(0);if(n===t)throw new Uu;return n},t.prototype.decodeEnd=function(e){e.reverse();try{var n=t.skipWhiteSpace(e),r=void 0;try{r=t.findGuardPattern(e,n,t.END_PATTERN_REVERSED[0])}catch(o){o instanceof Uu&&(r=t.findGuardPattern(e,n,t.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,r[0]);var a=r[0];return r[0]=e.getSize()-r[1],r[1]=e.getSize()-a,r}finally{e.reverse()}},t.findGuardPattern=function(e,n,r){var a=r.length,o=new Int32Array(a),i=e.getSize(),s=!1,l=0,c=n;o.fill(0);for(var u=n;u<i;u++)if(e.get(u)!==s)o[l]++;else{if(l===a-1){if(Ud.patternMatchVariance(o,r,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return[c,u];c+=o[0]+o[1],yu.arraycopy(o,2,o,0,l-1),o[l-1]=0,o[l]=0,l--}else l++;o[l]=1,s=!s}throw new Uu},t.decodeDigit=function(e){for(var n=t.MAX_AVG_VARIANCE,r=-1,a=t.PATTERNS.length,o=0;o<a;o++){var i=t.PATTERNS[o],s=Ud.patternMatchVariance(e,i,t.MAX_INDIVIDUAL_VARIANCE);s<n?(n=s,r=o):s===n&&(r=-1)}if(r>=0)return r%10;throw new Uu},t.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],t.MAX_AVG_VARIANCE=.38,t.MAX_INDIVIDUAL_VARIANCE=.5,t.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],t.START_PATTERN=Int32Array.from([1,1,1,1]),t.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],t}(Ud);const rh=nh;var ah=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const oh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.decodeRowStringBuffer="",t}return ah(t,e),t.findStartGuardPattern=function(e){for(var n,r=!1,a=0,o=Int32Array.from([0,0,0]);!r;){o=Int32Array.from([0,0,0]);var i=(n=t.findGuardPattern(e,a,!1,this.START_END_PATTERN,o))[0],s=i-((a=n[1])-i);s>=0&&(r=e.isRange(s,i,!1))}return n},t.checkChecksum=function(e){return t.checkStandardUPCEANChecksum(e)},t.checkStandardUPCEANChecksum=function(e){var n=e.length;if(0===n)return!1;var r=parseInt(e.charAt(n-1),10);return t.getStandardUPCEANChecksum(e.substring(0,n-1))===r},t.getStandardUPCEANChecksum=function(e){for(var t=e.length,n=0,r=t-1;r>=0;r-=2){if((a=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0))<0||a>9)throw new Tu;n+=a}n*=3;for(r=t-2;r>=0;r-=2){var a;if((a=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0))<0||a>9)throw new Tu;n+=a}return(1e3-n)%10},t.decodeEnd=function(e,n){return t.findGuardPattern(e,n,!1,t.START_END_PATTERN,new Int32Array(t.START_END_PATTERN.length).fill(0))},t.findGuardPatternWithoutCounters=function(e,t,n,r){return this.findGuardPattern(e,t,n,r,new Int32Array(r.length))},t.findGuardPattern=function(e,n,r,a,o){for(var i=e.getSize(),s=0,l=n=r?e.getNextUnset(n):e.getNextSet(n),c=a.length,u=r,d=n;d<i;d++)if(e.get(d)!==u)o[s]++;else{if(s===c-1){if(Ud.patternMatchVariance(o,a,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return Int32Array.from([l,d]);l+=o[0]+o[1];for(var h=o.slice(2,o.length),p=0;p<s-1;p++)o[p]=h[p];o[s-1]=0,o[s]=0,s--}else s++;o[s]=1,u=!u}throw new Uu},t.decodeDigit=function(e,n,r,a){this.recordPattern(e,r,n);for(var o=this.MAX_AVG_VARIANCE,i=-1,s=a.length,l=0;l<s;l++){var c=a[l],u=Ud.patternMatchVariance(n,c,t.MAX_INDIVIDUAL_VARIANCE);u<o&&(o=u,i=l)}if(i>=0)return i;throw new Uu},t.MAX_AVG_VARIANCE=.48,t.MAX_INDIVIDUAL_VARIANCE=.7,t.START_END_PATTERN=Int32Array.from([1,1,1]),t.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),t.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),t.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],t}(Ud);var ih=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},sh=function(){function e(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return e.prototype.decodeRow=function(t,n,r){var a=this.decodeRowStringBuffer,o=this.decodeMiddle(n,r,a),i=a.toString(),s=e.parseExtensionString(i),l=[new Ed((r[0]+r[1])/2,t),new Ed(o,t)],c=new od(i,null,0,l,sd.UPC_EAN_EXTENSION,(new Date).getTime());return null!=s&&c.putAllMetadata(s),c},e.prototype.decodeMiddle=function(t,n,r){var a,o,i=this.decodeMiddleCounters;i[0]=0,i[1]=0,i[2]=0,i[3]=0;for(var s=t.getSize(),l=n[1],c=0,u=0;u<5&&l<s;u++){var d=oh.decodeDigit(t,i,l,oh.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+d%10);try{for(var h=(a=void 0,ih(i)),p=h.next();!p.done;p=h.next()){l+=p.value}}catch(m){a={error:m}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}d>=10&&(c|=1<<4-u),4!==u&&(l=t.getNextSet(l),l=t.getNextUnset(l))}if(5!==r.length)throw new Uu;var f=this.determineCheckDigit(c);if(e.extensionChecksum(r.toString())!==f)throw new Uu;return l},e.extensionChecksum=function(e){for(var t=e.length,n=0,r=t-2;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);n*=3;for(r=t-1;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);return(n*=3)%10},e.prototype.determineCheckDigit=function(e){for(var t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new Uu},e.parseExtensionString=function(t){if(5!==t.length)return null;var n=e.parseExtension5String(t);return null==n?null:new Map([[cd.SUGGESTED_PRICE,n]])},e.parseExtension5String=function(e){var t;switch(e.charAt(0)){case"0":t="\xa3";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t=""}var n=parseInt(e.substring(1)),r=n%100;return t+(n/100).toString()+"."+(r<10?"0"+r:r.toString())},e}();const lh=sh;var ch=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},uh=function(){function e(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return e.prototype.decodeRow=function(t,n,r){var a=this.decodeRowStringBuffer,o=this.decodeMiddle(n,r,a),i=a.toString(),s=e.parseExtensionString(i),l=[new Ed((r[0]+r[1])/2,t),new Ed(o,t)],c=new od(i,null,0,l,sd.UPC_EAN_EXTENSION,(new Date).getTime());return null!=s&&c.putAllMetadata(s),c},e.prototype.decodeMiddle=function(e,t,n){var r,a,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var i=e.getSize(),s=t[1],l=0,c=0;c<2&&s<i;c++){var u=oh.decodeDigit(e,o,s,oh.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+u%10);try{for(var d=(r=void 0,ch(o)),h=d.next();!h.done;h=d.next()){s+=h.value}}catch(p){r={error:p}}finally{try{h&&!h.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}u>=10&&(l|=1<<1-c),1!==c&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(2!==n.length)throw new Uu;if(parseInt(n.toString())%4!==l)throw new Uu;return s},e.parseExtensionString=function(e){return 2!==e.length?null:new Map([[cd.ISSUE_NUMBER,parseInt(e)]])},e}();const dh=uh;const hh=function(){function e(){}return e.decodeRow=function(e,t,n){var r=oh.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new lh).decodeRow(e,t,r)}catch(a){return(new dh).decodeRow(e,t,r)}},e.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),e}();var ph=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fh=function(e){function t(){var n=e.call(this)||this;n.decodeRowStringBuffer="",t.L_AND_G_PATTERNS=t.L_PATTERNS.map(function(e){return Int32Array.from(e)});for(var r=10;r<20;r++){for(var a=t.L_PATTERNS[r-10],o=new Int32Array(a.length),i=0;i<a.length;i++)o[i]=a[a.length-i-1];t.L_AND_G_PATTERNS[r]=o}return n}return ph(t,e),t.prototype.decodeRow=function(e,n,r){var a=t.findStartGuardPattern(n),o=null==r?null:r.get(Au.NEED_RESULT_POINT_CALLBACK);if(null!=o){var i=new Ed((a[0]+a[1])/2,e);o.foundPossibleResultPoint(i)}var s=this.decodeMiddle(n,a,this.decodeRowStringBuffer),l=s.rowOffset,c=s.resultString;if(null!=o){var u=new Ed(l,e);o.foundPossibleResultPoint(u)}var d=t.decodeEnd(n,l);if(null!=o){var h=new Ed((d[0]+d[1])/2,e);o.foundPossibleResultPoint(h)}var p=d[1],f=p+(p-d[0]);if(f>=n.getSize()||!n.isRange(p,f,!1))throw new Uu;var m=c.toString();if(m.length<8)throw new Tu;if(!t.checkChecksum(m))throw new mu;var g=(a[1]+a[0])/2,x=(d[1]+d[0])/2,y=this.getBarcodeFormat(),v=[new Ed(g,e),new Ed(x,e)],b=new od(m,null,0,v,y,(new Date).getTime()),w=0;try{var k=hh.decodeRow(e,n,d[1]);b.putMetadata(cd.UPC_EAN_EXTENSION,k.getText()),b.putAllMetadata(k.getResultMetadata()),b.addResultPoints(k.getResultPoints()),w=k.getText().length}catch(_){}var j=null==r?null:r.get(Au.ALLOWED_EAN_EXTENSIONS);if(null!=j){var C=!1;for(var N in j)if(w.toString()===N){C=!0;break}if(!C)throw new Uu}return y===sd.EAN_13||sd.UPC_A,b},t.checkChecksum=function(e){return t.checkStandardUPCEANChecksum(e)},t.checkStandardUPCEANChecksum=function(e){var n=e.length;if(0===n)return!1;var r=parseInt(e.charAt(n-1),10);return t.getStandardUPCEANChecksum(e.substring(0,n-1))===r},t.getStandardUPCEANChecksum=function(e){for(var t=e.length,n=0,r=t-1;r>=0;r-=2){if((a=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0))<0||a>9)throw new Tu;n+=a}n*=3;for(r=t-2;r>=0;r-=2){var a;if((a=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0))<0||a>9)throw new Tu;n+=a}return(1e3-n)%10},t.decodeEnd=function(e,n){return t.findGuardPattern(e,n,!1,t.START_END_PATTERN,new Int32Array(t.START_END_PATTERN.length).fill(0))},t}(oh);const mh=fh;var gh=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xh=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},yh=function(e){function t(){var t=e.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return gh(t,e),t.prototype.decodeMiddle=function(e,n,r){var a,o,i,s,l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;for(var c=e.getSize(),u=n[1],d=0,h=0;h<6&&u<c;h++){var p=mh.decodeDigit(e,l,u,mh.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+p%10);try{for(var f=(a=void 0,xh(l)),m=f.next();!m.done;m=f.next()){u+=m.value}}catch(y){a={error:y}}finally{try{m&&!m.done&&(o=f.return)&&o.call(f)}finally{if(a)throw a.error}}p>=10&&(d|=1<<5-h)}r=t.determineFirstDigit(r,d),u=mh.findGuardPattern(e,u,!0,mh.MIDDLE_PATTERN,new Int32Array(mh.MIDDLE_PATTERN.length).fill(0))[1];for(h=0;h<6&&u<c;h++){p=mh.decodeDigit(e,l,u,mh.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+p);try{for(var g=(i=void 0,xh(l)),x=g.next();!x.done;x=g.next()){u+=x.value}}catch(v){i={error:v}}finally{try{x&&!x.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}}return{rowOffset:u,resultString:r}},t.prototype.getBarcodeFormat=function(){return sd.EAN_13},t.determineFirstDigit=function(e,t){for(var n=0;n<10;n++)if(t===this.FIRST_DIGIT_ENCODINGS[n])return e=String.fromCharCode("0".charCodeAt(0)+n)+e;throw new Uu},t.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],t}(mh);const vh=yh;var bh=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wh=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},kh=function(e){function t(){var t=e.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return bh(t,e),t.prototype.decodeMiddle=function(e,t,n){var r,a,o,i,s=this.decodeMiddleCounters;s[0]=0,s[1]=0,s[2]=0,s[3]=0;for(var l=e.getSize(),c=t[1],u=0;u<4&&c<l;u++){var d=mh.decodeDigit(e,s,c,mh.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+d);try{for(var h=(r=void 0,wh(s)),p=h.next();!p.done;p=h.next()){c+=p.value}}catch(g){r={error:g}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(r)throw r.error}}}c=mh.findGuardPattern(e,c,!0,mh.MIDDLE_PATTERN,new Int32Array(mh.MIDDLE_PATTERN.length).fill(0))[1];for(u=0;u<4&&c<l;u++){d=mh.decodeDigit(e,s,c,mh.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+d);try{for(var f=(o=void 0,wh(s)),m=f.next();!m.done;m=f.next()){c+=m.value}}catch(x){o={error:x}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}return{rowOffset:c,resultString:n}},t.prototype.getBarcodeFormat=function(){return sd.EAN_8},t}(mh);const jh=kh;var Ch=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Nh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ean13Reader=new vh,t}return Ch(t,e),t.prototype.getBarcodeFormat=function(){return sd.UPC_A},t.prototype.decode=function(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))},t.prototype.decodeRow=function(e,t,n){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,n))},t.prototype.decodeMiddle=function(e,t,n){return this.ean13Reader.decodeMiddle(e,t,n)},t.prototype.maybeReturnResult=function(e){var t=e.getText();if("0"===t.charAt(0)){var n=new od(t.substring(1),null,null,e.getResultPoints(),sd.UPC_A);return null!=e.getResultMetadata()&&n.putAllMetadata(e.getResultMetadata()),n}throw new Uu},t.prototype.reset=function(){this.ean13Reader.reset()},t}(mh);var _h=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sh=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Eh=function(e){function t(){var t=e.call(this)||this;return t.decodeMiddleCounters=new Int32Array(4),t}return _h(t,e),t.prototype.decodeMiddle=function(e,n,r){var a,o,i=this.decodeMiddleCounters.map(function(e){return e});i[0]=0,i[1]=0,i[2]=0,i[3]=0;for(var s=e.getSize(),l=n[1],c=0,u=0;u<6&&l<s;u++){var d=t.decodeDigit(e,i,l,t.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+d%10);try{for(var h=(a=void 0,Sh(i)),p=h.next();!p.done;p=h.next()){l+=p.value}}catch(f){a={error:f}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}d>=10&&(c|=1<<5-u)}return t.determineNumSysAndCheckDigit(new zu(r),c),l},t.prototype.decodeEnd=function(e,n){return t.findGuardPatternWithoutCounters(e,n,!0,t.MIDDLE_END_PATTERN)},t.prototype.checkChecksum=function(e){return mh.checkChecksum(t.convertUPCEtoUPCA(e))},t.determineNumSysAndCheckDigit=function(e,t){for(var n=0;n<=1;n++)for(var r=0;r<10;r++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[n][r])return e.insert(0,"0"+n),void e.append("0"+r);throw Uu.getNotFoundInstance()},t.prototype.getBarcodeFormat=function(){return sd.UPC_E},t.convertUPCEtoUPCA=function(e){var t=e.slice(1,7).split("").map(function(e){return e.charCodeAt(0)}),n=new zu;n.append(e.charAt(0));var r=t[5];switch(r){case 0:case 1:case 2:n.appendChars(t,0,2),n.append(r),n.append("0000"),n.appendChars(t,2,3);break;case 3:n.appendChars(t,0,3),n.append("00000"),n.appendChars(t,3,2);break;case 4:n.appendChars(t,0,4),n.append("00000"),n.append(t[4]);break;default:n.appendChars(t,0,5),n.append("0000"),n.append(r)}return e.length>=8&&n.append(e.charAt(7)),n.toString()},t.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),t.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],t}(mh);const Ah=Eh;var Ih=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Th=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ph=function(e){function t(t){var n=e.call(this)||this,r=null==t?null:t.get(Au.POSSIBLE_FORMATS),a=[];return null!=r&&(r.indexOf(sd.EAN_13)>-1&&a.push(new vh),r.indexOf(sd.UPC_A)>-1&&a.push(new Nh),r.indexOf(sd.EAN_8)>-1&&a.push(new jh),r.indexOf(sd.UPC_E)>-1&&a.push(new Ah)),0===a.length&&(a.push(new vh),a.push(new Nh),a.push(new jh),a.push(new Ah)),n.readers=a,n}return Ih(t,e),t.prototype.decodeRow=function(e,t,n){var r,a;try{for(var o=Th(this.readers),i=o.next();!i.done;i=o.next()){var s=i.value;try{var l=s.decodeRow(e,t,n),c=l.getBarcodeFormat()===sd.EAN_13&&"0"===l.getText().charAt(0),u=null==n?null:n.get(Au.POSSIBLE_FORMATS),d=null==u||u.includes(sd.UPC_A);if(c&&d){var h=l.getRawBytes(),p=new od(l.getText().substring(1),h,h?h.length:null,l.getResultPoints(),sd.UPC_A);return p.putAllMetadata(l.getResultMetadata()),p}return l}catch(f){}}}catch(m){r={error:m}}finally{try{i&&!i.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}throw new Uu},t.prototype.reset=function(){var e,t;try{for(var n=Th(this.readers),r=n.next();!r.done;r=n.next()){r.value.reset()}}catch(a){e={error:a}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t}(Ud);const Dh=Ph;var Mh=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},t}return Mh(t,e),t.prototype.decodeRow=function(e,t,n){var r=this.getValidRowData(t);if(!r)throw new Uu;var a=this.codaBarDecodeRow(r.row);if(!a)throw new Uu;return new od(a,null,0,[new Ed(r.left,e),new Ed(r.right,e)],sd.CODABAR,(new Date).getTime())},t.prototype.getValidRowData=function(e){var t=e.toArray(),n=t.indexOf(!0);if(-1===n)return null;var r=t.lastIndexOf(!0);if(r<=n)return null;for(var a=[],o=(t=t.slice(n,r+1))[0],i=1,s=1;s<t.length;s++)t[s]===o?i++:(o=t[s],a.push(i),i=1);return a.push(i),a.length<23&&(a.length+1)%8!==0?null:{row:a,left:n,right:r}},t.prototype.codaBarDecodeRow=function(e){for(var t=[],n=Math.ceil(e.reduce(function(e,t){return(e+t)/2},0));e.length>0;){var r=e.splice(0,8).splice(0,7).map(function(e){return e<n?"n":"w"}).join("");if(void 0===this.CODA_BAR_CHAR_SET[r])return null;t.push(this.CODA_BAR_CHAR_SET[r])}var a=t.join("");return this.validCodaBarString(a)?a:null},t.prototype.validCodaBarString=function(e){return/^[A-D].{1,}[A-D]$/.test(e)},t}(Ud);const Fh=Rh;var Oh=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bh=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Lh=function(e){function t(){var t=e.call(this)||this;return t.decodeFinderCounters=new Int32Array(4),t.dataCharacterCounters=new Int32Array(8),t.oddRoundingErrors=new Array(4),t.evenRoundingErrors=new Array(4),t.oddCounts=new Array(t.dataCharacterCounters.length/2),t.evenCounts=new Array(t.dataCharacterCounters.length/2),t}return Oh(t,e),t.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},t.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},t.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},t.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},t.prototype.getOddCounts=function(){return this.oddCounts},t.prototype.getEvenCounts=function(){return this.evenCounts},t.prototype.parseFinderValue=function(e,n){for(var r=0;r<n.length;r++)if(Ud.patternMatchVariance(e,n[r],t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return r;throw new Uu},t.count=function(e){return _d.sum(new Int32Array(e))},t.increment=function(e,t){for(var n=0,r=t[0],a=1;a<e.length;a++)t[a]>r&&(r=t[a],n=a);e[n]++},t.decrement=function(e,t){for(var n=0,r=t[0],a=1;a<e.length;a++)t[a]<r&&(r=t[a],n=a);e[n]--},t.isFinderPattern=function(e){var n,r,a=e[0]+e[1],o=a/(a+e[2]+e[3]);if(o>=t.MIN_FINDER_PATTERN_RATIO&&o<=t.MAX_FINDER_PATTERN_RATIO){var i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;try{for(var l=Bh(e),c=l.next();!c.done;c=l.next()){var u=c.value;u>s&&(s=u),u<i&&(i=u)}}catch(d){n={error:d}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return s<10*i}return!1},t.MAX_AVG_VARIANCE=.2,t.MAX_INDIVIDUAL_VARIANCE=.45,t.MIN_FINDER_PATTERN_RATIO=9.5/12,t.MAX_FINDER_PATTERN_RATIO=12.5/14,t}(Ud);const zh=Lh;const Wh=function(){function e(e,t){this.value=e,this.checksumPortion=t}return e.prototype.getValue=function(){return this.value},e.prototype.getChecksumPortion=function(){return this.checksumPortion},e.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;return this.value===n.value&&this.checksumPortion===n.checksumPortion},e.prototype.hashCode=function(){return this.value^this.checksumPortion},e}();const Vh=function(){function e(e,t,n,r,a){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new Ed(n,a)),this.resultPoints.push(new Ed(r,a))}return e.prototype.getValue=function(){return this.value},e.prototype.getStartEnd=function(){return this.startEnd},e.prototype.getResultPoints=function(){return this.resultPoints},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;return this.value===n.value},e.prototype.hashCode=function(){return this.value},e}();var Uh=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Hh=function(){function e(){}return e.getRSSvalue=function(t,n,r){var a,o,i=0;try{for(var s=Uh(t),l=s.next();!l.done;l=s.next()){i+=l.value}}catch(x){a={error:x}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(a)throw a.error}}for(var c=0,u=0,d=t.length,h=0;h<d-1;h++){var p=void 0;for(p=1,u|=1<<h;p<t[h];p++,u&=~(1<<h)){var f=e.combins(i-p-1,d-h-2);if(r&&0===u&&i-p-(d-h-1)>=d-h-1&&(f-=e.combins(i-p-(d-h),d-h-2)),d-h-1>1){for(var m=0,g=i-p-(d-h-2);g>n;g--)m+=e.combins(i-p-g-1,d-h-3);f-=m*(d-1-h)}else i-p>n&&f--;c+=f}i-=p}return c},e.combins=function(e,t){var n,r;e-t>t?(r=t,n=e-t):(r=e-t,n=t);for(var a=1,o=1,i=e;i>n;i--)a*=i,o<=r&&(a/=o,o++);for(;o<=r;)a/=o,o++;return a},e}();const Gh=Hh;const Kh=function(){function e(){}return e.buildBitArray=function(e){var t=2*e.length-1;null==e[e.length-1].getRightChar()&&(t-=1);for(var n=new Su(12*t),r=0,a=e[0].getRightChar().getValue(),o=11;o>=0;--o)0!==(a&1<<o)&&n.set(r),r++;for(o=1;o<e.length;++o){for(var i=e[o],s=i.getLeftChar().getValue(),l=11;l>=0;--l)0!==(s&1<<l)&&n.set(r),r++;if(null!==i.getRightChar()){var c=i.getRightChar().getValue();for(l=11;l>=0;--l)0!==(c&1<<l)&&n.set(r),r++}}return n},e}();const Xh=function(){function e(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}return e.prototype.getDecodedInformation=function(){return this.decodedInformation},e.prototype.isFinished=function(){return this.finished},e}();const Yh=function(){function e(e){this.newPosition=e}return e.prototype.getNewPosition=function(){return this.newPosition},e}();var qh=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Zh=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return qh(t,e),t.prototype.getValue=function(){return this.value},t.prototype.isFNC1=function(){return this.value===t.FNC1},t.FNC1="$",t}(Yh);var Jh=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Qh=function(e){function t(t,n,r){var a=e.call(this,t)||this;return r?(a.remaining=!0,a.remainingValue=a.remainingValue):(a.remaining=!1,a.remainingValue=0),a.newString=n,a}return Jh(t,e),t.prototype.getNewString=function(){return this.newString},t.prototype.isRemaining=function(){return this.remaining},t.prototype.getRemainingValue=function(){return this.remainingValue},t}(Yh);var $h=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const ep=function(e){function t(t,n,r){var a=e.call(this,t)||this;if(n<0||n>10||r<0||r>10)throw new Tu;return a.firstDigit=n,a.secondDigit=r,a}return $h(t,e),t.prototype.getFirstDigit=function(){return this.firstDigit},t.prototype.getSecondDigit=function(){return this.secondDigit},t.prototype.getValue=function(){return 10*this.firstDigit+this.secondDigit},t.prototype.isFirstDigitFNC1=function(){return this.firstDigit===t.FNC1},t.prototype.isSecondDigitFNC1=function(){return this.secondDigit===t.FNC1},t.prototype.isAnyFNC1=function(){return this.firstDigit===t.FNC1||this.secondDigit===t.FNC1},t.FNC1=10,t}(Yh);var tp=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},np=function(){function e(){}return e.parseFieldsInGeneralPurpose=function(t){var n,r,a,o,i,s,l,c;if(!t)return null;if(t.length<2)throw new Uu;var u=t.substring(0,2);try{for(var d=tp(e.TWO_DIGIT_DATA_LENGTH),h=d.next();!h.done;h=d.next()){if((w=h.value)[0]===u)return w[1]===e.VARIABLE_LENGTH?e.processVariableAI(2,w[2],t):e.processFixedAI(2,w[1],t)}}catch(k){n={error:k}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}if(t.length<3)throw new Uu;var p=t.substring(0,3);try{for(var f=tp(e.THREE_DIGIT_DATA_LENGTH),m=f.next();!m.done;m=f.next()){if((w=m.value)[0]===p)return w[1]===e.VARIABLE_LENGTH?e.processVariableAI(3,w[2],t):e.processFixedAI(3,w[1],t)}}catch(j){a={error:j}}finally{try{m&&!m.done&&(o=f.return)&&o.call(f)}finally{if(a)throw a.error}}try{for(var g=tp(e.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),x=g.next();!x.done;x=g.next()){if((w=x.value)[0]===p)return w[1]===e.VARIABLE_LENGTH?e.processVariableAI(4,w[2],t):e.processFixedAI(4,w[1],t)}}catch(C){i={error:C}}finally{try{x&&!x.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}if(t.length<4)throw new Uu;var y=t.substring(0,4);try{for(var v=tp(e.FOUR_DIGIT_DATA_LENGTH),b=v.next();!b.done;b=v.next()){var w;if((w=b.value)[0]===y)return w[1]===e.VARIABLE_LENGTH?e.processVariableAI(4,w[2],t):e.processFixedAI(4,w[1],t)}}catch(N){l={error:N}}finally{try{b&&!b.done&&(c=v.return)&&c.call(v)}finally{if(l)throw l.error}}throw new Uu},e.processFixedAI=function(t,n,r){if(r.length<t)throw new Uu;var a=r.substring(0,t);if(r.length<t+n)throw new Uu;var o=r.substring(t,t+n),i=r.substring(t+n),s="("+a+")"+o,l=e.parseFieldsInGeneralPurpose(i);return null==l?s:s+l},e.processVariableAI=function(t,n,r){var a,o=r.substring(0,t);a=r.length<t+n?r.length:t+n;var i=r.substring(t,a),s=r.substring(a),l="("+o+")"+i,c=e.parseFieldsInGeneralPurpose(s);return null==c?l:l+c},e.VARIABLE_LENGTH=[],e.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",e.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",e.VARIABLE_LENGTH,20],["22",e.VARIABLE_LENGTH,29],["30",e.VARIABLE_LENGTH,8],["37",e.VARIABLE_LENGTH,8],["90",e.VARIABLE_LENGTH,30],["91",e.VARIABLE_LENGTH,30],["92",e.VARIABLE_LENGTH,30],["93",e.VARIABLE_LENGTH,30],["94",e.VARIABLE_LENGTH,30],["95",e.VARIABLE_LENGTH,30],["96",e.VARIABLE_LENGTH,30],["97",e.VARIABLE_LENGTH,3],["98",e.VARIABLE_LENGTH,30],["99",e.VARIABLE_LENGTH,30]],e.THREE_DIGIT_DATA_LENGTH=[["240",e.VARIABLE_LENGTH,30],["241",e.VARIABLE_LENGTH,30],["242",e.VARIABLE_LENGTH,6],["250",e.VARIABLE_LENGTH,30],["251",e.VARIABLE_LENGTH,30],["253",e.VARIABLE_LENGTH,17],["254",e.VARIABLE_LENGTH,20],["400",e.VARIABLE_LENGTH,30],["401",e.VARIABLE_LENGTH,30],["402",17],["403",e.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",e.VARIABLE_LENGTH,20],["421",e.VARIABLE_LENGTH,15],["422",3],["423",e.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],e.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",e.VARIABLE_LENGTH,15],["391",e.VARIABLE_LENGTH,18],["392",e.VARIABLE_LENGTH,15],["393",e.VARIABLE_LENGTH,18],["703",e.VARIABLE_LENGTH,30]],e.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",e.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",e.VARIABLE_LENGTH,20],["8003",e.VARIABLE_LENGTH,30],["8004",e.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",e.VARIABLE_LENGTH,30],["8008",e.VARIABLE_LENGTH,12],["8018",18],["8020",e.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",e.VARIABLE_LENGTH,70],["8200",e.VARIABLE_LENGTH,70]],e}();const rp=np;var ap=function(){function e(e){this.buffer=new zu,this.information=e}return e.prototype.decodeAllCodes=function(e,t){for(var n=t,r=null;;){var a=this.decodeGeneralPurposeField(n,r),o=rp.parseFieldsInGeneralPurpose(a.getNewString());if(null!=o&&e.append(o),r=a.isRemaining()?""+a.getRemainingValue():null,n===a.getNewPosition())break;n=a.getNewPosition()}return e.toString()},e.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)},e.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var t=this.extractNumericValueFromBitArray(e,4);return new ep(this.information.getSize(),0===t?ep.FNC1:t-1,ep.FNC1)}var n=this.extractNumericValueFromBitArray(e,7);return new ep(e+7,(n-8)/11,(n-8)%11)},e.prototype.extractNumericValueFromBitArray=function(t,n){return e.extractNumericValueFromBitArray(this.information,t,n)},e.extractNumericValueFromBitArray=function(e,t,n){for(var r=0,a=0;a<n;++a)e.get(t+a)&&(r|=1<<n-a-1);return r},e.prototype.decodeGeneralPurposeField=function(e,t){this.buffer.setLengthToZero(),null!=t&&this.buffer.append(t),this.current.setPosition(e);var n=this.parseBlocks();return null!=n&&n.isRemaining()?new Qh(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Qh(this.current.getPosition(),this.buffer.toString())},e.prototype.parseBlocks=function(){var e,t;do{var n=this.current.getPosition();if(e=this.current.isAlpha()?(t=this.parseAlphaBlock()).isFinished():this.current.isIsoIec646()?(t=this.parseIsoIec646Block()).isFinished():(t=this.parseNumericBlock()).isFinished(),!(n!==this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()},e.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var t=void 0;return t=e.isSecondDigitFNC1()?new Qh(this.current.getPosition(),this.buffer.toString()):new Qh(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Xh(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){t=new Qh(this.current.getPosition(),this.buffer.toString());return new Xh(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Xh(!1)},e.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new Qh(this.current.getPosition(),this.buffer.toString());return new Xh(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Xh(!1)},e.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new Qh(this.current.getPosition(),this.buffer.toString());return new Xh(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Xh(!1)},e.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,8);return r>=232&&r<253},e.prototype.decodeIsoIec646=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(15===t)return new Zh(e+5,Zh.FNC1);if(t>=5&&t<15)return new Zh(e+5,"0"+(t-5));var n,r=this.extractNumericValueFromBitArray(e,7);if(r>=64&&r<90)return new Zh(e+7,""+(r+1));if(r>=90&&r<116)return new Zh(e+7,""+(r+7));switch(this.extractNumericValueFromBitArray(e,8)){case 232:n="!";break;case 233:n='"';break;case 234:n="%";break;case 235:n="&";break;case 236:n="'";break;case 237:n="(";break;case 238:n=")";break;case 239:n="*";break;case 240:n="+";break;case 241:n=",";break;case 242:n="-";break;case 243:n=".";break;case 244:n="/";break;case 245:n=":";break;case 246:n=";";break;case 247:n="<";break;case 248:n="=";break;case 249:n=">";break;case 250:n="?";break;case 251:n="_";break;case 252:n=" ";break;default:throw new Tu}return new Zh(e+8,n)},e.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},e.prototype.decodeAlphanumeric=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(15===t)return new Zh(e+5,Zh.FNC1);if(t>=5&&t<15)return new Zh(e+5,"0"+(t-5));var n,r=this.extractNumericValueFromBitArray(e,6);if(r>=32&&r<58)return new Zh(e+6,""+(r+33));switch(r){case 58:n="*";break;case 59:n=",";break;case 60:n="-";break;case 61:n=".";break;case 62:n="/";break;default:throw new wd("Decoding invalid alphanumeric value: "+r)}return new Zh(e+6,n)},e.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<5&&t+e<this.information.getSize();++t)if(2===t){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0},e.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0},e.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0},e}();const op=ap;const ip=function(){function e(e){this.information=e,this.generalDecoder=new op(e)}return e.prototype.getInformation=function(){return this.information},e.prototype.getGeneralDecoder=function(){return this.generalDecoder},e}();var sp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const lp=function(e){function t(t){return e.call(this,t)||this}return sp(t,e),t.prototype.encodeCompressedGtin=function(e,t){e.append("(01)");var n=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,n)},t.prototype.encodeCompressedGtinWithoutAI=function(e,n,r){for(var a=0;a<4;++a){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*a,10);o/100===0&&e.append("0"),o/10===0&&e.append("0"),e.append(o)}t.appendCheckDigit(e,r)},t.appendCheckDigit=function(e,t){for(var n=0,r=0;r<13;r++){var a=e.charAt(r+t).charCodeAt(0)-"0".charCodeAt(0);n+=0===(1&r)?3*a:a}10===(n=10-n%10)&&(n=0),e.append(n)},t.GTIN_SIZE=40,t}(ip);var cp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const up=function(e){function t(t){return e.call(this,t)||this}return cp(t,e),t.prototype.parseInformation=function(){var e=new zu;e.append("(01)");var n=e.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE,4);return e.append(r),this.encodeCompressedGtinWithoutAI(e,t.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(e,t.HEADER_SIZE+44)},t.HEADER_SIZE=4,t}(lp);var dp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const hp=function(e){function t(t){return e.call(this,t)||this}return dp(t,e),t.prototype.parseInformation=function(){var e=new zu;return this.getGeneralDecoder().decodeAllCodes(e,t.HEADER_SIZE)},t.HEADER_SIZE=5,t}(ip);var pp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const fp=function(e){function t(t){return e.call(this,t)||this}return pp(t,e),t.prototype.encodeCompressedWeight=function(e,t,n){var r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,n);this.addWeightCode(e,r);for(var a=this.checkWeight(r),o=1e5,i=0;i<5;++i)a/o===0&&e.append("0"),o/=10;e.append(a)},t}(lp);var mp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const gp=function(e){function t(t){return e.call(this,t)||this}return mp(t,e),t.prototype.parseInformation=function(){if(this.getInformation().getSize()!==t.HEADER_SIZE+fp.GTIN_SIZE+t.WEIGHT_SIZE)throw new Uu;var e=new zu;return this.encodeCompressedGtin(e,t.HEADER_SIZE),this.encodeCompressedWeight(e,t.HEADER_SIZE+fp.GTIN_SIZE,t.WEIGHT_SIZE),e.toString()},t.HEADER_SIZE=5,t.WEIGHT_SIZE=15,t}(fp);var xp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const yp=function(e){function t(t){return e.call(this,t)||this}return xp(t,e),t.prototype.addWeightCode=function(e,t){e.append("(3103)")},t.prototype.checkWeight=function(e){return e},t}(gp);var vp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const bp=function(e){function t(t){return e.call(this,t)||this}return vp(t,e),t.prototype.addWeightCode=function(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")},t.prototype.checkWeight=function(e){return e<1e4?e:e-1e4},t}(gp);var wp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const kp=function(e){function t(t){return e.call(this,t)||this}return wp(t,e),t.prototype.parseInformation=function(){if(this.getInformation().getSize()<t.HEADER_SIZE+lp.GTIN_SIZE)throw new Uu;var e=new zu;this.encodeCompressedGtin(e,t.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+lp.GTIN_SIZE,t.LAST_DIGIT_SIZE);e.append("(392"),e.append(n),e.append(")");var r=this.getGeneralDecoder().decodeGeneralPurposeField(t.HEADER_SIZE+lp.GTIN_SIZE+t.LAST_DIGIT_SIZE,null);return e.append(r.getNewString()),e.toString()},t.HEADER_SIZE=8,t.LAST_DIGIT_SIZE=2,t}(lp);var jp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Cp=function(e){function t(t){return e.call(this,t)||this}return jp(t,e),t.prototype.parseInformation=function(){if(this.getInformation().getSize()<t.HEADER_SIZE+lp.GTIN_SIZE)throw new Uu;var e=new zu;this.encodeCompressedGtin(e,t.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+lp.GTIN_SIZE,t.LAST_DIGIT_SIZE);e.append("(393"),e.append(n),e.append(")");var r=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+lp.GTIN_SIZE+t.LAST_DIGIT_SIZE,t.FIRST_THREE_DIGITS_SIZE);r/100===0&&e.append("0"),r/10===0&&e.append("0"),e.append(r);var a=this.getGeneralDecoder().decodeGeneralPurposeField(t.HEADER_SIZE+lp.GTIN_SIZE+t.LAST_DIGIT_SIZE+t.FIRST_THREE_DIGITS_SIZE,null);return e.append(a.getNewString()),e.toString()},t.HEADER_SIZE=8,t.LAST_DIGIT_SIZE=2,t.FIRST_THREE_DIGITS_SIZE=10,t}(lp);var Np=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const _p=function(e){function t(t,n,r){var a=e.call(this,t)||this;return a.dateCode=r,a.firstAIdigits=n,a}return Np(t,e),t.prototype.parseInformation=function(){if(this.getInformation().getSize()!==t.HEADER_SIZE+t.GTIN_SIZE+t.WEIGHT_SIZE+t.DATE_SIZE)throw new Uu;var e=new zu;return this.encodeCompressedGtin(e,t.HEADER_SIZE),this.encodeCompressedWeight(e,t.HEADER_SIZE+t.GTIN_SIZE,t.WEIGHT_SIZE),this.encodeCompressedDate(e,t.HEADER_SIZE+t.GTIN_SIZE+t.WEIGHT_SIZE),e.toString()},t.prototype.encodeCompressedDate=function(e,n){var r=this.getGeneralDecoder().extractNumericValueFromBitArray(n,t.DATE_SIZE);if(38400!==r){e.append("("),e.append(this.dateCode),e.append(")");var a=r%32,o=(r/=32)%12+1,i=r/=12;i/10===0&&e.append("0"),e.append(i),o/10===0&&e.append("0"),e.append(o),a/10===0&&e.append("0"),e.append(a)}},t.prototype.addWeightCode=function(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")},t.prototype.checkWeight=function(e){return e%1e5},t.HEADER_SIZE=8,t.WEIGHT_SIZE=20,t.DATE_SIZE=16,t}(fp);const Sp=function(){function e(e,t,n,r){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=r}return e.prototype.mayBeLast=function(){return this.maybeLast},e.prototype.getLeftChar=function(){return this.leftchar},e.prototype.getRightChar=function(){return this.rightchar},e.prototype.getFinderPattern=function(){return this.finderpattern},e.prototype.mustBeLast=function(){return null==this.rightchar},e.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(null==this.finderpattern?"null":this.finderpattern.getValue())+" ]"},e.equals=function(t,n){return t instanceof e&&(e.equalsOrNull(t.leftchar,n.leftchar)&&e.equalsOrNull(t.rightchar,n.rightchar)&&e.equalsOrNull(t.finderpattern,n.finderpattern))},e.equalsOrNull=function(t,n){return null===t?null===n:e.equals(t,n)},e.prototype.hashCode=function(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()},e}();const Ep=function(){function e(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}return e.prototype.getPairs=function(){return this.pairs},e.prototype.getRowNumber=function(){return this.rowNumber},e.prototype.isReversed=function(){return this.wasReversed},e.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},e.prototype.toString=function(){return"{ "+this.pairs+" }"},e.prototype.equals=function(t,n){return t instanceof e&&(this.checkEqualitity(t,n)&&t.wasReversed===n.wasReversed)},e.prototype.checkEqualitity=function(e,t){var n;if(e&&t)return e.forEach(function(e,r){t.forEach(function(t){e.getLeftChar().getValue()===t.getLeftChar().getValue()&&e.getRightChar().getValue()===t.getRightChar().getValue()&&e.getFinderPatter().getValue()===t.getFinderPatter().getValue()&&(n=!0)})}),n},e}();var Ap=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ip=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Tp=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.pairs=new Array(t.MAX_PAIRS),n.rows=new Array,n.startEnd=[2],n}return Ap(t,e),t.prototype.decodeRow=function(e,n,r){this.pairs.length=0,this.startFromEven=!1;try{return t.constructResult(this.decodeRow2pairs(e,n))}catch(Z_){}return this.pairs.length=0,this.startFromEven=!0,t.constructResult(this.decodeRow2pairs(e,n))},t.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},t.prototype.decodeRow2pairs=function(e,t){for(var n,r=!1;!r;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(o){if(o instanceof Uu){if(!this.pairs.length)throw new Uu;r=!0}}if(this.checkChecksum())return this.pairs;if(n=!!this.rows.length,this.storeRow(e,!1),n){var a=this.checkRowsBoolean(!1);if(null!=a)return a;if(null!=(a=this.checkRowsBoolean(!0)))return a}throw new Uu},t.prototype.checkRowsBoolean=function(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());var t=null;try{t=this.checkRows(new Array,0)}catch(Z_){console.log(Z_)}return e&&(this.rows=this.rows.reverse()),t},t.prototype.checkRows=function(e,n){for(var r,a,o=n;o<this.rows.length;o++){var i=this.rows[o];this.pairs.length=0;try{for(var s=(r=void 0,Ip(e)),l=s.next();!l.done;l=s.next()){var c=l.value;this.pairs.push(c.getPairs())}}catch(d){r={error:d}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}if(this.pairs.push(i.getPairs()),t.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var u=new Array(e);u.push(i);try{return this.checkRows(u,o+1)}catch(Z_){console.log(Z_)}}}throw new Uu},t.isValidSequence=function(e){var n,r;try{for(var a=Ip(t.FINDER_PATTERN_SEQUENCES),o=a.next();!o.done;o=a.next()){var i=o.value;if(!(e.length>i.length)){for(var s=!0,l=0;l<e.length;l++)if(e[l].getFinderPattern().getValue()!==i[l]){s=!1;break}if(s)return!0}}}catch(c){n={error:c}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1},t.prototype.storeRow=function(e,n){for(var r=0,a=!1,o=!1;r<this.rows.length;){var i=this.rows[r];if(i.getRowNumber()>e){o=i.isEquivalent(this.pairs);break}a=i.isEquivalent(this.pairs),r++}o||a||t.isPartialRow(this.pairs,this.rows)||(this.rows.push(r,new Ep(this.pairs,e,n)),this.removePartialRows(this.pairs,this.rows))},t.prototype.removePartialRows=function(e,t){var n,r,a,o,i,s;try{for(var l=Ip(t),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.getPairs().length!==e.length){try{for(var d=(a=void 0,Ip(u.getPairs())),h=d.next();!h.done;h=d.next()){var p=h.value,f=!1;try{for(var m=(i=void 0,Ip(e)),g=m.next();!g.done;g=m.next()){var x=g.value;if(Sp.equals(p,x)){f=!0;break}}}catch(y){i={error:y}}finally{try{g&&!g.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}f||!1}}catch(v){a={error:v}}finally{try{h&&!h.done&&(o=d.return)&&o.call(d)}finally{if(a)throw a.error}}}}}catch(b){n={error:b}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}},t.isPartialRow=function(e,t){var n,r,a,o,i,s;try{for(var l=Ip(t),c=l.next();!c.done;c=l.next()){var u=c.value,d=!0;try{for(var h=(a=void 0,Ip(e)),p=h.next();!p.done;p=h.next()){var f=p.value,m=!1;try{for(var g=(i=void 0,Ip(u.getPairs())),x=g.next();!x.done;x=g.next()){var y=x.value;if(f.equals(y)){m=!0;break}}}catch(v){i={error:v}}finally{try{x&&!x.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}if(!m){d=!1;break}}}catch(b){a={error:b}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}if(d)return!0}}catch(w){n={error:w}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return!1},t.prototype.getRows=function(){return this.rows},t.constructResult=function(e){var t=function(e){try{if(e.get(1))return new up(e);if(!e.get(2))return new hp(e);switch(op.extractNumericValueFromBitArray(e,1,4)){case 4:return new yp(e);case 5:return new bp(e)}switch(op.extractNumericValueFromBitArray(e,1,5)){case 12:return new kp(e);case 13:return new Cp(e)}switch(op.extractNumericValueFromBitArray(e,1,7)){case 56:return new _p(e,"310","11");case 57:return new _p(e,"320","11");case 58:return new _p(e,"310","13");case 59:return new _p(e,"320","13");case 60:return new _p(e,"310","15");case 61:return new _p(e,"320","15");case 62:return new _p(e,"310","17");case 63:return new _p(e,"320","17")}}catch(Z_){throw console.log(Z_),new wd("unknown decoder: "+e)}}(Kh.buildBitArray(e)).parseInformation(),n=e[0].getFinderPattern().getResultPoints(),r=e[e.length-1].getFinderPattern().getResultPoints(),a=[n[0],n[1],r[0],r[1]];return new od(t,null,null,a,sd.RSS_EXPANDED,null)},t.prototype.checkChecksum=function(){var e=this.pairs.get(0),t=e.getLeftChar(),n=e.getRightChar();if(null===n)return!1;for(var r=n.getChecksumPortion(),a=2,o=1;o<this.pairs.size();++o){var i=this.pairs.get(o);r+=i.getLeftChar().getChecksumPortion(),a++;var s=i.getRightChar();null!=s&&(r+=s.getChecksumPortion(),a++)}return 211*(a-4)+(r%=211)===t.getValue()},t.getNextSecondBar=function(e,t){var n;return e.get(t)?(n=e.getNextUnset(t),n=e.getNextSet(n)):(n=e.getNextSet(t),n=e.getNextUnset(n)),n},t.prototype.retrieveNextPair=function(e,n,r){var a,o=n.length%2===0;this.startFromEven&&(o=!o);var i=!0,s=-1;do{this.findNextPair(e,n,s),null===(a=this.parseFoundFinderPattern(e,r,o))?s=t.getNextSecondBar(e,this.startEnd[0]):i=!1}while(i);var l,c=this.decodeDataCharacter(e,a,o,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new Uu;try{l=this.decodeDataCharacter(e,a,o,!1)}catch(Z_){l=null,console.log(Z_)}return new Sp(c,l,a,!0)},t.prototype.isEmptyPair=function(e){return 0===e.length},t.prototype.findNextPair=function(e,n,r){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;var o,i=e.getSize();if(r>=0)o=r;else if(this.isEmptyPair(n))o=0;else{o=n[n.length-1].getFinderPattern().getStartEnd()[1]}var s=n.length%2!==0;this.startFromEven&&(s=!s);for(var l=!1;o<i&&(l=!e.get(o));)o++;for(var c=0,u=o,d=o;d<i;d++)if(e.get(d)!==l)a[c]++;else{if(3===c){if(s&&t.reverseCounters(a),t.isFinderPattern(a))return this.startEnd[0]=u,void(this.startEnd[1]=d);s&&t.reverseCounters(a),u+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,c--}else c++;a[c]=1,l=!l}throw new Uu},t.reverseCounters=function(e){for(var t=e.length,n=0;n<t/2;++n){var r=e[n];e[n]=e[t-n-1],e[t-n-1]=r}},t.prototype.parseFoundFinderPattern=function(e,n,r){var a,o,i;if(r){for(var s=this.startEnd[0]-1;s>=0&&!e.get(s);)s--;s++,a=this.startEnd[0]-s,o=s,i=this.startEnd[1]}else o=this.startEnd[0],a=(i=e.getNextUnset(this.startEnd[1]+1))-this.startEnd[1];var l,c=this.getDecodeFinderCounters();yu.arraycopy(c,0,c,1,c.length-1),c[0]=a;try{l=this.parseFinderValue(c,t.FINDER_PATTERNS)}catch(Z_){return null}return new Vh(l,[o,i],o,i,n)},t.prototype.decodeDataCharacter=function(e,n,r,a){for(var o=this.getDataCharacterCounters(),i=0;i<o.length;i++)o[i]=0;if(a)t.recordPatternInReverse(e,n.getStartEnd()[0],o);else{t.recordPattern(e,n.getStartEnd()[1],o);for(var s=0,l=o.length-1;s<l;s++,l--){var c=o[s];o[s]=o[l],o[l]=c}}var u=_d.sum(new Int32Array(o))/17,d=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(u-d)/d>.3)throw new Uu;var h=this.getOddCounts(),p=this.getEvenCounts(),f=this.getOddRoundingErrors(),m=this.getEvenRoundingErrors();for(s=0;s<o.length;s++){var g=1*o[s]/u,x=g+.5;if(x<1){if(g<.3)throw new Uu;x=1}else if(x>8){if(g>8.7)throw new Uu;x=8}var y=s/2;0===(1&s)?(h[y]=x,f[y]=g-x):(p[y]=x,m[y]=g-x)}this.adjustOddEvenCounts(17);var v=4*n.getValue()+(r?0:2)+(a?0:1)-1,b=0,w=0;for(s=h.length-1;s>=0;s--){if(t.isNotA1left(n,r,a)){var k=t.WEIGHTS[v][2*s];w+=h[s]*k}b+=h[s]}var j=0;for(s=p.length-1;s>=0;s--)if(t.isNotA1left(n,r,a)){k=t.WEIGHTS[v][2*s+1];j+=p[s]*k}var C=w+j;if(0!==(1&b)||b>13||b<4)throw new Uu;var N=(13-b)/2,_=t.SYMBOL_WIDEST[N],S=9-_,E=Gh.getRSSvalue(h,_,!0),A=Gh.getRSSvalue(p,S,!1),I=t.EVEN_TOTAL_SUBSET[N],T=t.GSUM[N];return new Wh(E*I+A+T,C)},t.isNotA1left=function(e,t,n){return!(0===e.getValue()&&t&&n)},t.prototype.adjustOddEvenCounts=function(e){var n=_d.sum(new Int32Array(this.getOddCounts())),r=_d.sum(new Int32Array(this.getEvenCounts())),a=!1,o=!1;n>13?o=!0:n<4&&(a=!0);var i=!1,s=!1;r>13?s=!0:r<4&&(i=!0);var l=n+r-e,c=1===(1&n),u=0===(1&r);if(1===l)if(c){if(u)throw new Uu;o=!0}else{if(!u)throw new Uu;s=!0}else if(-1===l)if(c){if(u)throw new Uu;a=!0}else{if(!u)throw new Uu;i=!0}else{if(0!==l)throw new Uu;if(c){if(!u)throw new Uu;n<r?(a=!0,s=!0):(o=!0,i=!0)}else if(u)throw new Uu}if(a){if(o)throw new Uu;t.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&t.decrement(this.getOddCounts(),this.getOddRoundingErrors()),i){if(s)throw new Uu;t.increment(this.getEvenCounts(),this.getOddRoundingErrors())}s&&t.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},t.SYMBOL_WIDEST=[7,5,4,3,1],t.EVEN_TOTAL_SUBSET=[4,20,52,104,204],t.GSUM=[0,348,1388,2948,3988],t.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],t.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],t.FINDER_PAT_A=0,t.FINDER_PAT_B=1,t.FINDER_PAT_C=2,t.FINDER_PAT_D=3,t.FINDER_PAT_E=4,t.FINDER_PAT_F=5,t.FINDER_PATTERN_SEQUENCES=[[t.FINDER_PAT_A,t.FINDER_PAT_A],[t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B],[t.FINDER_PAT_A,t.FINDER_PAT_C,t.FINDER_PAT_B,t.FINDER_PAT_D],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_C],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_D,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_D],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_E],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F]],t.MAX_PAIRS=11,t}(zh);const Pp=Tp;var Dp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Mp=function(e){function t(t,n,r){var a=e.call(this,t,n)||this;return a.count=0,a.finderPattern=r,a}return Dp(t,e),t.prototype.getFinderPattern=function(){return this.finderPattern},t.prototype.getCount=function(){return this.count},t.prototype.incrementCount=function(){this.count++},t}(Wh);var Rp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fp=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Op=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.possibleLeftPairs=[],t.possibleRightPairs=[],t}return Rp(t,e),t.prototype.decodeRow=function(e,n,r){var a,o,i,s,l=this.decodePair(n,!1,e,r);t.addOrTally(this.possibleLeftPairs,l),n.reverse();var c=this.decodePair(n,!0,e,r);t.addOrTally(this.possibleRightPairs,c),n.reverse();try{for(var u=Fp(this.possibleLeftPairs),d=u.next();!d.done;d=u.next()){var h=d.value;if(h.getCount()>1)try{for(var p=(i=void 0,Fp(this.possibleRightPairs)),f=p.next();!f.done;f=p.next()){var m=f.value;if(m.getCount()>1&&t.checkChecksum(h,m))return t.constructResult(h,m)}}catch(g){i={error:g}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(i)throw i.error}}}}catch(x){a={error:x}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}throw new Uu},t.addOrTally=function(e,t){var n,r;if(null!=t){var a=!1;try{for(var o=Fp(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(s.getValue()===t.getValue()){s.incrementCount(),a=!0;break}}}catch(l){n={error:l}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}a||e.push(t)}},t.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},t.constructResult=function(e,t){for(var n=4537077*e.getValue()+t.getValue(),r=new String(n).toString(),a=new zu,o=13-r.length;o>0;o--)a.append("0");a.append(r);var i=0;for(o=0;o<13;o++){var s=a.charAt(o).charCodeAt(0)-"0".charCodeAt(0);i+=0===(1&o)?3*s:s}10===(i=10-i%10)&&(i=0),a.append(i.toString());var l=e.getFinderPattern().getResultPoints(),c=t.getFinderPattern().getResultPoints();return new od(a.toString(),null,0,[l[0],l[1],c[0],c[1]],sd.RSS_14,(new Date).getTime())},t.checkChecksum=function(e,t){var n=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,r=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return r>72&&r--,r>8&&r--,n===r},t.prototype.decodePair=function(e,t,n,r){try{var a=this.findFinderPattern(e,t),o=this.parseFoundFinderPattern(e,n,t,a),i=null==r?null:r.get(Au.NEED_RESULT_POINT_CALLBACK);if(null!=i){var s=(a[0]+a[1])/2;t&&(s=e.getSize()-1-s),i.foundPossibleResultPoint(new Ed(s,n))}var l=this.decodeDataCharacter(e,o,!0),c=this.decodeDataCharacter(e,o,!1);return new Mp(1597*l.getValue()+c.getValue(),l.getChecksumPortion()+4*c.getChecksumPortion(),o)}catch(u){return null}},t.prototype.decodeDataCharacter=function(e,n,r){for(var a=this.getDataCharacterCounters(),o=0;o<a.length;o++)a[o]=0;if(r)Ud.recordPatternInReverse(e,n.getStartEnd()[0],a);else{Ud.recordPattern(e,n.getStartEnd()[1]+1,a);for(var i=0,s=a.length-1;i<s;i++,s--){var l=a[i];a[i]=a[s],a[s]=l}}var c=r?16:15,u=_d.sum(new Int32Array(a))/c,d=this.getOddCounts(),h=this.getEvenCounts(),p=this.getOddRoundingErrors(),f=this.getEvenRoundingErrors();for(i=0;i<a.length;i++){var m=a[i]/u,g=Math.floor(m+.5);g<1?g=1:g>8&&(g=8);var x=Math.floor(i/2);0===(1&i)?(d[x]=g,p[x]=m-g):(h[x]=g,f[x]=m-g)}this.adjustOddEvenCounts(r,c);var y=0,v=0;for(i=d.length-1;i>=0;i--)v*=9,v+=d[i],y+=d[i];var b=0,w=0;for(i=h.length-1;i>=0;i--)b*=9,b+=h[i],w+=h[i];var k=v+3*b;if(r){if(0!==(1&y)||y>12||y<4)throw new Uu;var j=(12-y)/2,C=9-(A=t.OUTSIDE_ODD_WIDEST[j]),N=Gh.getRSSvalue(d,A,!1),_=Gh.getRSSvalue(h,C,!0),S=t.OUTSIDE_EVEN_TOTAL_SUBSET[j],E=t.OUTSIDE_GSUM[j];return new Wh(N*S+_+E,k)}if(0!==(1&w)||w>10||w<4)throw new Uu;j=(10-w)/2,C=9-(A=t.INSIDE_ODD_WIDEST[j]),N=Gh.getRSSvalue(d,A,!0),_=Gh.getRSSvalue(h,C,!1);var A,I=t.INSIDE_ODD_TOTAL_SUBSET[j];E=t.INSIDE_GSUM[j];return new Wh(_*I+N+E,k)},t.prototype.findFinderPattern=function(e,t){var n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;for(var r=e.getSize(),a=!1,o=0;o<r&&t!==(a=!e.get(o));)o++;for(var i=0,s=o,l=o;l<r;l++)if(e.get(l)!==a)n[i]++;else{if(3===i){if(zh.isFinderPattern(n))return[s,l];s+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,i--}else i++;n[i]=1,a=!a}throw new Uu},t.prototype.parseFoundFinderPattern=function(e,n,r,a){for(var o=e.get(a[0]),i=a[0]-1;i>=0&&o!==e.get(i);)i--;i++;var s=a[0]-i,l=this.getDecodeFinderCounters(),c=new Int32Array(l.length);yu.arraycopy(l,0,c,1,l.length-1),c[0]=s;var u=this.parseFinderValue(c,t.FINDER_PATTERNS),d=i,h=a[1];return r&&(d=e.getSize()-1-d,h=e.getSize()-1-h),new Vh(u,[i,a[1]],d,h,n)},t.prototype.adjustOddEvenCounts=function(e,t){var n=_d.sum(new Int32Array(this.getOddCounts())),r=_d.sum(new Int32Array(this.getEvenCounts())),a=!1,o=!1,i=!1,s=!1;e?(n>12?o=!0:n<4&&(a=!0),r>12?s=!0:r<4&&(i=!0)):(n>11?o=!0:n<5&&(a=!0),r>10?s=!0:r<4&&(i=!0));var l=n+r-t,c=(1&n)===(e?1:0),u=1===(1&r);if(1===l)if(c){if(u)throw new Uu;o=!0}else{if(!u)throw new Uu;s=!0}else if(-1===l)if(c){if(u)throw new Uu;a=!0}else{if(!u)throw new Uu;i=!0}else{if(0!==l)throw new Uu;if(c){if(!u)throw new Uu;n<r?(a=!0,s=!0):(o=!0,i=!0)}else if(u)throw new Uu}if(a){if(o)throw new Uu;zh.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&zh.decrement(this.getOddCounts(),this.getOddRoundingErrors()),i){if(s)throw new Uu;zh.increment(this.getEvenCounts(),this.getOddRoundingErrors())}s&&zh.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},t.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],t.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],t.OUTSIDE_GSUM=[0,161,961,2015,2715],t.INSIDE_GSUM=[0,336,1036,1516],t.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],t.INSIDE_ODD_WIDEST=[2,4,6,8],t.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],t}(zh);const Bp=Op;var Lp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const zp=function(e){function t(t){var n=e.call(this)||this;n.readers=[];var r=t?t.get(Au.POSSIBLE_FORMATS):null,a=t&&void 0!==t.get(Au.ASSUME_CODE_39_CHECK_DIGIT),o=t&&void 0!==t.get(Au.ENABLE_CODE_39_EXTENDED_MODE);return r&&((r.includes(sd.EAN_13)||r.includes(sd.UPC_A)||r.includes(sd.EAN_8)||r.includes(sd.UPC_E))&&n.readers.push(new Dh(t)),r.includes(sd.CODE_39)&&n.readers.push(new qd(a,o)),r.includes(sd.CODE_93)&&n.readers.push(new $d),r.includes(sd.CODE_128)&&n.readers.push(new Gd),r.includes(sd.ITF)&&n.readers.push(new rh),r.includes(sd.CODABAR)&&n.readers.push(new Fh),r.includes(sd.RSS_14)&&n.readers.push(new Bp),r.includes(sd.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new Pp))),0===n.readers.length&&(n.readers.push(new Dh(t)),n.readers.push(new qd),n.readers.push(new $d),n.readers.push(new Dh(t)),n.readers.push(new Gd),n.readers.push(new rh),n.readers.push(new Bp)),n}return Lp(t,e),t.prototype.decodeRow=function(e,t,n){for(var r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(e,t,n)}catch(a){}throw new Uu},t.prototype.reset=function(){this.readers.forEach(function(e){return e.reset()})},t}(Ud);var Wp=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vp=(function(e){function t(t,n){return void 0===t&&(t=500),e.call(this,new zp(n),t,n)||this}Wp(t,e)}(rd),function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}),Up=function(){function e(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}return e.prototype.getECCodewords=function(){return this.ecCodewords},e.prototype.getECBlocks=function(){return this.ecBlocks},e}(),Hp=function(){function e(e,t){this.count=e,this.dataCodewords=t}return e.prototype.getCount=function(){return this.count},e.prototype.getDataCodewords=function(){return this.dataCodewords},e}(),Gp=function(){function e(e,t,n,r,a,o){var i,s;this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=a,this.ecBlocks=o;var l=0,c=o.getECCodewords(),u=o.getECBlocks();try{for(var d=Vp(u),h=d.next();!h.done;h=d.next()){var p=h.value;l+=p.getCount()*(p.getDataCodewords()+c)}}catch(f){i={error:f}}finally{try{h&&!h.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}this.totalCodewords=l}return e.prototype.getVersionNumber=function(){return this.versionNumber},e.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},e.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},e.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},e.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},e.prototype.getTotalCodewords=function(){return this.totalCodewords},e.prototype.getECBlocks=function(){return this.ecBlocks},e.getVersionForDimensions=function(t,n){var r,a;if(0!==(1&t)||0!==(1&n))throw new Tu;try{for(var o=Vp(e.VERSIONS),i=o.next();!i.done;i=o.next()){var s=i.value;if(s.symbolSizeRows===t&&s.symbolSizeColumns===n)return s}}catch(l){r={error:l}}finally{try{i&&!i.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}throw new Tu},e.prototype.toString=function(){return""+this.versionNumber},e.buildVersions=function(){return[new e(1,10,10,8,8,new Up(5,new Hp(1,3))),new e(2,12,12,10,10,new Up(7,new Hp(1,5))),new e(3,14,14,12,12,new Up(10,new Hp(1,8))),new e(4,16,16,14,14,new Up(12,new Hp(1,12))),new e(5,18,18,16,16,new Up(14,new Hp(1,18))),new e(6,20,20,18,18,new Up(18,new Hp(1,22))),new e(7,22,22,20,20,new Up(20,new Hp(1,30))),new e(8,24,24,22,22,new Up(24,new Hp(1,36))),new e(9,26,26,24,24,new Up(28,new Hp(1,44))),new e(10,32,32,14,14,new Up(36,new Hp(1,62))),new e(11,36,36,16,16,new Up(42,new Hp(1,86))),new e(12,40,40,18,18,new Up(48,new Hp(1,114))),new e(13,44,44,20,20,new Up(56,new Hp(1,144))),new e(14,48,48,22,22,new Up(68,new Hp(1,174))),new e(15,52,52,24,24,new Up(42,new Hp(2,102))),new e(16,64,64,14,14,new Up(56,new Hp(2,140))),new e(17,72,72,16,16,new Up(36,new Hp(4,92))),new e(18,80,80,18,18,new Up(48,new Hp(4,114))),new e(19,88,88,20,20,new Up(56,new Hp(4,144))),new e(20,96,96,22,22,new Up(68,new Hp(4,174))),new e(21,104,104,24,24,new Up(56,new Hp(6,136))),new e(22,120,120,18,18,new Up(68,new Hp(6,175))),new e(23,132,132,20,20,new Up(62,new Hp(8,163))),new e(24,144,144,22,22,new Up(62,new Hp(8,156),new Hp(2,155))),new e(25,8,18,6,16,new Up(7,new Hp(1,5))),new e(26,8,32,6,14,new Up(11,new Hp(1,10))),new e(27,12,26,10,24,new Up(14,new Hp(1,16))),new e(28,12,36,10,16,new Up(18,new Hp(1,22))),new e(29,16,36,14,16,new Up(24,new Hp(1,32))),new e(30,16,48,14,22,new Up(28,new Hp(1,49)))]},e.VERSIONS=e.buildVersions(),e}();const Kp=Gp;const Xp=function(){function e(t){var n=t.getHeight();if(n<8||n>144||0!==(1&n))throw new Tu;this.version=e.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new Wu(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return e.prototype.getVersion=function(){return this.version},e.readVersion=function(e){var t=e.getHeight(),n=e.getWidth();return Kp.getVersionForDimensions(t,n)},e.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),t=0,n=4,r=0,a=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),i=!1,s=!1,l=!1,c=!1;do{if(n!==a||0!==r||i)if(n!==a-2||0!==r||0===(3&o)||s)if(n!==a+4||2!==r||0!==(7&o)||l)if(n!==a-2||0!==r||4!==(7&o)||c){do{n<a&&r>=0&&!this.readMappingMatrix.get(r,n)&&(e[t++]=255&this.readUtah(n,r,a,o)),n-=2,r+=2}while(n>=0&&r<o);n+=1,r+=3;do{n>=0&&r<o&&!this.readMappingMatrix.get(r,n)&&(e[t++]=255&this.readUtah(n,r,a,o)),n+=2,r-=2}while(n<a&&r>=0);n+=3,r+=1}else e[t++]=255&this.readCorner4(a,o),n-=2,r+=2,c=!0;else e[t++]=255&this.readCorner3(a,o),n-=2,r+=2,l=!0;else e[t++]=255&this.readCorner2(a,o),n-=2,r+=2,s=!0;else e[t++]=255&this.readCorner1(a,o),n-=2,r+=2,i=!0}while(n<a||r<o);if(t!==this.version.getTotalCodewords())throw new Tu;return e},e.prototype.readModule=function(e,t,n,r){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=r,e+=4-(r+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)},e.prototype.readUtah=function(e,t,n,r){var a=0;return this.readModule(e-2,t-2,n,r)&&(a|=1),a<<=1,this.readModule(e-2,t-1,n,r)&&(a|=1),a<<=1,this.readModule(e-1,t-2,n,r)&&(a|=1),a<<=1,this.readModule(e-1,t-1,n,r)&&(a|=1),a<<=1,this.readModule(e-1,t,n,r)&&(a|=1),a<<=1,this.readModule(e,t-2,n,r)&&(a|=1),a<<=1,this.readModule(e,t-1,n,r)&&(a|=1),a<<=1,this.readModule(e,t,n,r)&&(a|=1),a},e.prototype.readCorner1=function(e,t){var n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n},e.prototype.readCorner2=function(e,t){var n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n},e.prototype.readCorner3=function(e,t){var n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n},e.prototype.readCorner4=function(e,t){var n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n},e.prototype.extractDataRegion=function(e){var t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new hu("Dimension of bitMatrix must match the version size");for(var r=this.version.getDataRegionSizeRows(),a=this.version.getDataRegionSizeColumns(),o=t/r|0,i=n/a|0,s=new Wu(i*a,o*r),l=0;l<o;++l)for(var c=l*r,u=0;u<i;++u)for(var d=u*a,h=0;h<r;++h)for(var p=l*(r+2)+1+h,f=c+h,m=0;m<a;++m){var g=u*(a+2)+1+m;if(e.get(g,p)){var x=d+m;s.set(x,f)}}return s},e}();var Yp=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},qp=function(){function e(e,t){this.numDataCodewords=e,this.codewords=t}return e.getDataBlocks=function(t,n){var r,a,o,i,s=n.getECBlocks(),l=0,c=s.getECBlocks();try{for(var u=Yp(c),d=u.next();!d.done;d=u.next()){l+=(g=d.value).getCount()}}catch(A){r={error:A}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}var h=new Array(l),p=0;try{for(var f=Yp(c),m=f.next();!m.done;m=f.next())for(var g=m.value,x=0;x<g.getCount();x++){var y=g.getDataCodewords(),v=s.getECCodewords()+y;h[p++]=new e(y,new Uint8Array(v))}}catch(I){o={error:I}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}var b=h[0].codewords.length-s.getECCodewords(),w=b-1,k=0;for(x=0;x<w;x++)for(var j=0;j<p;j++)h[j].codewords[x]=t[k++];var C=24===n.getVersionNumber(),N=C?8:p;for(j=0;j<N;j++)h[j].codewords[b-1]=t[k++];var _=h[0].codewords.length;for(x=b;x<_;x++)for(j=0;j<p;j++){var S=C?(j+8)%p:j,E=C&&S>7?x-1:x;h[S].codewords[E]=t[k++]}if(k!==t.length)throw new hu;return h},e.prototype.getNumDataCodewords=function(){return this.numDataCodewords},e.prototype.getCodewords=function(){return this.codewords},e}();const Zp=qp;const Jp=function(){function e(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return e.prototype.getBitOffset=function(){return this.bitOffset},e.prototype.getByteOffset=function(){return this.byteOffset},e.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new hu(""+e);var t=0,n=this.bitOffset,r=this.byteOffset,a=this.bytes;if(n>0){var o=8-n,i=e<o?e:o,s=255>>8-i<<(l=o-i);t=(a[r]&s)>>l,e-=i,8===(n+=i)&&(n=0,r++)}if(e>0){for(;e>=8;)t=t<<8|255&a[r],r++,e-=8;if(e>0){var l;s=255>>(l=8-e)<<l;t=t<<e|(a[r]&s)>>l,n+=e}}return this.bitOffset=n,this.byteOffset=r,t},e.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},e}();var Qp;!function(e){e[e.PAD_ENCODE=0]="PAD_ENCODE",e[e.ASCII_ENCODE=1]="ASCII_ENCODE",e[e.C40_ENCODE=2]="C40_ENCODE",e[e.TEXT_ENCODE=3]="TEXT_ENCODE",e[e.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",e[e.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",e[e.BASE256_ENCODE=6]="BASE256_ENCODE"}(Qp||(Qp={}));const $p=function(){function e(){}return e.decode=function(e){var t=new Jp(e),n=new zu,r=new zu,a=new Array,o=Qp.ASCII_ENCODE;do{if(o===Qp.ASCII_ENCODE)o=this.decodeAsciiSegment(t,n,r);else{switch(o){case Qp.C40_ENCODE:this.decodeC40Segment(t,n);break;case Qp.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case Qp.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case Qp.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case Qp.BASE256_ENCODE:this.decodeBase256Segment(t,n,a);break;default:throw new Tu}o=Qp.ASCII_ENCODE}}while(o!==Qp.PAD_ENCODE&&t.available()>0);return r.length()>0&&n.append(r.toString()),new ud(e,n.toString(),0===a.length?null:a,null)},e.decodeAsciiSegment=function(e,t,n){var r=!1;do{var a=e.readBits(8);if(0===a)throw new Tu;if(a<=128)return r&&(a+=128),t.append(String.fromCharCode(a-1)),Qp.ASCII_ENCODE;if(129===a)return Qp.PAD_ENCODE;if(a<=229){var o=a-130;o<10&&t.append("0"),t.append(""+o)}else switch(a){case 230:return Qp.C40_ENCODE;case 231:return Qp.BASE256_ENCODE;case 232:t.append(String.fromCharCode(29));break;case 233:case 234:case 241:break;case 235:r=!0;break;case 236:t.append("[)>\x1e05\x1d"),n.insert(0,"\x1e\x04");break;case 237:t.append("[)>\x1e06\x1d"),n.insert(0,"\x1e\x04");break;case 238:return Qp.ANSIX12_ENCODE;case 239:return Qp.TEXT_ENCODE;case 240:return Qp.EDIFACT_ENCODE;default:if(254!==a||0!==e.available())throw new Tu}}while(e.available()>0);return Qp.ASCII_ENCODE},e.decodeC40Segment=function(e,t){var n=!1,r=[],a=0;do{if(8===e.available())return;var o=e.readBits(8);if(254===o)return;this.parseTwoBytes(o,e.readBits(8),r);for(var i=0;i<3;i++){var s=r[i];switch(a){case 0:if(s<3)a=s+1;else{if(!(s<this.C40_BASIC_SET_CHARS.length))throw new Tu;var l=this.C40_BASIC_SET_CHARS[s];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}break;case 1:n?(t.append(String.fromCharCode(s+128)),n=!1):t.append(String.fromCharCode(s)),a=0;break;case 2:if(s<this.C40_SHIFT2_SET_CHARS.length){l=this.C40_SHIFT2_SET_CHARS[s];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else switch(s){case 27:t.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new Tu}a=0;break;case 3:n?(t.append(String.fromCharCode(s+224)),n=!1):t.append(String.fromCharCode(s+96)),a=0;break;default:throw new Tu}}}while(e.available()>0)},e.decodeTextSegment=function(e,t){var n=!1,r=[],a=0;do{if(8===e.available())return;var o=e.readBits(8);if(254===o)return;this.parseTwoBytes(o,e.readBits(8),r);for(var i=0;i<3;i++){var s=r[i];switch(a){case 0:if(s<3)a=s+1;else{if(!(s<this.TEXT_BASIC_SET_CHARS.length))throw new Tu;var l=this.TEXT_BASIC_SET_CHARS[s];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}break;case 1:n?(t.append(String.fromCharCode(s+128)),n=!1):t.append(String.fromCharCode(s)),a=0;break;case 2:if(s<this.TEXT_SHIFT2_SET_CHARS.length){l=this.TEXT_SHIFT2_SET_CHARS[s];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l)}else switch(s){case 27:t.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new Tu}a=0;break;case 3:if(!(s<this.TEXT_SHIFT3_SET_CHARS.length))throw new Tu;l=this.TEXT_SHIFT3_SET_CHARS[s];n?(t.append(String.fromCharCode(l.charCodeAt(0)+128)),n=!1):t.append(l),a=0;break;default:throw new Tu}}}while(e.available()>0)},e.decodeAnsiX12Segment=function(e,t){var n=[];do{if(8===e.available())return;var r=e.readBits(8);if(254===r)return;this.parseTwoBytes(r,e.readBits(8),n);for(var a=0;a<3;a++){var o=n[a];switch(o){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(o<14)t.append(String.fromCharCode(o+44));else{if(!(o<40))throw new Tu;t.append(String.fromCharCode(o+51))}}}}while(e.available()>0)},e.parseTwoBytes=function(e,t,n){var r=(e<<8)+t-1,a=Math.floor(r/1600);n[0]=a,r-=1600*a,a=Math.floor(r/40),n[1]=a,n[2]=r-40*a},e.decodeEdifactSegment=function(e,t){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var r=e.readBits(6);if(31===r){var a=8-e.getBitOffset();return void(8!==a&&e.readBits(a))}0===(32&r)&&(r|=64),t.append(String.fromCharCode(r))}}while(e.available()>0)},e.decodeBase256Segment=function(e,t,n){var r,a=1+e.getByteOffset(),o=this.unrandomize255State(e.readBits(8),a++);if((r=0===o?e.available()/8|0:o<250?o:250*(o-249)+this.unrandomize255State(e.readBits(8),a++))<0)throw new Tu;for(var i=new Uint8Array(r),s=0;s<r;s++){if(e.available()<8)throw new Tu;i[s]=this.unrandomize255State(e.readBits(8),a++)}n.push(i);try{t.append(Bu.decode(i,Lu.ISO88591))}catch(l){throw new wd("Platform does not support required encoding: "+l.message)}},e.unrandomize255State=function(e,t){var n=e-(149*t%255+1);return n>=0?n:n+256},e.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],e.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],e.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],e.TEXT_SHIFT2_SET_CHARS=e.C40_SHIFT2_SET_CHARS,e.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)],e}();var ef=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},tf=function(){function e(){this.rsDecoder=new jd(xd.DATA_MATRIX_FIELD_256)}return e.prototype.decode=function(e){var t,n,r=new Xp(e),a=r.getVersion(),o=r.readCodewords(),i=Zp.getDataBlocks(o,a),s=0;try{for(var l=ef(i),c=l.next();!c.done;c=l.next()){s+=c.value.getNumDataCodewords()}}catch(x){t={error:x}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}for(var u=new Uint8Array(s),d=i.length,h=0;h<d;h++){var p=i[h],f=p.getCodewords(),m=p.getNumDataCodewords();this.correctErrors(f,m);for(var g=0;g<m;g++)u[g*d+h]=f[g]}return $p.decode(u)},e.prototype.correctErrors=function(e,t){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch(a){throw new mu}for(var r=0;r<t;r++)e[r]=n[r]},e}();const nf=tf;var rf=function(){function e(e){this.image=e,this.rectangleDetector=new Pd(this.image)}return e.prototype.detect=function(){var t=this.rectangleDetector.detect(),n=this.detectSolid1(t);if((n=this.detectSolid2(n))[3]=this.correctTopRight(n),!n[3])throw new Uu;var r=(n=this.shiftToModuleCenter(n))[0],a=n[1],o=n[2],i=n[3],s=this.transitionsBetween(r,i)+1,l=this.transitionsBetween(o,i)+1;1===(1&s)&&(s+=1),1===(1&l)&&(l+=1),4*s<7*l&&4*l<7*s&&(s=l=Math.max(s,l));var c=e.sampleGrid(this.image,r,a,o,i,s,l);return new Ad(c,[r,a,o,i])},e.shiftPoint=function(e,t,n){var r=(t.getX()-e.getX())/(n+1),a=(t.getY()-e.getY())/(n+1);return new Ed(e.getX()+r,e.getY()+a)},e.moveAway=function(e,t,n){var r=e.getX(),a=e.getY();return r<t?r-=1:r+=1,a<n?a-=1:a+=1,new Ed(r,a)},e.prototype.detectSolid1=function(e){var t=e[0],n=e[1],r=e[3],a=e[2],o=this.transitionsBetween(t,n),i=this.transitionsBetween(n,r),s=this.transitionsBetween(r,a),l=this.transitionsBetween(a,t),c=o,u=[a,t,n,r];return c>i&&(c=i,u[0]=t,u[1]=n,u[2]=r,u[3]=a),c>s&&(c=s,u[0]=n,u[1]=r,u[2]=a,u[3]=t),c>l&&(u[0]=r,u[1]=a,u[2]=t,u[3]=n),u},e.prototype.detectSolid2=function(t){var n=t[0],r=t[1],a=t[2],o=t[3],i=this.transitionsBetween(n,o),s=e.shiftPoint(r,a,4*(i+1)),l=e.shiftPoint(a,r,4*(i+1));return this.transitionsBetween(s,n)<this.transitionsBetween(l,o)?(t[0]=n,t[1]=r,t[2]=a,t[3]=o):(t[0]=r,t[1]=a,t[2]=o,t[3]=n),t},e.prototype.correctTopRight=function(t){var n=t[0],r=t[1],a=t[2],o=t[3],i=this.transitionsBetween(n,o),s=this.transitionsBetween(r,o),l=e.shiftPoint(n,r,4*(s+1)),c=e.shiftPoint(a,r,4*(i+1));i=this.transitionsBetween(l,o),s=this.transitionsBetween(c,o);var u=new Ed(o.getX()+(a.getX()-r.getX())/(i+1),o.getY()+(a.getY()-r.getY())/(i+1)),d=new Ed(o.getX()+(n.getX()-r.getX())/(s+1),o.getY()+(n.getY()-r.getY())/(s+1));return this.isValid(u)?this.isValid(d)?this.transitionsBetween(l,u)+this.transitionsBetween(c,u)>this.transitionsBetween(l,d)+this.transitionsBetween(c,d)?u:d:u:this.isValid(d)?d:null},e.prototype.shiftToModuleCenter=function(t){var n=t[0],r=t[1],a=t[2],o=t[3],i=this.transitionsBetween(n,o)+1,s=this.transitionsBetween(a,o)+1,l=e.shiftPoint(n,r,4*s),c=e.shiftPoint(a,r,4*i);1===(1&(i=this.transitionsBetween(l,o)+1))&&(i+=1),1===(1&(s=this.transitionsBetween(c,o)+1))&&(s+=1);var u,d,h=(n.getX()+r.getX()+a.getX()+o.getX())/4,p=(n.getY()+r.getY()+a.getY()+o.getY())/4;return n=e.moveAway(n,h,p),r=e.moveAway(r,h,p),a=e.moveAway(a,h,p),o=e.moveAway(o,h,p),l=e.shiftPoint(n,r,4*s),l=e.shiftPoint(l,o,4*i),u=e.shiftPoint(r,n,4*s),u=e.shiftPoint(u,a,4*i),c=e.shiftPoint(a,o,4*s),c=e.shiftPoint(c,r,4*i),d=e.shiftPoint(o,a,4*s),[l,u,c,d=e.shiftPoint(d,n,4*i)]},e.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},e.sampleGrid=function(e,t,n,r,a,o,i){return Od.getInstance().sampleGrid(e,o,i,.5,.5,o-.5,.5,o-.5,i-.5,.5,i-.5,t.getX(),t.getY(),a.getX(),a.getY(),r.getX(),r.getY(),n.getX(),n.getY())},e.prototype.transitionsBetween=function(e,t){var n=Math.trunc(e.getX()),r=Math.trunc(e.getY()),a=Math.trunc(t.getX()),o=Math.trunc(t.getY()),i=Math.abs(o-r)>Math.abs(a-n);if(i){var s=n;n=r,r=s,s=a,a=o,o=s}for(var l=Math.abs(a-n),c=Math.abs(o-r),u=-l/2,d=r<o?1:-1,h=n<a?1:-1,p=0,f=this.image.get(i?r:n,i?n:r),m=n,g=r;m!==a;m+=h){var x=this.image.get(i?g:m,i?m:g);if(x!==f&&(p++,f=x),(u+=c)>0){if(g===o)break;g+=d,u-=l}}return p},e}();const af=rf;const of=function(){function e(){this.decoder=new nf}return e.prototype.decode=function(t,n){var r,a;if(void 0===n&&(n=null),null!=n&&n.has(Au.PURE_BARCODE)){var o=e.extractPureBits(t.getBlackMatrix());r=this.decoder.decode(o),a=e.NO_POINTS}else{var i=new af(t.getBlackMatrix()).detect();r=this.decoder.decode(i.getBits()),a=i.getPoints()}var s=r.getRawBytes(),l=new od(r.getText(),s,8*s.length,a,sd.DATA_MATRIX,yu.currentTimeMillis()),c=r.getByteSegments();null!=c&&l.putMetadata(cd.BYTE_SEGMENTS,c);var u=r.getECLevel();return null!=u&&l.putMetadata(cd.ERROR_CORRECTION_LEVEL,u),l},e.prototype.reset=function(){},e.extractPureBits=function(e){var t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(null==t||null==n)throw new Uu;var r=this.moduleSize(t,e),a=t[1],o=n[1],i=t[0],s=(n[0]-i+1)/r,l=(o-a+1)/r;if(s<=0||l<=0)throw new Uu;var c=r/2;a+=c,i+=c;for(var u=new Wu(s,l),d=0;d<l;d++)for(var h=a+d*r,p=0;p<s;p++)e.get(i+p*r,h)&&u.set(p,d);return u},e.moduleSize=function(e,t){for(var n=t.getWidth(),r=e[0],a=e[1];r<n&&t.get(r,a);)r++;if(r===n)throw new Uu;var o=r-e[0];if(0===o)throw new Uu;return o},e.NO_POINTS=[],e}();var sf,lf=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){function t(t){return void 0===t&&(t=500),e.call(this,new of,t)||this}lf(t,e)}(rd);!function(e){e[e.L=0]="L",e[e.M=1]="M",e[e.Q=2]="Q",e[e.H=3]="H"}(sf||(sf={}));const cf=function(){function e(t,n,r){this.value=t,this.stringValue=n,this.bits=r,e.FOR_BITS.set(r,this),e.FOR_VALUE.set(t,this)}return e.prototype.getValue=function(){return this.value},e.prototype.getBits=function(){return this.bits},e.fromString=function(t){switch(t){case"L":return e.L;case"M":return e.M;case"Q":return e.Q;case"H":return e.H;default:throw new uu(t+"not available")}},e.prototype.toString=function(){return this.stringValue},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;return this.value===n.value},e.forBits=function(t){if(t<0||t>=e.FOR_BITS.size)throw new hu;return e.FOR_BITS.get(t)},e.FOR_BITS=new Map,e.FOR_VALUE=new Map,e.L=new e(sf.L,"L",1),e.M=new e(sf.M,"M",0),e.Q=new e(sf.Q,"Q",3),e.H=new e(sf.H,"H",2),e}();var uf=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},df=function(){function e(e){this.errorCorrectionLevel=cf.forBits(e>>3&3),this.dataMask=7&e}return e.numBitsDiffering=function(e,t){return _u.bitCount(e^t)},e.decodeFormatInformation=function(t,n){var r=e.doDecodeFormatInformation(t,n);return null!==r?r:e.doDecodeFormatInformation(t^e.FORMAT_INFO_MASK_QR,n^e.FORMAT_INFO_MASK_QR)},e.doDecodeFormatInformation=function(t,n){var r,a,o=Number.MAX_SAFE_INTEGER,i=0;try{for(var s=uf(e.FORMAT_INFO_DECODE_LOOKUP),l=s.next();!l.done;l=s.next()){var c=l.value,u=c[0];if(u===t||u===n)return new e(c[1]);var d=e.numBitsDiffering(t,u);d<o&&(i=c[1],o=d),t!==n&&(d=e.numBitsDiffering(n,u))<o&&(i=c[1],o=d)}}catch(h){r={error:h}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}return o<=3?new e(i):null},e.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},e.prototype.getDataMask=function(){return this.dataMask},e.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;return this.errorCorrectionLevel===n.errorCorrectionLevel&&this.dataMask===n.dataMask},e.FORMAT_INFO_MASK_QR=21522,e.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],e}();const hf=df;var pf=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ff=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=t}return e.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},e.prototype.getNumBlocks=function(){var e,t,n=0,r=this.ecBlocks;try{for(var a=pf(r),o=a.next();!o.done;o=a.next()){n+=o.value.getCount()}}catch(i){e={error:i}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n},e.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},e.prototype.getECBlocks=function(){return this.ecBlocks},e}();const mf=ff;var gf=function(){function e(e,t){this.count=e,this.dataCodewords=t}return e.prototype.getCount=function(){return this.count},e.prototype.getDataCodewords=function(){return this.dataCodewords},e}();const xf=gf;var yf=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},vf=function(){function e(e,t){for(var n,r,a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=a;var i=0,s=a[0].getECCodewordsPerBlock(),l=a[0].getECBlocks();try{for(var c=yf(l),u=c.next();!u.done;u=c.next()){var d=u.value;i+=d.getCount()*(d.getDataCodewords()+s)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}this.totalCodewords=i}return e.prototype.getVersionNumber=function(){return this.versionNumber},e.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},e.prototype.getTotalCodewords=function(){return this.totalCodewords},e.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},e.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},e.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new Tu;try{return this.getVersionForNumber((e-17)/4)}catch(t){throw new Tu}},e.getVersionForNumber=function(t){if(t<1||t>40)throw new hu;return e.VERSIONS[t-1]},e.decodeVersionInformation=function(t){for(var n=Number.MAX_SAFE_INTEGER,r=0,a=0;a<e.VERSION_DECODE_INFO.length;a++){var o=e.VERSION_DECODE_INFO[a];if(o===t)return e.getVersionForNumber(a+7);var i=hf.numBitsDiffering(t,o);i<n&&(r=a+7,n=i)}return n<=3?e.getVersionForNumber(r):null},e.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),t=new Wu(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,r=0;r<n;r++)for(var a=this.alignmentPatternCenters[r]-2,o=0;o<n;o++)0===r&&(0===o||o===n-1)||r===n-1&&0===o||t.setRegion(this.alignmentPatternCenters[o]-2,a,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},e.prototype.toString=function(){return""+this.versionNumber},e.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),e.VERSIONS=[new e(1,new Int32Array(0),new mf(7,new xf(1,19)),new mf(10,new xf(1,16)),new mf(13,new xf(1,13)),new mf(17,new xf(1,9))),new e(2,Int32Array.from([6,18]),new mf(10,new xf(1,34)),new mf(16,new xf(1,28)),new mf(22,new xf(1,22)),new mf(28,new xf(1,16))),new e(3,Int32Array.from([6,22]),new mf(15,new xf(1,55)),new mf(26,new xf(1,44)),new mf(18,new xf(2,17)),new mf(22,new xf(2,13))),new e(4,Int32Array.from([6,26]),new mf(20,new xf(1,80)),new mf(18,new xf(2,32)),new mf(26,new xf(2,24)),new mf(16,new xf(4,9))),new e(5,Int32Array.from([6,30]),new mf(26,new xf(1,108)),new mf(24,new xf(2,43)),new mf(18,new xf(2,15),new xf(2,16)),new mf(22,new xf(2,11),new xf(2,12))),new e(6,Int32Array.from([6,34]),new mf(18,new xf(2,68)),new mf(16,new xf(4,27)),new mf(24,new xf(4,19)),new mf(28,new xf(4,15))),new e(7,Int32Array.from([6,22,38]),new mf(20,new xf(2,78)),new mf(18,new xf(4,31)),new mf(18,new xf(2,14),new xf(4,15)),new mf(26,new xf(4,13),new xf(1,14))),new e(8,Int32Array.from([6,24,42]),new mf(24,new xf(2,97)),new mf(22,new xf(2,38),new xf(2,39)),new mf(22,new xf(4,18),new xf(2,19)),new mf(26,new xf(4,14),new xf(2,15))),new e(9,Int32Array.from([6,26,46]),new mf(30,new xf(2,116)),new mf(22,new xf(3,36),new xf(2,37)),new mf(20,new xf(4,16),new xf(4,17)),new mf(24,new xf(4,12),new xf(4,13))),new e(10,Int32Array.from([6,28,50]),new mf(18,new xf(2,68),new xf(2,69)),new mf(26,new xf(4,43),new xf(1,44)),new mf(24,new xf(6,19),new xf(2,20)),new mf(28,new xf(6,15),new xf(2,16))),new e(11,Int32Array.from([6,30,54]),new mf(20,new xf(4,81)),new mf(30,new xf(1,50),new xf(4,51)),new mf(28,new xf(4,22),new xf(4,23)),new mf(24,new xf(3,12),new xf(8,13))),new e(12,Int32Array.from([6,32,58]),new mf(24,new xf(2,92),new xf(2,93)),new mf(22,new xf(6,36),new xf(2,37)),new mf(26,new xf(4,20),new xf(6,21)),new mf(28,new xf(7,14),new xf(4,15))),new e(13,Int32Array.from([6,34,62]),new mf(26,new xf(4,107)),new mf(22,new xf(8,37),new xf(1,38)),new mf(24,new xf(8,20),new xf(4,21)),new mf(22,new xf(12,11),new xf(4,12))),new e(14,Int32Array.from([6,26,46,66]),new mf(30,new xf(3,115),new xf(1,116)),new mf(24,new xf(4,40),new xf(5,41)),new mf(20,new xf(11,16),new xf(5,17)),new mf(24,new xf(11,12),new xf(5,13))),new e(15,Int32Array.from([6,26,48,70]),new mf(22,new xf(5,87),new xf(1,88)),new mf(24,new xf(5,41),new xf(5,42)),new mf(30,new xf(5,24),new xf(7,25)),new mf(24,new xf(11,12),new xf(7,13))),new e(16,Int32Array.from([6,26,50,74]),new mf(24,new xf(5,98),new xf(1,99)),new mf(28,new xf(7,45),new xf(3,46)),new mf(24,new xf(15,19),new xf(2,20)),new mf(30,new xf(3,15),new xf(13,16))),new e(17,Int32Array.from([6,30,54,78]),new mf(28,new xf(1,107),new xf(5,108)),new mf(28,new xf(10,46),new xf(1,47)),new mf(28,new xf(1,22),new xf(15,23)),new mf(28,new xf(2,14),new xf(17,15))),new e(18,Int32Array.from([6,30,56,82]),new mf(30,new xf(5,120),new xf(1,121)),new mf(26,new xf(9,43),new xf(4,44)),new mf(28,new xf(17,22),new xf(1,23)),new mf(28,new xf(2,14),new xf(19,15))),new e(19,Int32Array.from([6,30,58,86]),new mf(28,new xf(3,113),new xf(4,114)),new mf(26,new xf(3,44),new xf(11,45)),new mf(26,new xf(17,21),new xf(4,22)),new mf(26,new xf(9,13),new xf(16,14))),new e(20,Int32Array.from([6,34,62,90]),new mf(28,new xf(3,107),new xf(5,108)),new mf(26,new xf(3,41),new xf(13,42)),new mf(30,new xf(15,24),new xf(5,25)),new mf(28,new xf(15,15),new xf(10,16))),new e(21,Int32Array.from([6,28,50,72,94]),new mf(28,new xf(4,116),new xf(4,117)),new mf(26,new xf(17,42)),new mf(28,new xf(17,22),new xf(6,23)),new mf(30,new xf(19,16),new xf(6,17))),new e(22,Int32Array.from([6,26,50,74,98]),new mf(28,new xf(2,111),new xf(7,112)),new mf(28,new xf(17,46)),new mf(30,new xf(7,24),new xf(16,25)),new mf(24,new xf(34,13))),new e(23,Int32Array.from([6,30,54,78,102]),new mf(30,new xf(4,121),new xf(5,122)),new mf(28,new xf(4,47),new xf(14,48)),new mf(30,new xf(11,24),new xf(14,25)),new mf(30,new xf(16,15),new xf(14,16))),new e(24,Int32Array.from([6,28,54,80,106]),new mf(30,new xf(6,117),new xf(4,118)),new mf(28,new xf(6,45),new xf(14,46)),new mf(30,new xf(11,24),new xf(16,25)),new mf(30,new xf(30,16),new xf(2,17))),new e(25,Int32Array.from([6,32,58,84,110]),new mf(26,new xf(8,106),new xf(4,107)),new mf(28,new xf(8,47),new xf(13,48)),new mf(30,new xf(7,24),new xf(22,25)),new mf(30,new xf(22,15),new xf(13,16))),new e(26,Int32Array.from([6,30,58,86,114]),new mf(28,new xf(10,114),new xf(2,115)),new mf(28,new xf(19,46),new xf(4,47)),new mf(28,new xf(28,22),new xf(6,23)),new mf(30,new xf(33,16),new xf(4,17))),new e(27,Int32Array.from([6,34,62,90,118]),new mf(30,new xf(8,122),new xf(4,123)),new mf(28,new xf(22,45),new xf(3,46)),new mf(30,new xf(8,23),new xf(26,24)),new mf(30,new xf(12,15),new xf(28,16))),new e(28,Int32Array.from([6,26,50,74,98,122]),new mf(30,new xf(3,117),new xf(10,118)),new mf(28,new xf(3,45),new xf(23,46)),new mf(30,new xf(4,24),new xf(31,25)),new mf(30,new xf(11,15),new xf(31,16))),new e(29,Int32Array.from([6,30,54,78,102,126]),new mf(30,new xf(7,116),new xf(7,117)),new mf(28,new xf(21,45),new xf(7,46)),new mf(30,new xf(1,23),new xf(37,24)),new mf(30,new xf(19,15),new xf(26,16))),new e(30,Int32Array.from([6,26,52,78,104,130]),new mf(30,new xf(5,115),new xf(10,116)),new mf(28,new xf(19,47),new xf(10,48)),new mf(30,new xf(15,24),new xf(25,25)),new mf(30,new xf(23,15),new xf(25,16))),new e(31,Int32Array.from([6,30,56,82,108,134]),new mf(30,new xf(13,115),new xf(3,116)),new mf(28,new xf(2,46),new xf(29,47)),new mf(30,new xf(42,24),new xf(1,25)),new mf(30,new xf(23,15),new xf(28,16))),new e(32,Int32Array.from([6,34,60,86,112,138]),new mf(30,new xf(17,115)),new mf(28,new xf(10,46),new xf(23,47)),new mf(30,new xf(10,24),new xf(35,25)),new mf(30,new xf(19,15),new xf(35,16))),new e(33,Int32Array.from([6,30,58,86,114,142]),new mf(30,new xf(17,115),new xf(1,116)),new mf(28,new xf(14,46),new xf(21,47)),new mf(30,new xf(29,24),new xf(19,25)),new mf(30,new xf(11,15),new xf(46,16))),new e(34,Int32Array.from([6,34,62,90,118,146]),new mf(30,new xf(13,115),new xf(6,116)),new mf(28,new xf(14,46),new xf(23,47)),new mf(30,new xf(44,24),new xf(7,25)),new mf(30,new xf(59,16),new xf(1,17))),new e(35,Int32Array.from([6,30,54,78,102,126,150]),new mf(30,new xf(12,121),new xf(7,122)),new mf(28,new xf(12,47),new xf(26,48)),new mf(30,new xf(39,24),new xf(14,25)),new mf(30,new xf(22,15),new xf(41,16))),new e(36,Int32Array.from([6,24,50,76,102,128,154]),new mf(30,new xf(6,121),new xf(14,122)),new mf(28,new xf(6,47),new xf(34,48)),new mf(30,new xf(46,24),new xf(10,25)),new mf(30,new xf(2,15),new xf(64,16))),new e(37,Int32Array.from([6,28,54,80,106,132,158]),new mf(30,new xf(17,122),new xf(4,123)),new mf(28,new xf(29,46),new xf(14,47)),new mf(30,new xf(49,24),new xf(10,25)),new mf(30,new xf(24,15),new xf(46,16))),new e(38,Int32Array.from([6,32,58,84,110,136,162]),new mf(30,new xf(4,122),new xf(18,123)),new mf(28,new xf(13,46),new xf(32,47)),new mf(30,new xf(48,24),new xf(14,25)),new mf(30,new xf(42,15),new xf(32,16))),new e(39,Int32Array.from([6,26,54,82,110,138,166]),new mf(30,new xf(20,117),new xf(4,118)),new mf(28,new xf(40,47),new xf(7,48)),new mf(30,new xf(43,24),new xf(22,25)),new mf(30,new xf(10,15),new xf(67,16))),new e(40,Int32Array.from([6,30,58,86,114,142,170]),new mf(30,new xf(19,118),new xf(6,119)),new mf(28,new xf(18,47),new xf(31,48)),new mf(30,new xf(34,24),new xf(34,25)),new mf(30,new xf(20,15),new xf(61,16)))],e}();const bf=vf;var wf;!function(e){e[e.DATA_MASK_000=0]="DATA_MASK_000",e[e.DATA_MASK_001=1]="DATA_MASK_001",e[e.DATA_MASK_010=2]="DATA_MASK_010",e[e.DATA_MASK_011=3]="DATA_MASK_011",e[e.DATA_MASK_100=4]="DATA_MASK_100",e[e.DATA_MASK_101=5]="DATA_MASK_101",e[e.DATA_MASK_110=6]="DATA_MASK_110",e[e.DATA_MASK_111=7]="DATA_MASK_111"}(wf||(wf={}));const kf=function(){function e(e,t){this.value=e,this.isMasked=t}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e.values=new Map([[wf.DATA_MASK_000,new e(wf.DATA_MASK_000,function(e,t){return 0===(e+t&1)})],[wf.DATA_MASK_001,new e(wf.DATA_MASK_001,function(e,t){return 0===(1&e)})],[wf.DATA_MASK_010,new e(wf.DATA_MASK_010,function(e,t){return t%3===0})],[wf.DATA_MASK_011,new e(wf.DATA_MASK_011,function(e,t){return(e+t)%3===0})],[wf.DATA_MASK_100,new e(wf.DATA_MASK_100,function(e,t){return 0===(Math.floor(e/2)+Math.floor(t/3)&1)})],[wf.DATA_MASK_101,new e(wf.DATA_MASK_101,function(e,t){return e*t%6===0})],[wf.DATA_MASK_110,new e(wf.DATA_MASK_110,function(e,t){return e*t%6<3})],[wf.DATA_MASK_111,new e(wf.DATA_MASK_111,function(e,t){return 0===(e+t+e*t%3&1)})]]),e}();var jf=function(){function e(e){var t=e.getHeight();if(t<21||1!==(3&t))throw new Tu;this.bitMatrix=e}return e.prototype.readFormatInformation=function(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);var r=this.bitMatrix.getHeight(),a=0,o=r-7;for(n=r-1;n>=o;n--)a=this.copyBit(8,n,a);for(t=r-8;t<r;t++)a=this.copyBit(t,8,a);if(this.parsedFormatInfo=hf.decodeFormatInformation(e,a),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new Tu},e.prototype.readVersion=function(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return bf.getVersionForNumber(t);for(var n=0,r=e-11,a=5;a>=0;a--)for(var o=e-9;o>=r;o--)n=this.copyBit(o,a,n);var i=bf.decodeVersionInformation(n);if(null!==i&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;n=0;for(o=5;o>=0;o--)for(a=e-9;a>=r;a--)n=this.copyBit(o,a,n);if(null!==(i=bf.decodeVersionInformation(n))&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;throw new Tu},e.prototype.copyBit=function(e,t,n){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?n<<1|1:n<<1},e.prototype.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=kf.values.get(e.getDataMask()),r=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,r);for(var a=t.buildFunctionPattern(),o=!0,i=new Uint8Array(t.getTotalCodewords()),s=0,l=0,c=0,u=r-1;u>0;u-=2){6===u&&u--;for(var d=0;d<r;d++)for(var h=o?r-1-d:d,p=0;p<2;p++)a.get(u-p,h)||(c++,l<<=1,this.bitMatrix.get(u-p,h)&&(l|=1),8===c&&(i[s++]=l,c=0,l=0));o=!o}if(s!==t.getTotalCodewords())throw new Tu;return i},e.prototype.remask=function(){if(null!==this.parsedFormatInfo){var e=kf.values.get(this.parsedFormatInfo.getDataMask()),t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}},e.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},e.prototype.mirror=function(){for(var e=this.bitMatrix,t=0,n=e.getWidth();t<n;t++)for(var r=t+1,a=e.getHeight();r<a;r++)e.get(t,r)!==e.get(r,t)&&(e.flip(r,t),e.flip(t,r))},e}();const Cf=jf;var Nf=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_f=function(){function e(e,t){this.numDataCodewords=e,this.codewords=t}return e.getDataBlocks=function(t,n,r){var a,o,i,s;if(t.length!==n.getTotalCodewords())throw new hu;var l=n.getECBlocksForLevel(r),c=0,u=l.getECBlocks();try{for(var d=Nf(u),h=d.next();!h.done;h=d.next()){c+=(x=h.value).getCount()}}catch(E){a={error:E}}finally{try{h&&!h.done&&(o=d.return)&&o.call(d)}finally{if(a)throw a.error}}var p=new Array(c),f=0;try{for(var m=Nf(u),g=m.next();!g.done;g=m.next())for(var x=g.value,y=0;y<x.getCount();y++){var v=x.getDataCodewords(),b=l.getECCodewordsPerBlock()+v;p[f++]=new e(v,new Uint8Array(b))}}catch(A){i={error:A}}finally{try{g&&!g.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}for(var w=p[0].codewords.length,k=p.length-1;k>=0;){if(p[k].codewords.length===w)break;k--}k++;var j=w-l.getECCodewordsPerBlock(),C=0;for(y=0;y<j;y++)for(var N=0;N<f;N++)p[N].codewords[y]=t[C++];for(N=k;N<f;N++)p[N].codewords[j]=t[C++];var _=p[0].codewords.length;for(y=j;y<_;y++)for(N=0;N<f;N++){var S=N<k?y:y+1;p[N].codewords[S]=t[C++]}return p},e.prototype.getNumDataCodewords=function(){return this.numDataCodewords},e.prototype.getCodewords=function(){return this.codewords},e}();const Sf=_f;var Ef;!function(e){e[e.TERMINATOR=0]="TERMINATOR",e[e.NUMERIC=1]="NUMERIC",e[e.ALPHANUMERIC=2]="ALPHANUMERIC",e[e.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",e[e.BYTE=4]="BYTE",e[e.ECI=5]="ECI",e[e.KANJI=6]="KANJI",e[e.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",e[e.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",e[e.HANZI=9]="HANZI"}(Ef||(Ef={}));var Af=function(){function e(t,n,r,a){this.value=t,this.stringValue=n,this.characterCountBitsForVersions=r,this.bits=a,e.FOR_BITS.set(a,this),e.FOR_VALUE.set(t,this)}return e.forBits=function(t){var n=e.FOR_BITS.get(t);if(void 0===n)throw new hu;return n},e.prototype.getCharacterCountBits=function(e){var t,n=e.getVersionNumber();return t=n<=9?0:n<=26?1:2,this.characterCountBitsForVersions[t]},e.prototype.getValue=function(){return this.value},e.prototype.getBits=function(){return this.bits},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;return this.value===n.value},e.prototype.toString=function(){return this.stringValue},e.FOR_BITS=new Map,e.FOR_VALUE=new Map,e.TERMINATOR=new e(Ef.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),e.NUMERIC=new e(Ef.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),e.ALPHANUMERIC=new e(Ef.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),e.STRUCTURED_APPEND=new e(Ef.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),e.BYTE=new e(Ef.BYTE,"BYTE",Int32Array.from([8,16,16]),4),e.ECI=new e(Ef.ECI,"ECI",Int32Array.from([0,0,0]),7),e.KANJI=new e(Ef.KANJI,"KANJI",Int32Array.from([8,10,12]),8),e.FNC1_FIRST_POSITION=new e(Ef.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),e.FNC1_SECOND_POSITION=new e(Ef.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),e.HANZI=new e(Ef.HANZI,"HANZI",Int32Array.from([8,10,12]),13),e}();const If=Af;var Tf=function(){function e(){}return e.decode=function(t,n,r,a){var o=new Jp(t),i=new zu,s=new Array,l=-1,c=-1;try{var u=null,d=!1,h=void 0;do{if(o.available()<4)h=If.TERMINATOR;else{var p=o.readBits(4);h=If.forBits(p)}switch(h){case If.TERMINATOR:break;case If.FNC1_FIRST_POSITION:case If.FNC1_SECOND_POSITION:d=!0;break;case If.STRUCTURED_APPEND:if(o.available()<16)throw new Tu;l=o.readBits(8),c=o.readBits(8);break;case If.ECI:var f=e.parseECIValue(o);if(null===(u=Ru.getCharacterSetECIByValue(f)))throw new Tu;break;case If.HANZI:var m=o.readBits(4),g=o.readBits(h.getCharacterCountBits(n));m===e.GB2312_SUBSET&&e.decodeHanziSegment(o,i,g);break;default:var x=o.readBits(h.getCharacterCountBits(n));switch(h){case If.NUMERIC:e.decodeNumericSegment(o,i,x);break;case If.ALPHANUMERIC:e.decodeAlphanumericSegment(o,i,x,d);break;case If.BYTE:e.decodeByteSegment(o,i,x,u,s,a);break;case If.KANJI:e.decodeKanjiSegment(o,i,x);break;default:throw new Tu}}}while(h!==If.TERMINATOR)}catch(y){throw new Tu}return new ud(t,i.toString(),0===s.length?null:s,null===r?null:r.toString(),l,c)},e.decodeHanziSegment=function(e,t,n){if(13*n>e.available())throw new Tu;for(var r=new Uint8Array(2*n),a=0;n>0;){var o=e.readBits(13),i=o/96<<8&4294967295|o%96;i+=i<959?41377:42657,r[a]=i>>8&255,r[a+1]=255&i,a+=2,n--}try{t.append(Bu.decode(r,Lu.GB2312))}catch(s){throw new Tu(s)}},e.decodeKanjiSegment=function(e,t,n){if(13*n>e.available())throw new Tu;for(var r=new Uint8Array(2*n),a=0;n>0;){var o=e.readBits(13),i=o/192<<8&4294967295|o%192;i+=i<7936?33088:49472,r[a]=i>>8,r[a+1]=i,a+=2,n--}try{t.append(Bu.decode(r,Lu.SHIFT_JIS))}catch(s){throw new Tu(s)}},e.decodeByteSegment=function(e,t,n,r,a,o){if(8*n>e.available())throw new Tu;for(var i,s=new Uint8Array(n),l=0;l<n;l++)s[l]=e.readBits(8);i=null===r?Lu.guessEncoding(s,o):r.getName();try{t.append(Bu.decode(s,i))}catch(c){throw new Tu(c)}a.push(s)},e.toAlphaNumericChar=function(t){if(t>=e.ALPHANUMERIC_CHARS.length)throw new Tu;return e.ALPHANUMERIC_CHARS[t]},e.decodeAlphanumericSegment=function(t,n,r,a){for(var o=n.length();r>1;){if(t.available()<11)throw new Tu;var i=t.readBits(11);n.append(e.toAlphaNumericChar(Math.floor(i/45))),n.append(e.toAlphaNumericChar(i%45)),r-=2}if(1===r){if(t.available()<6)throw new Tu;n.append(e.toAlphaNumericChar(t.readBits(6)))}if(a)for(var s=o;s<n.length();s++)"%"===n.charAt(s)&&(s<n.length()-1&&"%"===n.charAt(s+1)?n.deleteCharAt(s+1):n.setCharAt(s,String.fromCharCode(29)))},e.decodeNumericSegment=function(t,n,r){for(;r>=3;){if(t.available()<10)throw new Tu;var a=t.readBits(10);if(a>=1e3)throw new Tu;n.append(e.toAlphaNumericChar(Math.floor(a/100))),n.append(e.toAlphaNumericChar(Math.floor(a/10)%10)),n.append(e.toAlphaNumericChar(a%10)),r-=3}if(2===r){if(t.available()<7)throw new Tu;var o=t.readBits(7);if(o>=100)throw new Tu;n.append(e.toAlphaNumericChar(Math.floor(o/10))),n.append(e.toAlphaNumericChar(o%10))}else if(1===r){if(t.available()<4)throw new Tu;var i=t.readBits(4);if(i>=10)throw new Tu;n.append(e.toAlphaNumericChar(i))}},e.parseECIValue=function(e){var t=e.readBits(8);if(0===(128&t))return 127&t;if(128===(192&t))return(63&t)<<8&4294967295|e.readBits(8);if(192===(224&t))return(31&t)<<16&4294967295|e.readBits(16);throw new Tu},e.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e.GB2312_SUBSET=1,e}();const Pf=Tf;const Df=function(){function e(e){this.mirrored=e}return e.prototype.isMirrored=function(){return this.mirrored},e.prototype.applyMirroredCorrection=function(e){if(this.mirrored&&null!==e&&!(e.length<3)){var t=e[0];e[0]=e[2],e[2]=t}},e}();var Mf=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Rf=function(){function e(){this.rsDecoder=new jd(xd.QR_CODE_FIELD_256)}return e.prototype.decodeBooleanArray=function(e,t){return this.decodeBitMatrix(Wu.parseFromBooleanArray(e),t)},e.prototype.decodeBitMatrix=function(e,t){var n=new Cf(e),r=null;try{return this.decodeBitMatrixParser(n,t)}catch(Z_){r=Z_}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var a=this.decodeBitMatrixParser(n,t);return a.setOther(new Df(!0)),a}catch(Z_){if(null!==r)throw r;throw Z_}},e.prototype.decodeBitMatrixParser=function(e,t){var n,r,a,o,i=e.readVersion(),s=e.readFormatInformation().getErrorCorrectionLevel(),l=e.readCodewords(),c=Sf.getDataBlocks(l,i,s),u=0;try{for(var d=Mf(c),h=d.next();!h.done;h=d.next()){u+=(x=h.value).getNumDataCodewords()}}catch(w){n={error:w}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var p=new Uint8Array(u),f=0;try{for(var m=Mf(c),g=m.next();!g.done;g=m.next()){var x,y=(x=g.value).getCodewords(),v=x.getNumDataCodewords();this.correctErrors(y,v);for(var b=0;b<v;b++)p[f++]=y[b]}}catch(k){a={error:k}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(a)throw a.error}}return Pf.decode(p,i,s,t)},e.prototype.correctErrors=function(e,t){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch(a){throw new mu}for(var r=0;r<t;r++)e[r]=n[r]},e}();const Ff=Rf;var Of=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Bf=function(e){function t(t,n,r){var a=e.call(this,t,n)||this;return a.estimatedModuleSize=r,a}return Of(t,e),t.prototype.aboutEquals=function(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){var r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1},t.prototype.combineEstimate=function(e,n,r){return new t((this.getX()+n)/2,(this.getY()+e)/2,(this.estimatedModuleSize+r)/2)},t}(Ed);var Lf=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},zf=function(){function e(e,t,n,r,a,o,i){this.image=e,this.startX=t,this.startY=n,this.width=r,this.height=a,this.moduleSize=o,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return e.prototype.find=function(){for(var e=this.startX,t=this.height,n=e+this.width,r=this.startY+t/2,a=new Int32Array(3),o=this.image,i=0;i<t;i++){var s=r+(0===(1&i)?Math.floor((i+1)/2):-Math.floor((i+1)/2));a[0]=0,a[1]=0,a[2]=0;for(var l=e;l<n&&!o.get(l,s);)l++;for(var c=0;l<n;){if(o.get(l,s))if(1===c)a[1]++;else if(2===c){var u;if(this.foundPatternCross(a))if(null!==(u=this.handlePossibleCenter(a,s,l)))return u;a[0]=a[2],a[1]=1,a[2]=0,c=1}else a[++c]++;else 1===c&&c++,a[c]++;l++}if(this.foundPatternCross(a))if(null!==(u=this.handlePossibleCenter(a,s,n)))return u}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new Uu},e.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},e.prototype.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0},e.prototype.crossCheckVertical=function(t,n,r,a){var o=this.image,i=o.getHeight(),s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;for(var l=t;l>=0&&o.get(n,l)&&s[1]<=r;)s[1]++,l--;if(l<0||s[1]>r)return NaN;for(;l>=0&&!o.get(n,l)&&s[0]<=r;)s[0]++,l--;if(s[0]>r)return NaN;for(l=t+1;l<i&&o.get(n,l)&&s[1]<=r;)s[1]++,l++;if(l===i||s[1]>r)return NaN;for(;l<i&&!o.get(n,l)&&s[2]<=r;)s[2]++,l++;if(s[2]>r)return NaN;var c=s[0]+s[1]+s[2];return 5*Math.abs(c-a)>=2*a?NaN:this.foundPatternCross(s)?e.centerFromEnd(s,l):NaN},e.prototype.handlePossibleCenter=function(t,n,r){var a,o,i=t[0]+t[1]+t[2],s=e.centerFromEnd(t,r),l=this.crossCheckVertical(n,s,2*t[1],i);if(!isNaN(l)){var c=(t[0]+t[1]+t[2])/3;try{for(var u=Lf(this.possibleCenters),d=u.next();!d.done;d=u.next()){var h=d.value;if(h.aboutEquals(c,l,s))return h.combineEstimate(l,s,c)}}catch(f){a={error:f}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}var p=new Bf(s,l,c);this.possibleCenters.push(p),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(p)}return null},e}();const Wf=zf;var Vf=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Uf=function(e){function t(t,n,r,a){var o=e.call(this,t,n)||this;return o.estimatedModuleSize=r,o.count=a,void 0===a&&(o.count=1),o}return Vf(t,e),t.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},t.prototype.getCount=function(){return this.count},t.prototype.aboutEquals=function(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){var r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1},t.prototype.combineEstimate=function(e,n,r){var a=this.count+1;return new t((this.count*this.getX()+n)/a,(this.count*this.getY()+e)/a,(this.count*this.estimatedModuleSize+r)/a,a)},t}(Ed);const Hf=Uf;const Gf=function(){function e(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return e.prototype.getBottomLeft=function(){return this.bottomLeft},e.prototype.getTopLeft=function(){return this.topLeft},e.prototype.getTopRight=function(){return this.topRight},e}();var Kf=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Xf=function(){function e(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}return e.prototype.getImage=function(){return this.image},e.prototype.getPossibleCenters=function(){return this.possibleCenters},e.prototype.find=function(t){var n=null!==t&&void 0!==t&&void 0!==t.get(Au.TRY_HARDER),r=null!==t&&void 0!==t&&void 0!==t.get(Au.PURE_BARCODE),a=this.image,o=a.getHeight(),i=a.getWidth(),s=Math.floor(3*o/(4*e.MAX_MODULES));(s<e.MIN_SKIP||n)&&(s=e.MIN_SKIP);for(var l=!1,c=new Int32Array(5),u=s-1;u<o&&!l;u+=s){c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0;for(var d=0,h=0;h<i;h++)if(a.get(h,u))1===(1&d)&&d++,c[d]++;else if(0===(1&d))if(4===d)if(e.foundPatternCross(c)){if(!0!==this.handlePossibleCenter(c,u,h,r)){c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,d=3;continue}if(s=2,!0===this.hasSkipped)l=this.haveMultiplyConfirmedCenters();else{var p=this.findRowSkip();p>c[2]&&(u+=p-c[2]-s,h=i-1)}d=0,c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0}else c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,d=3;else c[++d]++;else c[d]++;if(e.foundPatternCross(c))!0===this.handlePossibleCenter(c,u,i,r)&&(s=c[0],this.hasSkipped&&(l=this.haveMultiplyConfirmedCenters()))}var f=this.selectBestPatterns();return Ed.orderBestPatterns(f),new Gf(f)},e.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},e.foundPatternCross=function(e){for(var t=0,n=0;n<5;n++){var r=e[n];if(0===r)return!1;t+=r}if(t<7)return!1;var a=t/7,o=a/2;return Math.abs(a-e[0])<o&&Math.abs(a-e[1])<o&&Math.abs(3*a-e[2])<3*o&&Math.abs(a-e[3])<o&&Math.abs(a-e[4])<o},e.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},e.prototype.crossCheckDiagonal=function(t,n,r,a){for(var o=this.getCrossCheckStateCount(),i=0,s=this.image;t>=i&&n>=i&&s.get(n-i,t-i);)o[2]++,i++;if(t<i||n<i)return!1;for(;t>=i&&n>=i&&!s.get(n-i,t-i)&&o[1]<=r;)o[1]++,i++;if(t<i||n<i||o[1]>r)return!1;for(;t>=i&&n>=i&&s.get(n-i,t-i)&&o[0]<=r;)o[0]++,i++;if(o[0]>r)return!1;var l=s.getHeight(),c=s.getWidth();for(i=1;t+i<l&&n+i<c&&s.get(n+i,t+i);)o[2]++,i++;if(t+i>=l||n+i>=c)return!1;for(;t+i<l&&n+i<c&&!s.get(n+i,t+i)&&o[3]<r;)o[3]++,i++;if(t+i>=l||n+i>=c||o[3]>=r)return!1;for(;t+i<l&&n+i<c&&s.get(n+i,t+i)&&o[4]<r;)o[4]++,i++;if(o[4]>=r)return!1;var u=o[0]+o[1]+o[2]+o[3]+o[4];return Math.abs(u-a)<2*a&&e.foundPatternCross(o)},e.prototype.crossCheckVertical=function(t,n,r,a){for(var o=this.image,i=o.getHeight(),s=this.getCrossCheckStateCount(),l=t;l>=0&&o.get(n,l);)s[2]++,l--;if(l<0)return NaN;for(;l>=0&&!o.get(n,l)&&s[1]<=r;)s[1]++,l--;if(l<0||s[1]>r)return NaN;for(;l>=0&&o.get(n,l)&&s[0]<=r;)s[0]++,l--;if(s[0]>r)return NaN;for(l=t+1;l<i&&o.get(n,l);)s[2]++,l++;if(l===i)return NaN;for(;l<i&&!o.get(n,l)&&s[3]<r;)s[3]++,l++;if(l===i||s[3]>=r)return NaN;for(;l<i&&o.get(n,l)&&s[4]<r;)s[4]++,l++;if(s[4]>=r)return NaN;var c=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(c-a)>=2*a?NaN:e.foundPatternCross(s)?e.centerFromEnd(s,l):NaN},e.prototype.crossCheckHorizontal=function(t,n,r,a){for(var o=this.image,i=o.getWidth(),s=this.getCrossCheckStateCount(),l=t;l>=0&&o.get(l,n);)s[2]++,l--;if(l<0)return NaN;for(;l>=0&&!o.get(l,n)&&s[1]<=r;)s[1]++,l--;if(l<0||s[1]>r)return NaN;for(;l>=0&&o.get(l,n)&&s[0]<=r;)s[0]++,l--;if(s[0]>r)return NaN;for(l=t+1;l<i&&o.get(l,n);)s[2]++,l++;if(l===i)return NaN;for(;l<i&&!o.get(l,n)&&s[3]<r;)s[3]++,l++;if(l===i||s[3]>=r)return NaN;for(;l<i&&o.get(l,n)&&s[4]<r;)s[4]++,l++;if(s[4]>=r)return NaN;var c=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(c-a)>=a?NaN:e.foundPatternCross(s)?e.centerFromEnd(s,l):NaN},e.prototype.handlePossibleCenter=function(t,n,r,a){var o=t[0]+t[1]+t[2]+t[3]+t[4],i=e.centerFromEnd(t,r),s=this.crossCheckVertical(n,Math.floor(i),t[2],o);if(!isNaN(s)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(s),t[2],o),!isNaN(i)&&(!a||this.crossCheckDiagonal(Math.floor(s),Math.floor(i),t[2],o)))){for(var l=o/7,c=!1,u=this.possibleCenters,d=0,h=u.length;d<h;d++){var p=u[d];if(p.aboutEquals(l,s,i)){u[d]=p.combineEstimate(s,i,l),c=!0;break}}if(!c){var f=new Hf(i,s,l);u.push(f),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(f)}return!0}return!1},e.prototype.findRowSkip=function(){var t,n;if(this.possibleCenters.length<=1)return 0;var r=null;try{for(var a=Kf(this.possibleCenters),o=a.next();!o.done;o=a.next()){var i=o.value;if(i.getCount()>=e.CENTER_QUORUM){if(null!=r)return this.hasSkipped=!0,Math.floor((Math.abs(r.getX()-i.getX())-Math.abs(r.getY()-i.getY()))/2);r=i}}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return 0},e.prototype.haveMultiplyConfirmedCenters=function(){var t,n,r,a,o=0,i=0,s=this.possibleCenters.length;try{for(var l=Kf(this.possibleCenters),c=l.next();!c.done;c=l.next()){(f=c.value).getCount()>=e.CENTER_QUORUM&&(o++,i+=f.getEstimatedModuleSize())}}catch(m){t={error:m}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}if(o<3)return!1;var u=i/s,d=0;try{for(var h=Kf(this.possibleCenters),p=h.next();!p.done;p=h.next()){var f=p.value;d+=Math.abs(f.getEstimatedModuleSize()-u)}}catch(g){r={error:g}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(r)throw r.error}}return d<=.05*i},e.prototype.selectBestPatterns=function(){var e,t,n,r,a=this.possibleCenters.length;if(a<3)throw new Uu;var o,i=this.possibleCenters;if(a>3){var s=0,l=0;try{for(var c=Kf(this.possibleCenters),u=c.next();!u.done;u=c.next()){var d=u.value.getEstimatedModuleSize();s+=d,l+=d*d}}catch(y){e={error:y}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}o=s/a;var h=Math.sqrt(l/a-o*o);i.sort(function(e,t){var n=Math.abs(t.getEstimatedModuleSize()-o),r=Math.abs(e.getEstimatedModuleSize()-o);return n<r?-1:n>r?1:0});for(var p=Math.max(.2*o,h),f=0;f<i.length&&i.length>3;f++){var m=i[f];Math.abs(m.getEstimatedModuleSize()-o)>p&&(i.splice(f,1),f--)}}if(i.length>3){s=0;try{for(var g=Kf(i),x=g.next();!x.done;x=g.next()){s+=x.value.getEstimatedModuleSize()}}catch(v){n={error:v}}finally{try{x&&!x.done&&(r=g.return)&&r.call(g)}finally{if(n)throw n.error}}o=s/i.length,i.sort(function(e,t){if(t.getCount()===e.getCount()){var n=Math.abs(t.getEstimatedModuleSize()-o),r=Math.abs(e.getEstimatedModuleSize()-o);return n<r?1:n>r?-1:0}return t.getCount()-e.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]},e.CENTER_QUORUM=2,e.MIN_SKIP=3,e.MAX_MODULES=57,e}();const Yf=Xf;var qf=function(){function e(e){this.image=e}return e.prototype.getImage=function(){return this.image},e.prototype.getResultPointCallback=function(){return this.resultPointCallback},e.prototype.detect=function(e){this.resultPointCallback=null===e||void 0===e?null:e.get(Au.NEED_RESULT_POINT_CALLBACK);var t=new Yf(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(t)},e.prototype.processFinderPatternInfo=function(t){var n=t.getTopLeft(),r=t.getTopRight(),a=t.getBottomLeft(),o=this.calculateModuleSize(n,r,a);if(o<1)throw new Uu("No pattern found in proccess finder.");var i=e.computeDimension(n,r,a,o),s=bf.getProvisionalVersionForDimension(i),l=s.getDimensionForVersion()-7,c=null;if(s.getAlignmentPatternCenters().length>0)for(var u=r.getX()-n.getX()+a.getX(),d=r.getY()-n.getY()+a.getY(),h=1-3/l,p=Math.floor(n.getX()+h*(u-n.getX())),f=Math.floor(n.getY()+h*(d-n.getY())),m=4;m<=16;m<<=1)try{c=this.findAlignmentInRegion(o,p,f,m);break}catch(y){if(!(y instanceof Uu))throw y}var g=e.createTransform(n,r,a,c,i),x=e.sampleGrid(this.image,g,i);return new Ad(x,null===c?[a,n,r]:[a,n,r,c])},e.createTransform=function(e,t,n,r,a){var o,i,s,l,c=a-3.5;return null!==r?(o=r.getX(),i=r.getY(),l=s=c-3):(o=t.getX()-e.getX()+n.getX(),i=t.getY()-e.getY()+n.getY(),s=c,l=c),Md.quadrilateralToQuadrilateral(3.5,3.5,c,3.5,s,l,3.5,c,e.getX(),e.getY(),t.getX(),t.getY(),o,i,n.getX(),n.getY())},e.sampleGrid=function(e,t,n){return Od.getInstance().sampleGridWithTransform(e,n,n,t)},e.computeDimension=function(e,t,n,r){var a=_d.round(Ed.distance(e,t)/r),o=_d.round(Ed.distance(e,n)/r),i=Math.floor((a+o)/2)+7;switch(3&i){case 0:i++;break;case 2:i--;break;case 3:throw new Uu("Dimensions could be not found.")}return i},e.prototype.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},e.prototype.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14},e.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,r){var a=this.sizeOfBlackWhiteBlackRun(e,t,n,r),o=1,i=e-(n-e);i<0?(o=e/(e-i),i=0):i>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(i-e),i=this.image.getWidth()-1);var s=Math.floor(t-(r-t)*o);return o=1,s<0?(o=t/(t-s),s=0):s>=this.image.getHeight()&&(o=(this.image.getHeight()-1-t)/(s-t),s=this.image.getHeight()-1),i=Math.floor(e+(i-e)*o),(a+=this.sizeOfBlackWhiteBlackRun(e,t,i,s))-1},e.prototype.sizeOfBlackWhiteBlackRun=function(e,t,n,r){var a=Math.abs(r-t)>Math.abs(n-e);if(a){var o=e;e=t,t=o,o=n,n=r,r=o}for(var i=Math.abs(n-e),s=Math.abs(r-t),l=-i/2,c=e<n?1:-1,u=t<r?1:-1,d=0,h=n+c,p=e,f=t;p!==h;p+=c){var m=a?f:p,g=a?p:f;if(1===d===this.image.get(m,g)){if(2===d)return _d.distance(p,f,e,t);d++}if((l+=s)>0){if(f===r)break;f+=u,l-=i}}return 2===d?_d.distance(n+c,r,e,t):NaN},e.prototype.findAlignmentInRegion=function(e,t,n,r){var a=Math.floor(r*e),o=Math.max(0,t-a),i=Math.min(this.image.getWidth()-1,t+a);if(i-o<3*e)throw new Uu("Alignment top exceeds estimated module size.");var s=Math.max(0,n-a),l=Math.min(this.image.getHeight()-1,n+a);if(l-s<3*e)throw new Uu("Alignment bottom exceeds estimated module size.");return new Wf(this.image,o,s,i-o,l-s,e,this.resultPointCallback).find()},e}();const Zf=qf;const Jf=function(){function e(){this.decoder=new Ff}return e.prototype.getDecoder=function(){return this.decoder},e.prototype.decode=function(t,n){var r,a;if(void 0!==n&&null!==n&&void 0!==n.get(Au.PURE_BARCODE)){var o=e.extractPureBits(t.getBlackMatrix());r=this.decoder.decodeBitMatrix(o,n),a=e.NO_POINTS}else{var i=new Zf(t.getBlackMatrix()).detect(n);r=this.decoder.decodeBitMatrix(i.getBits(),n),a=i.getPoints()}r.getOther()instanceof Df&&r.getOther().applyMirroredCorrection(a);var s=new od(r.getText(),r.getRawBytes(),void 0,a,sd.QR_CODE,void 0),l=r.getByteSegments();null!==l&&s.putMetadata(cd.BYTE_SEGMENTS,l);var c=r.getECLevel();return null!==c&&s.putMetadata(cd.ERROR_CORRECTION_LEVEL,c),r.hasStructuredAppend()&&(s.putMetadata(cd.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),s.putMetadata(cd.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),s},e.prototype.reset=function(){},e.extractPureBits=function(e){var t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(null===t||null===n)throw new Uu;var r=this.moduleSize(t,e),a=t[1],o=n[1],i=t[0],s=n[0];if(i>=s||a>=o)throw new Uu;if(o-a!==s-i&&(s=i+(o-a))>=e.getWidth())throw new Uu;var l=Math.round((s-i+1)/r),c=Math.round((o-a+1)/r);if(l<=0||c<=0)throw new Uu;if(c!==l)throw new Uu;var u=Math.floor(r/2);a+=u;var d=(i+=u)+Math.floor((l-1)*r)-s;if(d>0){if(d>u)throw new Uu;i-=d}var h=a+Math.floor((c-1)*r)-o;if(h>0){if(h>u)throw new Uu;a-=h}for(var p=new Wu(l,c),f=0;f<c;f++)for(var m=a+Math.floor(f*r),g=0;g<l;g++)e.get(i+Math.floor(g*r),m)&&p.set(g,f);return p},e.moduleSize=function(e,t){for(var n=t.getHeight(),r=t.getWidth(),a=e[0],o=e[1],i=!0,s=0;a<r&&o<n;){if(i!==t.get(a,o)){if(5===++s)break;i=!i}a++,o++}if(a===r||o===n)throw new Uu;return(a-e[0])/7},e.NO_POINTS=new Array,e}();var Qf=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$f=function(){function e(){}return e.prototype.PDF417Common=function(){},e.getBitCountSum=function(e){return _d.sum(e)},e.toIntArray=function(t){var n,r;if(null==t||!t.length)return e.EMPTY_INT_ARRAY;var a=new Int32Array(t.length),o=0;try{for(var i=Qf(t),s=i.next();!s.done;s=i.next()){var l=s.value;a[o++]=l}}catch(c){n={error:c}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},e.getCodeword=function(t){var n=Nu.binarySearch(e.SYMBOL_TABLE,262143&t);return n<0?-1:(e.CODEWORD_TABLE[n]-1)%e.NUMBER_OF_CODEWORDS},e.NUMBER_OF_CODEWORDS=929,e.MAX_CODEWORDS_IN_BARCODE=e.NUMBER_OF_CODEWORDS-1,e.MIN_ROWS_IN_BARCODE=3,e.MAX_ROWS_IN_BARCODE=90,e.MODULES_IN_CODEWORD=17,e.MODULES_IN_STOP_PATTERN=18,e.BARS_IN_MODULE=8,e.EMPTY_INT_ARRAY=new Int32Array([]),e.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),e.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),e}();const em=$f;const tm=function(){function e(e,t){this.bits=e,this.points=t}return e.prototype.getBits=function(){return this.bits},e.prototype.getPoints=function(){return this.points},e}();var nm=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},rm=function(){function e(){}return e.detectMultiple=function(t,n,r){var a=t.getBlackMatrix(),o=e.detect(r,a);return o.length||((a=a.clone()).rotate180(),o=e.detect(r,a)),new tm(a,o)},e.detect=function(t,n){for(var r,a,o=new Array,i=0,s=0,l=!1;i<n.getHeight();){var c=e.findVertices(n,i,s);if(null!=c[0]||null!=c[3]){if(l=!0,o.push(c),!t)break;null!=c[2]?(s=Math.trunc(c[2].getX()),i=Math.trunc(c[2].getY())):(s=Math.trunc(c[4].getX()),i=Math.trunc(c[4].getY()))}else{if(!l)break;l=!1,s=0;try{for(var u=(r=void 0,nm(o)),d=u.next();!d.done;d=u.next()){var h=d.value;null!=h[1]&&(i=Math.trunc(Math.max(i,h[1].getY()))),null!=h[3]&&(i=Math.max(i,Math.trunc(h[3].getY())))}}catch(p){r={error:p}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}i+=e.ROW_STEP}}return o},e.findVertices=function(t,n,r){var a=t.getHeight(),o=t.getWidth(),i=new Array(8);return e.copyToResult(i,e.findRowsWithPattern(t,a,o,n,r,e.START_PATTERN),e.INDEXES_START_PATTERN),null!=i[4]&&(r=Math.trunc(i[4].getX()),n=Math.trunc(i[4].getY())),e.copyToResult(i,e.findRowsWithPattern(t,a,o,n,r,e.STOP_PATTERN),e.INDEXES_STOP_PATTERN),i},e.copyToResult=function(e,t,n){for(var r=0;r<n.length;r++)e[n[r]]=t[r]},e.findRowsWithPattern=function(t,n,r,a,o,i){for(var s=new Array(4),l=!1,c=new Int32Array(i.length);a<n;a+=e.ROW_STEP){if(null!=(p=e.findGuardPattern(t,o,a,r,!1,i,c))){for(;a>0;){if(null==(h=e.findGuardPattern(t,o,--a,r,!1,i,c))){a++;break}p=h}s[0]=new Ed(p[0],a),s[1]=new Ed(p[1],a),l=!0;break}}var u=a+1;if(l){for(var d=0,h=Int32Array.from([Math.trunc(s[0].getX()),Math.trunc(s[1].getX())]);u<n;u++){var p;if(null!=(p=e.findGuardPattern(t,h[0],u,r,!1,i,c))&&Math.abs(h[0]-p[0])<e.MAX_PATTERN_DRIFT&&Math.abs(h[1]-p[1])<e.MAX_PATTERN_DRIFT)h=p,d=0;else{if(d>e.SKIPPED_ROW_COUNT_MAX)break;d++}}u-=d+1,s[2]=new Ed(h[0],u),s[3]=new Ed(h[1],u)}return u-a<e.BARCODE_MIN_HEIGHT&&Nu.fill(s,null),s},e.findGuardPattern=function(t,n,r,a,o,i,s){Nu.fillWithin(s,0,s.length,0);for(var l=n,c=0;t.get(l,r)&&l>0&&c++<e.MAX_PIXEL_DRIFT;)l--;for(var u=l,d=0,h=i.length,p=o;u<a;u++){if(t.get(u,r)!==p)s[d]++;else{if(d===h-1){if(e.patternMatchVariance(s,i,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return new Int32Array([l,u]);l+=s[0]+s[1],yu.arraycopy(s,2,s,0,d-1),s[d-1]=0,s[d]=0,d--}else d++;s[d]=1,p=!p}}return d===h-1&&e.patternMatchVariance(s,i,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE?new Int32Array([l,u-1]):null},e.patternMatchVariance=function(e,t,n){for(var r=e.length,a=0,o=0,i=0;i<r;i++)a+=e[i],o+=t[i];if(a<o)return 1/0;var s=a/o;n*=s;for(var l=0,c=0;c<r;c++){var u=e[c],d=t[c]*s,h=u>d?u-d:d-u;if(h>n)return 1/0;l+=h}return l/a},e.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),e.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),e.MAX_AVG_VARIANCE=.42,e.MAX_INDIVIDUAL_VARIANCE=.8,e.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),e.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),e.MAX_PIXEL_DRIFT=3,e.MAX_PATTERN_DRIFT=5,e.SKIPPED_ROW_COUNT_MAX=25,e.ROW_STEP=5,e.BARCODE_MIN_HEIGHT=10,e}();const am=rm;var om=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},im=function(){function e(e,t){if(0===t.length)throw new hu;this.field=e;var n=t.length;if(n>1&&0===t[0]){for(var r=1;r<n&&0===t[r];)r++;r===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-r),yu.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return e.prototype.getCoefficients=function(){return this.coefficients},e.prototype.getDegree=function(){return this.coefficients.length-1},e.prototype.isZero=function(){return 0===this.coefficients[0]},e.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},e.prototype.evaluateAt=function(e){var t,n;if(0===e)return this.getCoefficient(0);if(1===e){var r=0;try{for(var a=om(this.coefficients),o=a.next();!o.done;o=a.next()){var i=o.value;r=this.field.add(r,i)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}for(var s=this.coefficients[0],l=this.coefficients.length,c=1;c<l;c++)s=this.field.add(this.field.multiply(e,s),this.coefficients[c]);return s},e.prototype.add=function(t){if(!this.field.equals(t.field))throw new hu("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;var n=this.coefficients,r=t.coefficients;if(n.length>r.length){var a=n;n=r,r=a}var o=new Int32Array(r.length),i=r.length-n.length;yu.arraycopy(r,0,o,0,i);for(var s=i;s<r.length;s++)o[s]=this.field.add(n[s-i],r[s]);return new e(this.field,o)},e.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new hu("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},e.prototype.multiply=function(t){return t instanceof e?this.multiplyOther(t):this.multiplyScalar(t)},e.prototype.multiplyOther=function(t){if(!this.field.equals(t.field))throw new hu("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new e(this.field,new Int32Array([0]));for(var n=this.coefficients,r=n.length,a=t.coefficients,o=a.length,i=new Int32Array(r+o-1),s=0;s<r;s++)for(var l=n[s],c=0;c<o;c++)i[s+c]=this.field.add(i[s+c],this.field.multiply(l,a[c]));return new e(this.field,i)},e.prototype.negative=function(){for(var t=this.coefficients.length,n=new Int32Array(t),r=0;r<t;r++)n[r]=this.field.subtract(0,this.coefficients[r]);return new e(this.field,n)},e.prototype.multiplyScalar=function(t){if(0===t)return new e(this.field,new Int32Array([0]));if(1===t)return this;for(var n=this.coefficients.length,r=new Int32Array(n),a=0;a<n;a++)r[a]=this.field.multiply(this.coefficients[a],t);return new e(this.field,r)},e.prototype.multiplyByMonomial=function(t,n){if(t<0)throw new hu;if(0===n)return new e(this.field,new Int32Array([0]));for(var r=this.coefficients.length,a=new Int32Array(r+t),o=0;o<r;o++)a[o]=this.field.multiply(this.coefficients[o],n);return new e(this.field,a)},e.prototype.toString=function(){for(var e=new zu,t=this.getDegree();t>=0;t--){var n=this.getCoefficient(t);0!==n&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),0!==t&&1===n||e.append(n),0!==t&&(1===t?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()},e}();const sm=im;const lm=function(){function e(){}return e.prototype.add=function(e,t){return(e+t)%this.modulus},e.prototype.subtract=function(e,t){return(this.modulus+e-t)%this.modulus},e.prototype.exp=function(e){return this.expTable[e]},e.prototype.log=function(e){if(0===e)throw new hu;return this.logTable[e]},e.prototype.inverse=function(e){if(0===e)throw new md;return this.expTable[this.modulus-this.logTable[e]-1]},e.prototype.multiply=function(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]},e.prototype.getSize=function(){return this.modulus},e.prototype.equals=function(e){return e===this},e}();var cm=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const um=function(e){function t(t,n){var r=e.call(this)||this;r.modulus=t,r.expTable=new Int32Array(t),r.logTable=new Int32Array(t);for(var a=1,o=0;o<t;o++)r.expTable[o]=a,a=a*n%t;for(o=0;o<t-1;o++)r.logTable[r.expTable[o]]=o;return r.zero=new sm(r,new Int32Array([0])),r.one=new sm(r,new Int32Array([1])),r}return cm(t,e),t.prototype.getZero=function(){return this.zero},t.prototype.getOne=function(){return this.one},t.prototype.buildMonomial=function(e,t){if(e<0)throw new hu;if(0===t)return this.zero;var n=new Int32Array(e+1);return n[0]=t,new sm(this,n)},t.PDF417_GF=new t(em.NUMBER_OF_CODEWORDS,3),t}(lm);var dm=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},hm=function(){function e(){this.field=um.PDF417_GF}return e.prototype.decode=function(e,t,n){for(var r,a,o=new sm(this.field,e),i=new Int32Array(t),s=!1,l=t;l>0;l--){var c=o.evaluateAt(this.field.exp(l));i[t-l]=c,0!==c&&(s=!0)}if(!s)return 0;var u=this.field.getOne();if(null!=n)try{for(var d=dm(n),h=d.next();!h.done;h=d.next()){var p=h.value,f=this.field.exp(e.length-1-p),m=new sm(this.field,new Int32Array([this.field.subtract(0,f),1]));u=u.multiply(m)}}catch(j){r={error:j}}finally{try{h&&!h.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}var g=new sm(this.field,i),x=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),g,t),y=x[0],v=x[1],b=this.findErrorLocations(y),w=this.findErrorMagnitudes(v,y,b);for(l=0;l<b.length;l++){var k=e.length-1-this.field.log(b[l]);if(k<0)throw mu.getChecksumInstance();e[k]=this.field.subtract(e[k],w[l])}return b.length},e.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.getDegree()<t.getDegree()){var r=e;e=t,t=r}for(var a=e,o=t,i=this.field.getZero(),s=this.field.getOne();o.getDegree()>=Math.round(n/2);){var l=a,c=i;if(i=s,(a=o).isZero())throw mu.getChecksumInstance();o=l;for(var u=this.field.getZero(),d=a.getCoefficient(a.getDegree()),h=this.field.inverse(d);o.getDegree()>=a.getDegree()&&!o.isZero();){var p=o.getDegree()-a.getDegree(),f=this.field.multiply(o.getCoefficient(o.getDegree()),h);u=u.add(this.field.buildMonomial(p,f)),o=o.subtract(a.multiplyByMonomial(p,f))}s=u.multiply(i).subtract(c).negative()}var m=s.getCoefficient(0);if(0===m)throw mu.getChecksumInstance();var g=this.field.inverse(m);return[s.multiply(g),o.multiply(g)]},e.prototype.findErrorLocations=function(e){for(var t=e.getDegree(),n=new Int32Array(t),r=0,a=1;a<this.field.getSize()&&r<t;a++)0===e.evaluateAt(a)&&(n[r]=this.field.inverse(a),r++);if(r!==t)throw mu.getChecksumInstance();return n},e.prototype.findErrorMagnitudes=function(e,t,n){for(var r=t.getDegree(),a=new Int32Array(r),o=1;o<=r;o++)a[r-o]=this.field.multiply(o,t.getCoefficient(o));var i=new sm(this.field,a),s=n.length,l=new Int32Array(s);for(o=0;o<s;o++){var c=this.field.inverse(n[o]),u=this.field.subtract(0,e.evaluateAt(c)),d=this.field.inverse(i.evaluateAt(c));l[o]=this.field.multiply(u,d)}return l},e}();const pm=hm;const fm=function(){function e(t,n,r,a,o){t instanceof e?this.constructor_2(t):this.constructor_1(t,n,r,a,o)}return e.prototype.constructor_1=function(e,t,n,r,a){var o=null==t||null==n,i=null==r||null==a;if(o&&i)throw new Uu;o?(t=new Ed(0,r.getY()),n=new Ed(0,a.getY())):i&&(r=new Ed(e.getWidth()-1,t.getY()),a=new Ed(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=r,this.bottomRight=a,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(r.getX(),a.getX())),this.minY=Math.trunc(Math.min(t.getY(),r.getY())),this.maxY=Math.trunc(Math.max(n.getY(),a.getY()))},e.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},e.merge=function(t,n){return null==t?n:null==n?t:new e(t.image,t.topLeft,t.bottomLeft,n.topRight,n.bottomRight)},e.prototype.addMissingRows=function(t,n,r){var a=this.topLeft,o=this.bottomLeft,i=this.topRight,s=this.bottomRight;if(t>0){var l=r?this.topLeft:this.topRight,c=Math.trunc(l.getY()-t);c<0&&(c=0);var u=new Ed(l.getX(),c);r?a=u:i=u}if(n>0){var d=r?this.bottomLeft:this.bottomRight,h=Math.trunc(d.getY()+n);h>=this.image.getHeight()&&(h=this.image.getHeight()-1);var p=new Ed(d.getX(),h);r?o=p:s=p}return new e(this.image,a,o,i,s)},e.prototype.getMinX=function(){return this.minX},e.prototype.getMaxX=function(){return this.maxX},e.prototype.getMinY=function(){return this.minY},e.prototype.getMaxY=function(){return this.maxY},e.prototype.getTopLeft=function(){return this.topLeft},e.prototype.getTopRight=function(){return this.topRight},e.prototype.getBottomLeft=function(){return this.bottomLeft},e.prototype.getBottomRight=function(){return this.bottomRight},e}();const mm=function(){function e(e,t,n,r){this.columnCount=e,this.errorCorrectionLevel=r,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}return e.prototype.getColumnCount=function(){return this.columnCount},e.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},e.prototype.getRowCount=function(){return this.rowCount},e.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},e.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},e}();const gm=function(){function e(){this.buffer=""}return e.form=function(e,t){var n=-1;return e.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(e,r,a,o,i,s){if("%%"===e)return"%";if(void 0!==t[++n]){e=o?parseInt(o.substr(1)):void 0;var l,c=i?parseInt(i.substr(1)):void 0;switch(s){case"s":l=t[n];break;case"c":l=t[n][0];break;case"f":l=parseFloat(t[n]).toFixed(e);break;case"p":l=parseFloat(t[n]).toPrecision(e);break;case"e":l=parseFloat(t[n]).toExponential(e);break;case"x":l=parseInt(t[n]).toString(c||16);break;case"d":l=parseFloat(parseInt(t[n],c||10).toPrecision(e)).toFixed(0)}l="object"===typeof l?JSON.stringify(l):(+l).toString(c);for(var u=parseInt(a),d=a&&a[0]+""==="0"?"0":" ";l.length<u;)l=void 0!==r?l+d:d+l;return l}})},e.prototype.format=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.buffer+=e.form(t,n)},e.prototype.toString=function(){return this.buffer},e}();var xm=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ym=function(){function e(e){this.boundingBox=new fm(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return e.prototype.getCodewordNearby=function(t){var n=this.getCodeword(t);if(null!=n)return n;for(var r=1;r<e.MAX_NEARBY_DISTANCE;r++){var a=this.imageRowToCodewordIndex(t)-r;if(a>=0&&null!=(n=this.codewords[a]))return n;if((a=this.imageRowToCodewordIndex(t)+r)<this.codewords.length&&null!=(n=this.codewords[a]))return n}return null},e.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},e.prototype.setCodeword=function(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t},e.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},e.prototype.getBoundingBox=function(){return this.boundingBox},e.prototype.getCodewords=function(){return this.codewords},e.prototype.toString=function(){var e,t,n=new gm,r=0;try{for(var a=xm(this.codewords),o=a.next();!o.done;o=a.next()){var i=o.value;null!=i?n.format("%3d: %3d|%3d%n",r++,i.getRowNumber(),i.getValue()):n.format("%3d:    |   %n",r++)}}catch(s){e={error:s}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n.toString()},e.MAX_NEARBY_DISTANCE=5,e}();const vm=ym;var bm=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},wm=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i},km=function(){function e(){this.values=new Map}return e.prototype.setValue=function(e){e=Math.trunc(e);var t=this.values.get(e);null==t&&(t=0),t++,this.values.set(e,t)},e.prototype.getValue=function(){var e,t,n=-1,r=new Array,a=function(e,t){var a=function(){return e},o=function(){return t};o()>n?(n=o(),(r=[]).push(a())):o()===n&&r.push(a())};try{for(var o=bm(this.values.entries()),i=o.next();!i.done;i=o.next()){var s=wm(i.value,2);a(s[0],s[1])}}catch(l){e={error:l}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return em.toIntArray(r)},e.prototype.getConfidence=function(e){return this.values.get(e)},e}();const jm=km;var Cm=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nm=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_m=function(e){function t(t,n){var r=e.call(this,t)||this;return r._isLeft=n,r}return Cm(t,e),t.prototype.setRowNumbers=function(){var e,t;try{for(var n=Nm(this.getCodewords()),r=n.next();!r.done;r=n.next()){var a=r.value;null!=a&&a.setRowNumberAsRowIndicatorColumn()}}catch(o){e={error:o}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t.prototype.adjustCompleteIndicatorColumnRowNumbers=function(e){var t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);for(var n=this.getBoundingBox(),r=this._isLeft?n.getTopLeft():n.getTopRight(),a=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),i=this.imageRowToCodewordIndex(Math.trunc(a.getY())),s=-1,l=1,c=0,u=o;u<i;u++)if(null!=t[u]){var d=t[u],h=d.getRowNumber()-s;if(0===h)c++;else if(1===h)l=Math.max(l,c),c=1,s=d.getRowNumber();else if(h<0||d.getRowNumber()>=e.getRowCount()||h>u)t[u]=null;else{for(var p=void 0,f=(p=l>2?(l-2)*h:h)>=u,m=1;m<=p&&!f;m++)f=null!=t[u-m];f?t[u]=null:(s=d.getRowNumber(),c=1)}}},t.prototype.getRowHeights=function(){var e,t,n=this.getBarcodeMetadata();if(null==n)return null;this.adjustIncompleteIndicatorColumnRowNumbers(n);var r=new Int32Array(n.getRowCount());try{for(var a=Nm(this.getCodewords()),o=a.next();!o.done;o=a.next()){var i=o.value;if(null!=i){var s=i.getRowNumber();if(s>=r.length)continue;r[s]++}}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return r},t.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(e){for(var t=this.getBoundingBox(),n=this._isLeft?t.getTopLeft():t.getTopRight(),r=this._isLeft?t.getBottomLeft():t.getBottomRight(),a=this.imageRowToCodewordIndex(Math.trunc(n.getY())),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),i=this.getCodewords(),s=-1,l=1,c=0,u=a;u<o;u++)if(null!=i[u]){var d=i[u];d.setRowNumberAsRowIndicatorColumn();var h=d.getRowNumber()-s;0===h?c++:1===h?(l=Math.max(l,c),c=1,s=d.getRowNumber()):d.getRowNumber()>=e.getRowCount()?i[u]=null:(s=d.getRowNumber(),c=1)}},t.prototype.getBarcodeMetadata=function(){var e,t,n=this.getCodewords(),r=new jm,a=new jm,o=new jm,i=new jm;try{for(var s=Nm(n),l=s.next();!l.done;l=s.next()){var c=l.value;if(null!=c){c.setRowNumberAsRowIndicatorColumn();var u=c.getValue()%30,d=c.getRowNumber();switch(this._isLeft||(d+=2),d%3){case 0:a.setValue(3*u+1);break;case 1:i.setValue(u/3),o.setValue(u%3);break;case 2:r.setValue(u+1)}}}}catch(p){e={error:p}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}if(0===r.getValue().length||0===a.getValue().length||0===o.getValue().length||0===i.getValue().length||r.getValue()[0]<1||a.getValue()[0]+o.getValue()[0]<em.MIN_ROWS_IN_BARCODE||a.getValue()[0]+o.getValue()[0]>em.MAX_ROWS_IN_BARCODE)return null;var h=new mm(r.getValue()[0],a.getValue()[0],o.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(n,h),h},t.prototype.removeIncorrectCodewords=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(null!=e[n]){var a=r.getValue()%30,o=r.getRowNumber();if(o>t.getRowCount())e[n]=null;else switch(this._isLeft||(o+=2),o%3){case 0:3*a+1!==t.getRowCountUpperPart()&&(e[n]=null);break;case 1:Math.trunc(a/3)===t.getErrorCorrectionLevel()&&a%3===t.getRowCountLowerPart()||(e[n]=null);break;case 2:a+1!==t.getColumnCount()&&(e[n]=null)}}}},t.prototype.isLeft=function(){return this._isLeft},t.prototype.toString=function(){return"IsLeft: "+this._isLeft+"\n"+e.prototype.toString.call(this)},t}(vm);const Sm=_m;var Em=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Am=function(){function e(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return e.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e,t=em.MAX_CODEWORDS_IN_BARCODE;do{e=t,t=this.adjustRowNumbersAndGetCount()}while(t>0&&t<e);return this.detectionResultColumns},e.prototype.adjustIndicatorColumnRowNumbers=function(e){null!=e&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},e.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(0===e)return 0;for(var t=1;t<this.barcodeColumnCount+1;t++)for(var n=this.detectionResultColumns[t].getCodewords(),r=0;r<n.length;r++)null!=n[r]&&(n[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,n));return e},e.prototype.adjustRowNumbersByRow=function(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()},e.prototype.adjustRowNumbersFromBothRI=function(){if(null!=this.detectionResultColumns[0]&&null!=this.detectionResultColumns[this.barcodeColumnCount+1])for(var e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(null!=e[n]&&null!=t[n]&&e[n].getRowNumber()===t[n].getRowNumber())for(var r=1;r<=this.barcodeColumnCount;r++){var a=this.detectionResultColumns[r].getCodewords()[n];null!=a&&(a.setRowNumber(e[n].getRowNumber()),a.hasValidRowNumber()||(this.detectionResultColumns[r].getCodewords()[n]=null))}},e.prototype.adjustRowNumbersFromRRI=function(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;for(var t=0,n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),r=0;r<n.length;r++)if(null!=n[r])for(var a=n[r].getRowNumber(),o=0,i=this.barcodeColumnCount+1;i>0&&o<this.ADJUST_ROW_NUMBER_SKIP;i--){var s=this.detectionResultColumns[i].getCodewords()[r];null!=s&&(o=e.adjustRowNumberIfValid(a,o,s),s.hasValidRowNumber()||t++)}return t},e.prototype.adjustRowNumbersFromLRI=function(){if(null==this.detectionResultColumns[0])return 0;for(var t=0,n=this.detectionResultColumns[0].getCodewords(),r=0;r<n.length;r++)if(null!=n[r])for(var a=n[r].getRowNumber(),o=0,i=1;i<this.barcodeColumnCount+1&&o<this.ADJUST_ROW_NUMBER_SKIP;i++){var s=this.detectionResultColumns[i].getCodewords()[r];null!=s&&(o=e.adjustRowNumberIfValid(a,o,s),s.hasValidRowNumber()||t++)}return t},e.adjustRowNumberIfValid=function(e,t,n){return null==n||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t},e.prototype.adjustRowNumbers=function(t,n,r){var a,o;if(null!=this.detectionResultColumns[t-1]){var i=r[n],s=this.detectionResultColumns[t-1].getCodewords(),l=s;null!=this.detectionResultColumns[t+1]&&(l=this.detectionResultColumns[t+1].getCodewords());var c=new Array(14);c[2]=s[n],c[3]=l[n],n>0&&(c[0]=r[n-1],c[4]=s[n-1],c[5]=l[n-1]),n>1&&(c[8]=r[n-2],c[10]=s[n-2],c[11]=l[n-2]),n<r.length-1&&(c[1]=r[n+1],c[6]=s[n+1],c[7]=l[n+1]),n<r.length-2&&(c[9]=r[n+2],c[12]=s[n+2],c[13]=l[n+2]);try{for(var u=Em(c),d=u.next();!d.done;d=u.next()){var h=d.value;if(e.adjustRowNumber(i,h))return}}catch(p){a={error:p}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}}},e.adjustRowNumber=function(e,t){return null!=t&&(!(!t.hasValidRowNumber()||t.getBucket()!==e.getBucket())&&(e.setRowNumber(t.getRowNumber()),!0))},e.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},e.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},e.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},e.prototype.setBoundingBox=function(e){this.boundingBox=e},e.prototype.getBoundingBox=function(){return this.boundingBox},e.prototype.setDetectionResultColumn=function(e,t){this.detectionResultColumns[e]=t},e.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},e.prototype.toString=function(){var e=this.detectionResultColumns[0];null==e&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var t=new gm,n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(var r=0;r<this.barcodeColumnCount+2;r++)if(null!=this.detectionResultColumns[r]){var a=this.detectionResultColumns[r].getCodewords()[n];null!=a?t.format(" %3d|%3d",a.getRowNumber(),a.getValue()):t.format("    |   ")}else t.format("    |   ");t.format("%n")}return t.toString()},e}();const Im=Am;const Tm=function(){function e(t,n,r,a){this.rowNumber=e.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(t),this.endX=Math.trunc(n),this.bucket=Math.trunc(r),this.value=Math.trunc(a)}return e.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},e.prototype.isValidRowNumber=function(t){return t!==e.BARCODE_ROW_UNKNOWN&&this.bucket===t%3*3},e.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))},e.prototype.getWidth=function(){return this.endX-this.startX},e.prototype.getStartX=function(){return this.startX},e.prototype.getEndX=function(){return this.endX},e.prototype.getBucket=function(){return this.bucket},e.prototype.getValue=function(){return this.value},e.prototype.getRowNumber=function(){return this.rowNumber},e.prototype.setRowNumber=function(e){this.rowNumber=e},e.prototype.toString=function(){return this.rowNumber+"|"+this.value},e.BARCODE_ROW_UNKNOWN=-1,e}();const Pm=function(){function e(){}return e.initialize=function(){for(var t=0;t<em.SYMBOL_TABLE.length;t++)for(var n=em.SYMBOL_TABLE[t],r=1&n,a=0;a<em.BARS_IN_MODULE;a++){for(var o=0;(1&n)===r;)o+=1,n>>=1;r=1&n,e.RATIOS_TABLE[t]||(e.RATIOS_TABLE[t]=new Array(em.BARS_IN_MODULE)),e.RATIOS_TABLE[t][em.BARS_IN_MODULE-a-1]=Math.fround(o/em.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},e.getDecodedValue=function(t){var n=e.getDecodedCodewordValue(e.sampleBitCounts(t));return-1!==n?n:e.getClosestDecodedValue(t)},e.sampleBitCounts=function(e){for(var t=_d.sum(e),n=new Int32Array(em.BARS_IN_MODULE),r=0,a=0,o=0;o<em.MODULES_IN_CODEWORD;o++){var i=t/(2*em.MODULES_IN_CODEWORD)+o*t/em.MODULES_IN_CODEWORD;a+e[r]<=i&&(a+=e[r],r++),n[r]++}return n},e.getDecodedCodewordValue=function(t){var n=e.getBitValue(t);return-1===em.getCodeword(n)?-1:n},e.getBitValue=function(e){for(var t=0,n=0;n<e.length;n++)for(var r=0;r<e[n];r++)t=t<<1|(n%2===0?1:0);return Math.trunc(t)},e.getClosestDecodedValue=function(t){var n=_d.sum(t),r=new Array(em.BARS_IN_MODULE);if(n>1)for(var a=0;a<r.length;a++)r[a]=Math.fround(t[a]/n);var o=Sd.MAX_VALUE,i=-1;this.bSymbolTableReady||e.initialize();for(var s=0;s<e.RATIOS_TABLE.length;s++){for(var l=0,c=e.RATIOS_TABLE[s],u=0;u<em.BARS_IN_MODULE;u++){var d=Math.fround(c[u]-r[u]);if((l+=Math.fround(d*d))>=o)break}l<o&&(o=l,i=em.SYMBOL_TABLE[s])}return i},e.bSymbolTableReady=!1,e.RATIOS_TABLE=new Array(em.SYMBOL_TABLE.length).map(function(e){return new Array(em.BARS_IN_MODULE)}),e}();const Dm=function(){function e(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return e.prototype.getSegmentIndex=function(){return this.segmentIndex},e.prototype.setSegmentIndex=function(e){this.segmentIndex=e},e.prototype.getFileId=function(){return this.fileId},e.prototype.setFileId=function(e){this.fileId=e},e.prototype.getOptionalData=function(){return this.optionalData},e.prototype.setOptionalData=function(e){this.optionalData=e},e.prototype.isLastSegment=function(){return this.lastSegment},e.prototype.setLastSegment=function(e){this.lastSegment=e},e.prototype.getSegmentCount=function(){return this.segmentCount},e.prototype.setSegmentCount=function(e){this.segmentCount=e},e.prototype.getSender=function(){return this.sender||null},e.prototype.setSender=function(e){this.sender=e},e.prototype.getAddressee=function(){return this.addressee||null},e.prototype.setAddressee=function(e){this.addressee=e},e.prototype.getFileName=function(){return this.fileName},e.prototype.setFileName=function(e){this.fileName=e},e.prototype.getFileSize=function(){return this.fileSize},e.prototype.setFileSize=function(e){this.fileSize=e},e.prototype.getChecksum=function(){return this.checksum},e.prototype.setChecksum=function(e){this.checksum=e},e.prototype.getTimestamp=function(){return this.timestamp},e.prototype.setTimestamp=function(e){this.timestamp=e},e}();const Mm=function(){function e(){}return e.parseLong=function(e,t){return void 0===t&&(t=void 0),parseInt(e,t)},e}();var Rm=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Fm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Rm(t,e),t.kind="NullPointerException",t}(lu);const Om=function(){function e(){}return e.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},e.prototype.writeBytesOffset=function(e,t,n){if(null==e)throw new Fm;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new bu;if(0!==n)for(var r=0;r<n;r++)this.write(e[t+r])},e.prototype.flush=function(){},e.prototype.close=function(){},e}();var Bm=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Lm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Bm(t,e),t}(lu);var zm=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Wm=function(e){function t(t){void 0===t&&(t=32);var n=e.call(this)||this;if(n.count=0,t<0)throw new hu("Negative initial size: "+t);return n.buf=new Uint8Array(t),n}return zm(t,e),t.prototype.ensureCapacity=function(e){e-this.buf.length>0&&this.grow(e)},t.prototype.grow=function(e){var t=this.buf.length<<1;if(t-e<0&&(t=e),t<0){if(e<0)throw new Lm;t=_u.MAX_VALUE}this.buf=Nu.copyOfUint8Array(this.buf,t)},t.prototype.write=function(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1},t.prototype.writeBytesOffset=function(e,t,n){if(t<0||t>e.length||n<0||t+n-e.length>0)throw new bu;this.ensureCapacity(this.count+n),yu.arraycopy(e,t,this.buf,this.count,n),this.count+=n},t.prototype.writeTo=function(e){e.writeBytesOffset(this.buf,0,this.count)},t.prototype.reset=function(){this.count=0},t.prototype.toByteArray=function(){return Nu.copyOfUint8Array(this.buf,this.count)},t.prototype.size=function(){return this.count},t.prototype.toString=function(e){return e?"string"===typeof e?this.toString_string(e):this.toString_number(e):this.toString_void()},t.prototype.toString_void=function(){return new String(this.buf).toString()},t.prototype.toString_string=function(e){return new String(this.buf).toString()},t.prototype.toString_number=function(e){return new String(this.buf).toString()},t.prototype.close=function(){},t}(Om);var Vm,Um;function Hm(){if("undefined"!==typeof window)return window.BigInt||null;if("undefined"!==typeof n.g)return n.g.BigInt||null;if("undefined"!==typeof self)return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}function Gm(e){if("undefined"===typeof Um&&(Um=Hm()),null===Um)throw new Error("BigInt is not supported!");return Um(e)}!function(e){e[e.ALPHA=0]="ALPHA",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.PUNCT=3]="PUNCT",e[e.ALPHA_SHIFT=4]="ALPHA_SHIFT",e[e.PUNCT_SHIFT=5]="PUNCT_SHIFT"}(Vm||(Vm={}));var Km=function(){function e(){}return e.decode=function(t,n){var r=new zu(""),a=Ru.ISO8859_1;r.enableDecoding(a);for(var o=1,i=t[o++],s=new Dm;o<t[0];){switch(i){case e.TEXT_COMPACTION_MODE_LATCH:o=e.textCompaction(t,o,r);break;case e.BYTE_COMPACTION_MODE_LATCH:case e.BYTE_COMPACTION_MODE_LATCH_6:o=e.byteCompaction(i,t,a,o,r);break;case e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o++]);break;case e.NUMERIC_COMPACTION_MODE_LATCH:o=e.numericCompaction(t,o,r);break;case e.ECI_CHARSET:Ru.getCharacterSetECIByValue(t[o++]);break;case e.ECI_GENERAL_PURPOSE:o+=2;break;case e.ECI_USER_DEFINED:o++;break;case e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:o=e.decodeMacroBlock(t,o,s);break;case e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case e.MACRO_PDF417_TERMINATOR:throw new Tu;default:o--,o=e.textCompaction(t,o,r)}if(!(o<t.length))throw Tu.getFormatInstance();i=t[o++]}if(0===r.length())throw Tu.getFormatInstance();var l=new ud(null,r.toString(),null,n);return l.setOther(s),l},e.decodeMacroBlock=function(t,n,r){if(n+e.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw Tu.getFormatInstance();for(var a=new Int32Array(e.NUMBER_OF_SEQUENCE_CODEWORDS),o=0;o<e.NUMBER_OF_SEQUENCE_CODEWORDS;o++,n++)a[o]=t[n];r.setSegmentIndex(_u.parseInt(e.decodeBase900toBase10(a,e.NUMBER_OF_SEQUENCE_CODEWORDS)));var i=new zu;n=e.textCompaction(t,n,i),r.setFileId(i.toString());var s=-1;for(t[n]===e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(s=n+1);n<t[0];)switch(t[n]){case e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t[++n]){case e.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var l=new zu;n=e.textCompaction(t,n+1,l),r.setFileName(l.toString());break;case e.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var c=new zu;n=e.textCompaction(t,n+1,c),r.setSender(c.toString());break;case e.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var u=new zu;n=e.textCompaction(t,n+1,u),r.setAddressee(u.toString());break;case e.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var d=new zu;n=e.numericCompaction(t,n+1,d),r.setSegmentCount(_u.parseInt(d.toString()));break;case e.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var h=new zu;n=e.numericCompaction(t,n+1,h),r.setTimestamp(Mm.parseLong(h.toString()));break;case e.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var p=new zu;n=e.numericCompaction(t,n+1,p),r.setChecksum(_u.parseInt(p.toString()));break;case e.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var f=new zu;n=e.numericCompaction(t,n+1,f),r.setFileSize(Mm.parseLong(f.toString()));break;default:throw Tu.getFormatInstance()}break;case e.MACRO_PDF417_TERMINATOR:n++,r.setLastSegment(!0);break;default:throw Tu.getFormatInstance()}if(-1!==s){var m=n-s;r.isLastSegment()&&m--,r.setOptionalData(Nu.copyOfRange(t,s,s+m))}return n},e.textCompaction=function(t,n,r){for(var a=new Int32Array(2*(t[0]-n)),o=new Int32Array(2*(t[0]-n)),i=0,s=!1;n<t[0]&&!s;){var l=t[n++];if(l<e.TEXT_COMPACTION_MODE_LATCH)a[i]=l/30,a[i+1]=l%30,i+=2;else switch(l){case e.TEXT_COMPACTION_MODE_LATCH:a[i++]=e.TEXT_COMPACTION_MODE_LATCH;break;case e.BYTE_COMPACTION_MODE_LATCH:case e.BYTE_COMPACTION_MODE_LATCH_6:case e.NUMERIC_COMPACTION_MODE_LATCH:case e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case e.MACRO_PDF417_TERMINATOR:n--,s=!0;break;case e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[i]=e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,l=t[n++],o[i]=l,i++}}return e.decodeTextCompaction(a,o,i,r),n},e.decodeTextCompaction=function(t,n,r,a){for(var o=Vm.ALPHA,i=Vm.ALPHA,s=0;s<r;){var l=t[s],c="";switch(o){case Vm.ALPHA:if(l<26)c=String.fromCharCode(65+l);else switch(l){case 26:c=" ";break;case e.LL:o=Vm.LOWER;break;case e.ML:o=Vm.MIXED;break;case e.PS:i=o,o=Vm.PUNCT_SHIFT;break;case e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(n[s]);break;case e.TEXT_COMPACTION_MODE_LATCH:o=Vm.ALPHA}break;case Vm.LOWER:if(l<26)c=String.fromCharCode(97+l);else switch(l){case 26:c=" ";break;case e.AS:i=o,o=Vm.ALPHA_SHIFT;break;case e.ML:o=Vm.MIXED;break;case e.PS:i=o,o=Vm.PUNCT_SHIFT;break;case e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(n[s]);break;case e.TEXT_COMPACTION_MODE_LATCH:o=Vm.ALPHA}break;case Vm.MIXED:if(l<e.PL)c=e.MIXED_CHARS[l];else switch(l){case e.PL:o=Vm.PUNCT;break;case 26:c=" ";break;case e.LL:o=Vm.LOWER;break;case e.AL:o=Vm.ALPHA;break;case e.PS:i=o,o=Vm.PUNCT_SHIFT;break;case e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(n[s]);break;case e.TEXT_COMPACTION_MODE_LATCH:o=Vm.ALPHA}break;case Vm.PUNCT:if(l<e.PAL)c=e.PUNCT_CHARS[l];else switch(l){case e.PAL:o=Vm.ALPHA;break;case e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(n[s]);break;case e.TEXT_COMPACTION_MODE_LATCH:o=Vm.ALPHA}break;case Vm.ALPHA_SHIFT:if(o=i,l<26)c=String.fromCharCode(65+l);else switch(l){case 26:c=" ";break;case e.TEXT_COMPACTION_MODE_LATCH:o=Vm.ALPHA}break;case Vm.PUNCT_SHIFT:if(o=i,l<e.PAL)c=e.PUNCT_CHARS[l];else switch(l){case e.PAL:o=Vm.ALPHA;break;case e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(n[s]);break;case e.TEXT_COMPACTION_MODE_LATCH:o=Vm.ALPHA}}""!==c&&a.append(c),s++}},e.byteCompaction=function(t,n,r,a,o){var i=new Wm,s=0,l=0,c=!1;switch(t){case e.BYTE_COMPACTION_MODE_LATCH:for(var u=new Int32Array(6),d=n[a++];a<n[0]&&!c;)switch(u[s++]=d,l=900*l+d,d=n[a++]){case e.TEXT_COMPACTION_MODE_LATCH:case e.BYTE_COMPACTION_MODE_LATCH:case e.NUMERIC_COMPACTION_MODE_LATCH:case e.BYTE_COMPACTION_MODE_LATCH_6:case e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case e.MACRO_PDF417_TERMINATOR:a--,c=!0;break;default:if(s%5===0&&s>0){for(var h=0;h<6;++h)i.write(Number(Gm(l)>>Gm(8*(5-h))));l=0,s=0}}a===n[0]&&d<e.TEXT_COMPACTION_MODE_LATCH&&(u[s++]=d);for(var p=0;p<s;p++)i.write(u[p]);break;case e.BYTE_COMPACTION_MODE_LATCH_6:for(;a<n[0]&&!c;){var f=n[a++];if(f<e.TEXT_COMPACTION_MODE_LATCH)s++,l=900*l+f;else switch(f){case e.TEXT_COMPACTION_MODE_LATCH:case e.BYTE_COMPACTION_MODE_LATCH:case e.NUMERIC_COMPACTION_MODE_LATCH:case e.BYTE_COMPACTION_MODE_LATCH_6:case e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case e.MACRO_PDF417_TERMINATOR:a--,c=!0}if(s%5===0&&s>0){for(h=0;h<6;++h)i.write(Number(Gm(l)>>Gm(8*(5-h))));l=0,s=0}}}return o.append(Bu.decode(i.toByteArray(),r)),a},e.numericCompaction=function(t,n,r){for(var a=0,o=!1,i=new Int32Array(e.MAX_NUMERIC_CODEWORDS);n<t[0]&&!o;){var s=t[n++];if(n===t[0]&&(o=!0),s<e.TEXT_COMPACTION_MODE_LATCH)i[a]=s,a++;else switch(s){case e.TEXT_COMPACTION_MODE_LATCH:case e.BYTE_COMPACTION_MODE_LATCH:case e.BYTE_COMPACTION_MODE_LATCH_6:case e.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case e.MACRO_PDF417_TERMINATOR:n--,o=!0}(a%e.MAX_NUMERIC_CODEWORDS===0||s===e.NUMERIC_COMPACTION_MODE_LATCH||o)&&a>0&&(r.append(e.decodeBase900toBase10(i,a)),a=0)}return n},e.decodeBase900toBase10=function(t,n){for(var r=Gm(0),a=0;a<n;a++)r+=e.EXP900[n-a-1]*Gm(t[a]);var o=r.toString();if("1"!==o.charAt(0))throw new Tu;return o.substring(1)},e.TEXT_COMPACTION_MODE_LATCH=900,e.BYTE_COMPACTION_MODE_LATCH=901,e.NUMERIC_COMPACTION_MODE_LATCH=902,e.BYTE_COMPACTION_MODE_LATCH_6=924,e.ECI_USER_DEFINED=925,e.ECI_GENERAL_PURPOSE=926,e.ECI_CHARSET=927,e.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,e.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,e.MACRO_PDF417_TERMINATOR=922,e.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,e.MAX_NUMERIC_CODEWORDS=15,e.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,e.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,e.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,e.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,e.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,e.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,e.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,e.PL=25,e.LL=27,e.AS=27,e.ML=28,e.AL=28,e.PS=29,e.PAL=29,e.PUNCT_CHARS=";<>@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'",e.MIXED_CHARS="0123456789&\r\t,:#-.$/+%*=^",e.EXP900=Hm()?function(){var e=[];e[0]=Gm(1);var t=Gm(900);e[1]=t;for(var n=2;n<16;n++)e[n]=e[n-1]*t;return e}():[],e.NUMBER_OF_SEQUENCE_CODEWORDS=2,e}();const Xm=Km;var Ym=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},qm=function(){function e(){}return e.decode=function(t,n,r,a,o,i,s){for(var l,c=new fm(t,n,r,a,o),u=null,d=null,h=!0;;h=!1){if(null!=n&&(u=e.getRowIndicatorColumn(t,c,n,!0,i,s)),null!=a&&(d=e.getRowIndicatorColumn(t,c,a,!1,i,s)),null==(l=e.merge(u,d)))throw Uu.getNotFoundInstance();var p=l.getBoundingBox();if(!h||null==p||!(p.getMinY()<c.getMinY()||p.getMaxY()>c.getMaxY()))break;c=p}l.setBoundingBox(c);var f=l.getBarcodeColumnCount()+1;l.setDetectionResultColumn(0,u),l.setDetectionResultColumn(f,d);for(var m=null!=u,g=1;g<=f;g++){var x=m?g:f-g;if(void 0===l.getDetectionResultColumn(x)){var y=void 0;y=0===x||x===f?new Sm(c,0===x):new vm(c),l.setDetectionResultColumn(x,y);for(var v=-1,b=v,w=c.getMinY();w<=c.getMaxY();w++){if((v=e.getStartColumn(l,x,w,m))<0||v>c.getMaxX()){if(-1===b)continue;v=b}var k=e.detectCodeword(t,c.getMinX(),c.getMaxX(),m,v,w,i,s);null!=k&&(y.setCodeword(w,k),b=v,i=Math.min(i,k.getWidth()),s=Math.max(s,k.getWidth()))}}}return e.createDecoderResult(l)},e.merge=function(t,n){if(null==t&&null==n)return null;var r=e.getBarcodeMetadata(t,n);if(null==r)return null;var a=fm.merge(e.adjustBoundingBox(t),e.adjustBoundingBox(n));return new Im(r,a)},e.adjustBoundingBox=function(t){var n,r;if(null==t)return null;var a=t.getRowHeights();if(null==a)return null;var o=e.getMax(a),i=0;try{for(var s=Ym(a),l=s.next();!l.done;l=s.next()){var c=l.value;if(i+=o-c,c>0)break}}catch(p){n={error:p}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}for(var u=t.getCodewords(),d=0;i>0&&null==u[d];d++)i--;var h=0;for(d=a.length-1;d>=0&&(h+=o-a[d],!(a[d]>0));d--);for(d=u.length-1;h>0&&null==u[d];d--)h--;return t.getBoundingBox().addMissingRows(i,h,t.isLeft())},e.getMax=function(e){var t,n,r=-1;try{for(var a=Ym(e),o=a.next();!o.done;o=a.next()){var i=o.value;r=Math.max(r,i)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r},e.getBarcodeMetadata=function(e,t){var n,r;return null==e||null==(n=e.getBarcodeMetadata())?null==t?null:t.getBarcodeMetadata():null==t||null==(r=t.getBarcodeMetadata())?n:n.getColumnCount()!==r.getColumnCount()&&n.getErrorCorrectionLevel()!==r.getErrorCorrectionLevel()&&n.getRowCount()!==r.getRowCount()?null:n},e.getRowIndicatorColumn=function(t,n,r,a,o,i){for(var s=new Sm(n,a),l=0;l<2;l++)for(var c=0===l?1:-1,u=Math.trunc(Math.trunc(r.getX())),d=Math.trunc(Math.trunc(r.getY()));d<=n.getMaxY()&&d>=n.getMinY();d+=c){var h=e.detectCodeword(t,0,t.getWidth(),a,u,d,o,i);null!=h&&(s.setCodeword(d,h),u=a?h.getStartX():h.getEndX())}return s},e.adjustCodewordCount=function(t,n){var r=n[0][1],a=r.getValue(),o=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-e.getNumberOfECCodeWords(t.getBarcodeECLevel());if(0===a.length){if(o<1||o>em.MAX_CODEWORDS_IN_BARCODE)throw Uu.getNotFoundInstance();r.setValue(o)}else a[0]!==o&&r.setValue(o)},e.createDecoderResult=function(t){var n=e.createBarcodeMatrix(t);e.adjustCodewordCount(t,n);for(var r=new Array,a=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),o=[],i=new Array,s=0;s<t.getBarcodeRowCount();s++)for(var l=0;l<t.getBarcodeColumnCount();l++){var c=n[s][l+1].getValue(),u=s*t.getBarcodeColumnCount()+l;0===c.length?r.push(u):1===c.length?a[u]=c[0]:(i.push(u),o.push(c))}for(var d=new Array(o.length),h=0;h<d.length;h++)d[h]=o[h];return e.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),a,em.toIntArray(r),em.toIntArray(i),d)},e.createDecoderResultFromAmbiguousValues=function(t,n,r,a,o){for(var i=new Int32Array(a.length),s=100;s-- >0;){for(var l=0;l<i.length;l++)n[a[l]]=o[l][i[l]];try{return e.decodeCodewords(n,t,r)}catch(c){if(!(c instanceof mu))throw c}if(0===i.length)throw mu.getChecksumInstance();for(l=0;l<i.length;l++){if(i[l]<o[l].length-1){i[l]++;break}if(i[l]=0,l===i.length-1)throw mu.getChecksumInstance()}}throw mu.getChecksumInstance()},e.createBarcodeMatrix=function(e){for(var t,n,r,a,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),i=0;i<o.length;i++)for(var s=0;s<o[i].length;s++)o[i][s]=new jm;var l=0;try{for(var c=Ym(e.getDetectionResultColumns()),u=c.next();!u.done;u=c.next()){var d=u.value;if(null!=d)try{for(var h=(r=void 0,Ym(d.getCodewords())),p=h.next();!p.done;p=h.next()){var f=p.value;if(null!=f){var m=f.getRowNumber();if(m>=0){if(m>=o.length)continue;o[m][l].setValue(f.getValue())}}}}catch(g){r={error:g}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(r)throw r.error}}l++}}catch(x){t={error:x}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return o},e.isValidBarcodeColumn=function(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1},e.getStartColumn=function(t,n,r,a){var o,i,s=a?1:-1,l=null;if(e.isValidBarcodeColumn(t,n-s)&&(l=t.getDetectionResultColumn(n-s).getCodeword(r)),null!=l)return a?l.getEndX():l.getStartX();if(null!=(l=t.getDetectionResultColumn(n).getCodewordNearby(r)))return a?l.getStartX():l.getEndX();if(e.isValidBarcodeColumn(t,n-s)&&(l=t.getDetectionResultColumn(n-s).getCodewordNearby(r)),null!=l)return a?l.getEndX():l.getStartX();for(var c=0;e.isValidBarcodeColumn(t,n-s);){n-=s;try{for(var u=(o=void 0,Ym(t.getDetectionResultColumn(n).getCodewords())),d=u.next();!d.done;d=u.next()){var h=d.value;if(null!=h)return(a?h.getEndX():h.getStartX())+s*c*(h.getEndX()-h.getStartX())}}catch(p){o={error:p}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}c++}return a?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()},e.detectCodeword=function(t,n,r,a,o,i,s,l){o=e.adjustCodewordStartColumn(t,n,r,a,o,i);var c,u=e.getModuleBitCount(t,n,r,a,o,i);if(null==u)return null;var d=_d.sum(u);if(a)c=o+d;else{for(var h=0;h<u.length/2;h++){var p=u[h];u[h]=u[u.length-1-h],u[u.length-1-h]=p}o=(c=o)-d}if(!e.checkCodewordSkew(d,s,l))return null;var f=Pm.getDecodedValue(u),m=em.getCodeword(f);return-1===m?null:new Tm(o,c,e.getCodewordBucketNumber(f),m)},e.getModuleBitCount=function(e,t,n,r,a,o){for(var i=a,s=new Int32Array(8),l=0,c=r?1:-1,u=r;(r?i<n:i>=t)&&l<s.length;)e.get(i,o)===u?(s[l]++,i+=c):(l++,u=!u);return l===s.length||i===(r?n:t)&&l===s.length-1?s:null},e.getNumberOfECCodeWords=function(e){return 2<<e},e.adjustCodewordStartColumn=function(t,n,r,a,o,i){for(var s=o,l=a?-1:1,c=0;c<2;c++){for(;(a?s>=n:s<r)&&a===t.get(s,i);){if(Math.abs(o-s)>e.CODEWORD_SKEW_SIZE)return o;s+=l}l=-l,a=!a}return s},e.checkCodewordSkew=function(t,n,r){return n-e.CODEWORD_SKEW_SIZE<=t&&t<=r+e.CODEWORD_SKEW_SIZE},e.decodeCodewords=function(t,n,r){if(0===t.length)throw Tu.getFormatInstance();var a=1<<n+1,o=e.correctErrors(t,r,a);e.verifyCodewordCount(t,a);var i=Xm.decode(t,""+n);return i.setErrorsCorrected(o),i.setErasures(r.length),i},e.correctErrors=function(t,n,r){if(null!=n&&n.length>r/2+e.MAX_ERRORS||r<0||r>e.MAX_EC_CODEWORDS)throw mu.getChecksumInstance();return e.errorCorrection.decode(t,r,n)},e.verifyCodewordCount=function(e,t){if(e.length<4)throw Tu.getFormatInstance();var n=e[0];if(n>e.length)throw Tu.getFormatInstance();if(0===n){if(!(t<e.length))throw Tu.getFormatInstance();e[0]=e.length-t}},e.getBitCountForCodeword=function(e){for(var t=new Int32Array(8),n=0,r=t.length-1;!((1&e)!==n&&(n=1&e,--r<0));)t[r]++,e>>=1;return t},e.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},e.getCodewordBucketNumber_number=function(t){return e.getCodewordBucketNumber(e.getBitCountForCodeword(t))},e.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},e.toString=function(e){for(var t=new gm,n=0;n<e.length;n++){t.format("Row %2d: ",n);for(var r=0;r<e[n].length;r++){var a=e[n][r];0===a.getValue().length?t.format("        ",null):t.format("%4d(%2d)",a.getValue()[0],a.getConfidence(a.getValue()[0]))}t.format("%n")}return t.toString()},e.CODEWORD_SKEW_SIZE=2,e.MAX_ERRORS=3,e.MAX_EC_CODEWORDS=512,e.errorCorrection=new pm,e}();const Zm=qm;var Jm=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Qm=function(){function e(){}return e.prototype.decode=function(t,n){void 0===n&&(n=null);var r=e.decode(t,n,!1);if(null==r||0===r.length||null==r[0])throw Uu.getNotFoundInstance();return r[0]},e.prototype.decodeMultiple=function(t,n){void 0===n&&(n=null);try{return e.decode(t,n,!0)}catch(r){if(r instanceof Tu||r instanceof mu)throw Uu.getNotFoundInstance();throw r}},e.decode=function(t,n,r){var a,o,i=new Array,s=am.detectMultiple(t,n,r);try{for(var l=Jm(s.getPoints()),c=l.next();!c.done;c=l.next()){var u=c.value,d=Zm.decode(s.getBits(),u[4],u[5],u[6],u[7],e.getMinCodewordWidth(u),e.getMaxCodewordWidth(u)),h=new od(d.getText(),d.getRawBytes(),void 0,u,sd.PDF_417);h.putMetadata(cd.ERROR_CORRECTION_LEVEL,d.getECLevel());var p=d.getOther();null!=p&&h.putMetadata(cd.PDF417_EXTRA_METADATA,p),i.push(h)}}catch(f){a={error:f}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(a)throw a.error}}return i.map(function(e){return e})},e.getMaxWidth=function(e,t){return null==e||null==t?0:Math.trunc(Math.abs(e.getX()-t.getX()))},e.getMinWidth=function(e,t){return null==e||null==t?_u.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))},e.getMaxCodewordWidth=function(t){return Math.floor(Math.max(Math.max(e.getMaxWidth(t[0],t[4]),e.getMaxWidth(t[6],t[2])*em.MODULES_IN_CODEWORD/em.MODULES_IN_STOP_PATTERN),Math.max(e.getMaxWidth(t[1],t[5]),e.getMaxWidth(t[7],t[3])*em.MODULES_IN_CODEWORD/em.MODULES_IN_STOP_PATTERN)))},e.getMinCodewordWidth=function(t){return Math.floor(Math.min(Math.min(e.getMinWidth(t[0],t[4]),e.getMinWidth(t[6],t[2])*em.MODULES_IN_CODEWORD/em.MODULES_IN_STOP_PATTERN),Math.min(e.getMinWidth(t[1],t[5]),e.getMinWidth(t[7],t[3])*em.MODULES_IN_CODEWORD/em.MODULES_IN_STOP_PATTERN)))},e.prototype.reset=function(){},e}();const $m=Qm;var eg=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const tg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eg(t,e),t.kind="ReaderException",t}(lu);var ng=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},rg=function(){function e(){}return e.prototype.decode=function(e,t){return this.setHints(t),this.decodeInternal(e)},e.prototype.decodeWithState=function(e){return null!==this.readers&&void 0!==this.readers||this.setHints(null),this.decodeInternal(e)},e.prototype.setHints=function(e){this.hints=e;var t=null!==e&&void 0!==e&&void 0!==e.get(Au.TRY_HARDER),n=null===e||void 0===e?null:e.get(Au.POSSIBLE_FORMATS),r=new Array;if(null!==n&&void 0!==n){var a=n.some(function(e){return e===sd.UPC_A||e===sd.UPC_E||e===sd.EAN_13||e===sd.EAN_8||e===sd.CODABAR||e===sd.CODE_39||e===sd.CODE_93||e===sd.CODE_128||e===sd.ITF||e===sd.RSS_14||e===sd.RSS_EXPANDED});a&&!t&&r.push(new zp(e)),n.includes(sd.QR_CODE)&&r.push(new Jf),n.includes(sd.DATA_MATRIX)&&r.push(new of),n.includes(sd.AZTEC)&&r.push(new Wd),n.includes(sd.PDF_417)&&r.push(new $m),a&&t&&r.push(new zp(e))}0===r.length&&(t||r.push(new zp(e)),r.push(new Jf),r.push(new of),r.push(new Wd),r.push(new $m),t&&r.push(new zp(e))),this.readers=r},e.prototype.reset=function(){var e,t;if(null!==this.readers)try{for(var n=ng(this.readers),r=n.next();!r.done;r=n.next()){r.value.reset()}}catch(a){e={error:a}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.decodeInternal=function(e){var t,n;if(null===this.readers)throw new tg("No readers where selected, nothing can be read.");try{for(var r=ng(this.readers),a=r.next();!a.done;a=r.next()){var o=a.value;try{return o.decode(e,this.hints)}catch(i){if(i instanceof tg)continue}}}catch(s){t={error:s}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}throw new Uu("No MultiFormat Readers were able to detect the code.")},e}();const ag=rg;var og,ig=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sg=(function(e){function t(t,n){void 0===t&&(t=null),void 0===n&&(n=500);var r=new ag;return r.setHints(t),e.call(this,r,n)||this}ig(t,e),t.prototype.decodeBitmap=function(e){return this.reader.decodeWithState(e)}}(rd),function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),lg=(function(e){function t(t){return void 0===t&&(t=500),e.call(this,new $m,t)||this}sg(t,e)}(rd),function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}());!function(e){function t(t){return void 0===t&&(t=500),e.call(this,new Jf,t)||this}lg(t,e)}(rd);!function(e){e[e.ERROR_CORRECTION=0]="ERROR_CORRECTION",e[e.CHARACTER_SET=1]="CHARACTER_SET",e[e.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",e[e.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",e[e.MIN_SIZE=4]="MIN_SIZE",e[e.MAX_SIZE=5]="MAX_SIZE",e[e.MARGIN=6]="MARGIN",e[e.PDF417_COMPACT=7]="PDF417_COMPACT",e[e.PDF417_COMPACTION=8]="PDF417_COMPACTION",e[e.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",e[e.AZTEC_LAYERS=10]="AZTEC_LAYERS",e[e.QR_VERSION=11]="QR_VERSION",e[e.GS1_FORMAT=12]="GS1_FORMAT",e[e.FORCE_C40=13]="FORCE_C40"}(og||(og={}));const cg=og;const ug=function(){function e(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new pd(e,Int32Array.from([1])))}return e.prototype.buildGenerator=function(e){var t=this.cachedGenerators;if(e>=t.length)for(var n=t[t.length-1],r=this.field,a=t.length;a<=e;a++){var o=n.multiply(new pd(r,Int32Array.from([1,r.exp(a-1+r.getGeneratorBase())])));t.push(o),n=o}return t[e]},e.prototype.encode=function(e,t){if(0===t)throw new hu("No error correction bytes");var n=e.length-t;if(n<=0)throw new hu("No data bytes provided");var r=this.buildGenerator(t),a=new Int32Array(n);yu.arraycopy(e,0,a,0,n);for(var o=new pd(this.field,a),i=(o=o.multiplyByMonomial(t,1)).divide(r)[1].getCoefficients(),s=t-i.length,l=0;l<s;l++)e[n+l]=0;yu.arraycopy(i,0,e,n+s,i.length)},e}();const dg=function(){function e(){}return e.applyMaskPenaltyRule1=function(t){return e.applyMaskPenaltyRule1Internal(t,!0)+e.applyMaskPenaltyRule1Internal(t,!1)},e.applyMaskPenaltyRule2=function(t){for(var n=0,r=t.getArray(),a=t.getWidth(),o=t.getHeight(),i=0;i<o-1;i++)for(var s=r[i],l=0;l<a-1;l++){var c=s[l];c===s[l+1]&&c===r[i+1][l]&&c===r[i+1][l+1]&&n++}return e.N2*n},e.applyMaskPenaltyRule3=function(t){for(var n=0,r=t.getArray(),a=t.getWidth(),o=t.getHeight(),i=0;i<o;i++)for(var s=0;s<a;s++){var l=r[i];s+6<a&&1===l[s]&&0===l[s+1]&&1===l[s+2]&&1===l[s+3]&&1===l[s+4]&&0===l[s+5]&&1===l[s+6]&&(e.isWhiteHorizontal(l,s-4,s)||e.isWhiteHorizontal(l,s+7,s+11))&&n++,i+6<o&&1===r[i][s]&&0===r[i+1][s]&&1===r[i+2][s]&&1===r[i+3][s]&&1===r[i+4][s]&&0===r[i+5][s]&&1===r[i+6][s]&&(e.isWhiteVertical(r,s,i-4,i)||e.isWhiteVertical(r,s,i+7,i+11))&&n++}return n*e.N3},e.isWhiteHorizontal=function(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(var r=t;r<n;r++)if(1===e[r])return!1;return!0},e.isWhiteVertical=function(e,t,n,r){n=Math.max(n,0),r=Math.min(r,e.length);for(var a=n;a<r;a++)if(1===e[a][t])return!1;return!0},e.applyMaskPenaltyRule4=function(t){for(var n=0,r=t.getArray(),a=t.getWidth(),o=t.getHeight(),i=0;i<o;i++)for(var s=r[i],l=0;l<a;l++)1===s[l]&&n++;var c=t.getHeight()*t.getWidth();return Math.floor(10*Math.abs(2*n-c)/c)*e.N4},e.getDataMaskBit=function(e,t,n){var r,a;switch(e){case 0:r=n+t&1;break;case 1:r=1&n;break;case 2:r=t%3;break;case 3:r=(n+t)%3;break;case 4:r=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:r=(1&(a=n*t))+a%3;break;case 6:r=(1&(a=n*t))+a%3&1;break;case 7:r=(a=n*t)%3+(n+t&1)&1;break;default:throw new hu("Invalid mask pattern: "+e)}return 0===r},e.applyMaskPenaltyRule1Internal=function(t,n){for(var r=0,a=n?t.getHeight():t.getWidth(),o=n?t.getWidth():t.getHeight(),i=t.getArray(),s=0;s<a;s++){for(var l=0,c=-1,u=0;u<o;u++){var d=n?i[s][u]:i[u][s];d===c?l++:(l>=5&&(r+=e.N1+(l-5)),l=1,c=d)}l>=5&&(r+=e.N1+(l-5))}return r},e.N1=3,e.N2=3,e.N3=40,e.N4=10,e}();var hg=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},pg=function(){function e(e,t){this.width=e,this.height=t;for(var n=new Array(t),r=0;r!==t;r++)n[r]=new Uint8Array(e);this.bytes=n}return e.prototype.getHeight=function(){return this.height},e.prototype.getWidth=function(){return this.width},e.prototype.get=function(e,t){return this.bytes[t][e]},e.prototype.getArray=function(){return this.bytes},e.prototype.setNumber=function(e,t,n){this.bytes[t][e]=n},e.prototype.setBoolean=function(e,t,n){this.bytes[t][e]=n?1:0},e.prototype.clear=function(e){var t,n;try{for(var r=hg(this.bytes),a=r.next();!a.done;a=r.next()){var o=a.value;Nu.fill(o,e)}}catch(i){t={error:i}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.width!==n.width)return!1;if(this.height!==n.height)return!1;for(var r=0,a=this.height;r<a;++r)for(var o=this.bytes[r],i=n.bytes[r],s=0,l=this.width;s<l;++s)if(o[s]!==i[s])return!1;return!0},e.prototype.toString=function(){for(var e=new zu,t=0,n=this.height;t<n;++t){for(var r=this.bytes[t],a=0,o=this.width;a<o;++a)switch(r[a]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ")}e.append("\n")}return e.toString()},e}();const fg=pg;const mg=function(){function e(){this.maskPattern=-1}return e.prototype.getMode=function(){return this.mode},e.prototype.getECLevel=function(){return this.ecLevel},e.prototype.getVersion=function(){return this.version},e.prototype.getMaskPattern=function(){return this.maskPattern},e.prototype.getMatrix=function(){return this.matrix},e.prototype.toString=function(){var e=new zu;return e.append("<<\n"),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append("\n ecLevel: "),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append("\n version: "),e.append(this.version?this.version.toString():"null"),e.append("\n maskPattern: "),e.append(this.maskPattern.toString()),this.matrix?(e.append("\n matrix:\n"),e.append(this.matrix.toString())):e.append("\n matrix: null\n"),e.append(">>\n"),e.toString()},e.prototype.setMode=function(e){this.mode=e},e.prototype.setECLevel=function(e){this.ecLevel=e},e.prototype.setVersion=function(e){this.version=e},e.prototype.setMaskPattern=function(e){this.maskPattern=e},e.prototype.setMatrix=function(e){this.matrix=e},e.isValidMaskPattern=function(t){return t>=0&&t<e.NUM_MASK_PATTERNS},e.NUM_MASK_PATTERNS=8,e}();var gg=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const xg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gg(t,e),t.kind="WriterException",t}(lu);const yg=function(){function e(){}return e.clearMatrix=function(e){e.clear(255)},e.buildMatrix=function(t,n,r,a,o){e.clearMatrix(o),e.embedBasicPatterns(r,o),e.embedTypeInfo(n,a,o),e.maybeEmbedVersionInfo(r,o),e.embedDataBits(t,a,o)},e.embedBasicPatterns=function(t,n){e.embedPositionDetectionPatternsAndSeparators(n),e.embedDarkDotAtLeftBottomCorner(n),e.maybeEmbedPositionAdjustmentPatterns(t,n),e.embedTimingPatterns(n)},e.embedTypeInfo=function(t,n,r){var a=new Su;e.makeTypeInfoBits(t,n,a);for(var o=0,i=a.getSize();o<i;++o){var s=a.get(a.getSize()-1-o),l=e.TYPE_INFO_COORDINATES[o],c=l[0],u=l[1];if(r.setBoolean(c,u,s),o<8){var d=r.getWidth()-o-1,h=8;r.setBoolean(d,h,s)}else{d=8,h=r.getHeight()-7+(o-8);r.setBoolean(d,h,s)}}},e.maybeEmbedVersionInfo=function(t,n){if(!(t.getVersionNumber()<7)){var r=new Su;e.makeVersionInfoBits(t,r);for(var a=17,o=0;o<6;++o)for(var i=0;i<3;++i){var s=r.get(a);a--,n.setBoolean(o,n.getHeight()-11+i,s),n.setBoolean(n.getHeight()-11+i,o,s)}}},e.embedDataBits=function(t,n,r){for(var a=0,o=-1,i=r.getWidth()-1,s=r.getHeight()-1;i>0;){for(6===i&&(i-=1);s>=0&&s<r.getHeight();){for(var l=0;l<2;++l){var c=i-l;if(e.isEmpty(r.get(c,s))){var u=void 0;a<t.getSize()?(u=t.get(a),++a):u=!1,255!==n&&dg.getDataMaskBit(n,c,s)&&(u=!u),r.setBoolean(c,s,u)}}s+=o}s+=o=-o,i-=2}if(a!==t.getSize())throw new xg("Not all bits consumed: "+a+"/"+t.getSize())},e.findMSBSet=function(e){return 32-_u.numberOfLeadingZeros(e)},e.calculateBCHCode=function(t,n){if(0===n)throw new hu("0 polynomial");var r=e.findMSBSet(n);for(t<<=r-1;e.findMSBSet(t)>=r;)t^=n<<e.findMSBSet(t)-r;return t},e.makeTypeInfoBits=function(t,n,r){if(!mg.isValidMaskPattern(n))throw new xg("Invalid mask pattern");var a=t.getBits()<<3|n;r.appendBits(a,5);var o=e.calculateBCHCode(a,e.TYPE_INFO_POLY);r.appendBits(o,10);var i=new Su;if(i.appendBits(e.TYPE_INFO_MASK_PATTERN,15),r.xor(i),15!==r.getSize())throw new xg("should not happen but we got: "+r.getSize())},e.makeVersionInfoBits=function(t,n){n.appendBits(t.getVersionNumber(),6);var r=e.calculateBCHCode(t.getVersionNumber(),e.VERSION_INFO_POLY);if(n.appendBits(r,12),18!==n.getSize())throw new xg("should not happen but we got: "+n.getSize())},e.isEmpty=function(e){return 255===e},e.embedTimingPatterns=function(t){for(var n=8;n<t.getWidth()-8;++n){var r=(n+1)%2;e.isEmpty(t.get(n,6))&&t.setNumber(n,6,r),e.isEmpty(t.get(6,n))&&t.setNumber(6,n,r)}},e.embedDarkDotAtLeftBottomCorner=function(e){if(0===e.get(8,e.getHeight()-8))throw new xg;e.setNumber(8,e.getHeight()-8,1)},e.embedHorizontalSeparationPattern=function(t,n,r){for(var a=0;a<8;++a){if(!e.isEmpty(r.get(t+a,n)))throw new xg;r.setNumber(t+a,n,0)}},e.embedVerticalSeparationPattern=function(t,n,r){for(var a=0;a<7;++a){if(!e.isEmpty(r.get(t,n+a)))throw new xg;r.setNumber(t,n+a,0)}},e.embedPositionAdjustmentPattern=function(t,n,r){for(var a=0;a<5;++a)for(var o=e.POSITION_ADJUSTMENT_PATTERN[a],i=0;i<5;++i)r.setNumber(t+i,n+a,o[i])},e.embedPositionDetectionPattern=function(t,n,r){for(var a=0;a<7;++a)for(var o=e.POSITION_DETECTION_PATTERN[a],i=0;i<7;++i)r.setNumber(t+i,n+a,o[i])},e.embedPositionDetectionPatternsAndSeparators=function(t){var n=e.POSITION_DETECTION_PATTERN[0].length;e.embedPositionDetectionPattern(0,0,t),e.embedPositionDetectionPattern(t.getWidth()-n,0,t),e.embedPositionDetectionPattern(0,t.getWidth()-n,t);e.embedHorizontalSeparationPattern(0,7,t),e.embedHorizontalSeparationPattern(t.getWidth()-8,7,t),e.embedHorizontalSeparationPattern(0,t.getWidth()-8,t);e.embedVerticalSeparationPattern(7,0,t),e.embedVerticalSeparationPattern(t.getHeight()-7-1,0,t),e.embedVerticalSeparationPattern(7,t.getHeight()-7,t)},e.maybeEmbedPositionAdjustmentPatterns=function(t,n){if(!(t.getVersionNumber()<2))for(var r=t.getVersionNumber()-1,a=e.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r],o=0,i=a.length;o!==i;o++){var s=a[o];if(s>=0)for(var l=0;l!==i;l++){var c=a[l];c>=0&&e.isEmpty(n.get(c,s))&&e.embedPositionAdjustmentPattern(c-2,s-2,n)}}},e.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),e.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),e.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),e.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),e.VERSION_INFO_POLY=7973,e.TYPE_INFO_POLY=1335,e.TYPE_INFO_MASK_PATTERN=21522,e}();const vg=function(){function e(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}return e.prototype.getDataBytes=function(){return this.dataBytes},e.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},e}();var bg=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},wg=function(){function e(){}return e.calculateMaskPenalty=function(e){return dg.applyMaskPenaltyRule1(e)+dg.applyMaskPenaltyRule2(e)+dg.applyMaskPenaltyRule3(e)+dg.applyMaskPenaltyRule4(e)},e.encode=function(t,n,r){void 0===r&&(r=null);var a=e.DEFAULT_BYTE_MODE_ENCODING,o=null!==r&&void 0!==r.get(cg.CHARACTER_SET);o&&(a=r.get(cg.CHARACTER_SET).toString());var i=this.chooseMode(t,a),s=new Su;if(i===If.BYTE&&(o||e.DEFAULT_BYTE_MODE_ENCODING!==a)){var l=Ru.getCharacterSetECIByName(a);void 0!==l&&this.appendECI(l,s)}this.appendModeInfo(i,s);var c,u=new Su;if(this.appendBytes(t,i,u,a),null!==r&&void 0!==r.get(cg.QR_VERSION)){var d=Number.parseInt(r.get(cg.QR_VERSION).toString(),10);c=bf.getVersionForNumber(d);var h=this.calculateBitsNeeded(i,s,u,c);if(!this.willFit(h,c,n))throw new xg("Data too big for requested version")}else c=this.recommendVersion(n,i,s,u);var p=new Su;p.appendBitArray(s);var f=i===If.BYTE?u.getSizeInBytes():t.length;this.appendLengthInfo(f,c,i,p),p.appendBitArray(u);var m=c.getECBlocksForLevel(n),g=c.getTotalCodewords()-m.getTotalECCodewords();this.terminateBits(g,p);var x=this.interleaveWithECBytes(p,c.getTotalCodewords(),g,m.getNumBlocks()),y=new mg;y.setECLevel(n),y.setMode(i),y.setVersion(c);var v=c.getDimensionForVersion(),b=new fg(v,v),w=this.chooseMaskPattern(x,n,c,b);return y.setMaskPattern(w),yg.buildMatrix(x,n,c,w,b),y.setMatrix(b),y},e.recommendVersion=function(e,t,n,r){var a=this.calculateBitsNeeded(t,n,r,bf.getVersionForNumber(1)),o=this.chooseVersion(a,e),i=this.calculateBitsNeeded(t,n,r,o);return this.chooseVersion(i,e)},e.calculateBitsNeeded=function(e,t,n,r){return t.getSize()+e.getCharacterCountBits(r)+n.getSize()},e.getAlphanumericCode=function(t){return t<e.ALPHANUMERIC_TABLE.length?e.ALPHANUMERIC_TABLE[t]:-1},e.chooseMode=function(t,n){if(void 0===n&&(n=null),Ru.SJIS.getName()===n&&this.isOnlyDoubleByteKanji(t))return If.KANJI;for(var r=!1,a=!1,o=0,i=t.length;o<i;++o){var s=t.charAt(o);if(e.isDigit(s))r=!0;else{if(-1===this.getAlphanumericCode(s.charCodeAt(0)))return If.BYTE;a=!0}}return a?If.ALPHANUMERIC:r?If.NUMERIC:If.BYTE},e.isOnlyDoubleByteKanji=function(e){var t;try{t=Bu.encode(e,Ru.SJIS)}catch(o){return!1}var n=t.length;if(n%2!==0)return!1;for(var r=0;r<n;r+=2){var a=255&t[r];if((a<129||a>159)&&(a<224||a>235))return!1}return!0},e.chooseMaskPattern=function(e,t,n,r){for(var a=Number.MAX_SAFE_INTEGER,o=-1,i=0;i<mg.NUM_MASK_PATTERNS;i++){yg.buildMatrix(e,t,n,i,r);var s=this.calculateMaskPenalty(r);s<a&&(a=s,o=i)}return o},e.chooseVersion=function(t,n){for(var r=1;r<=40;r++){var a=bf.getVersionForNumber(r);if(e.willFit(t,a,n))return a}throw new xg("Data too big")},e.willFit=function(e,t,n){return t.getTotalCodewords()-t.getECBlocksForLevel(n).getTotalECCodewords()>=(e+7)/8},e.terminateBits=function(e,t){var n=8*e;if(t.getSize()>n)throw new xg("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(var r=0;r<4&&t.getSize()<n;++r)t.appendBit(!1);var a=7&t.getSize();if(a>0)for(r=a;r<8;r++)t.appendBit(!1);var o=e-t.getSizeInBytes();for(r=0;r<o;++r)t.appendBits(0===(1&r)?236:17,8);if(t.getSize()!==n)throw new xg("Bits size does not equal capacity")},e.getNumDataBytesAndNumECBytesForBlockID=function(e,t,n,r,a,o){if(r>=n)throw new xg("Block ID too large");var i=e%n,s=n-i,l=Math.floor(e/n),c=l+1,u=Math.floor(t/n),d=u+1,h=l-u,p=c-d;if(h!==p)throw new xg("EC bytes mismatch");if(n!==s+i)throw new xg("RS blocks mismatch");if(e!==(u+h)*s+(d+p)*i)throw new xg("Total bytes mismatch");r<s?(a[0]=u,o[0]=h):(a[0]=d,o[0]=p)},e.interleaveWithECBytes=function(t,n,r,a){var o,i,s,l;if(t.getSizeInBytes()!==r)throw new xg("Number of bits and data bytes does not match");for(var c=0,u=0,d=0,h=new Array,p=0;p<a;++p){var f=new Int32Array(1),m=new Int32Array(1);e.getNumDataBytesAndNumECBytesForBlockID(n,r,a,p,f,m);var g=f[0],x=new Uint8Array(g);t.toBytes(8*c,x,0,g);var y=e.generateECBytes(x,m[0]);h.push(new vg(x,y)),u=Math.max(u,g),d=Math.max(d,y.length),c+=f[0]}if(r!==c)throw new xg("Data bytes does not match offset");var v=new Su;for(p=0;p<u;++p)try{for(var b=(o=void 0,bg(h)),w=b.next();!w.done;w=b.next()){p<(x=w.value.getDataBytes()).length&&v.appendBits(x[p],8)}}catch(C){o={error:C}}finally{try{w&&!w.done&&(i=b.return)&&i.call(b)}finally{if(o)throw o.error}}for(p=0;p<d;++p)try{for(var k=(s=void 0,bg(h)),j=k.next();!j.done;j=k.next()){p<(y=j.value.getErrorCorrectionBytes()).length&&v.appendBits(y[p],8)}}catch(N){s={error:N}}finally{try{j&&!j.done&&(l=k.return)&&l.call(k)}finally{if(s)throw s.error}}if(n!==v.getSizeInBytes())throw new xg("Interleaving error: "+n+" and "+v.getSizeInBytes()+" differ.");return v},e.generateECBytes=function(e,t){for(var n=e.length,r=new Int32Array(n+t),a=0;a<n;a++)r[a]=255&e[a];new ug(xd.QR_CODE_FIELD_256).encode(r,t);var o=new Uint8Array(t);for(a=0;a<t;a++)o[a]=r[n+a];return o},e.appendModeInfo=function(e,t){t.appendBits(e.getBits(),4)},e.appendLengthInfo=function(e,t,n,r){var a=n.getCharacterCountBits(t);if(e>=1<<a)throw new xg(e+" is bigger than "+((1<<a)-1));r.appendBits(e,a)},e.appendBytes=function(t,n,r,a){switch(n){case If.NUMERIC:e.appendNumericBytes(t,r);break;case If.ALPHANUMERIC:e.appendAlphanumericBytes(t,r);break;case If.BYTE:e.append8BitBytes(t,r,a);break;case If.KANJI:e.appendKanjiBytes(t,r);break;default:throw new xg("Invalid mode: "+n)}},e.getDigit=function(e){return e.charCodeAt(0)-48},e.isDigit=function(t){var n=e.getDigit(t);return n>=0&&n<=9},e.appendNumericBytes=function(t,n){for(var r=t.length,a=0;a<r;){var o=e.getDigit(t.charAt(a));if(a+2<r){var i=e.getDigit(t.charAt(a+1)),s=e.getDigit(t.charAt(a+2));n.appendBits(100*o+10*i+s,10),a+=3}else if(a+1<r){i=e.getDigit(t.charAt(a+1));n.appendBits(10*o+i,7),a+=2}else n.appendBits(o,4),a++}},e.appendAlphanumericBytes=function(t,n){for(var r=t.length,a=0;a<r;){var o=e.getAlphanumericCode(t.charCodeAt(a));if(-1===o)throw new xg;if(a+1<r){var i=e.getAlphanumericCode(t.charCodeAt(a+1));if(-1===i)throw new xg;n.appendBits(45*o+i,11),a+=2}else n.appendBits(o,6),a++}},e.append8BitBytes=function(e,t,n){var r;try{r=Bu.encode(e,n)}catch(s){throw new xg(s)}for(var a=0,o=r.length;a!==o;a++){var i=r[a];t.appendBits(i,8)}},e.appendKanjiBytes=function(e,t){var n;try{n=Bu.encode(e,Ru.SJIS)}catch(l){throw new xg(l)}for(var r=n.length,a=0;a<r;a+=2){var o=(255&n[a])<<8&4294967295|255&n[a+1],i=-1;if(o>=33088&&o<=40956?i=o-33088:o>=57408&&o<=60351&&(i=o-49472),-1===i)throw new xg("Invalid byte sequence");var s=192*(i>>8)+(255&i);t.appendBits(s,13)}},e.appendECI=function(e,t){t.appendBits(If.ECI.getBits(),4),t.appendBits(e.getValue(),8)},e.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),e.DEFAULT_BYTE_MODE_ENCODING=Ru.UTF8.getName(),e}();const kg=wg;!function(){function e(){}e.prototype.write=function(t,n,r,a){if(void 0===a&&(a=null),0===t.length)throw new hu("Found empty contents");if(n<0||r<0)throw new hu("Requested dimensions are too small: "+n+"x"+r);var o=cf.L,i=e.QUIET_ZONE_SIZE;null!==a&&(void 0!==a.get(cg.ERROR_CORRECTION)&&(o=cf.fromString(a.get(cg.ERROR_CORRECTION).toString())),void 0!==a.get(cg.MARGIN)&&(i=Number.parseInt(a.get(cg.MARGIN).toString(),10)));var s=kg.encode(t,o,a);return this.renderResult(s,n,r,i)},e.prototype.writeToDom=function(e,t,n,r,a){void 0===a&&(a=null),"string"===typeof e&&(e=document.querySelector(e));var o=this.write(t,n,r,a);e&&e.appendChild(o)},e.prototype.renderResult=function(e,t,n,r){var a=e.getMatrix();if(null===a)throw new wd;for(var o=a.getWidth(),i=a.getHeight(),s=o+2*r,l=i+2*r,c=Math.max(t,s),u=Math.max(n,l),d=Math.min(Math.floor(c/s),Math.floor(u/l)),h=Math.floor((c-o*d)/2),p=Math.floor((u-i*d)/2),f=this.createSVGElement(c,u),m=0,g=p;m<i;m++,g+=d)for(var x=0,y=h;x<o;x++,y+=d)if(1===a.get(x,m)){var v=this.createSvgRectElement(y,g,d,d);f.appendChild(v)}return f},e.prototype.createSVGElement=function(t,n){var r=document.createElementNS(e.SVG_NS,"svg");return r.setAttributeNS(null,"height",t.toString()),r.setAttributeNS(null,"width",n.toString()),r},e.prototype.createSvgRectElement=function(t,n,r,a){var o=document.createElementNS(e.SVG_NS,"rect");return o.setAttributeNS(null,"x",t.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"height",r.toString()),o.setAttributeNS(null,"width",a.toString()),o.setAttributeNS(null,"fill","#000000"),o},e.QUIET_ZONE_SIZE=4,e.SVG_NS="http://www.w3.org/2000/svg"}();var jg=function(){function e(){}return e.prototype.encode=function(t,n,r,a,o){if(0===t.length)throw new hu("Found empty contents");if(n!==sd.QR_CODE)throw new hu("Can only encode QR_CODE, but got "+n);if(r<0||a<0)throw new hu("Requested dimensions are too small: "+r+"x"+a);var i=cf.L,s=e.QUIET_ZONE_SIZE;null!==o&&(void 0!==o.get(cg.ERROR_CORRECTION)&&(i=cf.fromString(o.get(cg.ERROR_CORRECTION).toString())),void 0!==o.get(cg.MARGIN)&&(s=Number.parseInt(o.get(cg.MARGIN).toString(),10)));var l=kg.encode(t,i,o);return e.renderResult(l,r,a,s)},e.renderResult=function(e,t,n,r){var a=e.getMatrix();if(null===a)throw new wd;for(var o=a.getWidth(),i=a.getHeight(),s=o+2*r,l=i+2*r,c=Math.max(t,s),u=Math.max(n,l),d=Math.min(Math.floor(c/s),Math.floor(u/l)),h=Math.floor((c-o*d)/2),p=Math.floor((u-i*d)/2),f=new Wu(c,u),m=0,g=p;m<i;m++,g+=d)for(var x=0,y=h;x<o;x++,y+=d)1===a.get(x,m)&&f.setRegion(y,g,d,d);return f},e.QUIET_ZONE_SIZE=4,e}();const Cg=jg;!function(){function e(){}e.prototype.encode=function(e,t,n,r,a){if(t!==sd.QR_CODE)throw new hu("No encoder available for format "+t);return(new Cg).encode(e,t,n,r,a)}}();var Ng=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){function t(t,n,r,a,o,i,s,l){var c=e.call(this,i,s)||this;if(c.yuvData=t,c.dataWidth=n,c.dataHeight=r,c.left=a,c.top=o,a+i>n||o+s>r)throw new hu("Crop rectangle does not fit within image data.");return l&&c.reverseHorizontal(i,s),c}Ng(t,e),t.prototype.getRow=function(e,t){if(e<0||e>=this.getHeight())throw new hu("Requested row is outside the image: "+e);var n=this.getWidth();(null===t||void 0===t||t.length<n)&&(t=new Uint8ClampedArray(n));var r=(e+this.top)*this.dataWidth+this.left;return yu.arraycopy(this.yuvData,r,t,0,n),t},t.prototype.getMatrix=function(){var e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;var n=e*t,r=new Uint8ClampedArray(n),a=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return yu.arraycopy(this.yuvData,a,r,0,n),r;for(var o=0;o<t;o++){var i=o*e;yu.arraycopy(this.yuvData,a,r,i,e),a+=this.dataWidth}return r},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(e,n,r,a){return new t(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+n,r,a,!1)},t.prototype.renderThumbnail=function(){for(var e=this.getWidth()/t.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/t.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(e*n),a=this.yuvData,o=this.top*this.dataWidth+this.left,i=0;i<n;i++){for(var s=i*e,l=0;l<e;l++){var c=255&a[o+l*t.THUMBNAIL_SCALE_FACTOR];r[s+l]=4278190080|65793*c}o+=this.dataWidth*t.THUMBNAIL_SCALE_FACTOR}return r},t.prototype.getThumbnailWidth=function(){return this.getWidth()/t.THUMBNAIL_SCALE_FACTOR},t.prototype.getThumbnailHeight=function(){return this.getHeight()/t.THUMBNAIL_SCALE_FACTOR},t.prototype.reverseHorizontal=function(e,t){for(var n=this.yuvData,r=0,a=this.top*this.dataWidth+this.left;r<t;r++,a+=this.dataWidth)for(var o=a+e/2,i=a,s=a+e-1;i<o;i++,s--){var l=n[i];n[i]=n[s],n[s]=l}},t.prototype.invert=function(){return new Zu(this)},t.THUMBNAIL_SCALE_FACTOR=2}(Yu);var _g=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){function t(t,n,r,a,o,i,s){var l=e.call(this,n,r)||this;if(l.dataWidth=a,l.dataHeight=o,l.left=i,l.top=s,4===t.BYTES_PER_ELEMENT){for(var c=n*r,u=new Uint8ClampedArray(c),d=0;d<c;d++){var h=t[d],p=h>>16&255,f=h>>7&510,m=255&h;u[d]=(p+f+m)/4&255}l.luminances=u}else l.luminances=t;if(void 0===a&&(l.dataWidth=n),void 0===o&&(l.dataHeight=r),void 0===i&&(l.left=0),void 0===s&&(l.top=0),l.left+n>l.dataWidth||l.top+r>l.dataHeight)throw new hu("Crop rectangle does not fit within image data.");return l}_g(t,e),t.prototype.getRow=function(e,t){if(e<0||e>=this.getHeight())throw new hu("Requested row is outside the image: "+e);var n=this.getWidth();(null===t||void 0===t||t.length<n)&&(t=new Uint8ClampedArray(n));var r=(e+this.top)*this.dataWidth+this.left;return yu.arraycopy(this.luminances,r,t,0,n),t},t.prototype.getMatrix=function(){var e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;var n=e*t,r=new Uint8ClampedArray(n),a=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return yu.arraycopy(this.luminances,a,r,0,n),r;for(var o=0;o<t;o++){var i=o*e;yu.arraycopy(this.luminances,a,r,i,e),a+=this.dataWidth}return r},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(e,n,r,a){return new t(this.luminances,r,a,this.dataWidth,this.dataHeight,this.left+e,this.top+n)},t.prototype.invert=function(){return new Zu(this)}}(Yu);var Sg=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Eg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Sg(t,e),t.forName=function(e){return this.getCharacterSetECIByName(e)},t}(Ru);const Ag=function(){function e(){}return e.ISO_8859_1=Ru.ISO8859_1,e}();const Ig=function(){function e(e,t,n){this.codewords=e,this.numcols=t,this.numrows=n,this.bits=new Uint8Array(t*n),Nu.fill(this.bits,2)}return e.prototype.getNumrows=function(){return this.numrows},e.prototype.getNumcols=function(){return this.numcols},e.prototype.getBits=function(){return this.bits},e.prototype.getBit=function(e,t){return 1===this.bits[t*this.numcols+e]},e.prototype.setBit=function(e,t,n){this.bits[t*this.numcols+e]=n?1:0},e.prototype.noBit=function(e,t){return 2===this.bits[t*this.numcols+e]},e.prototype.place=function(){var e=0,t=4,n=0;do{t===this.numrows&&0===n&&this.corner1(e++),t===this.numrows-2&&0===n&&this.numcols%4!==0&&this.corner2(e++),t===this.numrows-2&&0===n&&this.numcols%8===4&&this.corner3(e++),t===this.numrows+4&&2===n&&this.numcols%8===0&&this.corner4(e++);do{t<this.numrows&&n>=0&&this.noBit(n,t)&&this.utah(t,n,e++),t-=2,n+=2}while(t>=0&&n<this.numcols);t++,n+=3;do{t>=0&&n<this.numcols&&this.noBit(n,t)&&this.utah(t,n,e++),t+=2,n-=2}while(t<this.numrows&&n>=0);t+=3,n++}while(t<this.numrows||n<this.numcols);this.noBit(this.numcols-1,this.numrows-1)&&(this.setBit(this.numcols-1,this.numrows-1,!0),this.setBit(this.numcols-2,this.numrows-2,!0))},e.prototype.module=function(e,t,n,r){e<0&&(e+=this.numrows,t+=4-(this.numrows+4)%8),t<0&&(t+=this.numcols,e+=4-(this.numcols+4)%8);var a=this.codewords.charCodeAt(n);a&=1<<8-r,this.setBit(t,e,0!==a)},e.prototype.utah=function(e,t,n){this.module(e-2,t-2,n,1),this.module(e-2,t-1,n,2),this.module(e-1,t-2,n,3),this.module(e-1,t-1,n,4),this.module(e-1,t,n,5),this.module(e,t-2,n,6),this.module(e,t-1,n,7),this.module(e,t,n,8)},e.prototype.corner1=function(e){this.module(this.numrows-1,0,e,1),this.module(this.numrows-1,1,e,2),this.module(this.numrows-1,2,e,3),this.module(0,this.numcols-2,e,4),this.module(0,this.numcols-1,e,5),this.module(1,this.numcols-1,e,6),this.module(2,this.numcols-1,e,7),this.module(3,this.numcols-1,e,8)},e.prototype.corner2=function(e){this.module(this.numrows-3,0,e,1),this.module(this.numrows-2,0,e,2),this.module(this.numrows-1,0,e,3),this.module(0,this.numcols-4,e,4),this.module(0,this.numcols-3,e,5),this.module(0,this.numcols-2,e,6),this.module(0,this.numcols-1,e,7),this.module(1,this.numcols-1,e,8)},e.prototype.corner3=function(e){this.module(this.numrows-3,0,e,1),this.module(this.numrows-2,0,e,2),this.module(this.numrows-1,0,e,3),this.module(0,this.numcols-2,e,4),this.module(0,this.numcols-1,e,5),this.module(1,this.numcols-1,e,6),this.module(2,this.numcols-1,e,7),this.module(3,this.numcols-1,e,8)},e.prototype.corner4=function(e){this.module(this.numrows-1,0,e,1),this.module(this.numrows-1,this.numcols-1,e,2),this.module(0,this.numcols-3,e,3),this.module(0,this.numcols-2,e,4),this.module(0,this.numcols-1,e,5),this.module(1,this.numcols-3,e,6),this.module(1,this.numcols-2,e,7),this.module(1,this.numcols-1,e,8)},e}();var Tg,Pg,Dg=[5,7,10,11,12,14,18,20,24,28,36,42,48,56,62,68],Mg=[[228,48,15,111,62],[23,68,144,134,240,92,254],[28,24,185,166,223,248,116,255,110,61],[175,138,205,12,194,168,39,245,60,97,120],[41,153,158,91,61,42,142,213,97,178,100,242],[156,97,192,252,95,9,157,119,138,45,18,186,83,185],[83,195,100,39,188,75,66,61,241,213,109,129,94,254,225,48,90,188],[15,195,244,9,233,71,168,2,188,160,153,145,253,79,108,82,27,174,186,172],[52,190,88,205,109,39,176,21,155,197,251,223,155,21,5,172,254,124,12,181,184,96,50,193],[211,231,43,97,71,96,103,174,37,151,170,53,75,34,249,121,17,138,110,213,141,136,120,151,233,168,93,255],[245,127,242,218,130,250,162,181,102,120,84,179,220,251,80,182,229,18,2,4,68,33,101,137,95,119,115,44,175,184,59,25,225,98,81,112],[77,193,137,31,19,38,22,153,247,105,122,2,245,133,242,8,175,95,100,9,167,105,214,111,57,121,21,1,253,57,54,101,248,202,69,50,150,177,226,5,9,5],[245,132,172,223,96,32,117,22,238,133,238,231,205,188,237,87,191,106,16,147,118,23,37,90,170,205,131,88,120,100,66,138,186,240,82,44,176,87,187,147,160,175,69,213,92,253,225,19],[175,9,223,238,12,17,220,208,100,29,175,170,230,192,215,235,150,159,36,223,38,200,132,54,228,146,218,234,117,203,29,232,144,238,22,150,201,117,62,207,164,13,137,245,127,67,247,28,155,43,203,107,233,53,143,46],[242,93,169,50,144,210,39,118,202,188,201,189,143,108,196,37,185,112,134,230,245,63,197,190,250,106,185,221,175,64,114,71,161,44,147,6,27,218,51,63,87,10,40,130,188,17,163,31,176,170,4,107,232,7,94,166,224,124,86,47,11,204],[220,228,173,89,251,149,159,56,89,33,147,244,154,36,73,127,213,136,248,180,234,197,158,177,68,122,93,213,15,160,227,236,66,139,153,185,202,167,179,25,220,232,96,210,231,136,223,239,181,241,59,52,172,25,49,232,211,189,64,54,108,153,132,63,96,103,82,186]],Rg=(Tg=function(e,t){for(var n=1,r=0;r<255;r++)t[r]=n,e[n]=r,(n*=2)>=256&&(n^=301);return{LOG:e,ALOG:t}}([],[]),Tg.LOG),Fg=Tg.ALOG;!function(e){e[e.FORCE_NONE=0]="FORCE_NONE",e[e.FORCE_SQUARE=1]="FORCE_SQUARE",e[e.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"}(Pg||(Pg={}));var Og="[)>\x1e05\x1d",Bg="[)>\x1e06\x1d",Lg="\x1e\x04",zg=function(){function e(){}return e.encodeECC200=function(e,t){if(e.length!==t.getDataCapacity())throw new Error("The number of codewords does not match the selected symbol");var n=new zu;n.append(e);var r=t.getInterleavedBlockCount();if(1===r){var a=this.createECCBlock(e,t.getErrorCodewords());n.append(a)}else{for(var o=[],i=[],s=0;s<r;s++)o[s]=t.getDataLengthForInterleavedBlock(s+1),i[s]=t.getErrorLengthForInterleavedBlock(s+1);for(var l=0;l<r;l++){for(var c=new zu,u=l;u<t.getDataCapacity();u+=r)c.append(e.charAt(u));a=this.createECCBlock(c.toString(),i[l]);for(var d=0,h=l;h<i[l]*r;h+=r)n.setCharAt(t.getDataCapacity()+h,a.charAt(d++))}}return n.toString()},e.createECCBlock=function(e,t){for(var n=-1,r=0;r<Dg.length;r++)if(Dg[r]===t){n=r;break}if(n<0)throw new Error("Illegal number of error correction codewords specified: "+t);var a=Mg[n],o=[];for(r=0;r<t;r++)o[r]=0;for(r=0;r<e.length;r++){for(var i=o[t-1]^e.charAt(r).charCodeAt(0),s=t-1;s>0;s--)0!==i&&0!==a[s]?o[s]=o[s-1]^Fg[(Rg[i]+Rg[a[s]])%255]:o[s]=o[s-1];0!==i&&0!==a[0]?o[0]=Fg[(Rg[i]+Rg[a[0]])%255]:o[0]=0}var l=[];for(r=0;r<t;r++)l[r]=o[t-r-1];return l.map(function(e){return String.fromCharCode(e)}).join("")},e}();const Wg=zg;var Vg=function(){function e(){}return e.prototype.getEncodingMode=function(){return 0},e.prototype.encode=function(e){if(ax.determineConsecutiveDigitCount(e.getMessage(),e.pos)>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var t=e.getCurrentChar(),n=ax.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(n!==this.getEncodingMode())switch(n){case 5:return e.writeCodeword(231),void e.signalEncoderChange(5);case 1:return e.writeCodeword(230),void e.signalEncoderChange(1);case 3:e.writeCodeword(238),e.signalEncoderChange(3);break;case 2:e.writeCodeword(239),e.signalEncoderChange(2);break;case 4:e.writeCodeword(240),e.signalEncoderChange(4);break;default:throw new Error("Illegal mode: "+n)}else ax.isExtendedASCII(t)?(e.writeCodeword(235),e.writeCodeword(t-128+1),e.pos++):(e.writeCodeword(t+1),e.pos++)}},e.prototype.encodeASCIIDigits=function(e,t){if(ax.isDigit(e)&&ax.isDigit(t))return 10*(e-48)+(t-48)+130;throw new Error("not digits: "+e+t)},e}(),Ug=function(){function e(){}return e.prototype.getEncodingMode=function(){return 5},e.prototype.encode=function(e){var t=new zu;for(t.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();if(t.append(n),e.pos++,ax.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode())!==this.getEncodingMode()){e.signalEncoderChange(0);break}}var r=t.length()-1,a=e.getCodewordCount()+r+1;e.updateSymbolInfo(a);var o=e.getSymbolInfo().getDataCapacity()-a>0;if(e.hasMoreCharacters()||o)if(r<=249)t.setCharAt(0,Lu.getCharAt(r));else{if(!(r<=1555))throw new Error("Message length not in valid ranges: "+r);t.setCharAt(0,Lu.getCharAt(Math.floor(r/250)+249)),t.insert(1,Lu.getCharAt(r%250))}var i=0;for(n=t.length();i<n;i++)e.writeCodeword(this.randomize255State(t.charAt(i).charCodeAt(0),e.getCodewordCount()+1))},e.prototype.randomize255State=function(e,t){var n=e+(149*t%255+1);return n<=255?n:n-256},e}(),Hg=function(){function e(){}return e.prototype.getEncodingMode=function(){return 1},e.prototype.encodeMaximal=function(e){for(var t=new zu,n=0,r=e.pos,a=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,t),t.length()%3===0&&(r=e.pos,a=t.length())}if(a!==t.length()){var i=Math.floor(t.length()/3*2),s=Math.floor(e.getCodewordCount()+i+1);e.updateSymbolInfo(s);var l=e.getSymbolInfo().getDataCapacity()-s,c=Math.floor(t.length()%3);(2===c&&2!==l||1===c&&(n>3||1!==l))&&(e.pos=r)}t.length()>0&&e.writeCodeword(230),this.handleEOD(e,t)},e.prototype.encode=function(e){for(var t=new zu;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var r=this.encodeChar(n,t),a=2*Math.floor(t.length()/3),o=e.getCodewordCount()+a;e.updateSymbolInfo(o);var i=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var s=new zu;for(t.length()%3===2&&2!==i&&(r=this.backtrackOneCharacter(e,t,s,r));t.length()%3===1&&(r>3||1!==i);)r=this.backtrackOneCharacter(e,t,s,r);break}if(t.length()%3===0)if(ax.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode())!==this.getEncodingMode()){e.signalEncoderChange(0);break}}this.handleEOD(e,t)},e.prototype.backtrackOneCharacter=function(e,t,n,r){var a=t.length(),o=t.toString().substring(0,a-r);t.setLengthToZero(),t.append(o),e.pos--;var i=e.getCurrentChar();return r=this.encodeChar(i,n),e.resetSymbolInfo(),r},e.prototype.writeNextTriplet=function(e,t){e.writeCodewords(this.encodeToCodewords(t.toString()));var n=t.toString().substring(3);t.setLengthToZero(),t.append(n)},e.prototype.handleEOD=function(e,t){var n=Math.floor(t.length()/3*2),r=t.length()%3,a=e.getCodewordCount()+n;e.updateSymbolInfo(a);var o=e.getSymbolInfo().getDataCapacity()-a;if(2===r){for(t.append("\0");t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(254)}else if(1===o&&1===r){for(;t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(254),e.pos--}else{if(0!==r)throw new Error("Unexpected case. Please report!");for(;t.length()>=3;)this.writeNextTriplet(e,t);(o>0||e.hasMoreCharacters())&&e.writeCodeword(254)}e.signalEncoderChange(0)},e.prototype.encodeChar=function(e,t){if(e===" ".charCodeAt(0))return t.append(3),1;if(e>="0".charCodeAt(0)&&e<="9".charCodeAt(0))return t.append(e-48+4),1;if(e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0))return t.append(e-65+14),1;if(e<" ".charCodeAt(0))return t.append(0),t.append(e),2;if(e<="/".charCodeAt(0))return t.append(1),t.append(e-33),2;if(e<="@".charCodeAt(0))return t.append(1),t.append(e-58+15),2;if(e<="_".charCodeAt(0))return t.append(1),t.append(e-91+22),2;if(e<=127)return t.append(2),t.append(e-96),2;t.append("1\x1e");var n=2;return n+=this.encodeChar(e-128,t)},e.prototype.encodeToCodewords=function(e){var t=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=t/256,r=t%256,a=new zu;return a.append(n),a.append(r),a.toString()},e}(),Gg=function(){function e(){}return e.prototype.getEncodingMode=function(){return 4},e.prototype.encode=function(e){for(var t=new zu;e.hasMoreCharacters();){var n=e.getCurrentChar();if(this.encodeChar(n,t),e.pos++,t.length()>=4){e.writeCodewords(this.encodeToCodewords(t.toString()));var r=t.toString().substring(4);if(t.setLengthToZero(),t.append(r),ax.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode())!==this.getEncodingMode()){e.signalEncoderChange(0);break}}}t.append(Lu.getCharAt(31)),this.handleEOD(e,t)},e.prototype.handleEOD=function(e,t){try{var n=t.length();if(0===n)return;if(1===n){e.updateSymbolInfo();var r=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),a=e.getRemainingCharacters();if(a>r&&(e.updateSymbolInfo(e.getCodewordCount()+1),r=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),a<=r&&r<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,i=this.encodeToCodewords(t.toString()),s=!e.hasMoreCharacters()&&o<=2;if(o<=2)e.updateSymbolInfo(e.getCodewordCount()+o),(r=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount())>=3&&(s=!1,e.updateSymbolInfo(e.getCodewordCount()+i.length));s?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(i)}finally{e.signalEncoderChange(0)}},e.prototype.encodeChar=function(e,t){e>=" ".charCodeAt(0)&&e<="?".charCodeAt(0)?t.append(e):e>="@".charCodeAt(0)&&e<="^".charCodeAt(0)?t.append(Lu.getCharAt(e-64)):ax.illegalCharacter(Lu.getCharAt(e))},e.prototype.encodeToCodewords=function(e){var t=e.length;if(0===t)throw new Error("StringBuilder must not be empty");var n=(e.charAt(0).charCodeAt(0)<<18)+((t>=2?e.charAt(1).charCodeAt(0):0)<<12)+((t>=3?e.charAt(2).charCodeAt(0):0)<<6)+(t>=4?e.charAt(3).charCodeAt(0):0),r=n>>16&255,a=n>>8&255,o=255&n,i=new zu;return i.append(r),t>=2&&i.append(a),t>=3&&i.append(o),i.toString()},e}(),Kg=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xg=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Yg=function(){function e(e,t,n,r,a,o,i,s){void 0===i&&(i=0),void 0===s&&(s=0),this.rectangular=e,this.dataCapacity=t,this.errorCodewords=n,this.matrixWidth=r,this.matrixHeight=a,this.dataRegions=o,this.rsBlockData=i,this.rsBlockError=s}return e.lookup=function(e,t,n,r,a){var o,i;void 0===t&&(t=0),void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=!0);try{for(var s=Xg(Jg),l=s.next();!l.done;l=s.next()){var c=l.value;if((1!==t||!c.rectangular)&&((2!==t||c.rectangular)&&(null==n||!(c.getSymbolWidth()<n.getWidth()||c.getSymbolHeight()<n.getHeight()))&&(null==r||!(c.getSymbolWidth()>r.getWidth()||c.getSymbolHeight()>r.getHeight()))&&e<=c.dataCapacity))return c}}catch(u){o={error:u}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}if(a)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},e.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},e.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},e.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},e.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},e.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+2*this.getHorizontalDataRegions()},e.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+2*this.getVerticalDataRegions()},e.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},e.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},e.prototype.getDataCapacity=function(){return this.dataCapacity},e.prototype.getErrorCodewords=function(){return this.errorCodewords},e.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},e.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},e}();const qg=Yg;var Zg=function(e){function t(){return e.call(this,!1,1558,620,22,22,36,-1,62)||this}return Kg(t,e),t.prototype.getInterleavedBlockCount=function(){return 10},t.prototype.getDataLengthForInterleavedBlock=function(e){return e<=8?156:155},t}(Yg),Jg=[new Yg(!1,3,5,8,8,1),new Yg(!1,5,7,10,10,1),new Yg(!0,5,7,16,6,1),new Yg(!1,8,10,12,12,1),new Yg(!0,10,11,14,6,2),new Yg(!1,12,12,14,14,1),new Yg(!0,16,14,24,10,1),new Yg(!1,18,14,16,16,1),new Yg(!1,22,18,18,18,1),new Yg(!0,22,18,16,10,2),new Yg(!1,30,20,20,20,1),new Yg(!0,32,24,16,14,2),new Yg(!1,36,24,22,22,1),new Yg(!1,44,28,24,24,1),new Yg(!0,49,28,22,14,2),new Yg(!1,62,36,14,14,4),new Yg(!1,86,42,16,16,4),new Yg(!1,114,48,18,18,4),new Yg(!1,144,56,20,20,4),new Yg(!1,174,68,22,22,4),new Yg(!1,204,84,24,24,4,102,42),new Yg(!1,280,112,14,14,16,140,56),new Yg(!1,368,144,16,16,16,92,36),new Yg(!1,456,192,18,18,16,114,48),new Yg(!1,576,224,20,20,16,144,56),new Yg(!1,696,272,22,22,16,174,68),new Yg(!1,816,336,24,24,16,136,56),new Yg(!1,1050,408,18,18,36,175,68),new Yg(!1,1304,496,20,20,36,163,62),new Zg],Qg=function(){function e(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var t=e.split("").map(function(e){return e.charCodeAt(0)}),n=new zu,r=0,a=t.length;r<a;r++){var o=String.fromCharCode(255&t[r]);if("?"===o&&"?"!==e.charAt(r))throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new zu,this.newEncoding=-1}return e.prototype.setSymbolShape=function(e){this.shape=e},e.prototype.setSizeConstraints=function(e,t){this.minSize=e,this.maxSize=t},e.prototype.getMessage=function(){return this.msg},e.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},e.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},e.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},e.prototype.getCodewords=function(){return this.codewords},e.prototype.writeCodewords=function(e){this.codewords.append(e)},e.prototype.writeCodeword=function(e){this.codewords.append(e)},e.prototype.getCodewordCount=function(){return this.codewords.length()},e.prototype.getNewEncoding=function(){return this.newEncoding},e.prototype.signalEncoderChange=function(e){this.newEncoding=e},e.prototype.resetEncoderSignal=function(){this.newEncoding=-1},e.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},e.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},e.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},e.prototype.getSymbolInfo=function(){return this.symbolInfo},e.prototype.updateSymbolInfo=function(e){void 0===e&&(e=this.getCodewordCount()),(null==this.symbolInfo||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=qg.lookup(e,this.shape,this.minSize,this.maxSize,!0))},e.prototype.resetSymbolInfo=function(){this.symbolInfo=null},e}(),$g=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ex=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $g(t,e),t.prototype.getEncodingMode=function(){return 3},t.prototype.encode=function(e){for(var t=new zu;e.hasMoreCharacters();){var n=e.getCurrentChar();if(e.pos++,this.encodeChar(n,t),t.length()%3===0)if(this.writeNextTriplet(e,t),ax.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode())!==this.getEncodingMode()){e.signalEncoderChange(0);break}}this.handleEOD(e,t)},t.prototype.encodeChar=function(e,t){switch(e){case 13:t.append(0);break;case"*".charCodeAt(0):t.append(1);break;case">".charCodeAt(0):t.append(2);break;case" ".charCodeAt(0):t.append(3);break;default:e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)?t.append(e-48+4):e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)?t.append(e-65+14):ax.illegalCharacter(Lu.getCharAt(e))}return 1},t.prototype.handleEOD=function(e,t){e.updateSymbolInfo();var n=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),r=t.length();e.pos-=r,(e.getRemainingCharacters()>1||n>1||e.getRemainingCharacters()!==n)&&e.writeCodeword(254),e.getNewEncoding()<0&&e.signalEncoderChange(0)},t}(Hg),tx=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nx=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tx(t,e),t.prototype.getEncodingMode=function(){return 2},t.prototype.encodeChar=function(e,t){if(e===" ".charCodeAt(0))return t.append(3),1;if(e>="0".charCodeAt(0)&&e<="9".charCodeAt(0))return t.append(e-48+4),1;if(e>="a".charCodeAt(0)&&e<="z".charCodeAt(0))return t.append(e-97+14),1;if(e<" ".charCodeAt(0))return t.append(0),t.append(e),2;if(e<="/".charCodeAt(0))return t.append(1),t.append(e-33),2;if(e<="@".charCodeAt(0))return t.append(1),t.append(e-58+15),2;if(e>="[".charCodeAt(0)&&e<="_".charCodeAt(0))return t.append(1),t.append(e-91+22),2;if(e==="`".charCodeAt(0))return t.append(2),t.append(0),2;if(e<="Z".charCodeAt(0))return t.append(2),t.append(e-65+1),2;if(e<=127)return t.append(2),t.append(e-123+27),2;t.append("1\x1e");var n=2;return n+=this.encodeChar(e-128,t)},t}(Hg),rx=function(){function e(){}return e.randomize253State=function(e){var t=129+(149*e%253+1);return t<=254?t:t-254},e.encodeHighLevel=function(e,t,n,r,a){void 0===t&&(t=0),void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=!1);var o=new Hg,i=[new Vg,o,new nx,new ex,new Gg,new Ug],s=new Qg(e);s.setSymbolShape(t),s.setSizeConstraints(n,r),e.startsWith(Og)&&e.endsWith(Lg)?(s.writeCodeword(236),s.setSkipAtEnd(2),s.pos+=7):e.startsWith(Bg)&&e.endsWith(Lg)&&(s.writeCodeword(237),s.setSkipAtEnd(2),s.pos+=7);var l=0;for(a&&(o.encodeMaximal(s),l=s.getNewEncoding(),s.resetEncoderSignal());s.hasMoreCharacters();)i[l].encode(s),s.getNewEncoding()>=0&&(l=s.getNewEncoding(),s.resetEncoderSignal());var c=s.getCodewordCount();s.updateSymbolInfo();var u=s.getSymbolInfo().getDataCapacity();c<u&&0!==l&&5!==l&&4!==l&&s.writeCodeword("\xfe");var d=s.getCodewords();for(d.length()<u&&d.append(129);d.length()<u;)d.append(this.randomize253State(d.length()+1));return s.getCodewords().toString()},e.lookAheadTest=function(e,t,n){var r=this.lookAheadTestIntern(e,t,n);if(3===n&&3===r){for(var a=Math.min(t+3,e.length),o=t;o<a;o++)if(!this.isNativeX12(e.charCodeAt(o)))return 0}else if(4===n&&4===r)for(a=Math.min(t+4,e.length),o=t;o<a;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return 0;return r},e.lookAheadTestIntern=function(e,t,n){if(t>=e.length)return n;var r;0===n?r=[0,1,1,1,1,1.25]:(r=[1,2,2,2,2,2.25])[n]=0;for(var a=0,o=new Uint8Array(6),i=[];;){if(t+a===e.length){Nu.fill(o,0),Nu.fill(i,0);var s=this.findMinimums(r,i,_u.MAX_VALUE,o),l=this.getMinimumCount(o);if(i[0]===s)return 0;if(1===l){if(o[5]>0)return 5;if(o[4]>0)return 4;if(o[2]>0)return 2;if(o[3]>0)return 3}return 1}var c=e.charCodeAt(t+a);if(a++,this.isDigit(c)?r[0]+=.5:this.isExtendedASCII(c)?(r[0]=Math.ceil(r[0]),r[0]+=2):(r[0]=Math.ceil(r[0]),r[0]++),this.isNativeC40(c)?r[1]+=2/3:this.isExtendedASCII(c)?r[1]+=8/3:r[1]+=4/3,this.isNativeText(c)?r[2]+=2/3:this.isExtendedASCII(c)?r[2]+=8/3:r[2]+=4/3,this.isNativeX12(c)?r[3]+=2/3:this.isExtendedASCII(c)?r[3]+=13/3:r[3]+=10/3,this.isNativeEDIFACT(c)?r[4]+=3/4:this.isExtendedASCII(c)?r[4]+=4.25:r[4]+=3.25,this.isSpecialB256(c)?r[5]+=4:r[5]++,a>=4){if(Nu.fill(o,0),Nu.fill(i,0),this.findMinimums(r,i,_u.MAX_VALUE,o),i[0]<this.min(i[5],i[1],i[2],i[3],i[4]))return 0;if(i[5]<i[0]||i[5]+1<this.min(i[1],i[2],i[3],i[4]))return 5;if(i[4]+1<this.min(i[5],i[1],i[2],i[3],i[0]))return 4;if(i[2]+1<this.min(i[5],i[1],i[4],i[3],i[0]))return 2;if(i[3]+1<this.min(i[5],i[1],i[4],i[2],i[0]))return 3;if(i[1]+1<this.min(i[0],i[5],i[4],i[2])){if(i[1]<i[3])return 1;if(i[1]===i[3]){for(var u=t+a+1;u<e.length;){var d=e.charCodeAt(u);if(this.isX12TermSep(d))return 3;if(!this.isNativeX12(d))break;u++}return 1}}}}},e.min=function(e,t,n,r,a){var o=Math.min(e,Math.min(t,Math.min(n,r)));return void 0===a?o:Math.min(o,a)},e.findMinimums=function(e,t,n,r){for(var a=0;a<6;a++){var o=t[a]=Math.ceil(e[a]);n>o&&(n=o,Nu.fill(r,0)),n===o&&(r[a]=r[a]+1)}return n},e.getMinimumCount=function(e){for(var t=0,n=0;n<6;n++)t+=e[n];return t||0},e.isDigit=function(e){return e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)},e.isExtendedASCII=function(e){return e>=128&&e<=255},e.isNativeC40=function(e){return e===" ".charCodeAt(0)||e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)},e.isNativeText=function(e){return e===" ".charCodeAt(0)||e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)},e.isNativeX12=function(e){return this.isX12TermSep(e)||e===" ".charCodeAt(0)||e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)},e.isX12TermSep=function(e){return 13===e||e==="*".charCodeAt(0)||e===">".charCodeAt(0)},e.isNativeEDIFACT=function(e){return e>=" ".charCodeAt(0)&&e<="^".charCodeAt(0)},e.isSpecialB256=function(e){return!1},e.determineConsecutiveDigitCount=function(e,t){void 0===t&&(t=0);for(var n=e.length,r=t;r<n&&this.isDigit(e.charCodeAt(r));)r++;return r-t},e.illegalCharacter=function(e){var t=_u.toHexString(e.charCodeAt(0));throw t="0000".substring(0,4-t.length)+t,new Error("Illegal character: "+e+" (0x"+t+")")},e}();const ax=rx;var ox,ix=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},sx=function(){function e(e){this.charset=e,this.name=e.name}return e.prototype.canEncode=function(e){try{return null!=Bu.encode(e,this.charset)}catch(t){return!1}},e}(),lx=function(){function e(e,t,n){var r,a,o,i,s,l;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(e){return new sx(Eg.forName(e))}),this.encoders=[];var c=[];c.push(new sx(Ag.ISO_8859_1));for(var u=null!=t&&t.name.startsWith("UTF"),d=0;d<e.length;d++){var h=!1;try{for(var p=(r=void 0,ix(c)),f=p.next();!f.done;f=p.next()){var m=f.value,g=e.charAt(d);if(g.charCodeAt(0)===n||m.canEncode(g)){h=!0;break}}}catch(j){r={error:j}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(r)throw r.error}}if(!h)try{for(var x=(o=void 0,ix(this.ENCODERS)),y=x.next();!y.done;y=x.next()){if((m=y.value).canEncode(e.charAt(d))){c.push(m),h=!0;break}}}catch(C){o={error:C}}finally{try{y&&!y.done&&(i=x.return)&&i.call(x)}finally{if(o)throw o.error}}h||(u=!0)}if(1!==c.length||u){this.encoders=[];var v=0;try{for(var b=ix(c),w=b.next();!w.done;w=b.next()){m=w.value;this.encoders[v++]=m}}catch(N){s={error:N}}finally{try{w&&!w.done&&(l=b.return)&&l.call(b)}finally{if(s)throw s.error}}}else this.encoders=[c[0]];var k=-1;if(null!=t)for(d=0;d<this.encoders.length;d++)if(null!=this.encoders[d]&&t.name===this.encoders[d].name){k=d;break}this.priorityEncoderIndex=k}return e.prototype.length=function(){return this.encoders.length},e.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},e.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},e.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},e.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},e.prototype.canEncode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return!0},e.prototype.encode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return Bu.encode(Lu.getCharAt(e),this.encoders[t].name)},e}(),cx=function(){function e(e,t,n){this.fnc1=n;var r=new lx(e,t,n);if(1===r.length())for(var a=0;a<this.bytes.length;a++){var o=e.charAt(a).charCodeAt(0);this.bytes[a]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,r,n)}return e.prototype.getFNC1Character=function(){return this.fnc1},e.prototype.length=function(){return this.bytes.length},e.prototype.haveNCharacters=function(e,t){if(e+t-1>=this.bytes.length)return!1;for(var n=0;n<t;n++)if(this.isECI(e+n))return!1;return!0},e.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},e.prototype.subSequence=function(e,t){if(e<0||e>t||t>this.length())throw new Error(""+e);for(var n=new zu,r=e;r<t;r++){if(this.isECI(r))throw new Error("value at "+r+" is not a character but an ECI");n.append(this.charAt(r))}return n.toString()},e.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},e.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return 1e3===this.bytes[e]},e.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},e.prototype.addEdge=function(e,t,n){(null==e[t][n.encoderIndex]||e[t][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[t][n.encoderIndex]=n)},e.prototype.addEdges=function(e,t,n,r,a,o){var i=e.charAt(r).charCodeAt(0),s=0,l=t.length();t.getPriorityEncoderIndex()>=0&&(i===o||t.canEncode(i,t.getPriorityEncoderIndex()))&&(l=(s=t.getPriorityEncoderIndex())+1);for(var c=s;c<l;c++)(i===o||t.canEncode(i,c))&&this.addEdge(n,r+1,new ux(i,t,c,a,o))},e.prototype.encodeMinimally=function(e,t,n){var r=e.length,a=new(ux[r+1][t.length()]);this.addEdges(e,t,a,0,null,n);for(var o=1;o<=r;o++){for(var i=0;i<t.length();i++)null!=a[o][i]&&o<r&&this.addEdges(e,t,a,o,a[o][i],n);for(i=0;i<t.length();i++)a[o-1][i]=null}var s=-1,l=_u.MAX_VALUE;for(i=0;i<t.length();i++)if(null!=a[r][i]){var c=a[r][i];c.cachedTotalSize<l&&(l=c.cachedTotalSize,s=i)}if(s<0)throw new Error('Failed to encode "'+e+'"');for(var u=[],d=a[r][s];null!=d;){if(d.isFNC1())u.unshift(1e3);else{var h=t.encode(d.c,d.encoderIndex);for(o=h.length-1;o>=0;o--)u.unshift(255&h[o])}(null===d.previous?0:d.previous.encoderIndex)!==d.encoderIndex&&u.unshift(256+t.getECIValue(d.encoderIndex)),d=d.previous}var p=[];for(o=0;o<p.length;o++)p[o]=u[o];return p},e}(),ux=function(){function e(e,t,n,r,a){this.c=e,this.encoderSet=t,this.encoderIndex=n,this.previous=r,this.fnc1=a,this.c=e===a?1e3:e;var o=this.isFNC1()?1:t.encode(e,n).length;(null===r?0:r.encoderIndex)!==n&&(o+=3),null!=r&&(o+=r.cachedTotalSize),this.cachedTotalSize=o}return e.prototype.isFNC1=function(){return 1e3===this.c},e}(),dx=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hx=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},px=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i},fx=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(px(arguments[t]));return e};!function(e){e[e.ASCII=0]="ASCII",e[e.C40=1]="C40",e[e.TEXT=2]="TEXT",e[e.X12=3]="X12",e[e.EDF=4]="EDF",e[e.B256=5]="B256"}(ox||(ox={}));var mx=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],gx=function(){function e(){}return e.isExtendedASCII=function(e,t){return e!==t&&e>=128&&e<=255},e.isInC40Shift1Set=function(e){return e<=31},e.isInC40Shift2Set=function(e,t){var n,r;try{for(var a=hx(mx),o=a.next();!o.done;o=a.next()){if(o.value.charCodeAt(0)===e)return!0}}catch(i){n={error:i}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return e===t},e.isInTextShift1Set=function(e){return this.isInC40Shift1Set(e)},e.isInTextShift2Set=function(e,t){return this.isInC40Shift2Set(e,t)},e.encodeHighLevel=function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=-1),void 0===r&&(r=0);var a=0;return e.startsWith(Og)&&e.endsWith(Lg)?(a=5,e=e.substring(7,e.length-2)):e.startsWith(Bg)&&e.endsWith(Lg)&&(a=6,e=e.substring(7,e.length-2)),decodeURIComponent(escape(String.fromCharCode.apply(String,fx(this.encode(e,t,n,r,a)))))},e.encode=function(e,t,n,r,a){return this.encodeMinimally(new vx(e,t,n,r,a)).getBytes()},e.addEdge=function(e,t){var n=t.fromPosition+t.characterLength;(null===e[n][t.getEndMode()]||e[n][t.getEndMode()].cachedTotalSize>t.cachedTotalSize)&&(e[n][t.getEndMode()]=t)},e.getNumberOfC40Words=function(t,n,r,a){for(var o=0,i=n;i<t.length();i++){if(t.isECI(i))return a[0]=0,0;var s=t.charAt(i);if(r&&ax.isNativeC40(s)||!r&&ax.isNativeText(s))o++;else if(e.isExtendedASCII(s,t.getFNC1Character())){var l=255&s;l>=128&&(r&&ax.isNativeC40(l-128)||!r&&ax.isNativeText(l-128))?o+=3:o+=4}else o+=2;if(o%3===0||(o-2)%3===0&&i+1===t.length())return a[0]=i-n+1,Math.ceil(o/3)}return a[0]=0,0},e.addEdges=function(t,n,r,a){var o,i;if(t.isECI(r))this.addEdge(n,new yx(t,ox.ASCII,r,1,a));else{var s,l=t.charAt(r);if(null===a||a.getEndMode()!==ox.EDF){ax.isDigit(l)&&t.haveNCharacters(r,2)&&ax.isDigit(t.charAt(r+1))?this.addEdge(n,new yx(t,ox.ASCII,r,2,a)):this.addEdge(n,new yx(t,ox.ASCII,r,1,a));var c=[ox.C40,ox.TEXT];try{for(var u=hx(c),d=u.next();!d.done;d=u.next()){var h=d.value,p=[];e.getNumberOfC40Words(t,r,h===ox.C40,p)>0&&this.addEdge(n,new yx(t,h,r,p[0],a))}}catch(m){o={error:m}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}t.haveNCharacters(r,3)&&ax.isNativeX12(t.charAt(r))&&ax.isNativeX12(t.charAt(r+1))&&ax.isNativeX12(t.charAt(r+2))&&this.addEdge(n,new yx(t,ox.X12,r,3,a)),this.addEdge(n,new yx(t,ox.B256,r,1,a))}for(s=0;s<3;s++){var f=r+s;if(!t.haveNCharacters(f,1)||!ax.isNativeEDIFACT(t.charAt(f)))break;this.addEdge(n,new yx(t,ox.EDF,r,s+1,a))}3===s&&t.haveNCharacters(r,4)&&ax.isNativeEDIFACT(t.charAt(r+3))&&this.addEdge(n,new yx(t,ox.EDF,r,4,a))}},e.encodeMinimally=function(e){var t=e.length(),n=Array(t+1).fill(null).map(function(){return Array(6).fill(0)});this.addEdges(e,n,0,null);for(var r=1;r<=t;r++){for(var a=0;a<6;a++)null!==n[r][a]&&r<t&&this.addEdges(e,n,r,n[r][a]);for(a=0;a<6;a++)n[r-1][a]=null}var o=-1,i=_u.MAX_VALUE;for(a=0;a<6;a++)if(null!==n[t][a]){var s=n[t][a],l=a>=1&&a<=3?s.cachedTotalSize+1:s.cachedTotalSize;l<i&&(i=l,o=a)}if(o<0)throw new Error('Failed to encode "'+e+'"');return new xx(n[t][o])},e}(),xx=function(){function e(e){var t=e.input,n=0,r=[],a=[],o=[];e.mode!==ox.C40&&e.mode!==ox.TEXT&&e.mode!==ox.X12||e.getEndMode()===ox.ASCII||(n+=this.prepend(yx.getBytes(254),r));for(var i=e;null!==i;)n+=this.prepend(i.getDataBytes(),r),null!==i.previous&&i.getPreviousStartMode()===i.getMode()||(i.getMode()===ox.B256&&(n<=249?(r.unshift(n),n++):(r.unshift(n%250),r.unshift(n/250+249),n+=2),a.push(r.length),o.push(n)),this.prepend(i.getLatchBytes(),r),n=0),i=i.previous;5===t.getMacroId()?n+=this.prepend(yx.getBytes(236),r):6===t.getMacroId()&&(n+=this.prepend(yx.getBytes(237),r)),t.getFNC1Character()>0&&(n+=this.prepend(yx.getBytes(232),r));for(var s=0;s<a.length;s++)this.applyRandomPattern(r,r.length-a[s],o[s]);var l=e.getMinSymbolSize(r.length);for(r.length<l&&r.push(129);r.length<l;)r.push(this.randomize253State(r.length+1));this.bytes=new Uint8Array(r.length);for(s=0;s<this.bytes.length;s++)this.bytes[s]=r[s]}return e.prototype.prepend=function(e,t){for(var n=e.length-1;n>=0;n--)t.unshift(e[n]);return e.length},e.prototype.randomize253State=function(e){var t=129+(149*e%253+1);return t<=254?t:t-254},e.prototype.applyRandomPattern=function(e,t,n){for(var r=0;r<n;r++){var a=t+r,o=(255&e[a])+(149*(a+1)%255+1);e[a]=o<=255?o:o-256}},e.prototype.getBytes=function(){return this.bytes},e}(),yx=function(){function e(e,t,n,r,a){if(this.input=e,this.mode=t,this.fromPosition=n,this.characterLength=r,this.previous=a,this.allCodewordCapacities=[3,5,8,10,12,16,18,22,30,32,36,44,49,62,86,114,144,174,204,280,368,456,576,696,816,1050,1304,1558],this.squareCodewordCapacities=[3,5,8,12,18,22,30,36,44,62,86,114,144,174,204,280,368,456,576,696,816,1050,1304,1558],this.rectangularCodewordCapacities=[5,10,16,33,32,49],!(n+r<=e.length()))throw new Error("Invalid edge");var o=null!==a?a.cachedTotalSize:0,i=this.getPreviousMode();switch(t){case ox.ASCII:o++,(e.isECI(n)||gx.isExtendedASCII(e.charAt(n),e.getFNC1Character()))&&o++,i!==ox.C40&&i!==ox.TEXT&&i!==ox.X12||o++;break;case ox.B256:o++,(i!==ox.B256||250===this.getB256Size())&&o++,i===ox.ASCII?o++:i!==ox.C40&&i!==ox.TEXT&&i!==ox.X12||(o+=2);break;case ox.C40:case ox.TEXT:case ox.X12:if(t===ox.X12)o+=2;else{o+=2*gx.getNumberOfC40Words(e,n,t===ox.C40,[])}i===ox.ASCII||i===ox.B256?o++:i===t||i!==ox.C40&&i!==ox.TEXT&&i!==ox.X12||(o+=2);break;case ox.EDF:o+=3,i===ox.ASCII||i===ox.B256?o++:i!==ox.C40&&i!==ox.TEXT&&i!==ox.X12||(o+=2)}this.cachedTotalSize=o}return e.prototype.getB256Size=function(){for(var e=0,t=this;null!==t&&t.mode===ox.B256&&e<=250;)e++,t=t.previous;return e},e.prototype.getPreviousStartMode=function(){return null===this.previous?ox.ASCII:this.previous.mode},e.prototype.getPreviousMode=function(){return null===this.previous?ox.ASCII:this.previous.getEndMode()},e.prototype.getEndMode=function(){if(this.mode===ox.EDF){if(this.characterLength<4)return ox.ASCII;if((e=this.getLastASCII())>0&&this.getCodewordsRemaining(this.cachedTotalSize+e)<=2-e)return ox.ASCII}if(this.mode===ox.C40||this.mode===ox.TEXT||this.mode===ox.X12){if(this.fromPosition+this.characterLength>=this.input.length()&&0===this.getCodewordsRemaining(this.cachedTotalSize))return ox.ASCII;var e;if(1===(e=this.getLastASCII())&&0===this.getCodewordsRemaining(this.cachedTotalSize+1))return ox.ASCII}return this.mode},e.prototype.getMode=function(){return this.mode},e.prototype.getLastASCII=function(){var e=this.input.length(),t=this.fromPosition+this.characterLength;return e-t>4||t>=e?0:e-t===1?gx.isExtendedASCII(this.input.charAt(t),this.input.getFNC1Character())?0:1:e-t===2?gx.isExtendedASCII(this.input.charAt(t),this.input.getFNC1Character())||gx.isExtendedASCII(this.input.charAt(t+1),this.input.getFNC1Character())?0:ax.isDigit(this.input.charAt(t))&&ax.isDigit(this.input.charAt(t+1))?1:2:e-t===3?ax.isDigit(this.input.charAt(t))&&ax.isDigit(this.input.charAt(t+1))&&!gx.isExtendedASCII(this.input.charAt(t+2),this.input.getFNC1Character())||ax.isDigit(this.input.charAt(t+1))&&ax.isDigit(this.input.charAt(t+2))&&!gx.isExtendedASCII(this.input.charAt(t),this.input.getFNC1Character())?2:0:ax.isDigit(this.input.charAt(t))&&ax.isDigit(this.input.charAt(t+1))&&ax.isDigit(this.input.charAt(t+2))&&ax.isDigit(this.input.charAt(t+3))?2:0},e.prototype.getMinSymbolSize=function(e){var t,n,r,a,o,i;switch(this.input.getShapeHint()){case 1:try{for(var s=hx(this.squareCodewordCapacities),l=s.next();!l.done;l=s.next()){if((p=l.value)>=e)return p}}catch(f){t={error:f}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}break;case 2:try{for(var c=hx(this.rectangularCodewordCapacities),u=c.next();!u.done;u=c.next()){if((p=u.value)>=e)return p}}catch(m){r={error:m}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}}try{for(var d=hx(this.allCodewordCapacities),h=d.next();!h.done;h=d.next()){var p;if((p=h.value)>=e)return p}}catch(g){o={error:g}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}return this.allCodewordCapacities[this.allCodewordCapacities.length-1]},e.prototype.getCodewordsRemaining=function(e){return this.getMinSymbolSize(e)-e},e.getBytes=function(e,t){var n=new Uint8Array(t?2:1);return n[0]=e,t&&(n[1]=t),n},e.prototype.setC40Word=function(e,t,n,r,a){var o=1600*(255&n)+40*(255&r)+(255&a)+1;e[t]=o/256,e[t+1]=o%256},e.prototype.getX12Value=function(e){return 13===e?0:42===e?1:62===e?2:32===e?3:e>=48&&e<=57?e-44:e>=65&&e<=90?e-51:e},e.prototype.getX12Words=function(){if(this.characterLength%3!==0)throw new Error("X12 words must be a multiple of 3");for(var e=new Uint8Array(this.characterLength/3*2),t=0;t<e.length;t+=2)this.setC40Word(e,t,this.getX12Value(this.input.charAt(this.fromPosition+t/2*3)),this.getX12Value(this.input.charAt(this.fromPosition+t/2*3+1)),this.getX12Value(this.input.charAt(this.fromPosition+t/2*3+2)));return e},e.prototype.getShiftValue=function(e,t,n){return t&&gx.isInC40Shift1Set(e)||!t&&gx.isInTextShift1Set(e)?0:t&&gx.isInC40Shift2Set(e,n)||!t&&gx.isInTextShift2Set(e,n)?1:2},e.prototype.getC40Value=function(e,t,n,r){if(n===r){if(2!==t)throw new Error("FNC1 cannot be used in C40 shift 2");return 27}return e?n<=31?n:32===n?3:n<=47?n-33:n<=57?n-44:n<=64?n-43:n<=90?n-51:n<=95?n-69:n<=127?n-96:n:0===n?0:0===t&&n<=3?n-1:1===t&&n<=31?n:32===n?3:n>=33&&n<=47?n-33:n>=48&&n<=57?n-44:n>=58&&n<=64?n-43:n>=65&&n<=90?n-64:n>=91&&n<=95?n-69:96===n?0:n>=97&&n<=122?n-83:n>=123&&n<=127?n-96:n},e.prototype.getC40Words=function(e,t){for(var n=[],r=0;r<this.characterLength;r++){var a=this.input.charAt(this.fromPosition+r);if(e&&ax.isNativeC40(a)||!e&&ax.isNativeText(a))n.push(this.getC40Value(e,0,a,t));else if(gx.isExtendedASCII(a,t)){var o=(255&a)-128;if(e&&ax.isNativeC40(o)||!e&&ax.isNativeText(o))n.push(1),n.push(30),n.push(this.getC40Value(e,0,o,t));else{n.push(1),n.push(30);i=this.getShiftValue(o,e,t);n.push(i),n.push(this.getC40Value(e,i,o,t))}}else{var i=this.getShiftValue(a,e,t);n.push(i),n.push(this.getC40Value(e,i,a,t))}}if(n.length%3!==0){if((n.length-2)%3!==0||this.fromPosition+this.characterLength!==this.input.length())throw new Error("C40 words must be a multiple of 3");n.push(0)}var s=new Uint8Array(n.length/3*2),l=0;for(r=0;r<n.length;r+=3)this.setC40Word(s,l,255&n[r],255&n[r+1],255&n[r+2]),l+=2;return s},e.prototype.getEDFBytes=function(){for(var e=Math.ceil(this.characterLength/4),t=new Uint8Array(3*e),n=this.fromPosition,r=Math.min(this.fromPosition+this.characterLength-1,this.input.length()-1),a=0;a<e;a+=3){for(var o=[],i=0;i<4;i++)o[i]=n<=r?63&this.input.charAt(n++):n===r+1?31:0;var s=o[0]<<18;s|=o[1]<<12,s|=o[2]<<6,s|=o[3],t[a]=s>>16&255,t[a+1]=s>>8&255,t[a+2]=255&s}return t},e.prototype.getLatchBytes=function(){switch(this.getPreviousMode()){case ox.ASCII:case ox.B256:switch(this.mode){case ox.B256:return e.getBytes(231);case ox.C40:return e.getBytes(230);case ox.TEXT:return e.getBytes(239);case ox.X12:return e.getBytes(238);case ox.EDF:return e.getBytes(240)}break;case ox.C40:case ox.TEXT:case ox.X12:if(this.mode!==this.getPreviousMode())switch(this.mode){case ox.ASCII:return e.getBytes(254);case ox.B256:return e.getBytes(254,231);case ox.C40:return e.getBytes(254,230);case ox.TEXT:return e.getBytes(254,239);case ox.X12:return e.getBytes(254,238);case ox.EDF:return e.getBytes(254,240)}break;case ox.EDF:if(this.mode!==ox.EDF)throw new Error("Cannot switch from EDF to "+this.mode)}return new Uint8Array(0)},e.prototype.getDataBytes=function(){switch(this.mode){case ox.ASCII:return this.input.isECI(this.fromPosition)?e.getBytes(241,this.input.getECIValue(this.fromPosition)+1):gx.isExtendedASCII(this.input.charAt(this.fromPosition),this.input.getFNC1Character())?e.getBytes(235,this.input.charAt(this.fromPosition)-127):2===this.characterLength?e.getBytes(10*this.input.charAt(this.fromPosition)+this.input.charAt(this.fromPosition+1)+130):this.input.isFNC1(this.fromPosition)?e.getBytes(232):e.getBytes(this.input.charAt(this.fromPosition)+1);case ox.B256:return e.getBytes(this.input.charAt(this.fromPosition));case ox.C40:return this.getC40Words(!0,this.input.getFNC1Character());case ox.TEXT:return this.getC40Words(!1,this.input.getFNC1Character());case ox.X12:return this.getX12Words();case ox.EDF:return this.getEDFBytes()}},e}(),vx=function(e){function t(t,n,r,a,o){var i=e.call(this,t,n,r)||this;return i.shape=a,i.macroId=o,i}return dx(t,e),t.prototype.getMacroId=function(){return this.macroId},t.prototype.getShapeHint=function(){return this.shape},t}(cx);!function(){function e(){}e.prototype.encode=function(e,t,n,r,a){if(void 0===a&&(a=null),""===e.trim())throw new Error("Found empty contents");if(t!==sd.DATA_MATRIX)throw new Error("Can only encode DATA_MATRIX, but got "+t);if(n<0||r<0)throw new Error("Requested dimensions can't be negative: "+n+"x"+r);var o,i=0,s=null,l=null;if(null!=a){var c=a.get(cg.DATA_MATRIX_SHAPE);null!=c&&(i=c);var u=a.get(cg.MIN_SIZE);null!=u&&(s=u);var d=a.get(cg.MAX_SIZE);null!=d&&(l=d)}if(null!=a&&a.has(cg.DATA_MATRIX_COMPACT)&&Boolean(a.get(cg.DATA_MATRIX_COMPACT).toString())){var h=a.has(cg.GS1_FORMAT)&&Boolean(a.get(cg.GS1_FORMAT).toString()),p=null;a.has(cg.CHARACTER_SET)&&(p=Eg.forName(a.get(cg.CHARACTER_SET).toString())),o=gx.encodeHighLevel(e,p,h?29:-1,i)}else{var f=null!=a&&a.has(cg.FORCE_C40)&&Boolean(a.get(cg.FORCE_C40).toString());o=ax.encodeHighLevel(e,i,s,l,f)}var m=qg.lookup(o.length,i,s,l,!0),g=Wg.encodeECC200(o,m),x=new Ig(g,m.getSymbolDataWidth(),m.getSymbolDataHeight());return x.place(),this.encodeLowLevel(x,m,n,r)},e.prototype.encodeLowLevel=function(e,t,n,r){for(var a=t.getSymbolDataWidth(),o=t.getSymbolDataHeight(),i=new fg(t.getSymbolWidth(),t.getSymbolHeight()),s=0,l=0;l<o;l++){var c=void 0;if(l%t.matrixHeight===0){c=0;for(var u=0;u<t.getSymbolWidth();u++)i.setBoolean(c,s,u%2===0),c++;s++}c=0;for(u=0;u<a;u++)u%t.matrixWidth===0&&(i.setBoolean(c,s,!0),c++),i.setBoolean(c,s,e.getBit(u,l)),c++,u%t.matrixWidth===t.matrixWidth-1&&(i.setBoolean(c,s,l%2===0),c++);if(s++,l%t.matrixHeight===t.matrixHeight-1){c=0;for(u=0;u<t.getSymbolWidth();u++)i.setBoolean(c,s,!0),c++;s++}}return this.convertByteMatrixToBitMatrix(i,n,r)},e.prototype.convertByteMatrixToBitMatrix=function(e,t,n){var r,a=e.getWidth(),o=e.getHeight(),i=Math.max(t,a),s=Math.max(n,o),l=Math.min(i/a,s/o),c=(i-a*l)/2,u=(s-o*l)/2;n<o||t<a?(c=0,u=0,r=new Wu(a,o)):r=new Wu(t,n),r.clear();for(var d=0,h=u;d<o;d++,h+=l)for(var p=0,f=c;p<a;p++,f+=l)1===e.get(p,d)&&r.setRegion(f,h,l,l);return r}}();const bx=function(){function e(){}return e.prototype.isCompact=function(){return this.compact},e.prototype.setCompact=function(e){this.compact=e},e.prototype.getSize=function(){return this.size},e.prototype.setSize=function(e){this.size=e},e.prototype.getLayers=function(){return this.layers},e.prototype.setLayers=function(e){this.layers=e},e.prototype.getCodeWords=function(){return this.codeWords},e.prototype.setCodeWords=function(e){this.codeWords=e},e.prototype.getMatrix=function(){return this.matrix},e.prototype.setMatrix=function(e){this.matrix=e},e}();const wx=function(){function e(){}return e.singletonList=function(e){return[e]},e.min=function(e,t){return e.sort(t)[0]},e}();const kx=function(){function e(e){this.previous=e}return e.prototype.getPrevious=function(){return this.previous},e}();var jx=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Cx=function(e){function t(t,n,r){var a=e.call(this,t)||this;return a.value=n,a.bitCount=r,a}return jx(t,e),t.prototype.appendTo=function(e,t){e.appendBits(this.value,this.bitCount)},t.prototype.add=function(e,n){return new t(this,e,n)},t.prototype.addBinaryShift=function(e,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new t(this,e,n)},t.prototype.toString=function(){var e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+_u.toBinaryString(e|1<<this.bitCount).substring(1)+">"},t}(kx);var Nx=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const _x=function(e){function t(t,n,r){var a=e.call(this,t,0,0)||this;return a.binaryShiftStart=n,a.binaryShiftByteCount=r,a}return Nx(t,e),t.prototype.appendTo=function(e,t){for(var n=0;n<this.binaryShiftByteCount;n++)(0===n||31===n&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):0===n?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+n],8)},t.prototype.addBinaryShift=function(e,n){return new t(this,e,n)},t.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},t}(Cx);function Sx(e,t,n){return new Cx(e,t,n)}var Ex=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Ax=new Cx(null,0,0),Ix=[Int32Array.from([0,327708,327710,327709,656318]),Int32Array.from([590318,0,327710,327709,656318]),Int32Array.from([262158,590300,0,590301,932798]),Int32Array.from([327709,327708,656318,0,327710]),Int32Array.from([327711,656380,656382,656381,0])],Tx=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var Px=function(e){var t,n;try{for(var r=Tx(e),a=r.next();!a.done;a=r.next()){var o=a.value;Nu.fill(o,-1)}}catch(i){t={error:i}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return e[0][4]=0,e[1][4]=0,e[1][0]=28,e[3][4]=0,e[2][4]=0,e[2][0]=15,e}(Nu.createInt32Array(6,6)),Dx=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Mx=function(){function e(e,t,n,r){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=r}return e.prototype.getMode=function(){return this.mode},e.prototype.getToken=function(){return this.token},e.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},e.prototype.getBitCount=function(){return this.bitCount},e.prototype.latchAndAppend=function(t,n){var r=this.bitCount,a=this.token;if(t!==this.mode){var o=Ix[this.mode][t];a=Sx(a,65535&o,o>>16),r+=o>>16}var i=2===t?4:5;return new e(a=Sx(a,n,i),t,0,r+i)},e.prototype.shiftAndAppend=function(t,n){var r=this.token,a=2===this.mode?4:5;return r=Sx(r,Px[this.mode][t],a),new e(r=Sx(r,n,5),this.mode,0,this.bitCount+a+5)},e.prototype.addBinaryShiftChar=function(t){var n=this.token,r=this.mode,a=this.bitCount;if(4===this.mode||2===this.mode){var o=Ix[r][0];n=Sx(n,65535&o,o>>16),a+=o>>16,r=0}var i=0===this.binaryShiftByteCount||31===this.binaryShiftByteCount?18:62===this.binaryShiftByteCount?9:8,s=new e(n,r,this.binaryShiftByteCount+1,a+i);return 2078===s.binaryShiftByteCount&&(s=s.endBinaryShift(t+1)),s},e.prototype.endBinaryShift=function(t){if(0===this.binaryShiftByteCount)return this;var n=this.token;return new e(n=function(e,t,n){return new _x(e,t,n)}(n,t-this.binaryShiftByteCount,this.binaryShiftByteCount),this.mode,0,this.bitCount)},e.prototype.isBetterThanOrEqualTo=function(t){var n=this.bitCount+(Ix[this.mode][t.mode]>>16);return this.binaryShiftByteCount<t.binaryShiftByteCount?n+=e.calculateBinaryShiftCost(t)-e.calculateBinaryShiftCost(this):this.binaryShiftByteCount>t.binaryShiftByteCount&&t.binaryShiftByteCount>0&&(n+=10),n<=t.bitCount},e.prototype.toBitArray=function(e){for(var t,n,r=[],a=this.endBinaryShift(e.length).token;null!==a;a=a.getPrevious())r.unshift(a);var o=new Su;try{for(var i=Dx(r),s=i.next();!s.done;s=i.next()){s.value.appendTo(o,e)}}catch(l){t={error:l}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o},e.prototype.toString=function(){return Lu.format("%s bits=%d bytes=%d",Ex[this.mode],this.bitCount,this.binaryShiftByteCount)},e.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},e.INITIAL_STATE=new e(Ax,0,0,0),e}();const Rx=Mx;var Fx=function(e){var t=Lu.getCharCode(" "),n=Lu.getCharCode("."),r=Lu.getCharCode(",");e[0][t]=1;for(var a=Lu.getCharCode("Z"),o=Lu.getCharCode("A"),i=o;i<=a;i++)e[0][i]=i-o+2;e[1][t]=1;var s=Lu.getCharCode("z"),l=Lu.getCharCode("a");for(i=l;i<=s;i++)e[1][i]=i-l+2;e[2][t]=1;var c=Lu.getCharCode("9"),u=Lu.getCharCode("0");for(i=u;i<=c;i++)e[2][i]=i-u+2;e[2][r]=12,e[2][n]=13;for(var d=["\0"," ","\x01","\x02","\x03","\x04","\x05","\x06","\x07","\b","\t","\n","\v","\f","\r","\x1b","\x1c","\x1d","\x1e","\x1f","@","\\","^","_","`","|","~","\x7f"],h=0;h<d.length;h++)e[3][Lu.getCharCode(d[h])]=h;var p=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(h=0;h<p.length;h++)Lu.getCharCode(p[h])>0&&(e[4][Lu.getCharCode(p[h])]=h);return e}(Nu.createInt32Array(5,256)),Ox=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Bx=function(){function e(e){this.text=e}return e.prototype.encode=function(){for(var t=Lu.getCharCode(" "),n=Lu.getCharCode("\n"),r=wx.singletonList(Rx.INITIAL_STATE),a=0;a<this.text.length;a++){var o=void 0,i=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case Lu.getCharCode("\r"):o=i===n?2:0;break;case Lu.getCharCode("."):o=i===t?3:0;break;case Lu.getCharCode(","):o=i===t?4:0;break;case Lu.getCharCode(":"):o=i===t?5:0;break;default:o=0}o>0?(r=e.updateStateListForPair(r,a,o),a++):r=this.updateStateListForChar(r,a)}return wx.min(r,function(e,t){return e.getBitCount()-t.getBitCount()}).toBitArray(this.text)},e.prototype.updateStateListForChar=function(t,n){var r,a,o=[];try{for(var i=Ox(t),s=i.next();!s.done;s=i.next()){var l=s.value;this.updateStateForChar(l,n,o)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return e.simplifyStates(o)},e.prototype.updateStateForChar=function(e,t,n){for(var r=255&this.text[t],a=Fx[e.getMode()][r]>0,o=null,i=0;i<=4;i++){var s=Fx[i][r];if(s>0){if(null==o&&(o=e.endBinaryShift(t)),!a||i===e.getMode()||2===i){var l=o.latchAndAppend(i,s);n.push(l)}if(!a&&Px[e.getMode()][i]>=0){var c=o.shiftAndAppend(i,s);n.push(c)}}}if(e.getBinaryShiftByteCount()>0||0===Fx[e.getMode()][r]){var u=e.addBinaryShiftChar(t);n.push(u)}},e.updateStateListForPair=function(e,t,n){var r,a,o=[];try{for(var i=Ox(e),s=i.next();!s.done;s=i.next()){var l=s.value;this.updateStateForPair(l,t,n,o)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return this.simplifyStates(o)},e.updateStateForPair=function(e,t,n,r){var a=e.endBinaryShift(t);if(r.push(a.latchAndAppend(4,n)),4!==e.getMode()&&r.push(a.shiftAndAppend(4,n)),3===n||4===n){var o=a.latchAndAppend(2,16-n).latchAndAppend(2,1);r.push(o)}if(e.getBinaryShiftByteCount()>0){var i=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);r.push(i)}},e.simplifyStates=function(e){var t,n,r,a,o=[];try{for(var i=Ox(e),s=i.next();!s.done;s=i.next()){var l=s.value,c=!0,u=function(e){if(e.isBetterThanOrEqualTo(l))return c=!1,"break";l.isBetterThanOrEqualTo(e)&&(o=o.filter(function(t){return t!==e}))};try{for(var d=(r=void 0,Ox(o)),h=d.next();!h.done;h=d.next()){if("break"===u(h.value))break}}catch(p){r={error:p}}finally{try{h&&!h.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}c&&o.push(l)}}catch(f){t={error:f}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o},e}();const Lx=Bx;var zx=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Wx=function(){function e(){}return e.encodeBytes=function(t){return e.encode(t,e.DEFAULT_EC_PERCENT,e.DEFAULT_AZTEC_LAYERS)},e.encode=function(t,n,r){var a,o,i,s,l,c=new Lx(t).encode(),u=_u.truncDivision(c.getSize()*n,100)+11,d=c.getSize()+u;if(r!==e.DEFAULT_AZTEC_LAYERS){if(a=r<0,(o=Math.abs(r))>(a?e.MAX_NB_BITS_COMPACT:e.MAX_NB_BITS))throw new hu(Lu.format("Illegal value %s for layers",r));var h=(i=e.totalBitsInLayer(o,a))-i%(s=e.WORD_SIZE[o]);if((l=e.stuffBits(c,s)).getSize()+u>h)throw new hu("Data to large for user specified layer");if(a&&l.getSize()>64*s)throw new hu("Data to large for user specified layer")}else{s=0,l=null;for(var p=0;;p++){if(p>e.MAX_NB_BITS)throw new hu("Data too large for an Aztec code");if(o=(a=p<=3)?p+1:p,!(d>(i=e.totalBitsInLayer(o,a)))){null!=l&&s===e.WORD_SIZE[o]||(s=e.WORD_SIZE[o],l=e.stuffBits(c,s));h=i-i%s;if(!(a&&l.getSize()>64*s)&&l.getSize()+u<=h)break}}}var f,m=e.generateCheckWords(l,i,s),g=l.getSize()/s,x=e.generateModeMessage(a,o,g),y=(a?11:14)+4*o,v=new Int32Array(y);if(a){f=y;for(p=0;p<v.length;p++)v[p]=p}else{f=y+1+2*_u.truncDivision(_u.truncDivision(y,2)-1,15);var b=_u.truncDivision(y,2),w=_u.truncDivision(f,2);for(p=0;p<b;p++){var k=p+_u.truncDivision(p,15);v[b-p-1]=w-k-1,v[b+p]=w+k+1}}for(var j=new Wu(f),C=(p=0,0);p<o;p++){for(var N=4*(o-p)+(a?9:12),_=0;_<N;_++)for(var S=2*_,E=0;E<2;E++)m.get(C+S+E)&&j.set(v[2*p+E],v[2*p+_]),m.get(C+2*N+S+E)&&j.set(v[2*p+_],v[y-1-2*p-E]),m.get(C+4*N+S+E)&&j.set(v[y-1-2*p-E],v[y-1-2*p-_]),m.get(C+6*N+S+E)&&j.set(v[y-1-2*p-_],v[2*p+E]);C+=8*N}if(e.drawModeMessage(j,a,f,x),a)e.drawBullsEye(j,_u.truncDivision(f,2),5);else{e.drawBullsEye(j,_u.truncDivision(f,2),7);for(p=0,_=0;p<_u.truncDivision(y,2)-1;p+=15,_+=16)for(E=1&_u.truncDivision(f,2);E<f;E+=2)j.set(_u.truncDivision(f,2)-_,E),j.set(_u.truncDivision(f,2)+_,E),j.set(E,_u.truncDivision(f,2)-_),j.set(E,_u.truncDivision(f,2)+_)}var A=new bx;return A.setCompact(a),A.setSize(f),A.setLayers(o),A.setCodeWords(g),A.setMatrix(j),A},e.drawBullsEye=function(e,t,n){for(var r=0;r<n;r+=2)for(var a=t-r;a<=t+r;a++)e.set(a,t-r),e.set(a,t+r),e.set(t-r,a),e.set(t+r,a);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)},e.generateModeMessage=function(t,n,r){var a=new Su;return t?(a.appendBits(n-1,2),a.appendBits(r-1,6),a=e.generateCheckWords(a,28,4)):(a.appendBits(n-1,5),a.appendBits(r-1,11),a=e.generateCheckWords(a,40,4)),a},e.drawModeMessage=function(e,t,n,r){var a=_u.truncDivision(n,2);if(t)for(var o=0;o<7;o++){var i=a-3+o;r.get(o)&&e.set(i,a-5),r.get(o+7)&&e.set(a+5,i),r.get(20-o)&&e.set(i,a+5),r.get(27-o)&&e.set(a-5,i)}else for(o=0;o<10;o++){i=a-5+o+_u.truncDivision(o,5);r.get(o)&&e.set(i,a-7),r.get(o+10)&&e.set(a+7,i),r.get(29-o)&&e.set(i,a+7),r.get(39-o)&&e.set(a-7,i)}},e.generateCheckWords=function(t,n,r){var a,o,i=t.getSize()/r,s=new ug(e.getGF(r)),l=_u.truncDivision(n,r),c=e.bitsToWords(t,r,l);s.encode(c,l-i);var u=n%r,d=new Su;d.appendBits(0,u);try{for(var h=zx(Array.from(c)),p=h.next();!p.done;p=h.next()){var f=p.value;d.appendBits(f,r)}}catch(m){a={error:m}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}return d},e.bitsToWords=function(e,t,n){var r,a,o=new Int32Array(n);for(r=0,a=e.getSize()/t;r<a;r++){for(var i=0,s=0;s<t;s++)i|=e.get(r*t+s)?1<<t-s-1:0;o[r]=i}return o},e.getGF=function(e){switch(e){case 4:return xd.AZTEC_PARAM;case 6:return xd.AZTEC_DATA_6;case 8:return xd.AZTEC_DATA_8;case 10:return xd.AZTEC_DATA_10;case 12:return xd.AZTEC_DATA_12;default:throw new hu("Unsupported word size "+e)}},e.stuffBits=function(e,t){for(var n=new Su,r=e.getSize(),a=(1<<t)-2,o=0;o<r;o+=t){for(var i=0,s=0;s<t;s++)(o+s>=r||e.get(o+s))&&(i|=1<<t-1-s);(i&a)===a?(n.appendBits(i&a,t),o--):0===(i&a)?(n.appendBits(1|i,t),o--):n.appendBits(i,t)}return n},e.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},e.DEFAULT_EC_PERCENT=33,e.DEFAULT_AZTEC_LAYERS=0,e.MAX_NB_BITS=32,e.MAX_NB_BITS_COMPACT=4,e.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),e}();const Vx=Wx;!function(){function e(){}e.prototype.encode=function(e,t,n,r){return this.encodeWithHints(e,t,n,r,null)},e.prototype.encodeWithHints=function(t,n,r,a,o){var i=Ag.ISO_8859_1,s=Vx.DEFAULT_EC_PERCENT,l=Vx.DEFAULT_AZTEC_LAYERS;return null!=o&&(o.has(cg.CHARACTER_SET)&&(i=Eg.forName(o.get(cg.CHARACTER_SET).toString())),o.has(cg.ERROR_CORRECTION)&&(s=_u.parseInt(o.get(cg.ERROR_CORRECTION).toString())),o.has(cg.AZTEC_LAYERS)&&(l=_u.parseInt(o.get(cg.AZTEC_LAYERS).toString()))),e.encodeLayers(t,n,r,a,i,s,l)},e.encodeLayers=function(t,n,r,a,o,i,s){if(n!==sd.AZTEC)throw new hu("Can only encode AZTEC, but got "+n);var l=Vx.encode(Lu.getBytes(t,o),i,s);return e.renderResult(l,r,a)},e.renderResult=function(e,t,n){var r=e.getMatrix();if(null==r)throw new wd;for(var a=r.getWidth(),o=r.getHeight(),i=Math.max(t,a),s=Math.max(n,o),l=Math.min(i/a,s/o),c=(i-a*l)/2,u=(s-o*l)/2,d=new Wu(i,s),h=0,p=u;h<o;h++,p+=l)for(var f=0,m=c;f<a;f++,m+=l)r.get(f,h)&&d.setRegion(m,p,l,l);return d}}();var Ux=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hx=function(e){function t(n){var r=e.call(this,n.width,n.height)||this;return r.canvas=n,r.tempCanvasElement=null,r.buffer=t.makeBufferFromCanvasImageData(n),r}return Ux(t,e),t.makeBufferFromCanvasImageData=function(e){var n;try{n=e.getContext("2d",{willReadFrequently:!0})}catch(Z_){n=e.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var r=n.getImageData(0,0,e.width,e.height);return t.toGrayscaleBuffer(r.data,e.width,e.height)},t.toGrayscaleBuffer=function(e,t,n){for(var r=new Uint8ClampedArray(t*n),a=0,o=0,i=e.length;a<i;a+=4,o++){var s=void 0;if(0===e[a+3])s=255;else s=306*e[a]+601*e[a+1]+117*e[a+2]+512>>10;r[o]=s}return r},t.prototype.getRow=function(e,t){if(e<0||e>=this.getHeight())throw new hu("Requested row is outside the image: "+e);var n=this.getWidth(),r=e*n;return null===t?t=this.buffer.slice(r,r+n):(t.length<n&&(t=new Uint8ClampedArray(n)),t.set(this.buffer.slice(r,r+n))),t},t.prototype.getMatrix=function(){return this.buffer},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(t,n,r,a){return e.prototype.crop.call(this,t,n,r,a),this},t.prototype.isRotateSupported=function(){return!0},t.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},t.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},t.prototype.invert=function(){return new Zu(this)},t.prototype.getTempCanvasElement=function(){if(null===this.tempCanvasElement){var e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement},t.prototype.rotate=function(e){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var r=e*t.DEGREE_TO_RADIANS,a=this.canvas.width,o=this.canvas.height,i=Math.ceil(Math.abs(Math.cos(r))*a+Math.abs(Math.sin(r))*o),s=Math.ceil(Math.abs(Math.sin(r))*a+Math.abs(Math.cos(r))*o);n.width=i,n.height=s;var l=n.getContext("2d");if(!l)throw new Error("Could not create a Canvas Context element.");return l.translate(i/2,s/2),l.rotate(r),l.drawImage(this.canvas,a/-2,o/-2),this.buffer=t.makeBufferFromCanvasImageData(n),this},t.DEGREE_TO_RADIANS=Math.PI/180,t}(Yu);function Gx(){return"undefined"!==typeof navigator}function Kx(){return!!(Gx()&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)}var Xx=function(){return Xx=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Xx.apply(this,arguments)},Yx=function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{l(r.next(e))}catch(Z_){o(Z_)}}function s(e){try{l(r.throw(e))}catch(Z_){o(Z_)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,s)}l((r=r.apply(e,t||[])).next())})},qx=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(Z_){o=[6,Z_],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Zx=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Jx={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},Qx=function(){function e(e,t,n){void 0===t&&(t=new Map),void 0===n&&(n={}),this.reader=e,this.hints=t,this.options=Xx(Xx({},Jx),n)}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(e){this.hints.set(Au.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),e.addVideoSource=function(e,t){try{e.srcObject=t}catch(n){console.error("got interrupted by new loading request")}},e.mediaStreamSetTorch=function(e,t){return Yx(this,void 0,void 0,function(){return qx(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:t?"flash":"off",torch:!!t}]})];case 1:return n.sent(),[2]}})})},e.mediaStreamIsTorchCompatible=function(t){var n,r,a=t.getVideoTracks();try{for(var o=Zx(a),i=o.next();!i.done;i=o.next()){var s=i.value;if(e.mediaStreamIsTorchCompatibleTrack(s))return!0}}catch(l){n={error:l}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1},e.mediaStreamIsTorchCompatibleTrack=function(e){try{return"torch"in e.getCapabilities()}catch(t){return console.error(t),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},e.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},e.getMediaElement=function(e,t){var n=document.getElementById(e);if(!n)throw new uu("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new uu("element with id '".concat(e,"' must be an ").concat(t," element"));return n},e.createVideoElement=function(t){if(t instanceof HTMLVideoElement)return t;if("string"===typeof t)return e.getMediaElement(t,"video");if(!t&&"undefined"!==typeof document){var n=document.createElement("video");return n.width=200,n.height=200,n}throw new Error("Couldn't get videoElement from videoSource!")},e.prepareImageElement=function(t){if(t instanceof HTMLImageElement)return t;if("string"===typeof t)return e.getMediaElement(t,"img");if("undefined"===typeof t){var n=document.createElement("img");return n.width=200,n.height=200,n}throw new Error("Couldn't get imageElement from imageSource!")},e.prepareVideoElement=function(t){var n=e.createVideoElement(t);return n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),n.setAttribute("playsinline","true"),n},e.isImageLoaded=function(e){return!!e.complete&&0!==e.naturalWidth},e.createBinaryBitmapFromCanvas=function(e){var t=new Hx(e),n=new Xu(t);return new pu(n)},e.drawImageOnCanvas=function(e,t){e.drawImage(t,0,0)},e.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},e.createCaptureCanvas=function(t){if(!t)throw new uu("Cannot create a capture canvas without a media element.");if("undefined"===typeof document)throw new Error('The page "Document" is undefined, make sure you\'re running in a browser.');var n=document.createElement("canvas"),r=e.getMediaElementDimensions(t),a=r.width,o=r.height;return n.style.width=a+"px",n.style.height=o+"px",n.width=a,n.height=o,n},e.tryPlayVideo=function(t){return Yx(this,void 0,void 0,function(){var n;return qx(this,function(r){switch(r.label){case 0:if(null===t||void 0===t?void 0:t.ended)return console.error("Trying to play video that has ended."),[2,!1];if(e.isVideoPlaying(t))return console.warn("Trying to play video that is already playing."),[2,!0];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.play()];case 2:return r.sent(),[2,!0];case 3:return n=r.sent(),console.warn("It was not possible to play the video.",n),[2,!1];case 4:return[2]}})})},e.createCanvasFromMediaElement=function(t){var n=e.createCaptureCanvas(t),r=n.getContext("2d");if(!r)throw new Error("Couldn't find Canvas 2D Context.");return e.drawImageOnCanvas(r,t),n},e.createBinaryBitmapFromMediaElem=function(t){var n=e.createCanvasFromMediaElement(t);return e.createBinaryBitmapFromCanvas(n)},e.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},e.listVideoInputDevices=function(){return Yx(this,void 0,void 0,function(){var e,t,n,r,a,o,i,s,l,c,u,d;return qx(this,function(h){switch(h.label){case 0:if(!Gx())throw new Error("Can't enumerate devices, navigator is not present.");if(!Kx())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),t=[];try{for(n=Zx(e),r=n.next();!r.done;r=n.next())a=r.value,"videoinput"===(o="video"===a.kind?"videoinput":a.kind)&&(i=a.deviceId||a.id,s=a.label||"Video device ".concat(t.length+1),l=a.groupId,c={deviceId:i,label:s,kind:o,groupId:l},t.push(c))}catch(p){u={error:p}}finally{try{r&&!r.done&&(d=n.return)&&d.call(n)}finally{if(u)throw u.error}}return[2,t]}})})},e.findDeviceById=function(t){return Yx(this,void 0,void 0,function(){var n;return qx(this,function(r){switch(r.label){case 0:return[4,e.listVideoInputDevices()];case 1:return(n=r.sent())?[2,n.find(function(e){return e.deviceId===t})]:[2]}})})},e.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch(t){e.src=""}e&&e.removeAttribute("src")}},e.releaseAllStreams=function(){0!==e.streamTracker.length&&e.streamTracker.forEach(function(e){e.getTracks().forEach(function(e){return e.stop()})}),e.streamTracker=[]},e.playVideoOnLoadAsync=function(t,n){return Yx(this,void 0,void 0,function(){return qx(this,function(r){switch(r.label){case 0:return[4,e.tryPlayVideo(t)];case 1:return r.sent()?[2,!0]:[2,new Promise(function(r,a){var o=setTimeout(function(){e.isVideoPlaying(t)||(a(!1),t.removeEventListener("canplay",i))},n),i=function(){e.tryPlayVideo(t).then(function(e){clearTimeout(o),t.removeEventListener("canplay",i),r(e)})};t.addEventListener("canplay",i)})]}})})},e.attachStreamToVideo=function(t,n,r){return void 0===r&&(r=5e3),Yx(this,void 0,void 0,function(){var a;return qx(this,function(o){switch(o.label){case 0:return a=e.prepareVideoElement(n),e.addVideoSource(a,t),[4,e.playVideoOnLoadAsync(a,r)];case 1:return o.sent(),[2,a]}})})},e._waitImageLoad=function(t){return new Promise(function(n,r){var a=setTimeout(function(){e.isImageLoaded(t)||(t.removeEventListener("load",o),r())},1e4),o=function(){clearTimeout(a),t.removeEventListener("load",o),n()};t.addEventListener("load",o)})},e.checkCallbackFnOrThrow=function(e){if(!e)throw new uu("`callbackFn` is a required parameter, you cannot capture results without it.")},e.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(e){return e.stop()}),e=void 0},e.prototype.decode=function(t){var n=e.createCanvasFromMediaElement(t);return this.decodeFromCanvas(n)},e.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},e.prototype.decodeFromCanvas=function(t){var n=e.createBinaryBitmapFromCanvas(t);return this.decodeBitmap(n)},e.prototype.decodeFromImageElement=function(t){return Yx(this,void 0,void 0,function(){var n;return qx(this,function(r){switch(r.label){case 0:if(!t)throw new uu("An image element must be provided.");return n=e.prepareImageElement(t),[4,this._decodeOnLoadImage(n)];case 1:return[2,r.sent()]}})})},e.prototype.decodeFromImageUrl=function(t){return Yx(this,void 0,void 0,function(){var n;return qx(this,function(r){switch(r.label){case 0:if(!t)throw new uu("An URL must be provided.");(n=e.prepareImageElement()).src=t,r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.decodeFromImageElement(n)];case 2:return[2,r.sent()];case 3:return e.destroyImageElement(n),[7];case 4:return[2]}})})},e.prototype.decodeFromConstraints=function(t,n,r){return Yx(this,void 0,void 0,function(){var a,o;return qx(this,function(i){switch(i.label){case 0:return e.checkCallbackFnOrThrow(r),[4,this.getUserMedia(t)];case 1:a=i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.decodeFromStream(a,n,r)];case 3:return[2,i.sent()];case 4:throw o=i.sent(),e.disposeMediaStream(a),o;case 5:return[2]}})})},e.prototype.decodeFromStream=function(t,n,r){return Yx(this,void 0,void 0,function(){var a,o,i,s,l,c,u,d,h=this;return qx(this,function(p){switch(p.label){case 0:return e.checkCallbackFnOrThrow(r),a=this.options.tryPlayVideoTimeout,[4,e.attachStreamToVideo(t,n,a)];case 1:return o=p.sent(),i=function(){e.disposeMediaStream(t),e.cleanVideoSource(o)},s=this.scan(o,r,i),l=t.getVideoTracks(),c=Xx(Xx({},s),{stop:function(){s.stop()},streamVideoConstraintsApply:function(e,t){return Yx(this,void 0,void 0,function(){var n,r,a,o,i,s;return qx(this,function(c){switch(c.label){case 0:n=t?l.filter(t):l,c.label=1;case 1:c.trys.push([1,6,7,8]),r=Zx(n),a=r.next(),c.label=2;case 2:return a.done?[3,5]:[4,a.value.applyConstraints(e)];case 3:c.sent(),c.label=4;case 4:return a=r.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),i={error:o},[3,8];case 7:try{a&&!a.done&&(s=r.return)&&s.call(r)}finally{if(i)throw i.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(e){return l.find(e).getConstraints()},streamVideoSettingsGet:function(e){return l.find(e).getSettings()},streamVideoCapabilitiesGet:function(e){return l.find(e).getCapabilities()}}),e.mediaStreamIsTorchCompatible(t)&&(u=null===l||void 0===l?void 0:l.find(function(t){return e.mediaStreamIsTorchCompatibleTrack(t)}),d=function(t){return Yx(h,void 0,void 0,function(){return qx(this,function(n){switch(n.label){case 0:return[4,e.mediaStreamSetTorch(u,t)];case 1:return n.sent(),[2]}})})},c.switchTorch=d,c.stop=function(){return Yx(h,void 0,void 0,function(){return qx(this,function(e){switch(e.label){case 0:return s.stop(),[4,d(!1)];case 1:return e.sent(),[2]}})})}),[2,c]}})})},e.prototype.decodeFromVideoDevice=function(t,n,r){return Yx(this,void 0,void 0,function(){var a;return qx(this,function(o){switch(o.label){case 0:return e.checkCallbackFnOrThrow(r),a={video:t?{deviceId:{exact:t}}:{facingMode:"environment"}},[4,this.decodeFromConstraints(a,n,r)];case 1:return[2,o.sent()]}})})},e.prototype.decodeFromVideoElement=function(t,n){return Yx(this,void 0,void 0,function(){var r,a;return qx(this,function(o){switch(o.label){case 0:if(e.checkCallbackFnOrThrow(n),!t)throw new uu("A video element must be provided.");return r=e.prepareVideoElement(t),a=this.options.tryPlayVideoTimeout,[4,e.playVideoOnLoadAsync(r,a)];case 1:return o.sent(),[2,this.scan(r,n)]}})})},e.prototype.decodeFromVideoUrl=function(t,n){return Yx(this,void 0,void 0,function(){var r,a,o;return qx(this,function(i){switch(i.label){case 0:if(e.checkCallbackFnOrThrow(n),!t)throw new uu("An URL must be provided.");return(r=e.prepareVideoElement()).src=t,a=function(){e.cleanVideoSource(r)},o=this.options.tryPlayVideoTimeout,[4,e.playVideoOnLoadAsync(r,o)];case 1:return i.sent(),[2,this.scan(r,n,a)]}})})},e.prototype.decodeOnceFromConstraints=function(e,t){return Yx(this,void 0,void 0,function(){var n;return qx(this,function(r){switch(r.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=r.sent(),[4,this.decodeOnceFromStream(n,t)];case 2:return[2,r.sent()]}})})},e.prototype.decodeOnceFromStream=function(t,n){return Yx(this,void 0,void 0,function(){var r,a;return qx(this,function(o){switch(o.label){case 0:return r=Boolean(n),[4,e.attachStreamToVideo(t,n)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return[2,o.sent()];case 4:return r||e.cleanVideoSource(a),[7];case 5:return[2]}})})},e.prototype.decodeOnceFromVideoDevice=function(e,t){return Yx(this,void 0,void 0,function(){var n;return qx(this,function(r){switch(r.label){case 0:return n={video:e?{deviceId:{exact:e}}:{facingMode:"environment"}},[4,this.decodeOnceFromConstraints(n,t)];case 1:return[2,r.sent()]}})})},e.prototype.decodeOnceFromVideoElement=function(t){return Yx(this,void 0,void 0,function(){var n,r;return qx(this,function(a){switch(a.label){case 0:if(!t)throw new uu("A video element must be provided.");return n=e.prepareVideoElement(t),r=this.options.tryPlayVideoTimeout,[4,e.playVideoOnLoadAsync(n,r)];case 1:return a.sent(),[4,this.scanOneResult(n)];case 2:return[2,a.sent()]}})})},e.prototype.decodeOnceFromVideoUrl=function(t){return Yx(this,void 0,void 0,function(){var n,r;return qx(this,function(a){switch(a.label){case 0:if(!t)throw new uu("An URL must be provided.");(n=e.prepareVideoElement()).src=t,r=this.decodeOnceFromVideoElement(n),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,r];case 2:return[2,a.sent()];case 3:return e.cleanVideoSource(n),[7];case 4:return[2]}})})},e.prototype.scanOneResult=function(e,t,n,r){var a=this;return void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),new Promise(function(o,i){a.scan(e,function(e,a,s){if(e)return o(e),void s.stop();if(a){if(a instanceof Uu&&t)return;if(a instanceof mu&&n)return;if(a instanceof Tu&&r)return;s.stop(),i(a)}})})},e.prototype.scan=function(t,n,r){var a=this;e.checkCallbackFnOrThrow(n);var o,i=e.createCaptureCanvas(t);try{o=i.getContext("2d",{willReadFrequently:!0})}catch(Z_){o=i.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var s,l=function(){o=void 0,i=void 0},c=!1,u={stop:function(){c=!0,clearTimeout(s),l(),r&&r()}},d=function(){if(!c)try{e.drawImageOnCanvas(o,t);var h=a.decodeFromCanvas(i);n(h,void 0,u),s=setTimeout(d,a.options.delayBetweenScanSuccess)}catch(p){if(n(void 0,p,u),p instanceof mu||p instanceof Tu||p instanceof Uu)return void(s=setTimeout(d,a.options.delayBetweenScanAttempts));l(),r&&r(p)}};return d(),u},e.prototype._decodeOnLoadImage=function(t){return Yx(this,void 0,void 0,function(){return qx(this,function(n){switch(n.label){case 0:return e.isImageLoaded(t)?[3,2]:[4,e._waitImageLoad(t)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(t)]}})})},e.prototype.getUserMedia=function(t){return Yx(this,void 0,void 0,function(){var n;return qx(this,function(r){switch(r.label){case 0:return[4,navigator.mediaDevices.getUserMedia(t)];case 1:return n=r.sent(),e.streamTracker.push(n),[2,n]}})})},e.streamTracker=[],e}(),$x=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ey=(function(e){function t(t,n){return e.call(this,new Wd,t,n)||this}$x(t,e)}(Qx),function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),ty=(function(e){function t(t,n){return e.call(this,new zp(t),t,n)||this}ey(t,e)}(Qx),function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),ny=(function(e){function t(t,n){return e.call(this,new of,t,n)||this}ty(t,e)}(Qx),function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),ry=function(e){function t(t,n){var r=this,a=new ag;return a.setHints(t),(r=e.call(this,a,t,n)||this).reader=a,r}return ny(t,e),Object.defineProperty(t.prototype,"possibleFormats",{set:function(e){this.hints.set(Au.POSSIBLE_FORMATS,e),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),t.prototype.decodeBitmap=function(e){return this.reader.decodeWithState(e)},t.prototype.setHints=function(e){this.hints=e,this.reader.setHints(this.hints)},t}(Qx),ay=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oy=(function(e){function t(t,n){return e.call(this,new $m,t,n)||this}ay(t,e)}(Qx),function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),iy=(function(e){function t(t,n){return e.call(this,new Jf,t,n)||this}oy(t,e)}(Qx),"http://www.w3.org/2000/svg"),sy=(function(){function e(e){if("string"===typeof e){var t=document.getElementById(e);if(!t)throw new Error("Could not find a Container element with '".concat(e,"'."));this.containerElement=t}else this.containerElement=e}e.prototype.write=function(t,n,r,a){if(0===t.length)throw new hu("Found empty contents");if(n<0||r<0)throw new hu("Requested dimensions are too small: "+n+"x"+r);var o=a&&void 0!==a.get(cg.MARGIN)?Number.parseInt(a.get(cg.MARGIN).toString(),10):e.QUIET_ZONE_SIZE,i=this.encode(a,t);return this.renderResult(i,n,r,o)},e.prototype.createSVGElement=function(t,n){var r=document.createElementNS(e.SVG_NS,"svg");return r.setAttributeNS(iy,"width",n.toString()),r.setAttributeNS(iy,"height",t.toString()),r},e.prototype.createSvgPathPlaceholderElement=function(t,n){var r=document.createElementNS(e.SVG_NS,"path");return r.setAttributeNS(iy,"d","M0 0h".concat(t,"v").concat(n,"H0z")),r.setAttributeNS(iy,"fill","none"),r},e.prototype.createSvgRectElement=function(t,n,r,a){var o=document.createElementNS(e.SVG_NS,"rect");return o.setAttributeNS(iy,"x",t.toString()),o.setAttributeNS(iy,"y",n.toString()),o.setAttributeNS(iy,"height",r.toString()),o.setAttributeNS(iy,"width",a.toString()),o.setAttributeNS(iy,"fill","#000000"),o},e.prototype.encode=function(e,t){var n=cf.L;if(e&&void 0!==e.get(cg.ERROR_CORRECTION)){var r=e.get(cg.ERROR_CORRECTION).toString();n=cf.fromString(r)}return kg.encode(t,n,e)},e.prototype.renderResult=function(e,t,n,r){var a=e.getMatrix();if(null===a)throw new wd;var o=a.getWidth(),i=a.getHeight(),s=o+2*r,l=i+2*r,c=Math.max(t,s),u=Math.max(n,l),d=Math.min(Math.floor(c/s),Math.floor(u/l)),h=Math.floor((c-o*d)/2),p=Math.floor((u-i*d)/2),f=this.createSVGElement(c,u),m=this.createSvgPathPlaceholderElement(t,n);f.appendChild(m),this.containerElement.appendChild(f);for(var g=0,x=p;g<i;g++,x+=d)for(var y=0,v=h;y<o;y++,v+=d)if(1===a.get(y,g)){var b=this.createSvgRectElement(v,x,d,d);f.appendChild(b)}return f},e.QUIET_ZONE_SIZE=4,e.SVG_NS="http://www.w3.org/2000/svg"}(),"http://www.w3.org/2000/svg");!function(){function e(){}e.prototype.write=function(t,n,r,a){if(0===t.length)throw new hu("Found empty contents");if(n<0||r<0)throw new hu("Requested dimensions are too small: "+n+"x"+r);var o=cf.L,i=e.QUIET_ZONE_SIZE;if(a){if(void 0!==a.get(cg.ERROR_CORRECTION)){var s=a.get(cg.ERROR_CORRECTION).toString();o=cf.fromString(s)}void 0!==a.get(cg.MARGIN)&&(i=Number.parseInt(a.get(cg.MARGIN).toString(),10))}var l=kg.encode(t,o,a);return this.renderResult(l,n,r,i)},e.prototype.writeToDom=function(e,t,n,r,a){if("string"===typeof e){var o=document.querySelector(e);if(!o)throw new Error("Could no find the target HTML element.");e=o}var i=this.write(t,n,r,a);e instanceof HTMLElement&&e.appendChild(i)},e.prototype.renderResult=function(e,t,n,r){var a=e.getMatrix();if(null===a)throw new wd;for(var o=a.getWidth(),i=a.getHeight(),s=o+2*r,l=i+2*r,c=Math.max(t,s),u=Math.max(n,l),d=Math.min(Math.floor(c/s),Math.floor(u/l)),h=Math.floor((c-o*d)/2),p=Math.floor((u-i*d)/2),f=this.createSVGElement(c,u),m=0,g=p;m<i;m++,g+=d)for(var x=0,y=h;x<o;x++,y+=d)if(1===a.get(x,m)){var v=this.createSvgRectElement(y,g,d,d);f.appendChild(v)}return f},e.prototype.createSVGElement=function(e,t){var n=document.createElementNS(sy,"svg"),r=e.toString(),a=t.toString();return n.setAttribute("height",a),n.setAttribute("width",r),n.setAttribute("viewBox","0 0 "+r+" "+a),n},e.prototype.createSvgRectElement=function(e,t,n,r){var a=document.createElementNS(sy,"rect");return a.setAttribute("x",e.toString()),a.setAttribute("y",t.toString()),a.setAttribute("height",n.toString()),a.setAttribute("width",r.toString()),a.setAttribute("fill","#000000"),a},e.QUIET_ZONE_SIZE=4}();const ly={formats:[sd.EAN_13,sd.EAN_8,sd.CODE_128,sd.QR_CODE],desiredWidth:1280,desiredHeight:720,decodeFPS:15,roiResizeLongSide:600,consensusFrames:2,maxWorkerQueue:2,tryHarderAfter:3,backendFallbackEnabled:!0,backendFallbackURL:"/api/barcode/decode",backendFallbackAfterFailures:2,backendFallbackTimeout:5e3};const cy=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.video=void 0,this.opts=void 0,this.worker=null,this.pendingWorkerJobs=0,this.lastResults=[],this.roi=null,this.trackingStableCount=0,this._onFound=()=>{},this._onProgress=()=>{},this._onError=()=>{},this._running=!1,this._lastDecodeTime=0,this.stream=null,this.barcodeDetector=null,this.zxingReader=null,this.consecutiveFailures=0,this.backendInFlight=!1,this.backendCircuitOpen=!1,this.lastBackendBitmap=null,this.video=e,this.opts=tt(tt({},ly),t),"undefined"!==typeof window&&window.BarcodeDetector)try{const e=this.opts.formats.map(e=>this.formatToNative(e)).filter(Boolean);this.barcodeDetector=new window.BarcodeDetector({formats:e}),console.log("[Scanner] BarcodeDetector API available")}catch(Z_){console.warn("[Scanner] BarcodeDetector init failed:",Z_)}this.initZXing()}formatToNative(e){return{[sd.EAN_13]:"ean_13",[sd.EAN_8]:"ean_8",[sd.UPC_A]:"upc_a",[sd.UPC_E]:"upc_e",[sd.CODE_128]:"code_128",[sd.CODE_39]:"code_39",[sd.QR_CODE]:"qr_code",[sd.DATA_MATRIX]:"data_matrix"}[e]||null}initZXing(){try{const e=new Map;e.set(Au.POSSIBLE_FORMATS,this.opts.formats),e.set(Au.TRY_HARDER,!1),this.zxingReader=new ry(e),console.log("[Scanner] ZXing reader initialized")}catch(Z_){console.error("[Scanner] ZXing init failed:",Z_)}}async start(){try{await this.ensureCamera(),this.startWorker(),this._running=!0,this._onProgress({phase:"started"}),this.loop()}catch(e){throw this._onError(e instanceof Error?e:new Error(String(e))),e}}stop(){this._running=!1,this.worker&&(this.worker.terminate(),this.worker=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.video.srcObject=null,this._onProgress({phase:"stopped"})}onFound(e){this._onFound=e}onProgress(e){this._onProgress=e}onError(e){this._onError=e}async ensureCamera(){if(this.stream)return;const e={video:{facingMode:"environment",width:{ideal:this.opts.desiredWidth},height:{ideal:this.opts.desiredHeight}}};this.stream=await navigator.mediaDevices.getUserMedia(e),this.video.srcObject=this.stream,await this.video.play(),this._onProgress({phase:"camera-ready"})}startWorker(){if(!this.worker)try{this.worker=new Worker("/workers/zxing-worker.js"),this.worker.onmessage=this.handleWorkerMessage.bind(this),this.worker.onerror=e=>{console.error("[Scanner] Worker error:",e)},this.worker.postMessage({type:"init",formats:this.opts.formats.map(e=>this.formatToNative(e))})}catch(Z_){console.warn("[Scanner] Worker creation failed, using main thread only:",Z_)}}handleWorkerMessage(e){const t=e.data;"ready"===t.type?this._onProgress({phase:"worker-ready"}):"processed"===t.type?(this.pendingWorkerJobs=Math.max(0,this.pendingWorkerJobs-1),this.decodeFromLuminance(t.luminanceSource,t.width,t.height)):"result"===t.type&&(this.pendingWorkerJobs=Math.max(0,this.pendingWorkerJobs-1),t.result&&this.accumulateResult(t.result))}async decodeFromLuminance(e,t,n){if(this.zxingReader)try{const r=document.createElement("canvas");r.width=t,r.height=n;const a=r.getContext("2d");if(!a)return;const o=a.createImageData(t,n),i=o.data,s=e.luminances;for(let e=0;e<s.length;e++){const t=4*e;i[t]=i[t+1]=i[t+2]=s[e],i[t+3]=255}a.putImageData(o,0,0);const l=await this.zxingReader.decodeFromCanvas(r);l&&this.accumulateResult({text:l.getText(),format:sd[l.getBarcodeFormat()],rawValue:l.getText()})}catch(Z_){}}accumulateResult(e){const t=e.rawValue||e.text;if(!t)return;const n=Date.now();this.lastResults.push({payload:t,timestamp:n,result:e});this.lastResults=this.lastResults.filter(e=>n-e.timestamp<1500);const r={};for(const a of this.lastResults)r[a.payload]=(r[a.payload]||0)+1;for(const a in r)if(r[a]>=this.opts.consensusFrames){console.log("[Scanner] Consensus reached:",a,"(".concat(r[a],"/").concat(this.opts.consensusFrames,")")),this._onFound({text:a,format:e.format,rawValue:a}),this.lastResults=[];break}}async loop(){const e=1e3/this.opts.decodeFPS;for(;this._running;){const n=performance.now();if(n-this._lastDecodeTime<e){await this.sleep(5);continue}this._lastDecodeTime=n;let r=null;try{r=await createImageBitmap(this.video)}catch(t){console.warn("[Scanner] Capture failed:",t),await this.sleep(30);continue}let a=!1;if(this.barcodeDetector)try{const e=await this.barcodeDetector.detect(r);if(e&&e.length>0){a=!0,this.consecutiveFailures=0;for(const t of e)this.accumulateResult({text:t.rawValue,format:t.format,rawValue:t.rawValue});r.close();continue}}catch(Z_){console.warn("[Scanner] BarcodeDetector error:",Z_)}if(this.worker&&this.pendingWorkerJobs<this.opts.maxWorkerQueue){const e=this.computeCrop(r.width,r.height);try{const t=await this.createResizedBitmap(r,e,this.opts.roiResizeLongSide);this.pendingWorkerJobs++,this.worker.postMessage({type:"decode",image:t},[t])}catch(Z_){console.warn("[Scanner] Resize failed:",Z_)}}else try{if(this.zxingReader){const e=document.createElement("canvas");e.width=r.width,e.height=r.height;const t=e.getContext("2d");if(t){t.drawImage(r,0,0);const n=await this.zxingReader.decodeFromCanvas(e);n&&(a=!0,this.consecutiveFailures=0,this.accumulateResult({text:n.getText(),format:sd[n.getBarcodeFormat()],rawValue:n.getText()}))}}}catch(Z_){}a||(this.consecutiveFailures++,this.opts.backendFallbackEnabled&&this.consecutiveFailures>=this.opts.backendFallbackAfterFailures&&!this.backendInFlight&&!this.backendCircuitOpen&&this.tryBackendFallback(r).catch(()=>{})),r.close(),await this.sleep(1)}}computeCrop(e,t){if(this.roi&&this.trackingStableCount>0)return this.roi;const n=Math.floor(.75*Math.min(e,t));return{x:Math.floor((e-n)/2),y:Math.floor((t-n)/2),w:n,h:n}}async createResizedBitmap(e,t,n){const{x:r,y:a,w:o,h:i}=t,s=await createImageBitmap(e,r,a,o,i),l=Math.max(o,i),c=Math.min(1,n/l),u=Math.max(1,Math.round(o*c)),d=Math.max(1,Math.round(i*c));let h;if("undefined"!==typeof OffscreenCanvas){const e=new OffscreenCanvas(u,d),t=e.getContext("2d");t?(t.drawImage(s,0,0,u,d),h=await createImageBitmap(e)):h=s}else{const e=document.createElement("canvas");e.width=u,e.height=d;const t=e.getContext("2d");t?(t.drawImage(s,0,0,u,d),h=await createImageBitmap(e)):h=s}return s.close(),h}sleep(e){return new Promise(t=>setTimeout(t,e))}async tryBackendFallback(e){if(!this.backendInFlight&&!this.backendCircuitOpen&&this.opts.backendFallbackEnabled){this.backendInFlight=!0,this._onProgress({phase:"backend-fallback",data:{failures:this.consecutiveFailures}});try{const t=this.computeCrop(e.width,e.height),n=await createImageBitmap(e,t.x,t.y,t.w,t.h),r=document.createElement("canvas");r.width=n.width,r.height=n.height;const a=r.getContext("2d");if(!a)return void n.close();a.drawImage(n,0,0),n.close();const o=await new Promise(e=>{r.toBlob(e,"image/webp",.75)});if(!o)return void console.warn("[Scanner] Failed to create blob");const i=new FormData;i.append("file",o,"roi.webp");const s=new AbortController,l=setTimeout(()=>s.abort(),this.opts.backendFallbackTimeout),c=await fetch(this.opts.backendFallbackURL,{method:"POST",body:i,signal:s.signal});if(clearTimeout(l),!c.ok)throw new Error("Backend error: ".concat(c.status));const u=await c.json();if(u.ok&&u.results&&u.results.length>0){const e=u.results[0];console.log("[Scanner] Backend found:",e.text,"(".concat(u.latency_ms,"ms, path: ").concat(u.path,")")),this._onProgress({phase:"backend-success",data:{latency:u.latency_ms,cached:u.cached,path:u.path}}),this.accumulateResult({text:e.text,format:e.type,rawValue:e.text}),this.consecutiveFailures=0}else console.log("[Scanner] Backend returned no results"),this._onProgress({phase:"backend-no-result"})}catch(t){console.error("[Scanner] Backend fallback error:",t),this._onProgress({phase:"backend-error",data:{error:String(t)}}),this.backendCircuitOpen=!0,setTimeout(()=>{this.backendCircuitOpen=!1,console.log("[Scanner] Backend circuit breaker reset")},3e4)}finally{this.backendInFlight=!1}}}},uy=e=>{let{isActive:t,onToggle:n,onBarcodeDetected:r,cornerColor:o="yellow",showManualInput:i=!1}=e;const s=(0,a.useRef)(null),l=(0,a.useRef)(null),[c,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)(""),[p,f]=(0,a.useState)(""),m="orange"===o?"border-orange-500":"border-yellow-400",g=(0,a.useRef)(""),x=(0,a.useRef)(0),y=(0,a.useRef)(r);return(0,a.useEffect)(()=>{y.current=r},[r]),(0,a.useEffect)(()=>{if(t&&s.current){u(!0),h("");const e=async()=>{try{l.current=new cy(s.current,{desiredWidth:1280,desiredHeight:720,decodeFPS:20,roiResizeLongSide:600,consensusFrames:1}),l.current.onFound(e=>{const t=Date.now(),n=e.text;n===g.current&&t-x.current<2e3?console.log("[Scanner] DEBOUNCED - same barcode within 2s:",n):(g.current=n,x.current=t,console.log("[Scanner] NEW SCAN:",n),y.current(n))}),l.current.onProgress(e=>{"camera-ready"===e.phase&&u(!1)}),l.current.onError(e=>{console.error("[ScannerSection] Error:",e),h(e.message||"Gagal mengakses kamera"),u(!1)}),await l.current.start()}catch(e){console.error("[ScannerSection] Init error:",e),h(e.message||"Gagal memulai scanner"),u(!1)}};e()}return()=>{l.current&&(l.current.stop(),l.current=null)}},[t]),t?(0,Ue.jsxs)("div",{className:"scanner-active relative bg-black",children:[(0,Ue.jsx)("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-48 object-cover"}),c&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)("div",{className:"text-white text-center",children:[(0,Ue.jsxs)("svg",{className:"w-8 h-8 mx-auto mb-2 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),(0,Ue.jsx)("span",{className:"text-sm",children:"Memulai kamera..."})]})}),d&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80",children:(0,Ue.jsxs)("div",{className:"text-white text-center px-4",children:[(0,Ue.jsx)("div",{className:"text-red-400 mb-2",children:"\u26a0\ufe0f"}),(0,Ue.jsx)("p",{className:"text-sm mb-3",children:d}),(0,Ue.jsx)("button",{onClick:n,className:"bg-gray-700 text-white px-4 py-2 rounded-lg text-sm",children:"Tutup"})]})}),!c&&!d&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,Ue.jsxs)("div",{className:"relative w-64 h-24",children:[(0,Ue.jsx)("div",{className:"absolute top-0 left-0 w-6 h-6 border-t-2 border-l-2 ".concat(m)}),(0,Ue.jsx)("div",{className:"absolute top-0 right-0 w-6 h-6 border-t-2 border-r-2 ".concat(m)}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-0 w-6 h-6 border-b-2 border-l-2 ".concat(m)}),(0,Ue.jsx)("div",{className:"absolute bottom-0 right-0 w-6 h-6 border-b-2 border-r-2 ".concat(m)})]})}),(0,Ue.jsx)("button",{onClick:n,className:"absolute top-2 right-2 bg-black/50 hover:bg-black/70 text-white px-3 py-1.5 rounded-full text-sm transition-colors",children:"\u2715 Tutup"}),i&&(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:p,onChange:e=>(e=>{const t=e.replace(/\D/g,"").slice(0,13);f(t),13===t.length&&(r(t),f(""))})(e.target.value),placeholder:"Input barcode atau ketik nama produk",className:"w-full px-4 py-3 text-sm bg-white text-gray-700 border-t border-gray-200 focus:outline-none placeholder:text-gray-400",maxLength:13})]}):(0,Ue.jsx)("div",{className:"scanner-trigger px-4 py-2",style:{backgroundColor:"transparent"},children:(0,Ue.jsxs)("button",{onClick:n,className:"w-full bg-amber-500 hover:bg-amber-600 active:bg-amber-700 text-white py-4 rounded-xl flex items-center justify-center gap-2 text-lg font-semibold transition-colors border border-amber-400",style:{boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",style:{width:"24px",height:"24px"}}),"Scan Barcode"]})})},dy="milkyhoop_draft_purchase",hy="#F97316",py="#737373",fy="#D4D4D4",my="#E5E5E5",gy="#F5F5F5",xy="#FFFFFF",yy="#262626",vy="#22C55E",by={karton:"pcs",dus:"pcs",box:"pcs",slop:"bungkus",bal:"bungkus",koli:"pcs",pack:"pcs",lusin:"pcs",kg:"kg",liter:"liter"},wy=["karton","dus","box","slop","bal","koli","pack","lusin","kg","liter"],ky=["pcs","lembar","unit","liter","mili liter","gram","kg","botol","sachet","bungkus"],jy=e=>new Intl.NumberFormat("id-ID",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),Cy=e=>{const t=e.replace(/[^\d]/g,"");return parseInt(t,10)||0},Ny=e=>e.toISOString().split("T")[0],_y=()=>{const e=new Date;return e.setDate(e.getDate()+1),Ny(e)},Sy=()=>({type:"wholesales",supplier:"",date:Ny(new Date),product:"",qty:1,unit:"karton",unitsPerPack:void 0,pricePerUnit:0,discountType:"none",discountValue:void 0,notes:"",paymentMethod:"transfer",dueDate:void 0,includePPN:!1}),Ey=e=>{let{isOpen:t,onClose:n,isMobile:r=!1,isEmbedded:o=!1,onTransactionComplete:i,scannedProductData:s}=e;ee(),Q();const[l,c]=(0,a.useState)(1),[u,d]=(0,a.useState)(Sy()),[h,p]=(0,a.useState)({}),[f,m]=(0,a.useState)({}),[g,x]=(0,a.useState)(!1),[y,v]=(0,a.useState)("idle"),[b,w]=(0,a.useState)(!1),[k,j]=(0,a.useState)(!1),[C,N]=(0,a.useState)(""),[_,S]=(0,a.useState)(""),[E,A]=(0,a.useState)("right"),[I,T]=(0,a.useState)(!1),[P,D]=(0,a.useState)(null),[M,R]=(0,a.useState)(!1),[F,O]=(0,a.useState)(!1),[B,L]=(0,a.useState)(!1),[z,W]=(0,a.useState)(!1),[V,U]=(0,a.useState)(null),[H,G]=(0,a.useState)(1),[K,X]=(0,a.useState)(0),[Y,q]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(console.log("[PurchaseForm] scannedProductData effect:",{isOpen:t,scannedProductData:s,lastProcessedBarcode:P}),t&&s){const{name:e,barcode:t,unit:n,units_per_pack:r,harga_jual:a,last_price:o}=s;if(t===P)return void console.log("[PurchaseForm] Skipping - already processed barcode:",t);const i=setTimeout(()=>{console.log("[PurchaseForm] AUTO-FILLING from scan:",{name:e,barcode:t,unit:n,units_per_pack:r,harga_jual:a,last_price:o}),d(t=>tt(tt(tt(tt({},t),{},{product:e},n?{unit:n}:{}),r&&r>0?{unitsPerPack:r}:{}),o&&o>0?{pricePerUnit:o}:{})),N(""),D(t),a&&a>0&&q(a),c(e=>1===e?2:e)},150);return()=>clearTimeout(i)}},[t,s,P]),(0,a.useEffect)(()=>{t||(console.log("[PurchaseForm] Form closed - resetting lastProcessedBarcode"),D(null))},[t]);const[Z,J]=(0,a.useState)([]),[$,te]=(0,a.useState)([]),[ne,re]=(0,a.useState)(!1),[ae,oe]=(0,a.useState)(!1),ie=(0,a.useRef)(null),se=(0,a.useRef)(null),le=(0,a.useRef)(null),ce=(0,a.useRef)(null),ue=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;const t=()=>{const e=window.visualViewport;if(e&&e.height<.75*window.innerHeight){const e=document.activeElement;!e||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName||setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"center"})},100)}};return null===(e=window.visualViewport)||void 0===e||e.addEventListener("resize",t),()=>{var e;return null===(e=window.visualViewport)||void 0===e?void 0:e.removeEventListener("resize",t)}},[]);(0,a.useEffect)(()=>(ce.current&&clearTimeout(ce.current),C&&b?ce.current=setTimeout(()=>{(async e=>{if(e.length<1)J([]);else{re(!0);try{const t=localStorage.getItem("access_token"),n=await fetch("/api/products/search?q=".concat(encodeURIComponent(e),"&limit=10"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();J(e.suggestions||[])}else J([])}catch(t){console.error("Failed to fetch product suggestions:",t),J([])}finally{re(!1)}}})(C)},300):J([]),()=>{ce.current&&clearTimeout(ce.current)}),[C,b]),(0,a.useEffect)(()=>(ue.current&&clearTimeout(ue.current),_&&k?ue.current=setTimeout(()=>{(async e=>{if(e.length<1)te([]);else{oe(!0);try{const t=localStorage.getItem("access_token"),n=await fetch("/api/suppliers/search?q=".concat(encodeURIComponent(e),"&limit=10"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();te(e.suggestions||[])}else te([])}catch(t){console.error("Failed to fetch supplier suggestions:",t),te([])}finally{oe(!1)}}})(_)},300):te([]),()=>{ue.current&&clearTimeout(ue.current)}),[_,k]);const de=(0,a.useMemo)(()=>{const e=u.qty*u.pricePerUnit;let t=0;"amount"===u.discountType&&u.discountValue?t=u.discountValue:"percentage"===u.discountType&&u.discountValue&&(t=e*u.discountValue/100);const n=Math.max(0,e-t),r=u.includePPN?.11*n:0;return{subtotal:n,ppn:r,total:n+r,discount:t}},[u.qty,u.pricePerUnit,u.discountType,u.discountValue,u.includePPN]),he=(0,a.useMemo)(()=>{const e="wholesales"===u.type?by[u.unit]||"pcs":u.unit,t=u.unitsPerPack||1,n="wholesales"===u.type&&t>0?u.pricePerUnit/t:u.pricePerUnit,r="wholesales"===u.type?u.qty*t:u.qty,a=Y?Y-n:0;return{retailUnit:e,estimatedHppPerUnit:n,estimatedMargin:a,estimatedMarginPercent:n>0&&Y?a/n*100:0,totalUnits:r,estimatedTotalProfit:a*r}},[u.type,u.unit,u.pricePerUnit,u.unitsPerPack,u.qty,Y]),pe=(0,a.useMemo)(()=>{const e=he.retailUnit,t=he.totalUnits,n=de.total,r=t>0?n/t:0,a=Y?Y-r:0;return{retailUnit:e,finalHppPerUnit:r,finalMargin:a,finalMarginPercent:r>0&&Y?a/r*100:0,totalUnits:t,finalTotalProfit:a*t}},[de.total,he.retailUnit,he.totalUnits,Y]);he.retailUnit,he.estimatedHppPerUnit,he.estimatedMargin,he.estimatedMarginPercent,he.totalUnits,he.estimatedTotalProfit;(0,a.useEffect)(()=>{if(2===l&&!Y&&pe.finalHppPerUnit>0){const e=Math.round(1.1*pe.finalHppPerUnit);q(e)}},[l,pe.finalHppPerUnit]),(0,a.useEffect)(()=>{if(t){const e=localStorage.getItem(dy);if(e)try{const t=JSON.parse(e);Date.now()-t.timestamp<864e5?t.fromScan?(d(t.formData),c(t.currentStep),localStorage.removeItem(dy)):T(!0):localStorage.removeItem(dy)}catch(J_){localStorage.removeItem(dy)}}},[t]),(0,a.useEffect)(()=>{t&&setTimeout(()=>{1===l&&le.current?le.current.focus():se.current&&se.current.focus()},300)},[t,l]),(0,a.useEffect)(()=>{const e=e=>{"Escape"===e.key&&t&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,n]),(0,a.useEffect)(()=>(document.body.style.overflow=t?"hidden":"",()=>{document.body.style.overflow=""}),[t]);const fe=e=>{const t={};return 1===e&&(u.type||(t.type="Tipe pembelian wajib dipilih"),u.date||(t.date="Tanggal wajib diisi"),u.product&&""!==u.product.trim()||(t.product="Produk wajib dipilih"),(!u.qty||u.qty<1)&&(t.qty="Qty minimal 1"),(!u.pricePerUnit||u.pricePerUnit<=0)&&(t.pricePerUnit="Harga wajib diisi"),"wholesales"===u.type&&(!u.unitsPerPack||u.unitsPerPack<=0)&&(t.unitsPerPack="Isi per unit wajib diisi untuk wholesales")),2===e&&("percentage"===u.discountType&&u.discountValue&&(u.discountValue<0||u.discountValue>100)&&(t.discountValue="Diskon harus 0-100%"),u.paymentMethod||(t.paymentMethod="Metode bayar wajib dipilih"),"kredit"!==u.paymentMethod||u.dueDate||(t.dueDate="Jatuh tempo wajib diisi")),p(t),0===Object.keys(t).length},me=e=>{m(t=>tt(tt({},t),{},{[e]:!0}))},ge=(e,t)=>{d(n=>tt(tt({},n),{},{[e]:t})),h[e]&&p(t=>tt(tt({},t),{},{[e]:void 0}))},xe=()=>{n(),setTimeout(()=>{d(Sy()),c(1),m({}),p({}),v("idle"),N(""),S(""),T(!1),q(null)},300)};if(!t)return null;const ye=e=>{if(1===e){const e=!!u.type,t=!!u.product&&u.product.trim().length>0,n=u.qty>=1,r=!!u.date,a=u.pricePerUnit>0;if("wholesales"===u.type){const o="number"===typeof u.unitsPerPack&&u.unitsPerPack>0;return e&&t&&n&&r&&a&&o}return e&&t&&n&&r&&a}if(2===e){return!!u.paymentMethod&&("kredit"!==u.paymentMethod||!!u.dueDate)}return!1},ve=o?"h-full bg-white flex flex-col":"fixed inset-0 z-[100] flex items-end sm:items-center justify-center";return(0,Ue.jsxs)("div",{className:ve,children:[!o&&(0,Ue.jsx)("div",{className:"absolute inset-0 bg-black/20",onClick:xe}),I&&(0,Ue.jsx)("div",{className:"absolute inset-0 z-[101] flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-5 mx-4 max-w-sm shadow-2xl",children:[(0,Ue.jsx)("h3",{className:"text-base font-semibold mb-2",style:{color:"#262626"},children:"Lanjutkan Draft?"}),(0,Ue.jsx)("p",{className:"text-sm mb-4",style:{color:"#737373"},children:"Anda memiliki draft yang belum selesai. Lanjutkan atau mulai baru?"}),(0,Ue.jsxs)("div",{className:"flex gap-2",children:[(0,Ue.jsx)("button",{onClick:()=>{localStorage.removeItem(dy),T(!1)},className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50",children:"Mulai Baru"}),(0,Ue.jsx)("button",{onClick:()=>{const e=localStorage.getItem(dy);if(e){const t=JSON.parse(e);d(t.formData),c(t.currentStep)}T(!1)},className:"flex-1 px-4 py-2.5 text-white rounded-lg text-sm font-medium",style:{background:hy},children:"Lanjutkan"})]})]})}),(0,Ue.jsxs)("div",{ref:ie,className:o?"h-full bg-white flex flex-col overflow-hidden":"relative w-full bg-white shadow-2xl animate-slide-up sm:animate-popup-slide ".concat(r?"rounded-t-2xl max-h-[90vh]":"rounded-2xl max-w-[600px] max-h-[85vh] mx-4"),style:o?{}:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15)"},children:[(0,Ue.jsxs)("div",{className:"sticky top-0 bg-white border-b px-4 py-3 flex items-center justify-between z-10 ".concat(o?"":"rounded-t-2xl"),style:{borderColor:"#E5E5E5"},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("button",{onClick:xe,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:fy},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain"})}),(0,Ue.jsx)("span",{className:"font-semibold",style:{color:"#525252",fontSize:"15px"},children:"Pembelian"})]}),(0,Ue.jsx)("div",{className:"flex items-center gap-2",style:{background:"#F5F5F5",borderRadius:"12px",padding:"6px 12px"},children:(0,Ue.jsxs)("span",{style:{fontSize:"12px",fontWeight:600,color:"#737373"},children:[l,"/",2]})})]}),(0,Ue.jsx)("div",{className:"px-4 pt-2 pb-1",children:(0,Ue.jsx)("div",{className:"h-1 rounded-full overflow-hidden",style:{background:"#E5E5E5"},children:(0,Ue.jsx)("div",{className:"h-full transition-all duration-300 ease-out",style:{width:"".concat(l/2*100,"%"),background:"#F97316"}})})}),(0,Ue.jsxs)("div",{className:"overflow-y-auto px-4 sm:px-6 py-4 ".concat(o?"flex-1":""),style:o?{}:{maxHeight:r?"calc(90vh - 180px)":"calc(85vh - 180px)"},children:[1===l&&(0,Ue.jsxs)("div",{className:"space-y-3 animate-fade-in",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,Ue.jsxs)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #E5E5E5",background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:"#737373"},children:["Tipe Pembelian ",(0,Ue.jsx)("span",{style:{color:"#EF4444"},children:"*"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2",children:["wholesales","eceran"].map((e,t)=>(0,Ue.jsxs)("button",{type:"button",ref:"wholesales"===e?le:void 0,onClick:()=>{ge("type",e),ge("unit","eceran"===e?"pcs":"karton")},className:"flex items-center justify-center gap-2 py-3 px-4 transition-all",style:{background:u.type===e?"#FFF7ED":t%2===0?xy:gy,borderBottom:u.type===e?"2px solid ".concat(hy):"none",borderRight:0===t?"1px solid #E5E5E5":"none"},children:[(0,Ue.jsx)("div",{className:"w-4 h-4 rounded-full border-2 flex items-center justify-center",style:{borderColor:u.type===e?hy:"#9CA3AF"},children:u.type===e&&(0,Ue.jsx)("div",{className:"w-2 h-2 rounded-full",style:{background:hy}})}),(0,Ue.jsx)("span",{className:"text-sm font-medium",style:{color:u.type===e?hy:py},children:"wholesales"===e?"Wholesales":"Eceran"})]},e))}),h.type&&(0,Ue.jsx)("p",{className:"px-3 py-2 text-xs text-red-500",children:h.type})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("label",{htmlFor:"product",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:"Produk"}),(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsxs)("div",{className:"relative flex-1",children:[(0,Ue.jsx)("input",{id:"product",name:"product",ref:se,type:"text",value:C||u.product,onChange:e=>{N(e.target.value),w(!0)},onFocus:()=>w(!0),onBlur:()=>{setTimeout(()=>w(!1),200),me("product")},placeholder:"Cari produk...","aria-invalid":!!h.product,className:"w-full px-3 py-2.5 pr-8 border rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-1 ".concat(h.product&&f.product?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-gray-500 focus:ring-gray-500")}),(0,Ue.jsx)("svg",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,Ue.jsx)("button",{type:"button",onClick:()=>R(!M),className:"p-2.5 border rounded-lg transition-colors ".concat(M?"border-orange-500 bg-orange-50 text-orange-600":"border-gray-300 text-gray-500 hover:text-gray-700 hover:bg-gray-50 active:bg-gray-100"),"aria-label":"Scan barcode",title:"Scan barcode produk",children:(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",style:{width:"20px",height:"20px"}})})]}),b&&(0,Ue.jsxs)("div",{className:"absolute z-20 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[ne?(0,Ue.jsx)("div",{className:"px-3 py-3 text-sm text-gray-500 text-center",children:(0,Ue.jsxs)("svg",{className:"animate-spin w-4 h-4 mx-auto",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):Z.length>0?Z.map((e,t)=>(0,Ue.jsx)("button",{type:"button",onClick:()=>{ge("product",e.name),ge("unit",e.unit),e.last_price&&ge("pricePerUnit",e.last_price),e.units_per_pack&&e.units_per_pack>0&&ge("unitsPerPack",e.units_per_pack),e.harga_jual&&e.harga_jual>0&&q(e.harga_jual),N(""),w(!1)},className:"w-full text-left px-3 py-3 text-sm text-gray-800 hover:bg-gray-50 transition-colors",children:(0,Ue.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",children:e.name}),(0,Ue.jsxs)("div",{className:"text-xs text-gray-500",children:[e.unit,e.last_price&&" \xb7 Rp ".concat(jy(e.last_price))]})]}),(0,Ue.jsxs)("span",{className:"text-xs text-gray-400",children:[e.usage_count,"x"]})]})},"".concat(e.name,"-").concat(e.unit,"-").concat(t))):C&&C.length>0?(0,Ue.jsx)("div",{className:"px-3 py-3 text-sm text-gray-500 text-center",children:"Tidak ada produk ditemukan"}):null,C&&(0,Ue.jsxs)("button",{type:"button",onClick:()=>{ge("product",C),N(""),w(!1)},className:"w-full text-left px-3 py-3 text-sm text-blue-600 hover:bg-blue-50 transition-colors flex items-center gap-1 border-t border-gray-100",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),'Produk Baru: "',C,'"']})]}),h.product&&f.product&&(0,Ue.jsxs)("p",{className:"mt-1 text-xs text-red-500 flex items-center gap-1",children:[(0,Ue.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),h.product]}),M&&(0,Ue.jsxs)("div",{className:"mt-2 rounded-xl overflow-hidden border border-gray-200",children:[(0,Ue.jsx)(uy,{isActive:M,onToggle:()=>R(!1),onBarcodeDetected:async e=>{console.log("[PurchaseForm] Barcode scanned:",e),O(!0);try{const t=localStorage.getItem("access_token"),n=await fetch("/api/products/barcode/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const t=await n.json();console.log("[PurchaseForm] Product found:",t),d(e=>tt(tt(tt(tt({},e),{},{product:t.nama_produk||t.name},t.satuan||t.unit?{unit:t.satuan||t.unit}:{}),t.units_per_pack&&t.units_per_pack>0?{unitsPerPack:t.units_per_pack}:{}),t.last_price&&t.last_price>0?{pricePerUnit:t.last_price}:{})),N(""),D(e),t.harga_jual&&t.harga_jual>0&&q(t.harga_jual),R(!1)}else 404===n.status?(console.log("[PurchaseForm] Product not found for barcode:",e),alert("Produk tidak ditemukan untuk barcode: ".concat(e))):(console.error("[PurchaseForm] Product lookup error:",n.status),alert("Gagal mencari produk. Silakan coba lagi."))}catch(t){console.error("[PurchaseForm] Product lookup error:",t),alert("Gagal mencari produk. Silakan coba lagi.")}finally{O(!1)}},cornerColor:"orange",showManualInput:!0}),F&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-30",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl px-6 py-4 flex flex-col items-center gap-2",children:[(0,Ue.jsxs)("svg",{className:"animate-spin w-6 h-6 text-orange-500",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),(0,Ue.jsx)("span",{className:"text-sm text-gray-600",children:"Mencari produk..."})]})})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"qty",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:"Qty"}),(0,Ue.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>ge("qty",Math.max(1,u.qty-1)),className:"flex-shrink-0 rounded-full flex items-center justify-center font-semibold text-sm",style:{width:"32px",height:"32px",minWidth:"32px",minHeight:"32px",background:my,color:"#525252"},"aria-label":"Decrease quantity",children:"\u2212"}),(0,Ue.jsx)("input",{id:"qty",name:"qty",type:"number",min:"1",value:u.qty,onChange:e=>ge("qty",parseInt(e.target.value)||1),onBlur:()=>me("qty"),"aria-invalid":!!h.qty,className:"w-16 py-2.5 border rounded-lg text-sm text-gray-900 text-center focus:outline-none focus:ring-1 ".concat(h.qty&&f.qty?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-gray-500 focus:ring-gray-500")}),(0,Ue.jsx)("button",{type:"button",onClick:()=>ge("qty",u.qty+1),className:"flex-shrink-0 rounded-full flex items-center justify-center font-semibold text-sm text-white",style:{width:"32px",height:"32px",minWidth:"32px",minHeight:"32px",background:hy},"aria-label":"Increase quantity",children:"+"})]}),h.qty&&f.qty&&(0,Ue.jsx)("p",{className:"mt-1 text-xs text-red-500",children:h.qty})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"unit",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:"Satuan"}),(0,Ue.jsx)("select",{id:"unit",value:u.unit,onChange:e=>ge("unit",e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm text-gray-900 focus:outline-none focus:border-gray-500 focus:ring-1 focus:ring-gray-500 bg-white",children:("eceran"===u.type?ky:wy).map(e=>(0,Ue.jsx)("option",{value:e,children:e},e))})]})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsxs)("label",{htmlFor:"supplier",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:["Supplier ",(0,Ue.jsx)("span",{className:"text-gray-400",children:"(opsional)"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{id:"supplier",type:"text",value:_||u.supplier,onChange:e=>{S(e.target.value),j(!0)},onFocus:()=>j(!0),onBlur:()=>setTimeout(()=>j(!1),200),placeholder:"Pilih supplier...",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:border-gray-500 focus:ring-1 focus:ring-gray-500"}),(0,Ue.jsx)("svg",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k&&(0,Ue.jsxs)("div",{className:"absolute z-20 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[ae?(0,Ue.jsx)("div",{className:"px-3 py-3 text-sm text-gray-500 text-center",children:(0,Ue.jsxs)("svg",{className:"animate-spin w-4 h-4 mx-auto",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):$.length>0?$.map((e,t)=>(0,Ue.jsxs)("button",{type:"button",onClick:()=>{ge("supplier",e.name),S(""),j(!1)},className:"w-full text-left px-3 py-3 text-sm text-gray-800 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[(0,Ue.jsx)("span",{children:e.name}),(0,Ue.jsxs)("span",{className:"text-xs text-gray-400",children:[e.usage_count,"x"]})]},"".concat(e.name,"-").concat(t))):_&&_.length>0?(0,Ue.jsx)("div",{className:"px-3 py-3 text-sm text-gray-500 text-center",children:"Tidak ada supplier ditemukan"}):null,_&&!$.find(e=>e.name.toLowerCase()===_.toLowerCase())&&(0,Ue.jsxs)("button",{type:"button",onClick:()=>{ge("supplier",_),S(""),j(!1)},className:"w-full text-left px-3 py-3 text-sm text-blue-600 hover:bg-blue-50 transition-colors flex items-center gap-1 border-t border-gray-100",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),'Gunakan "',_,'"']})]})]}),(0,Ue.jsxs)("div",{className:"w-full",children:[(0,Ue.jsxs)("label",{htmlFor:"date",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:["Tanggal ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("div",{className:"relative w-full",children:(0,Ue.jsx)("input",{id:"date",type:"date",value:u.date,onChange:e=>ge("date",e.target.value),onBlur:()=>me("date"),className:"w-full px-3 py-2.5 border rounded-lg text-sm text-gray-900 focus:outline-none focus:ring-1 appearance-none box-border ".concat(h.date&&f.date?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-gray-500 focus:ring-gray-500"),style:{maxWidth:"100%"}})}),h.date&&f.date&&(0,Ue.jsx)("p",{className:"mt-1 text-xs text-red-500",children:h.date})]})]}),2===l&&(0,Ue.jsxs)("div",{className:"space-y-3 animate-fade-in",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,Ue.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #E5E5E5",background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:"#737373"},children:"Produk"}),(0,Ue.jsx)("div",{className:"px-3 py-2.5",style:{background:xy},children:(0,Ue.jsx)("span",{className:"text-sm font-semibold",style:{color:yy},children:u.product})}),(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-2.5",style:{background:gy},children:[(0,Ue.jsxs)("span",{className:"text-sm",style:{color:py},children:["HPP Final per ",pe.retailUnit]}),(0,Ue.jsxs)("span",{className:"text-sm font-semibold",style:{color:yy},children:["Rp ",jy(Math.round(pe.finalHppPerUnit))]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"hargaJual",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:["Harga Jual ",(0,Ue.jsx)("span",{className:"text-gray-400",children:"(ketik atau geser slider)"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:"Rp"}),(0,Ue.jsx)("input",{id:"hargaJual",type:"text",inputMode:"numeric",value:Y?jy(Y):"",onChange:e=>q(Cy(e.target.value)||null),placeholder:"Masukkan harga jual",className:"w-full pl-10 pr-16 py-2.5 border rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-1 border-gray-300 focus:border-gray-500 focus:ring-gray-500"}),(0,Ue.jsxs)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:["/",pe.retailUnit]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,Ue.jsx)("label",{className:"text-xs font-medium",style:{color:"#525252"},children:"Margin"}),(0,Ue.jsxs)("span",{className:"text-base font-bold",style:{color:"#16A34A"},children:[Y&&pe.finalHppPerUnit>0?Math.round((Y-pe.finalHppPerUnit)/pe.finalHppPerUnit*100):0,"%"]})]}),(0,Ue.jsx)("input",{type:"range",min:"1",max:"100",value:Y&&pe.finalHppPerUnit>0?Math.max(1,Math.min(100,Math.round((Y-pe.finalHppPerUnit)/pe.finalHppPerUnit*100))):10,onChange:e=>{const t=parseInt(e.target.value),n=Math.round(pe.finalHppPerUnit*(1+t/100));q(n)},className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gradient-to-r from-red-300 via-yellow-300 to-green-400",style:{accentColor:"#16a34a"}}),(0,Ue.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,Ue.jsx)("span",{children:"1%"}),(0,Ue.jsx)("span",{children:"50%"}),(0,Ue.jsx)("span",{children:"100%"})]})]}),Y&&Y>0&&(0,Ue.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,Ue.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #E5E5E5",background:pe.finalMarginPercent>=10?"#DCFCE7":"#FEF3C7",fontSize:"12px",fontWeight:600,color:pe.finalMarginPercent>=10?vy:"#D97706"},children:pe.finalMarginPercent>=10?"\u2713 Margin Sehat":"\u26a0 Margin Rendah"}),(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-2.5",style:{background:xy},children:[(0,Ue.jsxs)("span",{className:"text-sm",style:{color:py},children:["Profit per ",pe.retailUnit]}),(0,Ue.jsxs)("span",{className:"text-sm font-semibold",style:{color:vy},children:["Rp ",jy(Math.round(pe.finalMargin))," (",pe.finalMarginPercent.toFixed(0),"%)"]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-2.5",style:{background:gy},children:[(0,Ue.jsx)("span",{className:"text-sm",style:{color:py},children:"Total Profit"}),(0,Ue.jsxs)("span",{className:"text-sm font-bold",style:{color:vy},children:["Rp ",jy(Math.round(pe.finalTotalProfit))]})]}),pe.finalMarginPercent<0&&(0,Ue.jsx)("div",{className:"px-3 py-2 text-xs",style:{background:"#FEF2F2",color:"#DC2626"},children:"\u26a0 RUGI! Harga jual lebih rendah dari HPP."})]}),"success"===y&&(0,Ue.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,Ue.jsx)("span",{className:"text-sm text-green-700",children:"Berhasil disimpan!"})]}),"error"===y&&(0,Ue.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,Ue.jsx)("span",{className:"text-sm text-red-700",children:"Gagal menyimpan, coba lagi"})]}),"session_expired"===y&&(0,Ue.jsxs)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-2",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,Ue.jsx)("span",{className:"text-sm text-yellow-700",children:"Session expired. Redirecting to login..."})]})]}),1===l&&(0,Ue.jsxs)("div",{className:"space-y-3 animate-fade-in",children:["wholesales"===u.type?(0,Ue.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"pricePerUnit",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:["Harga per ",u.unit]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:"Rp"}),(0,Ue.jsx)("input",{id:"pricePerUnit",name:"pricePerUnit",type:"text",inputMode:"numeric",value:u.pricePerUnit?jy(u.pricePerUnit):"",onChange:e=>ge("pricePerUnit",Cy(e.target.value)),onBlur:()=>me("pricePerUnit"),placeholder:"0","aria-invalid":!!h.pricePerUnit,className:"w-full pl-10 pr-12 py-2.5 border rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-1 ".concat(h.pricePerUnit&&f.pricePerUnit?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-gray-500 focus:ring-gray-500")}),(0,Ue.jsxs)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:["/",u.unit]})]}),h.pricePerUnit&&f.pricePerUnit&&(0,Ue.jsxs)("p",{className:"mt-1 text-xs text-red-500 flex items-center gap-1",children:[(0,Ue.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),h.pricePerUnit]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"unitsPerPack",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:["Isi per ",u.unit," ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{id:"unitsPerPack",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:u.unitsPerPack||"",onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,"");ge("unitsPerPack",t?parseInt(t):void 0)},placeholder:"40",className:"w-full px-3 pr-16 py-2.5 border rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-1 ".concat(h.unitsPerPack?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-gray-500 focus:ring-gray-500")}),(0,Ue.jsxs)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:["pcs/",u.unit]})]}),h.unitsPerPack&&(0,Ue.jsx)("p",{className:"mt-1 text-xs text-red-500",children:h.unitsPerPack})]})]}):(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"pricePerUnit",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:["Harga per ",u.unit]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:"Rp"}),(0,Ue.jsx)("input",{id:"pricePerUnit",name:"pricePerUnit",type:"text",inputMode:"numeric",value:u.pricePerUnit?jy(u.pricePerUnit):"",onChange:e=>ge("pricePerUnit",Cy(e.target.value)),onBlur:()=>me("pricePerUnit"),placeholder:"0","aria-invalid":!!h.pricePerUnit,className:"w-full pl-10 pr-20 py-2.5 border rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-1 ".concat(h.pricePerUnit&&f.pricePerUnit?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-gray-500 focus:ring-gray-500")}),(0,Ue.jsxs)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:["/",u.unit]})]}),h.pricePerUnit&&f.pricePerUnit&&(0,Ue.jsxs)("p",{className:"mt-1 text-xs text-red-500 flex items-center gap-1",children:[(0,Ue.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),h.pricePerUnit]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("span",{className:"text-xs font-medium block mb-1.5",style:{color:"#525252"},children:"Diskon"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{"percentage"===u.discountType?(X(u.discountValue||0),W(!0)):(X(1),W(!0))},className:"inline-flex items-center justify-center gap-1 px-3 py-1.5 rounded-full text-sm font-medium transition-colors",style:{background:"percentage"===u.discountType?hy:my,color:"percentage"===u.discountType?"white":"#525252"},children:"percentage"===u.discountType&&u.discountValue?(0,Ue.jsxs)(Ue.Fragment,{children:[u.discountValue,"%"]}):(0,Ue.jsx)(Ue.Fragment,{children:"diskon off"})})]}),(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("span",{className:"text-xs font-medium block mb-1.5",style:{color:"#525252"},children:"PPN"}),(0,Ue.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:u.includePPN,onChange:e=>ge("includePPN",e.target.checked),className:"sr-only peer"}),(0,Ue.jsx)("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-gray-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-neutral-500 relative"})]})]}),(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("span",{className:"text-xs font-medium block mb-1.5",style:{color:"#525252"},children:"Cara Bayar"}),(0,Ue.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:"tunai"!==u.paymentMethod||!0===f.paymentMethod,onChange:e=>{e.target.checked?me("paymentMethod"):(ge("paymentMethod","tunai"),ge("dueDate",void 0),m(e=>tt(tt({},e),{},{paymentMethod:!1})))},className:"sr-only peer"}),(0,Ue.jsx)("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-gray-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-neutral-500 relative"})]})]})]}),("tunai"!==u.paymentMethod||!0===f.paymentMethod)&&(0,Ue.jsx)("div",{className:"flex gap-2",children:[{value:"tunai",label:"Tunai"},{value:"transfer",label:"Transfer"},{value:"kredit",label:"Tempo"}].map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>{ge("paymentMethod",e.value),"kredit"!==e.value&&ge("dueDate",void 0)},className:"flex-1 py-2.5 px-3 rounded-xl text-sm font-medium transition-colors",style:u.paymentMethod===e.value?{background:hy,color:xy}:{background:gy,color:py},children:e.label},e.value))}),"kredit"===u.paymentMethod&&(0,Ue.jsxs)("div",{className:"w-full",children:[(0,Ue.jsx)("label",{htmlFor:"dueDate",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:"Jatuh Tempo"}),(0,Ue.jsx)("div",{className:"relative w-full",children:(0,Ue.jsx)("input",{id:"dueDate",name:"dueDate",type:"date",min:_y(),value:u.dueDate||"",onChange:e=>ge("dueDate",e.target.value),onBlur:()=>me("dueDate"),"aria-invalid":!!h.dueDate,className:"w-full px-3 py-2.5 border rounded-lg text-sm text-gray-900 focus:outline-none focus:ring-1 appearance-none box-border ".concat(h.dueDate&&f.dueDate?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-gray-500 focus:ring-gray-500"),style:{maxWidth:"100%"}})}),h.dueDate&&f.dueDate&&(0,Ue.jsx)("p",{className:"mt-1 text-xs text-red-500",children:h.dueDate})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"notes",className:"block text-xs font-medium mb-1",style:{color:"#525252"},children:["Catatan ",(0,Ue.jsx)("span",{className:"text-gray-400",children:"(opsional)"})]}),(0,Ue.jsx)("textarea",{id:"notes",value:u.notes,onChange:e=>ge("notes",e.target.value.slice(0,200)),placeholder:"Catatan tambahan...",rows:1,maxLength:200,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:border-gray-500 focus:ring-1 focus:ring-gray-500 resize-none"})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden mt-3",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,Ue.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #E5E5E5",background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:"#737373"},children:"Ringkasan"}),(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-2.5",style:{background:xy},children:[(0,Ue.jsx)("span",{className:"text-sm",style:{color:py},children:"Subtotal"}),(0,Ue.jsxs)("span",{className:"text-sm font-semibold",style:{color:yy},children:["Rp ",jy(u.qty*u.pricePerUnit)]})]}),de.discount>0&&(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-2.5",style:{background:gy},children:[(0,Ue.jsx)("span",{className:"text-sm",style:{color:py},children:"Diskon"}),(0,Ue.jsxs)("span",{className:"text-sm font-semibold",style:{color:vy},children:["- Rp ",jy(de.discount)]})]}),u.includePPN&&(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-2.5",style:{background:de.discount>0?xy:gy},children:[(0,Ue.jsx)("span",{className:"text-sm",style:{color:py},children:"PPN (11%)"}),(0,Ue.jsxs)("span",{className:"text-sm font-semibold",style:{color:yy},children:["Rp ",jy(de.ppn)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-3",style:{background:"#FFF7ED",borderTop:"2px solid ".concat(hy)},children:[(0,Ue.jsx)("span",{className:"text-sm font-semibold",style:{color:yy},children:"TOTAL BAYAR"}),(0,Ue.jsxs)("span",{className:"text-lg font-bold",style:{color:hy},children:["Rp ",jy(de.total)]})]}),"wholesales"===u.type&&u.unitsPerPack&&u.unitsPerPack>0&&(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-2.5",style:{background:gy,borderTop:"1px solid #E5E5E5"},children:[(0,Ue.jsxs)("span",{className:"text-sm",style:{color:py},children:["HPP Final per ",pe.retailUnit]}),(0,Ue.jsxs)("span",{className:"text-sm font-medium",style:{color:yy},children:["Rp ",jy(Math.round(pe.finalHppPerUnit))]})]})]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 ".concat(o?"":"rounded-b-2xl"),style:{background:my,paddingBottom:"max(12px, env(safe-area-inset-bottom))"},children:[1===l&&(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsx)("div",{className:"flex items-center justify-center rounded-xl font-semibold",style:{background:xy,color:py,fontSize:"14px",padding:"14px"},children:"Step 1/2"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{fe(l)&&(A("right"),c(e=>Math.min(e+1,2)))},disabled:!ye(1),className:"rounded-xl font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{background:ye(1)?hy:xy,color:ye(1)?xy:py,fontSize:"14px",padding:"14px"},children:"Next \u2192"})]}),2===l&&(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>{A("left"),c(e=>Math.max(e-1,1))},className:"rounded-xl font-semibold transition-colors",style:{background:xy,color:py,fontSize:"14px",padding:"14px"},children:"\u2190"}),(0,Ue.jsxs)("button",{type:"button",onClick:async()=>{if(fe(2)){x(!0),v("idle");try{const e=localStorage.getItem("access_token");if(!e)return v("session_expired"),console.error("No auth token found - session expired"),void setTimeout(()=>{window.location.href="/login"},2e3);console.log("[PurchaseForm] Submitting transaction...");const t=await fetch("/api/transactions/purchase",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({product_name:u.product,quantity:u.qty,unit:u.unit,price_per_unit:u.pricePerUnit,payment_method:u.paymentMethod,vendor_name:u.supplier||null,notes:u.notes||null,discount_type:"none"===u.discountType?null:u.discountType,discount_value:u.discountValue||0,include_vat:u.includePPN,units_per_pack:u.unitsPerPack||null,purchase_type:u.type,purchase_date:u.date,due_date:u.dueDate||null,hpp_per_unit:pe.finalHppPerUnit,harga_jual:Y,margin:pe.finalMargin,margin_percent:pe.finalMarginPercent,retail_unit:pe.retailUnit})});if(console.log("[PurchaseForm] Response status:",t.status),!t.ok)return console.error("[PurchaseForm] HTTP error:",t.status),void v("error");const n=await t.json();console.log("[PurchaseForm] Response data:",n),"success"===n.status?(localStorage.removeItem(dy),v("success"),console.log("[PurchaseForm] Transaction saved:",n.transaction_id),i&&n.message&&i(n.message),xe()):(console.error("[PurchaseForm] API error:",n.message),v("error"))}catch(e){console.error("[PurchaseForm] Submit error:",e),v("error")}finally{x(!1)}}},disabled:!ye(2)||g,className:"col-span-1 flex items-center justify-center gap-2 rounded-xl font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{background:ye(2)&&!g?hy:xy,color:ye(2)&&!g?xy:py,fontSize:"14px",padding:"14px"},children:[g?(0,Ue.jsxs)("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,"Simpan"]}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{const e={formData:u,currentStep:l,timestamp:Date.now()};localStorage.setItem(dy,JSON.stringify(e)),xe()},className:"rounded-xl font-semibold transition-colors",style:{background:xy,color:py,fontSize:"14px",padding:"14px"},children:"Draft"})]})]})]}),B&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>L(!1),children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm mx-4 w-full",style:{boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:e=>e.stopPropagation(),children:[(0,Ue.jsx)("div",{className:"text-center mb-4 text-lg font-semibold",style:{color:yy},children:"Kuantiti"}),(0,Ue.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>G(Math.max(1,H-1)),className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl",style:{background:my,color:"#525252"},children:"\u2212"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:H,onChange:e=>G(parseInt(e.target.value.replace(/\D/g,""))||1),className:"w-20 px-4 py-3 rounded-lg border text-center text-2xl font-bold",style:{borderColor:my,color:yy},autoFocus:!0}),(0,Ue.jsx)("button",{type:"button",onClick:()=>G(H+1),className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl text-white",style:{background:hy},children:"+"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>L(!1),className:"py-3 rounded-lg font-semibold transition-colors",style:{background:my,color:"#525252"},children:"Batal"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{ge("qty",H),L(!1)},className:"py-3 rounded-lg font-semibold text-white transition-colors",style:{background:hy},children:"OK"})]})]})}),z&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>W(!1),children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm mx-4 w-full",style:{boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:e=>e.stopPropagation(),children:[(0,Ue.jsx)("div",{className:"text-center mb-4 text-lg font-semibold",style:{color:yy},children:"Diskon"}),(0,Ue.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>X(Math.max(0,K-1)),className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl",style:{background:my,color:"#525252"},children:"\u2212"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:K,onChange:e=>{const t=parseInt(e.target.value.replace(/\D/g,""))||0;X(Math.min(99,t))},className:"w-20 px-4 py-3 rounded-lg border text-center text-2xl font-bold",style:{borderColor:my,color:yy},autoFocus:!0}),(0,Ue.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-lg font-bold",style:{color:py},children:"%"})]}),(0,Ue.jsx)("button",{type:"button",onClick:()=>X(Math.min(99,K+1)),className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl text-white",style:{background:hy},children:"+"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>W(!1),className:"py-3 rounded-lg font-semibold transition-colors",style:{background:my,color:"#525252"},children:"Batal"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{K>0?(ge("discountType","percentage"),ge("discountValue",K)):(ge("discountType","none"),ge("discountValue",void 0)),W(!1)},className:"py-3 rounded-lg font-semibold text-white transition-colors",style:{background:hy},children:"OK"})]})]})})]})};function Ay(e){const t=Ye(()=>Nr(e)),{isStatic:n}=(0,a.useContext)(ot);if(n){const[,n]=(0,a.useState)(e);(0,a.useEffect)(()=>t.on("change",n),[])}return t}class Iy{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>e.finished))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e){const t=this.animations.map(t=>t.attachTimeline(e));return()=>{t.forEach((e,t)=>{e&&e(),this.animations[t].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get state(){return this.getAll("state")}get startTime(){return this.getAll("startTime")}get duration(){return Ty(this.animations,"duration")}get iterationDuration(){return Ty(this.animations,"iterationDuration")}runAll(e){this.animations.forEach(t=>t[e]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function Ty(e,t){let n=0;for(let r=0;r<e.length;r++){const a=e[r][t];null!==a&&a>n&&(n=a)}return n}class Py extends Iy{then(e,t){return this.finished.finally(e).then(()=>{})}}function Dy(e,t){return zo(e)?e[((e,t,n)=>{const r=t-e;return((n-e)%r+r)%r+e})(0,e.length,t)]:e}function My(e){return"object"===typeof e&&!Array.isArray(e)}function Ry(e,t,n,r){return"string"===typeof e&&My(t)?Jl(e,n,r):e instanceof NodeList?Array.from(e):Array.isArray(e)?e:[e]}function Fy(e,t,n){return e*(t+1)}function Oy(e,t,n,r){return"number"===typeof t?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,e+parseFloat(t)):"<"===t?n:t.startsWith("<")?Math.max(0,n+parseFloat(t.slice(1))):null!==(a=r.get(t))&&void 0!==a?a:e;var a}function By(e,t,n,r,a,o){!function(e,t,n){for(let r=0;r<e.length;r++){const a=e[r];a.at>t&&a.at<n&&(br(e,a),r--)}}(e,a,o);for(let i=0;i<t.length;i++)e.push({value:t[i],at:Mt(a,o,r[i]),easing:Dy(n,i)})}function Ly(e,t){for(let n=0;n<e.length;n++)e[n]=e[n]/(t+1)}function zy(e,t){return e.at===t.at?null===e.value?1:null===t.value?-1:0:e.at-t.at}const Wy=["defaultTransition"],Vy=["delay","times","type","repeat","repeatType","repeatDelay"];function Uy(e,t){return!t.has(e)&&t.set(e,{}),t.get(e)}function Hy(e,t){return t[e]||(t[e]=[]),t[e]}function Gy(e){return Array.isArray(e)?e:[e]}function Ky(e,t){return e&&e[t]?tt(tt({},e),e[t]):tt({},e)}const Xy=e=>"number"===typeof e,Yy=e=>e.every(Xy);class qy extends Gr{constructor(){super(...arguments),this.type="object"}readValueFromInstance(e,t){if(function(e,t){return e in t}(t,e)){const n=e[t];if("string"===typeof n||"number"===typeof n)return n}}getBaseTargetFromProps(){}removeValueFromRenderState(e,t){delete t.output[e]}measureInstanceViewportBox(){return{x:{min:0,max:0},y:{min:0,max:0}}}build(e,t){Object.assign(e.output,t)}renderInstance(e,t){let{output:n}=t;Object.assign(e,n)}sortInstanceNodePosition(){return 0}}function Zy(e){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},n=Us(e)&&!Hs(e)?new ua(t):new ta(t);n.mount(e),Mr.set(e,n)}function Jy(e){const t=new qy({presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}});t.mount(e),Mr.set(e,t)}function Qy(e,t,n,r){const a=[];if(function(e,t){return fr(e)||"number"===typeof e||"string"===typeof e&&!My(t)}(e,t))a.push(Gs(e,My(t)&&t.default||t,n&&n.default||n));else{const o=Ry(e,t,r),i=o.length;Boolean(i);for(let e=0;e<i;e++){const r=o[e];hn();const s=r instanceof Element?Zy:Jy;Mr.has(r)||s(r);const l=Mr.get(r),c=tt({},n);"delay"in c&&"function"===typeof c.delay&&(c.delay=c.delay(e,i)),a.push(...Wi(l,tt(tt({},t),{},{transition:c}),{}))}}return a}function $y(e,t,n){const r=[],a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{defaultTransition:n={}}=t,r=mr(t,Wy),a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;const i=n.duration||.3,s=new Map,l=new Map,c={},u=new Map;let d=0,h=0,p=0;for(let f=0;f<e.length;f++){const t=e[f];if("string"===typeof t){u.set(t,h);continue}if(!Array.isArray(t)){u.set(t.name,Oy(h,t.at,d,u));continue}let[r,s,m={}]=t;void 0!==m.at&&(h=Oy(h,m.at,d,u));let g=0;const x=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const l=Gy(e),{delay:c=0,times:u=ni(l),type:d="keyframes",repeat:f,repeatType:m,repeatDelay:x=0}=t,y=mr(t,Vy);let{ease:v=n.ease||"easeOut",duration:b}=t;const w="function"===typeof c?c(a,s):c,k=l.length,j=bi(d)?d:null===o||void 0===o?void 0:o[d||"keyframes"];if(k<=2&&j){let e=100;if(2===k&&Yy(l)){const t=l[1]-l[0];e=Math.abs(t)}const t=tt({},y);void 0!==b&&(t.duration=no(b));const n=jo(t,e,j);v=n.ease,b=n.duration}null!==b&&void 0!==b||(b=i);const C=h+w;1===u.length&&0===u[0]&&(u[1]=1);const N=u.length-l.length;if(N>0&&ti(u,N),1===l.length&&l.unshift(null),f){b=Fy(b,f);const e=[...l],t=[...u];v=Array.isArray(v)?[...v]:[v];const n=[...v];for(let r=0;r<f;r++){l.push(...e);for(let a=0;a<e.length;a++)u.push(t[a]+(r+1)),v.push(0===a?"linear":Dy(n,a-1))}Ly(u,f)}const _=C+b;By(r,l,v,u,C,_),g=Math.max(w+b,g),p=Math.max(_,p)};if(fr(r))x(s,m,Hy("default",Uy(r,l)));else{const e=Ry(r,s,a,c),t=e.length;for(let n=0;n<t;n++){const r=Uy(e[n],l);for(const e in s)x(s[e],Ky(m,e),Hy(e,r),n,t)}}d=h,h+=g}return l.forEach((e,t)=>{for(const a in e){const o=e[a];o.sort(zy);const i=[],l=[],c=[];for(let e=0;e<o.length;e++){const{at:t,value:n,easing:r}=o[e];i.push(n),l.push($o(0,p,t)),c.push(r||"easeOut")}0!==l[0]&&(l.unshift(0),i.unshift(i[0]),c.unshift("easeInOut")),1!==l[l.length-1]&&(l.push(1),i.push(null)),s.has(t)||s.set(t,{keyframes:{},transition:{}});const u=s.get(t);u.keyframes[a]=i,u.transition[a]=tt(tt({},n),{},{duration:p,ease:c,times:l},r)}}),s}(e,t,n,{spring:Do});return a.forEach((e,t)=>{let{keyframes:n,transition:a}=e;r.push(...Qy(t,n,a))}),r}const ev=["onComplete"];const tv=function(e,t,n){let r,a=[];if(o=e,Array.isArray(o)&&o.some(Array.isArray))a=$y(e,t,nv);else{const o=n||{},{onComplete:i}=o;"function"===typeof i&&(r=i),a=Qy(e,t,mr(o,ev),nv)}var o;const i=new Py(a);return r&&i.finished.then(r),nv&&(nv.animations.push(i),i.finished.then(()=>{br(nv.animations,i)})),i};var nv;const rv=new class{constructor(){this.audioContext=null}getAudioContext(){return this.audioContext||(this.audioContext=new AudioContext),"suspended"===this.audioContext.state&&this.audioContext.resume(),this.audioContext}playTone(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{const r=this.getAudioContext(),a=r.createOscillator(),o=r.createGain();a.connect(o),o.connect(r.destination),a.frequency.value=e,a.type="sine";const i=r.currentTime+n/1e3,s=i+t/1e3;o.gain.setValueAtTime(.3,i),o.gain.exponentialRampToValueAtTime(.01,s),a.start(i),a.stop(s)}catch(Z_){console.warn("Sound playback failed:",Z_)}}scanSuccess(){this.playTone(800,50,0),this.playTone(1200,80,60)}scanError(){this.playTone(400,100,0),this.playTone(300,150,110)}transactionComplete(){this.playTone(1e3,80,0),this.playTone(1200,80,100),this.playTone(1400,120,200)}tap(){this.playTone(600,20,0)}itemAdded(){this.playTone(1e3,40,0)}},av="#F97316",ov="#0EA5E9",iv="#737373",sv="#D4D4D4",lv="#E5E5E5",cv="#F5F5F5",uv="#FFFFFF",dv="#262626",hv="#22C55E",pv={shake:{x:[0,-8,8,-6,6,-3,3,0],transition:{duration:.5,ease:"easeOut"}}},fv=[{id:"ongkir_masuk",label:"Ongkir Masuk",icon:"\ud83d\udce5",code:"6101",desc:"Ongkir beli barang"},{id:"gaji",label:"Gaji Karyawan",icon:"\ud83d\udc64",code:"6102",desc:"Gaji karyawan/kasir"},{id:"sewa",label:"Sewa Tempat",icon:"\ud83c\udfe0",code:"6103",desc:"Sewa toko/ruko"},{id:"listrik",label:"Listrik & Air",icon:"\ud83d\udca1",code:"6104",desc:"PLN, PDAM"},{id:"telepon",label:"Telepon & Internet",icon:"\ud83d\udcf1",code:"6105",desc:"Pulsa, WiFi"},{id:"perlengkapan",label:"Perlengkapan",icon:"\ud83d\udce6",code:"6106",desc:"Plastik, nota, ATK"},{id:"transport",label:"Transportasi",icon:"\ud83d\ude97",code:"6107",desc:"Bensin, parkir"},{id:"ongkir_keluar",label:"Ongkir Keluar",icon:"\ud83d\udce4",code:"6108",desc:"Antar ke customer"},{id:"pajak",label:"Pajak UMKM",icon:"\ud83d\udccb",code:"6109",desc:"Pajak 0.5% omzet"},{id:"lainnya_operasional",label:"Beban Lain-lain",icon:"\ud83d\udcdd",code:"6110",desc:"Kebersihan, keamanan"},{id:"bunga",label:"Bunga Pinjaman",icon:"\ud83d\udcb0",code:"7201",desc:"Bunga pinjaman bank"},{id:"biaya_bank",label:"Admin Bank",icon:"\ud83c\udfe6",code:"7202",desc:"Potongan admin bulanan"},{id:"beban_dimuka",label:"Beban Dibayar di Muka",icon:"\ud83d\udcc5",code:"1105",desc:"Sewa/asuransi bayar duluan"},{id:"pemeliharaan",label:"Pemeliharaan",icon:"\ud83d\udd27",code:"6110",desc:"Service AC, perbaikan"},{id:"asuransi",label:"Asuransi",icon:"\ud83d\udee1\ufe0f",code:"6110",desc:"Asuransi toko"},{id:"iklan",label:"Iklan & Promosi",icon:"\ud83d\udce2",code:"6110",desc:"Iklan/promosi"},{id:"makan",label:"Makan Karyawan",icon:"\ud83c\udf7d\ufe0f",code:"6110",desc:"Makan karyawan"},{id:"penyusutan",label:"Penyusutan Aset",icon:"\ud83d\udcc9",code:"6110",desc:"Penyusutan aset tetap"},{id:"lainnya",label:"Tulis Sendiri...",icon:"\u270f\ufe0f",code:"-",desc:"Kategori custom"}],mv={gaji:"beban_gaji",sewa:"beban_sewa",listrik:"beban_utilitas",telepon:"beban_telepon",perlengkapan:"beban_perlengkapan",transport:"beban_transport",ongkir_masuk:"beban_ongkir_masuk",ongkir_keluar:"beban_ongkir_keluar",pajak:"beban_pajak",lainnya_operasional:"beban_lainnya",pemeliharaan:"beban_pemeliharaan",biaya_bank:"beban_admin_bank",bunga:"beban_bunga",asuransi:"beban_asuransi",iklan:"beban_iklan",makan:"beban_makan",penyusutan:"beban_penyusutan",beban_dimuka:"beban_dibayar_dimuka",lainnya:"beban_lainnya"},gv="milkyhoop_draft_beban",xv=a.memo(e=>{let{checked:t,onChange:n,labelOn:r,labelOff:o}=e;const[i,s]=a.useState(!1),l=Ay(t?42:-42);a.useEffect(()=>{i||tv(l,t?42:-42,{type:"spring",stiffness:500,damping:30})},[t,i,l]);return(0,Ue.jsxs)("button",{onClick:()=>{i||(n(!t),rv.itemAdded())},style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"120px",height:"36px",padding:"4px",background:t?av:"#E5E5E5",borderRadius:"18px",border:"none",cursor:"pointer",userSelect:"none",touchAction:"pan-y"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",fontWeight:400,color:t?"#FFFFFF":iv,zIndex:1,paddingLeft:t?"0":"24px",paddingRight:t?"24px":"0",pointerEvents:"none"},children:t?r:o}),(0,Ue.jsx)(yc.span,{drag:"x",dragElastic:.1,dragMomentum:!1,dragConstraints:{left:-42,right:42},onDragStart:()=>s(!0),onDragEnd:(e,r)=>{Math.abs(r.offset.x)>20&&(r.offset.x>0&&!t||r.offset.x<0&&t)?(n(!t),rv.itemAdded()):tv(l,t?42:-42,{type:"spring",stiffness:500,damping:30}),s(!1)},style:{x:l,position:"absolute",width:"28px",height:"28px",borderRadius:"50%",background:"#FFFFFF",boxShadow:"0 2px 4px rgba(0,0,0,0.15)",cursor:"grab",zIndex:2},whileDrag:{cursor:"grabbing",scale:1.05}})]})}),yv=e=>{let{tenantId:t,onClose:n,onTransactionComplete:r}=e;const o=(0,a.useRef)(null),[i,s]=(0,a.useState)({category:"listrik",categoryLabel:"Listrik & Air",customCategory:"",amount:0,description:"",date:(new Date).toLocaleDateString("id-ID",{day:"numeric",month:"long"})}),[l,c]=(0,a.useState)(""),[u,d]=(0,a.useState)(!1),[h,p]=(0,a.useState)(fv),[f,m]=(0,a.useState)("tunai"),[g]=(0,a.useState)(35e5),[x]=(0,a.useState)(25e5),[y,v]=(0,a.useState)(()=>{const e=new Date;return e.setDate(e.getDate()+30),e.toLocaleDateString("id-ID",{day:"numeric",month:"long"})}),[b]=(0,a.useState)({totalBebanBulan:125e4,rataRataBeban:125e3,jumlahTransaksi:10}),[w,k]=(0,a.useState)(!1),[j,C]=(0,a.useState)(!1),[N,_]=(0,a.useState)(!1),[S,E]=(0,a.useState)(!1),[A,I]=(0,a.useState)(""),[T,P]=(0,a.useState)(""),[D,M]=(0,a.useState)(""),[R,F]=(0,a.useState)(!1),[O,B]=(0,a.useState)(!1),[L,z]=(0,a.useState)(""),[W,V]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=localStorage.getItem(gv);if(e)try{const t=JSON.parse(e);Date.now()-t.timestamp<864e5?(s(t.formData),t.paymentMethod&&m(t.paymentMethod)):localStorage.removeItem(gv)}catch(J_){localStorage.removeItem(gv)}},[]),(0,a.useEffect)(()=>{if(l.trim()){const e=fv.filter(e=>e.label.toLowerCase().includes(l.toLowerCase())||e.desc.toLowerCase().includes(l.toLowerCase()));p(e),d(!0)}else p(fv),d(!1)},[l]);const U=e=>"Rp ".concat(e.toLocaleString("id-ID")),H=()=>{rv.itemAdded()},G=i.category&&i.amount>0;return(0,Ue.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",background:lv,fontFamily:"'Hiragino Kaku Gothic ProN', -apple-system, BlinkMacSystemFont, sans-serif"},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 flex-shrink-0",style:{height:"60px",paddingTop:"max(4px, env(safe-area-inset-top))",background:lv},children:[(0,Ue.jsx)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:sv},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain"})}),(0,Ue.jsx)("span",{className:"font-semibold",style:{fontSize:"20px",fontWeight:600,color:"#1F2937"},children:"Beban"})]}),(0,Ue.jsx)("div",{style:{padding:"0 16px 8px",flexShrink:0},children:(0,Ue.jsxs)("div",{style:{position:"relative"},children:[(0,Ue.jsx)("input",{ref:o,type:"text",value:l,onChange:e=>c(e.target.value),onFocus:()=>l&&d(!0),onBlur:()=>setTimeout(()=>d(!1),200),placeholder:"Ketik nama beban",style:{width:"100%",height:"52px",padding:"0 56px 0 16px",background:uv,border:"1px solid ".concat(sv),borderRadius:"12px",fontSize:"14px",color:dv,outline:"none"}}),(0,Ue.jsx)("button",{onClick:H,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",cursor:"pointer"},children:(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",style:{width:"24px",height:"24px"}})}),u&&h.length>0&&(0,Ue.jsx)("div",{style:{position:"absolute",top:"56px",left:0,right:0,background:"white",border:"1px solid ".concat(lv),borderRadius:"12px",maxHeight:"200px",overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:50},children:h.map(e=>(0,Ue.jsxs)("div",{onClick:()=>(e=>{if(rv.itemAdded(),"lainnya"===e.id)return d(!1),P(""),void _(!0);s(t=>tt(tt({},t),{},{category:e.id,categoryLabel:e.label})),c(""),d(!1)})(e),style:{padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid ".concat(cv),display:"flex",alignItems:"center",gap:"12px"},children:[(0,Ue.jsx)("span",{style:{fontSize:"18px"},children:e.icon}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",fontWeight:500,color:dv},children:e.label}),(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv},children:e.desc})]})]},e.id))})]})}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",padding:"0 16px",minHeight:0,overflow:"auto"},children:[(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"10px",flex:1,minHeight:0},children:[(0,Ue.jsxs)("div",{style:{background:uv,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid ".concat(sv),display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[(0,Ue.jsx)("div",{style:{flexShrink:0,padding:"10px 12px",borderBottom:"1px solid ".concat(lv),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:iv,textAlign:"center"},children:"Rincian"}),(0,Ue.jsxs)("div",{onClick:()=>k(!0),style:{flex:1,padding:"10px 12px",background:uv,display:"flex",flexDirection:"column",justifyContent:"center",cursor:"pointer"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Nama Beban"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:i.categoryLabel||"Nama Beban"})]}),(0,Ue.jsxs)("div",{onClick:()=>{I(i.amount>0?i.amount.toString():""),C(!0)},style:{flex:1,padding:"10px 12px",background:cv,display:"flex",flexDirection:"column",justifyContent:"center",cursor:"pointer"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Biaya Beban"}),(0,Ue.jsxs)("div",{style:{fontSize:"15px",fontWeight:700,color:i.amount>0?dv:iv,textAlign:"left",display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:iv},children:"\u270e"})," ",i.amount>0?U(i.amount):"Rp 0"]})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:uv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Tanggal"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:i.date})]})]}),(0,Ue.jsxs)("div",{style:{background:uv,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid ".concat(sv),display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[(0,Ue.jsx)("div",{style:{flexShrink:0,padding:"10px 12px",borderBottom:"1px solid ".concat(lv),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:iv,textAlign:"center"},children:"Insight Bulanan"}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:uv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Beban Berjalan"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:U(b.totalBebanBulan)})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:cv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Beban Bulan Lalu"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:U(55e5)})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:uv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Beban Rata-Rata"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:U(58e5)})]})]})]}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",flex:1,minHeight:0},children:[(0,Ue.jsxs)("div",{style:{background:uv,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid ".concat(sv),display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[(0,Ue.jsx)("div",{style:{flexShrink:0,padding:"10px 12px",borderBottom:"1px solid ".concat(lv),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:iv,textAlign:"center"},children:"kredit"===f?"Hutang":"Kas & Bank"}),"kredit"===f?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{onClick:()=>E(!0),style:{flex:1,padding:"10px 12px",background:uv,cursor:"pointer",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Jatuh Tempo"}),(0,Ue.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:dv,textAlign:"left",display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:iv},children:"\u270e"})," ",y]})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:cv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Nilai Hutang"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:U(i.amount)})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:uv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Total Hutang Toko"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:U(x+i.amount)})]})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:uv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Kas Bank"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:U(g)})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:cv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Total Bayar"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:dv,textAlign:"left"},children:U(i.amount)})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:uv,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:iv,textAlign:"left"},children:"Update Kas Bank"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:"#EF4444",textAlign:"left"},children:U(g-i.amount)})]})]})]}),(0,Ue.jsxs)("div",{style:{background:uv,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid ".concat(sv),display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[(0,Ue.jsx)("div",{style:{flexShrink:0,padding:"10px 12px",borderBottom:"1px solid ".concat(lv),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:iv,textAlign:"center"},children:"Cara Bayar"}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 12px",background:"tunai"===f?"#FFF7ED":uv,borderBottom:"1px solid ".concat(cv)},children:(0,Ue.jsx)(xv,{checked:"tunai"===f,onChange:()=>m("tunai"),labelOn:"Tunai",labelOff:"Tunai off"})}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 12px",background:"transfer"===f?"#FFF7ED":cv,borderBottom:"1px solid ".concat(lv)},children:(0,Ue.jsx)(xv,{checked:"transfer"===f,onChange:()=>m("transfer"),labelOn:"Transfer",labelOff:"Transfer off"})}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 12px",background:"kredit"===f?"#FFF7ED":uv},children:(0,Ue.jsx)(xv,{checked:"kredit"===f,onChange:()=>m("kredit"),labelOn:"Tempo",labelOff:"Tempo off"})})]})]})]}),L&&(0,Ue.jsx)("div",{style:{padding:"12px 16px",background:"#FEE2E2",color:"#DC2626",textAlign:"center",fontSize:"14px",fontWeight:500},children:L}),(0,Ue.jsxs)("div",{style:{flexShrink:0,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",padding:"12px 16px",background:lv,paddingBottom:"max(12px, env(safe-area-inset-bottom))"},children:[(0,Ue.jsxs)("button",{onClick:H,style:{padding:"14px 16px",background:uv,color:"#525252",border:"1px solid ".concat(sv),borderRadius:"12px",fontSize:"15px",fontWeight:600,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,Ue.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,Ue.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,Ue.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,Ue.jsx)("polyline",{points:"21,15 16,10 5,21"})]}),"Foto Bukti"]}),(0,Ue.jsx)(yc.button,{animate:R?"shake":"",variants:pv,onClick:async()=>{if(!i.category||i.amount<=0)return F(!0),setTimeout(()=>F(!1),500),rv.scanError(),z("Pilih kategori dan masukkan nominal"),void setTimeout(()=>z(""),3e3);if(!O){B(!0),z("");try{const e=localStorage.getItem("access_token");if(!e)throw new Error("Sesi berakhir. Silakan login ulang.");const a=tt({transaction_type:"beban",category:"lainnya"===i.category?i.customCategory:mv[i.category]||"beban_lainnya",description:i.description||i.categoryLabel,amount:i.amount,total_amount:i.amount,payment_method:"tunai"===f?"CASH":"transfer"===f?"TRANSFER":"TEMPO",date:i.date},"kredit"===f&&{due_date:y,is_tempo:!0}),o=await fetch("/api/tenant/".concat(t,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Beban",session_id:"beban-".concat(Date.now()),conversation_context:JSON.stringify({form_data:a})})});if(!o.ok){if(401===o.status)throw new Error("Sesi berakhir. Silakan login ulang.");const e=await o.json().catch(()=>({}));throw new Error(e.message||e.detail||"Gagal menyimpan beban")}await o.json(),rv.transactionComplete(),V(!0),localStorage.removeItem(gv),setTimeout(()=>{null===r||void 0===r||r("Beban ".concat(i.categoryLabel," ").concat(U(i.amount)," berhasil dicatat.")),n()},1500)}catch(Z_){rv.scanError(),z(Z_.message||"Transaksi gagal. Silakan coba lagi."),setTimeout(()=>z(""),3e3)}finally{B(!1)}}},disabled:!G||O,style:{padding:"14px 16px",background:G&&!O?ov:"#D1D5DB",color:"white",border:"1px solid ".concat(sv),borderRadius:"12px",fontSize:"17px",fontWeight:700,boxShadow:"0 1px 3px rgba(0,0,0,0.1)",cursor:G&&!O?"pointer":"not-allowed"},children:O?"Menyimpan...":"Simpan"})]}),(0,Ue.jsx)(mt,{children:w&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>k(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"16px",width:"100%",maxWidth:"340px",maxHeight:"70vh",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"12px",color:dv},children:"Pilih Kategori Beban"}),(0,Ue.jsx)("div",{style:{flex:1,overflowY:"auto"},children:fv.map(e=>(0,Ue.jsxs)("div",{onClick:()=>(e=>{if(rv.itemAdded(),"lainnya"===e.id)return k(!1),P(i.customCategory),void _(!0);s(t=>tt(tt({},t),{},{category:e.id,categoryLabel:e.label})),k(!1),c(""),d(!1)})(e),style:{padding:"14px 16px",cursor:"pointer",borderBottom:"1px solid ".concat(cv),display:"flex",alignItems:"center",gap:"12px",background:i.category===e.id?"#FFF7ED":"transparent"},children:[(0,Ue.jsx)("span",{style:{fontSize:"20px"},children:e.icon}),(0,Ue.jsx)("span",{style:{fontSize:"14px",fontWeight:i.category===e.id?600:400,color:i.category===e.id?av:dv},children:e.label})]},e.id))}),(0,Ue.jsx)("button",{onClick:()=>k(!1),style:{marginTop:"12px",padding:"12px",background:cv,border:"none",borderRadius:"8px",fontWeight:600,cursor:"pointer"},children:"Batal"})]})})}),(0,Ue.jsx)(mt,{children:N&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>_(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"300px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:dv},children:"Kategori Lainnya"}),(0,Ue.jsx)("input",{type:"text",value:T,onChange:e=>P(e.target.value),placeholder:"Contoh: Biaya parkir",autoFocus:!0,style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"14px",border:"2px solid ".concat(av),borderRadius:"8px",marginBottom:"16px",outline:"none"}}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:()=>_(!1),style:{padding:"12px",background:cv,border:"none",borderRadius:"8px",fontWeight:600},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{T.trim()&&s(e=>tt(tt({},e),{},{category:"lainnya",categoryLabel:T.trim(),customCategory:T.trim()})),_(!1)},style:{padding:"12px",background:av,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Simpan"})]})]})})}),(0,Ue.jsx)(mt,{children:j&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>C(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"300px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:dv},children:"Nominal Beban"}),(0,Ue.jsxs)("div",{style:{position:"relative",marginBottom:"16px"},children:[(0,Ue.jsx)("span",{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",fontSize:"14px",color:iv},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:A,onChange:e=>I(e.target.value.replace(/\D/g,"")),autoFocus:!0,style:{width:"100%",height:"48px",paddingLeft:"40px",paddingRight:"16px",textAlign:"right",fontSize:"24px",fontWeight:600,border:"2px solid ".concat(av),borderRadius:"8px",outline:"none"}})]}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:()=>C(!1),style:{padding:"12px",background:cv,border:"none",borderRadius:"8px",fontWeight:600},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{const e=parseInt(A.replace(/\D/g,""))||0;s(t=>tt(tt({},t),{},{amount:e})),C(!1)},style:{padding:"12px",background:av,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Simpan"})]})]})})}),(0,Ue.jsx)(mt,{children:S&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>E(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"300px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:dv},children:"Jatuh Tempo"}),(0,Ue.jsx)("input",{type:"text",value:D,onChange:e=>M(e.target.value),placeholder:"Contoh: 15 Januari 2025",autoFocus:!0,style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"14px",border:"2px solid ".concat(av),borderRadius:"8px",marginBottom:"16px",outline:"none"}}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:()=>E(!1),style:{padding:"12px",background:cv,border:"none",borderRadius:"8px",fontWeight:600},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{D.trim()&&v(D),E(!1)},style:{padding:"12px",background:av,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Simpan"})]})]})})}),(0,Ue.jsx)(mt,{children:W&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:200,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},style:{background:"white",borderRadius:"16px",padding:"32px",textAlign:"center",maxWidth:"300px",width:"100%"},children:[(0,Ue.jsx)("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"#F0FDF4",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:(0,Ue.jsx)("svg",{style:{width:"32px",height:"32px",color:hv},fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,Ue.jsx)("h3",{style:{fontSize:"18px",fontWeight:600,color:dv,marginBottom:"8px"},children:"Beban Berhasil!"}),(0,Ue.jsxs)("p",{style:{fontSize:"14px",color:iv},children:[i.categoryLabel," ",U(i.amount)," telah dicatat"]})]})})})]})};function vv(e){return Array.isArray?Array.isArray(e):"[object Array]"===_v(e)}function bv(e){return"string"===typeof e}function wv(e){return"number"===typeof e}function kv(e){return!0===e||!1===e||function(e){return jv(e)&&null!==e}(e)&&"[object Boolean]"==_v(e)}function jv(e){return"object"===typeof e}function Cv(e){return void 0!==e&&null!==e}function Nv(e){return!e.trim().length}function _v(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Sv=Object.prototype.hasOwnProperty;class Ev{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(e=>{let n=Av(e);this._keys.push(n),this._keyMap[n.id]=n,t+=n.weight}),this._keys.forEach(e=>{e.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Av(e){let t=null,n=null,r=null,a=1,o=null;if(bv(e)||vv(e))r=e,t=Iv(e),n=Tv(e);else{if(!Sv.call(e,"name"))throw new Error((e=>"Missing ".concat(e," property in key"))("name"));const i=e.name;if(r=i,Sv.call(e,"weight")&&(a=e.weight,a<=0))throw new Error((e=>"Property 'weight' in key '".concat(e,"' must be a positive integer"))(i));t=Iv(i),n=Tv(i),o=e.getFn}return{path:t,id:n,weight:a,src:r,getFn:o}}function Iv(e){return vv(e)?e:e.split(".")}function Tv(e){return vv(e)?e.join("."):e}const Pv={useExtendedSearch:!1,getFn:function(e,t){let n=[],r=!1;const a=(e,t,o)=>{if(Cv(e))if(t[o]){const i=e[t[o]];if(!Cv(i))return;if(o===t.length-1&&(bv(i)||wv(i)||kv(i)))n.push(function(e){return null==e?"":function(e){if("string"==typeof e)return e;let t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(i));else if(vv(i)){r=!0;for(let e=0,n=i.length;e<n;e+=1)a(i[e],t,o+1)}else t.length&&a(i,t,o+1)}else n.push(e)};return a(e,bv(t)?t.split("."):t,0),r?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Dv=tt(tt(tt(tt({},{isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1}),{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1}),{location:0,threshold:.6,distance:100}),Pv);const Mv=/[^ ]+/g;class Rv{constructor(){let{getFn:e=Dv.getFn,fieldNormWeight:t=Dv.fieldNormWeight}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.norm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;const n=new Map,r=Math.pow(10,t);return{get(t){const a=t.match(Mv).length;if(n.has(a))return n.get(a);const o=1/Math.pow(a,.5*e),i=parseFloat(Math.round(o*r)/r);return n.set(a,i),i},clear(){n.clear()}}}(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.docs=e}setIndexRecords(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.records=e}setKeys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keys=e,this._keysMap={},e.forEach((e,t)=>{this._keysMap[e.id]=t})}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,bv(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();bv(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!Cv(e)||Nv(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((t,r)=>{let a=t.getFn?t.getFn(e):this.getFn(e,t.path);if(Cv(a))if(vv(a)){let e=[];const t=[{nestedArrIndex:-1,value:a}];for(;t.length;){const{nestedArrIndex:n,value:r}=t.pop();if(Cv(r))if(bv(r)&&!Nv(r)){let t={v:r,i:n,n:this.norm.get(r)};e.push(t)}else vv(r)&&r.forEach((e,n)=>{t.push({nestedArrIndex:n,value:e})})}n.$[r]=e}else if(bv(a)&&!Nv(a)){let e={v:a,n:this.norm.get(a)};n.$[r]=e}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function Fv(e,t){let{getFn:n=Dv.getFn,fieldNormWeight:r=Dv.fieldNormWeight}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=new Rv({getFn:n,fieldNormWeight:r});return a.setKeys(e.map(Av)),a.setSources(t),a.create(),a}function Ov(e){let{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:a=Dv.distance,ignoreLocation:o=Dv.ignoreLocation}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t/e.length;if(o)return i;const s=Math.abs(r-n);return a?i+s/a:s?1:i}const Bv=32;function Lv(e,t,n){let{location:r=Dv.location,distance:a=Dv.distance,threshold:o=Dv.threshold,findAllMatches:i=Dv.findAllMatches,minMatchCharLength:s=Dv.minMatchCharLength,includeMatches:l=Dv.includeMatches,ignoreLocation:c=Dv.ignoreLocation}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t.length>Bv)throw new Error("Pattern length exceeds max of ".concat(Bv,"."));const u=t.length,d=e.length,h=Math.max(0,Math.min(r,d));let p=o,f=h;const m=s>1||l,g=m?Array(d):[];let x;for(;(x=e.indexOf(t,f))>-1;){let e=Ov(t,{currentLocation:x,expectedLocation:h,distance:a,ignoreLocation:c});if(p=Math.min(e,p),f=x+u,m){let e=0;for(;e<u;)g[x+e]=1,e+=1}}f=-1;let y=[],v=1,b=u+d;const w=1<<u-1;for(let j=0;j<u;j+=1){let r=0,o=b;for(;r<o;){Ov(t,{errors:j,currentLocation:h+o,expectedLocation:h,distance:a,ignoreLocation:c})<=p?r=o:b=o,o=Math.floor((b-r)/2+r)}b=o;let s=Math.max(1,h-o+1),l=i?d:Math.min(h+o,d)+u,x=Array(l+2);x[l+1]=(1<<j)-1;for(let i=l;i>=s;i-=1){let r=i-1,o=n[e.charAt(r)];if(m&&(g[r]=+!!o),x[i]=(x[i+1]<<1|1)&o,j&&(x[i]|=(y[i+1]|y[i])<<1|1|y[i+1]),x[i]&w&&(v=Ov(t,{errors:j,currentLocation:r,expectedLocation:h,distance:a,ignoreLocation:c}),v<=p)){if(p=v,f=r,f<=h)break;s=Math.max(1,2*h-f)}}if(Ov(t,{errors:j+1,currentLocation:h,expectedLocation:h,distance:a,ignoreLocation:c})>p)break;y=x}const k={isMatch:f>=0,score:Math.max(.001,v)};if(m){const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dv.minMatchCharLength,n=[],r=-1,a=-1,o=0;for(let i=e.length;o<i;o+=1){let i=e[o];i&&-1===r?r=o:i||-1===r||(a=o-1,a-r+1>=t&&n.push([r,a]),r=-1)}return e[o-1]&&o-r>=t&&n.push([r,o-1]),n}(g,s);e.length?l&&(k.indices=e):k.isMatch=!1}return k}function zv(e){let t={};for(let n=0,r=e.length;n<r;n+=1){const a=e.charAt(n);t[a]=(t[a]||0)|1<<r-n-1}return t}const Wv=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class Vv{constructor(e){let{location:t=Dv.location,threshold:n=Dv.threshold,distance:r=Dv.distance,includeMatches:a=Dv.includeMatches,findAllMatches:o=Dv.findAllMatches,minMatchCharLength:i=Dv.minMatchCharLength,isCaseSensitive:s=Dv.isCaseSensitive,ignoreDiacritics:l=Dv.ignoreDiacritics,ignoreLocation:c=Dv.ignoreLocation}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.options={location:t,threshold:n,distance:r,includeMatches:a,findAllMatches:o,minMatchCharLength:i,isCaseSensitive:s,ignoreDiacritics:l,ignoreLocation:c},e=s?e:e.toLowerCase(),e=l?Wv(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const u=(e,t)=>{this.chunks.push({pattern:e,alphabet:zv(e),startIndex:t})},d=this.pattern.length;if(d>Bv){let e=0;const t=d%Bv,n=d-t;for(;e<n;)u(this.pattern.substr(e,Bv),e),e+=Bv;if(t){const e=d-Bv;u(this.pattern.substr(e),e)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,ignoreDiacritics:n,includeMatches:r}=this.options;if(e=t?e:e.toLowerCase(),e=n?Wv(e):e,this.pattern===e){let t={isMatch:!0,score:0};return r&&(t.indices=[[0,e.length-1]]),t}const{location:a,distance:o,threshold:i,findAllMatches:s,minMatchCharLength:l,ignoreLocation:c}=this.options;let u=[],d=0,h=!1;this.chunks.forEach(t=>{let{pattern:n,alphabet:p,startIndex:f}=t;const{isMatch:m,score:g,indices:x}=Lv(e,n,p,{location:a+f,distance:o,threshold:i,findAllMatches:s,minMatchCharLength:l,includeMatches:r,ignoreLocation:c});m&&(h=!0),d+=g,m&&x&&(u=[...u,...x])});let p={isMatch:h,score:h?d/this.chunks.length:1};return h&&r&&(p.indices=u),p}}class Uv{constructor(e){this.pattern=e}static isMultiMatch(e){return Hv(e,this.multiRegex)}static isSingleMatch(e){return Hv(e,this.singleRegex)}search(){}}function Hv(e,t){const n=e.match(t);return n?n[1]:null}class Gv extends Uv{constructor(e){let{location:t=Dv.location,threshold:n=Dv.threshold,distance:r=Dv.distance,includeMatches:a=Dv.includeMatches,findAllMatches:o=Dv.findAllMatches,minMatchCharLength:i=Dv.minMatchCharLength,isCaseSensitive:s=Dv.isCaseSensitive,ignoreDiacritics:l=Dv.ignoreDiacritics,ignoreLocation:c=Dv.ignoreLocation}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),this._bitapSearch=new Vv(e,{location:t,threshold:n,distance:r,includeMatches:a,findAllMatches:o,minMatchCharLength:i,isCaseSensitive:s,ignoreDiacritics:l,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Kv extends Uv{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t,n=0;const r=[],a=this.pattern.length;for(;(t=e.indexOf(this.pattern,n))>-1;)n=t+a,r.push([t,n-1]);const o=!!r.length;return{isMatch:o,score:o?0:1,indices:r}}}const Xv=[class extends Uv{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},Kv,class extends Uv{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},class extends Uv{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends Uv{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends Uv{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},class extends Uv{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const t=-1===e.indexOf(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},Gv],Yv=Xv.length,qv=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/;const Zv=new Set([Gv.type,Kv.type]);class Jv{constructor(e){let{isCaseSensitive:t=Dv.isCaseSensitive,ignoreDiacritics:n=Dv.ignoreDiacritics,includeMatches:r=Dv.includeMatches,minMatchCharLength:a=Dv.minMatchCharLength,ignoreLocation:o=Dv.ignoreLocation,findAllMatches:i=Dv.findAllMatches,location:s=Dv.location,threshold:l=Dv.threshold,distance:c=Dv.distance}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:n,includeMatches:r,minMatchCharLength:a,findAllMatches:i,ignoreLocation:o,location:s,threshold:l,distance:c},e=t?e:e.toLowerCase(),e=n?Wv(e):e,this.pattern=e,this.query=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.split("|").map(e=>{let n=e.trim().split(qv).filter(e=>e&&!!e.trim()),r=[];for(let a=0,o=n.length;a<o;a+=1){const e=n[a];let o=!1,i=-1;for(;!o&&++i<Yv;){const n=Xv[i];let a=n.isMultiMatch(e);a&&(r.push(new n(a,t)),o=!0)}if(!o)for(i=-1;++i<Yv;){const n=Xv[i];let a=n.isSingleMatch(e);if(a){r.push(new n(a,t));break}}}return r})}(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:r,ignoreDiacritics:a}=this.options;e=r?e:e.toLowerCase(),e=a?Wv(e):e;let o=0,i=[],s=0;for(let l=0,c=t.length;l<c;l+=1){const r=t[l];i.length=0,o=0;for(let t=0,a=r.length;t<a;t+=1){const a=r[t],{isMatch:l,indices:c,score:u}=a.search(e);if(!l){s=0,o=0,i.length=0;break}if(o+=1,s+=u,n){const e=a.constructor.type;Zv.has(e)?i=[...i,...c]:i.push(c)}}if(o){let e={isMatch:!0,score:s/o};return n&&(e.indices=i),e}}return{isMatch:!1,score:1}}}const Qv=[];function $v(e,t){for(let n=0,r=Qv.length;n<r;n+=1){let r=Qv[n];if(r.condition(e,t))return new r(e,t)}return new Vv(e,t)}const eb="$and",tb="$or",nb="$path",rb="$val",ab=e=>!(!e[eb]&&!e[tb]),ob=e=>({[eb]:Object.keys(e).map(t=>({[t]:e[t]}))});function ib(e,t){let{auto:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e=>{let a=Object.keys(e);const o=(e=>!!e[nb])(e);if(!o&&a.length>1&&!ab(e))return r(ob(e));if((e=>!vv(e)&&jv(e)&&!ab(e))(e)){const r=o?e[nb]:a[0],i=o?e[rb]:e[r];if(!bv(i))throw new Error((e=>"Invalid value for key ".concat(e))(r));const s={keyId:Tv(r),pattern:i};return n&&(s.searcher=$v(i,t)),s}let i={children:[],operator:a[0]};return a.forEach(t=>{const n=e[t];vv(n)&&n.forEach(e=>{i.children.push(r(e))})}),i};return ab(e)||(e=ob(e)),r(e)}function sb(e,t){const n=e.matches;t.matches=[],Cv(n)&&n.forEach(e=>{if(!Cv(e.indices)||!e.indices.length)return;const{indices:n,value:r}=e;let a={indices:n,value:r};e.key&&(a.key=e.key.src),e.idx>-1&&(a.refIndex=e.idx),t.matches.push(a)})}function lb(e,t){t.score=e.score}class cb{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.options=tt(tt({},Dv),t),this.options.useExtendedSearch,this._keyStore=new Ev(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof Rv))throw new Error("Incorrect 'index' type");this._myIndex=t||Fv(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Cv(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>!1;const t=[];for(let n=0,r=this._docs.length;n<r;n+=1){const a=this._docs[n];e(a,n)&&(this.removeAt(n),n-=1,r-=1,t.push(a))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e){let{limit:t=-1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{includeMatches:n,includeScore:r,shouldSort:a,sortFn:o,ignoreFieldNorm:i}=this.options;let s=bv(e)?bv(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return function(e,t){let{ignoreFieldNorm:n=Dv.ignoreFieldNorm}=t;e.forEach(e=>{let t=1;e.matches.forEach(e=>{let{key:r,norm:a,score:o}=e;const i=r?r.weight:null;t*=Math.pow(0===o&&i?Number.EPSILON:o,(i||1)*(n?1:a))}),e.score=t})}(s,{ignoreFieldNorm:i}),a&&s.sort(o),wv(t)&&t>-1&&(s=s.slice(0,t)),function(e,t){let{includeMatches:n=Dv.includeMatches,includeScore:r=Dv.includeScore}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=[];return n&&a.push(sb),r&&a.push(lb),e.map(e=>{const{idx:n}=e,r={item:t[n],refIndex:n};return a.length&&a.forEach(t=>{t(e,r)}),r})}(s,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(e){const t=$v(e,this.options),{records:n}=this._myIndex,r=[];return n.forEach(e=>{let{v:n,i:a,n:o}=e;if(!Cv(n))return;const{isMatch:i,score:s,indices:l}=t.searchIn(n);i&&r.push({item:n,idx:a,matches:[{score:s,value:n,norm:o,indices:l}]})}),r}_searchLogical(e){const t=ib(e,this.options),n=(e,t,r)=>{if(!e.children){const{keyId:n,searcher:a}=e,o=this._findMatches({key:this._keyStore.get(n),value:this._myIndex.getValueForItemAtKeyId(t,n),searcher:a});return o&&o.length?[{idx:r,item:t,matches:o}]:[]}const a=[];for(let o=0,i=e.children.length;o<i;o+=1){const i=e.children[o],s=n(i,t,r);if(s.length)a.push(...s);else if(e.operator===eb)return[]}return a},r=this._myIndex.records,a={},o=[];return r.forEach(e=>{let{$:r,i:i}=e;if(Cv(r)){let e=n(t,r,i);e.length&&(a[i]||(a[i]={idx:i,item:r,matches:[]},o.push(a[i])),e.forEach(e=>{let{matches:t}=e;a[i].matches.push(...t)}))}}),o}_searchObjectList(e){const t=$v(e,this.options),{keys:n,records:r}=this._myIndex,a=[];return r.forEach(e=>{let{$:r,i:o}=e;if(!Cv(r))return;let i=[];n.forEach((e,n)=>{i.push(...this._findMatches({key:e,value:r[n],searcher:t}))}),i.length&&a.push({idx:o,item:r,matches:i})}),a}_findMatches(e){let{key:t,value:n,searcher:r}=e;if(!Cv(n))return[];let a=[];if(vv(n))n.forEach(e=>{let{v:n,i:o,n:i}=e;if(!Cv(n))return;const{isMatch:s,score:l,indices:c}=r.searchIn(n);s&&a.push({score:l,key:t,value:n,idx:o,norm:i,indices:c})});else{const{v:e,n:o}=n,{isMatch:i,score:s,indices:l}=r.searchIn(e);i&&a.push({score:s,key:t,value:e,norm:o,indices:l})}return a}}cb.version="7.1.0",cb.createIndex=Fv,cb.parseIndex=function(e){let{getFn:t=Dv.getFn,fieldNormWeight:n=Dv.fieldNormWeight}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{keys:r,records:a}=e,o=new Rv({getFn:t,fieldNormWeight:n});return o.setKeys(r),o.setIndexRecords(a),o},cb.config=Dv,cb.parseQuery=ib,function(){Qv.push(...arguments)}(Jv);const ub=e=>{let{value:t,onChange:n,placeholder:r="Ketik nama produk...",className:o="",disabled:i=!1}=e;const[s,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0),[d,h]=(0,a.useState)(-1),[p,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{u(!0);try{const e=localStorage.getItem("access_token"),t=await fetch("/api/products/all",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("Failed to fetch products");const n=await t.json();l(n);const r=new cb(n,{keys:["name"],threshold:.3,distance:100,minMatchCharLength:1});f(r)}catch(e){console.error("Failed to fetch products:",e)}finally{u(!1)}})()},[]);const m=(0,a.useMemo)(()=>{if(!t||!p)return s.slice(0,10);return p.search(t).map(e=>e.item).slice(0,10)},[t,p,s]);return c?(0,Ue.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,Ue.jsxs)("svg",{className:"animate-spin h-5 w-5 mx-auto text-amber-500",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,Ue.jsx)("div",{className:"mt-2 text-sm",children:"Loading produk..."})]}):0===m.length?(0,Ue.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,Ue.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 opacity-30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,Ue.jsx)("div",{className:"text-sm",children:t?"Produk tidak ditemukan":"Belum ada produk"}),t&&(0,Ue.jsxs)("button",{onClick:()=>n(t),className:"mt-2 text-xs text-amber-600 hover:text-amber-700",children:['Tambah "',t,'" sebagai produk baru']})]}):(0,Ue.jsxs)("div",{className:"p-2 max-h-80 overflow-y-auto",children:[(0,Ue.jsx)("div",{className:"text-xs text-gray-500 mb-2 px-2",children:t?"\ud83d\udd0d ".concat(m.length," hasil:"):"\ud83d\udd25 Produk Sering Dibeli:"}),(0,Ue.jsx)("div",{className:"space-y-0.5",children:m.map((e,t)=>{return(0,Ue.jsxs)("button",{onClick:()=>(e=>{n(e.name,e)})(e),className:"w-full px-3 py-2 text-left hover:bg-amber-50 flex items-center justify-between rounded transition-colors ".concat(t===d?"bg-amber-50":""),children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:e.unit})]})]}),e.last_price&&(0,Ue.jsx)("span",{className:"text-xs text-gray-500",children:(r=e.last_price,r?r>=1e6?"".concat((r/1e6).toFixed(1),"jt"):r>=1e3?"".concat(Math.round(r/1e3),"rb"):r.toString():"")})]},"".concat(e.name,"-").concat(e.unit,"-").concat(t));var r})})]})},db=e=>{let{value:t,onChange:n,placeholder:r="Ketik nama supplier...",className:o="",disabled:i=!1}=e;const[s,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0),[d,h]=(0,a.useState)(-1),[p,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{u(!0);try{const e=localStorage.getItem("access_token"),t=await fetch("/api/suppliers/all",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("Failed to fetch suppliers");const n=await t.json();l(n);const r=new cb(n,{keys:["name"],threshold:.3,distance:100,minMatchCharLength:1});f(r)}catch(e){console.error("Failed to fetch suppliers:",e)}finally{u(!1)}})()},[]);const m=(0,a.useMemo)(()=>{if(!t||!p)return s.slice(0,10);return p.search(t).map(e=>e.item).slice(0,10)},[t,p,s]);return c?(0,Ue.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,Ue.jsxs)("svg",{className:"animate-spin h-5 w-5 mx-auto text-amber-500",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,Ue.jsx)("div",{className:"mt-2 text-sm",children:"Loading supplier..."})]}):0===m.length?(0,Ue.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,Ue.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 opacity-30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),(0,Ue.jsx)("div",{className:"text-sm",children:t?"Supplier tidak ditemukan":"Belum ada supplier"}),t&&(0,Ue.jsxs)("button",{onClick:()=>n(t),className:"mt-2 text-xs text-amber-600 hover:text-amber-700",children:['Tambah "',t,'" sebagai supplier baru']})]}):(0,Ue.jsxs)("div",{className:"p-2 max-h-80 overflow-y-auto",children:[(0,Ue.jsx)("div",{className:"text-xs text-gray-500 mb-2 px-2",children:t?"\ud83c\udfe2 ".concat(m.length," hasil:"):"\ud83d\udd25 Supplier Sering Dipakai:"}),(0,Ue.jsx)("div",{className:"space-y-0.5",children:m.map((e,t)=>(0,Ue.jsx)("button",{onClick:()=>(e=>{n(e.name)})(e),className:"w-full px-3 py-2 text-left hover:bg-amber-50 flex items-center justify-between rounded transition-colors ".concat(t===d?"bg-amber-50":""),children:(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium text-sm",children:e.name}),e.contact&&(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:e.contact})]})]})},"".concat(e.name,"-").concat(t)))})]})},hb=()=>{const[e,t]=(0,a.useState)(0);return(0,a.useEffect)(()=>{const e=setInterval(()=>{t(e=>(e+1)%4)},400);return()=>clearInterval(e)},[]),(0,Ue.jsxs)("span",{children:["Scanning",".".repeat(e)]})},pb=e=>{let{isOpen:t,productId:n,productName:r,onClose:o,onSuccess:i}=e;const[s,l]=(0,a.useState)("choose"),[c,u]=(0,a.useState)(""),[d,h]=(0,a.useState)(!1),[p,f]=(0,a.useState)(""),[m,g]=(0,a.useState)(!1),[x,y]=(0,a.useState)(""),[v,b]=(0,a.useState)(null),[w,k]=(0,a.useState)(""),[j,C]=(0,a.useState)(!1),N=(0,a.useRef)(!0),_=(0,a.useRef)(!1),S=(0,a.useRef)(null),E=(0,a.useRef)(null);(0,a.useEffect)(()=>{t?(l("choose"),u(""),f(""),y(""),g(!1),b(null),k(""),C(!1),N.current=!0,_.current=!1):(A(),N.current=!1)},[t]),(0,a.useEffect)(()=>()=>{N.current=!1,A()},[]);const A=()=>{S.current&&(S.current.stop(),S.current=null),console.log("[BarcodeModal] Scanner cleanup")},I=e=>e?/^\d+$/.test(e)?13!==e.length?{valid:!1,message:"Barcode harus 13 digit (EAN-13). Terdeteksi ".concat(e.length," digit.")}:{valid:!0,message:""}:{valid:!1,message:"Barcode harus berupa angka saja"}:{valid:!1,message:"Barcode kosong"},T=(0,a.useCallback)(async e=>{const t=I(e);if(t.valid){h(!0),f("");try{const t=localStorage.getItem("access_token"),r=await fetch("/api/products/".concat(n,"/barcode"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({barcode:e})});if(!r.ok){const e=await r.json();throw new Error(e.detail||"Gagal menyimpan barcode")}i(e)}catch(r){console.error("[BarcodeModal] Submit error:",r),f(r.message||"Gagal menyimpan barcode")}finally{h(!1)}}else f(t.message)},[n,i]),P=(0,a.useCallback)(e=>{if(!N.current||_.current)return;const t=e.text;console.log("[BarcodeModal] Barcode detected:",t,"format:",e.format),_.current=!0,A(),g(!1),navigator.vibrate&&navigator.vibrate(200);const n=I(t);b(t),n.valid?T(t):k(n.message)},[T]),D=(0,a.useCallback)(async()=>{y(""),b(null),k(""),C(!0),_.current=!1,console.log("[BarcodeModal] Initializing scanner...");try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return y("Browser tidak mendukung akses kamera."),void C(!1);if(await new Promise(e=>setTimeout(e,100)),!N.current||!E.current)return;const e=new cy(E.current,{desiredWidth:1280,desiredHeight:720,decodeFPS:12,roiResizeLongSide:800,consensusFrames:2});e.onFound(P),e.onProgress(e=>{console.log("[BarcodeModal] Progress:",e.phase),"camera-ready"===e.phase&&(g(!0),C(!1))}),e.onError(e=>{console.error("[BarcodeModal] Scanner error:",e),e.message.includes("Permission")||"NotAllowedError"===e.name?y("Akses kamera ditolak. Izinkan akses kamera di pengaturan browser."):"NotFoundError"===e.name?y("Kamera tidak ditemukan."):y("Gagal mengakses kamera: ".concat(e.message)),C(!1)}),S.current=e,await e.start()}catch(e){console.error("[BarcodeModal] Scanner init error:",e),y("Gagal memulai scanner."),C(!1)}},[P]),M=async e=>{l(e),f(""),k(""),b(null),"scan"===e&&await D()},R=()=>{A(),g(!1),y(""),l("choose"),u(""),f(""),b(null),k("")},F=async()=>{b(null),k(""),_.current=!1,await D()},O=()=>{l("manual"),b(null),k(""),v&&u(v)};(0,a.useEffect)(()=>{"manual"===s&&13===c.length&&T(c.trim())},[c,s,T]);return t?"scan"===s?(0,Ue.jsxs)("div",{className:"fixed inset-0 z-[200] bg-gray-900 flex flex-col",children:[(0,Ue.jsxs)("div",{className:"bg-white border-b border-gray-200 p-4 flex items-center gap-3",children:[(0,Ue.jsx)("button",{onClick:R,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors active:bg-gray-200",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h1",{className:"font-semibold text-lg",children:"Daftarkan Barcode"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500 truncate",children:r})]}),(0,Ue.jsx)("button",{onClick:o,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsxs)("div",{className:"flex-1 relative bg-black",children:[(0,Ue.jsx)("video",{ref:E,className:"absolute inset-0 w-full h-full object-cover",playsInline:!0,muted:!0,autoPlay:!0}),x&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white p-6 z-10 bg-black",children:(0,Ue.jsxs)("div",{className:"text-center max-w-md",children:[(0,Ue.jsx)("svg",{className:"w-12 h-12 mx-auto mb-3 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,Ue.jsx)("p",{className:"mb-4",children:x}),(0,Ue.jsxs)("button",{onClick:D,className:"px-6 py-3 bg-amber-500 text-white rounded-lg hover:bg-amber-600 active:bg-amber-700 transition-colors flex items-center gap-2 mx-auto",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Coba Lagi"]})]})}),j&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white z-10 bg-black",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",className:"mx-auto mb-3 animate-pulse",style:{width:"48px",height:"48px"}}),(0,Ue.jsx)("p",{children:"Memulai scanner..."})]})}),m&&!v&&(0,Ue.jsx)("div",{className:"absolute inset-0 pointer-events-none z-10",children:(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"relative transition-all duration-200",style:{width:"85vw",height:"60vh",maxWidth:"500px",maxHeight:"400px",boxShadow:"0 0 20px ".concat("rgba(255, 255, 255, 0.3)")},children:[(0,Ue.jsx)("div",{className:"absolute top-0 left-0 w-10 h-10 border-t-4 border-l-4 ".concat("border-white/70"," transition-colors")}),(0,Ue.jsx)("div",{className:"absolute top-0 right-0 w-10 h-10 border-t-4 border-r-4 ".concat("border-white/70"," transition-colors")}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-0 w-10 h-10 border-b-4 border-l-4 ".concat("border-white/70"," transition-colors")}),(0,Ue.jsx)("div",{className:"absolute bottom-0 right-0 w-10 h-10 border-b-4 border-r-4 ".concat("border-white/70"," transition-colors")}),(0,Ue.jsx)("div",{className:"absolute left-2 right-2 h-0.5 bg-white/80",style:{boxShadow:"0 0 10px rgba(255, 255, 255, 0.6)",animation:"scanLine 1.5s ease-in-out infinite"}})]})})}),v&&w&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-30 bg-black/80",children:(0,Ue.jsx)("div",{className:"bg-white rounded-xl p-6 mx-4 max-w-sm w-full shadow-2xl",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("svg",{className:"w-10 h-10 mx-auto mb-3 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Barcode Tidak Valid"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:w}),(0,Ue.jsx)("p",{className:"text-xs text-gray-400 mb-4 font-mono",children:v}),(0,Ue.jsxs)("div",{className:"flex gap-2",children:[(0,Ue.jsx)("button",{onClick:F,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Scan Ulang"}),(0,Ue.jsx)("button",{onClick:O,className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg text-sm font-medium hover:bg-gray-700",children:"Input Manual"})]})]})})}),d&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-30 bg-black/80",children:(0,Ue.jsx)("div",{className:"bg-white rounded-xl p-6 mx-4 max-w-sm w-full shadow-2xl",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsxs)("svg",{className:"animate-spin w-8 h-8 mx-auto mb-3 text-gray-600",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Menyimpan barcode..."})]})})}),(0,Ue.jsx)("style",{children:"\n            @keyframes scanLine {\n              0% { top: 10%; }\n              50% { top: 90%; }\n              100% { top: 10%; }\n            }\n          "}),m&&!v&&(0,Ue.jsx)("div",{className:"absolute bottom-32 left-0 right-0 text-center text-white z-20",children:(0,Ue.jsx)("div",{className:"inline-block px-6 py-3 rounded-full backdrop-blur-sm bg-black/60",children:(0,Ue.jsx)("p",{className:"text-sm font-medium",children:(0,Ue.jsx)(hb,{})})})})]})]}):(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:e=>{e.target===e.currentTarget&&"scan"!==s&&o()},children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl w-full max-w-md shadow-2xl overflow-hidden",children:[(0,Ue.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"choose"===s?"Daftarkan Barcode":"Input Barcode Manual"}),(0,Ue.jsx)("button",{onClick:o,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500 mt-1 truncate",children:r})]}),(0,Ue.jsx)("div",{className:"p-4",children:"choose"===s?(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("button",{onClick:()=>M("scan"),className:"w-full p-4 border-2 border-gray-200 rounded-xl hover:border-amber-500 hover:bg-amber-50 transition-colors flex items-center gap-4",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",style:{width:"24px",height:"24px"}})}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:"Scan Barcode"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Gunakan kamera untuk scan"})]})]}),(0,Ue.jsxs)("button",{onClick:()=>M("manual"),className:"w-full p-4 border-2 border-gray-200 rounded-xl hover:border-gray-400 hover:bg-gray-50 transition-colors flex items-center gap-4",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:"Input Manual"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Ketik barcode 13 digit"})]})]})]}):(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsx)("input",{type:"text",value:c,onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,13);u(t),f("")},placeholder:"13 digit code",className:"w-full px-4 py-4 text-xl text-center font-mono border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 tracking-widest placeholder:text-gray-400 placeholder:text-base placeholder:font-sans",inputMode:"numeric",pattern:"[0-9]*",maxLength:13,autoFocus:!0}),p&&(0,Ue.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,Ue.jsx)("p",{className:"text-sm text-red-600",children:p})}),d&&(0,Ue.jsx)("div",{className:"text-center py-2",children:(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Menyimpan..."})}),(0,Ue.jsx)("button",{type:"button",onClick:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:"Kembali"})]})})]})}):null};class fb{constructor(){this.denominations=[1e5,5e4,2e4,1e4,5e3,2e3,1e3,500,100]}calculate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;const n=new Set;n.add(100*Math.ceil(e/100)),n.add(500*Math.ceil(e/500)),n.add(1e3*Math.ceil(e/1e3));const r=5e3*Math.ceil(e/5e3);n.add(r),r===Math.round(e)&&e%1e4!==0&&n.add(r+5e3);const a=1e4*Math.ceil(e/1e4);if(n.add(a),a===Math.round(e)&&n.add(a+1e4),e%1e4===0&&e>0)n.add(e+1e3);else{const t=5e3*Math.floor(e/5e3),r=5e3*Math.ceil(e/5e3);for(let a=1;a<=3;a++){const o=t+2e3*a;if(o>e&&o<r&&o-e<2e3){n.add(o);break}}}e>5e4&&e<=7e4&&n.add(7e4),e>7e4&&e<=8e4&&n.add(8e4),e>7e4&&e<=9e4&&n.add(9e4),e<=2e4&&n.add(2e4),e<=5e4&&n.add(5e4),n.add(1e5),e>1e5&&e<=15e4&&n.add(15e4),e>15e4&&e<=17e4&&n.add(17e4),e>1e5&&e<=2e5&&n.add(2e5),e>2e5&&e<=25e4&&n.add(25e4),e>2e5&&e<=3e5&&n.add(3e5),e>3e5&&e<=4e5&&n.add(4e5),e>4e5&&e<=5e5&&n.add(5e5);const o=1e5*Math.ceil(e/1e5);return Array.from(n).filter(t=>t>=e&&t<=o).sort((e,t)=>e-t).slice(0,t).map(t=>{const n=this.greedyBills(t);return{total:t,change:t-e,count:n.length,bills:n,label:this.getLabel(t,e),formatted:this.formatBills(n)}})}greedyBills(e){const t=[];let n=e;for(const r of this.denominations)for(;n>=r;)t.push(r),n-=r;return t}getLabel(e,t){return e===100*Math.ceil(t/100)&&e-t<100?"UANG PAS":5e4===e||1e5===e||2e5===e?"PECAHAN":e%1e4===0?"BULAT":"KEMBALIAN KECIL"}formatBills(e){if(0===e.length)return"";const t=new Map;for(const n of e)t.set(n,(t.get(n)||0)+1);return Array.from(t.entries()).sort((e,t)=>t[0]-e[0]).map(e=>{let[t,n]=e;const r=this.formatDenom(t);return n>1?"".concat(n,"\xd7").concat(r):r}).join(" + ")}formatDenom(e){return e>=1e3?"".concat(e/1e3,"k"):"".concat(e)}formatCurrency(e){return"Rp ".concat(e.toLocaleString("id-ID"))}}const mb={duration:.3,ease:[.4,0,.2,1]},gb="#F97316",xb="#0EA5E9",yb="#262626",vb="#737373",bb="#D4D4D4",wb="#E5E5E5",kb="#F5F5F5",jb="#FFFFFF",Cb="#262626",Nb="#22C55E",_b=e=>{let{tenantId:t,onClose:n,isEmbedded:r=!1,onTransactionComplete:o,initialItems:i,initialPaymentMethod:s,onPrefillProcessed:l}=e;const[c,u]=(0,a.useState)("pos"),[d,h]=(0,a.useState)("left"),[p,f]=(0,a.useState)(!1),[m,g]=(0,a.useState)([]),[x,y]=(0,a.useState)(0),[v,b]=(0,a.useState)(!0),[w,k]=(0,a.useState)(!1),[j,C]=(0,a.useState)(""),N=(0,a.useRef)(null),_=(0,a.useRef)(null),[S,E]=(0,a.useState)(""),[A,I]=(0,a.useState)(!1),[T,P]=(0,a.useState)([]),[D,M]=(0,a.useState)(!1),R=(0,a.useRef)(null),F=(0,a.useRef)(null),[O,B]=(0,a.useState)("tunai"),[L,z]=(0,a.useState)(""),[W,V]=(0,a.useState)(null),[U,H]=(0,a.useState)([]),[G,K]=(0,a.useState)(!1),[X,Y]=(0,a.useState)(!1),q=(0,a.useRef)(null),[Z,J]=(0,a.useState)(0),[Q,$]=(0,a.useState)([]),[ee,te]=(0,a.useState)(null),ne=(0,a.useRef)(null),[re,ae]=(0,a.useState)(!1),[oe,ie]=(0,a.useState)(""),[se,le]=(0,a.useState)(!1),[ce,ue]=(0,a.useState)(null),[de,he]=(0,a.useState)(!1),[pe,fe]=(0,a.useState)(!1),[me,ge]=(0,a.useState)(!1),[xe,ye]=(0,a.useState)(""),[ve,be]=(0,a.useState)(""),[we,ke]=(0,a.useState)(""),[je,Ce]=(0,a.useState)(!1),[Ne,_e]=(0,a.useState)(0),[Se,Ae]=(0,a.useState)(0),[Ie,Te]=(0,a.useState)(!1),Pe="pos_draft_".concat(t),De=(0,a.useRef)({barcode:"",time:0}),Me=(0,a.useRef)(()=>{}),Re=(0,a.useRef)(null),Fe=(0,a.useMemo)(()=>new fb,[]),Oe=m.reduce((e,t)=>e+t.price*t.qty,0),Be=Math.round(Oe*(x/100)),Le=Oe-Be,ze=Z-Le;(0,a.useEffect)(()=>{if(!i||0===i.length)return;(async()=>{console.log("[SalesTransaction] Processing initial items from chat:",i);for(const t of i)try{const e=localStorage.getItem("access_token"),n=await fetch("/api/products/search/pos?q=".concat(encodeURIComponent(t.productQuery),"&limit=1"),{headers:{Authorization:"Bearer ".concat(e)}}),r=await n.json();if(r.products&&r.products.length>0){const e=r.products[0];console.log("[SalesTransaction] Found product for query:",t.productQuery,"->",e.name),g(n=>{const r=n.findIndex(t=>t.id===e.id||t.name.toLowerCase()===e.name.toLowerCase());if(r>=0){console.log("[SalesTransaction] Product exists in cart, adding qty:",t.qty);const e=[...n];return e[r]=tt(tt({},e[r]),{},{qty:e[r].qty+t.qty}),e}return console.log("[SalesTransaction] Adding new product to cart:",e.name,"x",t.qty),[...n,{id:e.id,productId:e.id,name:e.name,price:e.harga_jual,qty:t.qty,barcode:e.barcode||""}]}),rv.itemAdded()}else console.warn("[SalesTransaction] Product not found for query:",t.productQuery)}catch(e){console.error("[SalesTransaction] Error searching product:",t.productQuery,e)}null===l||void 0===l||l()})()},[i,l]),(0,a.useEffect)(()=>{s&&(console.log("[SalesTransaction] Setting initial payment method:",s),B(s))},[s]),(0,a.useEffect)(()=>{let e=!0,t=null;if(v&&"pos"===c){k(!0),C("");const n=async()=>{if(N.current){if(e)try{_.current=new cy(N.current,{desiredWidth:1280,desiredHeight:720,decodeFPS:20,roiResizeLongSide:600,consensusFrames:1}),_.current.onFound(e=>{const t=Date.now(),n=e.text;n===De.current.barcode&&t-De.current.time<1500||(De.current={barcode:n,time:t},Me.current(n))}),_.current.onProgress(t=>{"camera-ready"===t.phase&&e&&k(!1)}),_.current.onError(t=>{e&&(C(t.message||"Gagal mengakses kamera"),k(!1))}),await _.current.start()}catch(t){e&&(C(t.message||"Gagal memulai scanner"),k(!1))}}else console.log("[Scanner] Waiting for video element...")};t=setTimeout(()=>{n()},350)}return()=>{e=!1,t&&clearTimeout(t),_.current&&(_.current.stop(),_.current=null)}},[v,c]);const We=(0,a.useCallback)(async e=>{ie("");const n=m.findIndex(t=>t.barcode===e);if(-1!==n)return g(e=>e.map((e,t)=>t===n?tt(tt({},e),{},{qty:e.qty+1}):e)),void rv.scanSuccess();try{const n=localStorage.getItem("access_token"),r=await fetch("/api/products/barcode/".concat(e,"?tenant_id=").concat(t),{headers:{Authorization:"Bearer ".concat(n)}});if(!r.ok)return rv.scanError(),void le(!0);const a=await r.json(),o={id:"cart_".concat(Date.now()),productId:a.id,name:a.nama_produk||a.name,barcode:e,price:a.harga_jual||a.price||0,qty:1};g(e=>[...e,o]),rv.scanSuccess()}catch(Z_){rv.scanError(),le(!0)}},[t,m]);(0,a.useEffect)(()=>{Me.current=We},[We]),(0,a.useEffect)(()=>{m.length>5&&Re.current&&(Re.current.scrollTop=Re.current.scrollHeight)},[m.length]),(0,a.useEffect)(()=>{try{const e=localStorage.getItem(Pe);if(e){const t=JSON.parse(e);t.cart&&t.cart.length>0&&Te(!0)}}catch(Z_){console.error("Failed to load POS draft:",Z_)}},[Pe]),(0,a.useEffect)(()=>{if(m.length>0)try{const e={cart:m,discount:x,savedAt:(new Date).toISOString()};localStorage.setItem(Pe,JSON.stringify(e))}catch(Z_){console.error("Failed to save POS draft:",Z_)}},[m,x,Pe]);const Ve=()=>{try{localStorage.removeItem(Pe)}catch(Z_){console.error("Failed to clear POS draft:",Z_)}};(0,a.useEffect)(()=>{F.current&&clearTimeout(F.current);const e=S.replace(/\D/g,"");if(13===e.length)return We(e),E(""),void I(!1);if(S&&A){M(!0);const e=S.length>=3?0:80;0===e?He(S):F.current=setTimeout(()=>{He(S)},e)}else P([]),M(!1);return()=>{F.current&&clearTimeout(F.current)}},[S,A]);const He=(0,a.useCallback)(async e=>{if(e.length<1)P([]);else{M(!0);try{const t=localStorage.getItem("access_token"),n=await fetch("/api/products/search/pos?q=".concat(encodeURIComponent(e),"&limit=10"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=((await n.json()).products||[]).map(e=>({id:e.id,name:e.name,barcode:e.barcode||"",price:e.harga_jual||0,stock:e.stok||0}));P(e)}else console.error("Product search failed:",n.status),P([])}catch(Z_){console.error("Product search failed:",Z_),P([])}finally{M(!1)}}},[]);(0,a.useEffect)(()=>(q.current&&clearTimeout(q.current),L&&G?q.current=setTimeout(()=>{Ge(L)},200):H([]),()=>{q.current&&clearTimeout(q.current)}),[L,G]);const Ge=(0,a.useCallback)(async e=>{if(e.length<1)H([]);else{Y(!0);try{const t=Ee(),n=await fetch("/api/members/search?q=".concat(encodeURIComponent(e),"&limit=10"),{headers:{Authorization:"Bearer ".concat(t)}});if(n.ok){const e=await n.json();H(e.members||[])}else console.error("Member search failed:",n.status),H([])}catch(Z_){console.error("Member search error:",Z_),H([])}finally{Y(!1)}}},[]),Ke=e=>{g(t=>t.map(t=>t.id===e?tt(tt({},t),{},{qty:t.qty+1}):t))},Xe=e=>{g(t=>{const n=t.find(t=>t.id===e);return n&&n.qty<=1?t.filter(t=>t.id!==e):t.map(t=>t.id===e?tt(tt({},t),{},{qty:t.qty-1}):t)})},Ye=()=>y(e=>Math.min(100,e+1)),qe=()=>{ye(x.toString()),he(!0)},Ze=()=>{be(Z>0?Z.toString():Le.toString()),fe(!0)},Je=async e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){const e=new FileReader;e.onload=async e=>{var t;const n=null===(t=e.target)||void 0===t?void 0:t.result,r=await function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return new Promise(n=>{const r=new Image;r.onload=()=>{const e=document.createElement("canvas");let a=r.width,o=r.height;const i=1024;(a>i||o>i)&&(a>o?(o=o/a*i,a=i):(a=a/o*i,o=i)),e.width=a,e.height=o,e.getContext("2d").drawImage(r,0,0,a,o);let s=.8,l=e.toDataURL("image/jpeg",s);for(;l.length>1024*t&&s>.3;)s-=.1,l=e.toDataURL("image/jpeg",s);n(l)},r.src=e})}(n);te(r)},e.readAsDataURL(n)}e.target.value=""},Qe=()=>{0!==m.length&&(J(Le),$([Le]),_e(Le),Ae(0),h("left"),u("checkout"))},$e=()=>{h("right"),u("pos")},et=async()=>{if(!re&&0!==m.length){if("tunai"===O&&Z<Le)return ie("Pembayaran kurang"),void setTimeout(()=>ie(""),3e3);if("qris"===O&&!ee)return ie("Bukti transfer diperlukan"),void setTimeout(()=>ie(""),3e3);ae(!0);try{const e=localStorage.getItem("access_token"),t={tunai:"CASH",qris:"QRIS",hutang:"CASH"},n={items:m.map(e=>({productId:e.productId,name:e.name,barcode:e.barcode,qty:e.qty,price:e.price})),totalAmount:Le,paymentAmount:"tunai"===O?Z:"hutang"===O?Se:Le,kembalian:"tunai"===O?Math.max(0,ze):0,paymentMethod:t[O]||"CASH",proofImage:ee||void 0,discount:x,hutang:"hutang"===O?Ne:0},r=await fetch("/api/transactions/sales",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(n)}),a=await r.json();if(r.ok&&"success"===a.status){if(rv.transactionComplete(),ue(a),f(!0),Ve(),W){const e=await(async(e,t)=>{try{const n=Ee(),r=await fetch("/api/members/add-points",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({member_id:e,transaction_amount:t})});if(r.ok){const t=await r.json();return console.log("Points added:",t),W&&W.id===e&&V(tt(tt({},W),{},{points:t.new_total_points})),t}}catch(Z_){console.error("Failed to add points:",Z_)}return null})(W.id,Le);e&&console.log("[POS] Added ".concat(e.points_added," points to ").concat(W.nama))}o&&a.message&&o(a.message)}else{let e="Transaksi gagal";a.message&&"string"===typeof a.message?e=a.message:a.detail&&("string"===typeof a.detail?e=a.detail:Array.isArray(a.detail)&&a.detail.length>0&&(e=a.detail.map(e=>e.msg||"Validation error").join(", "))),ie(e),setTimeout(()=>ie(""),3e3)}}catch(Z_){ie("Transaksi gagal"),setTimeout(()=>ie(""),3e3)}finally{ae(!1)}}},nt=()=>{g([]),y(0),J(0),$([]),te(null),B("tunai"),_e(0),Ae(0),f(!1),V(null),z(""),ue(null),h("right"),u("pos"),Ve()},rt=e=>"Rp ".concat(e.toLocaleString("id-ID"));return(0,Ue.jsxs)("div",{className:"flex flex-col overflow-hidden ".concat(r?"h-full w-full":"fixed inset-0 z-50"),style:{backgroundColor:wb,fontFamily:"'Hiragino Kaku Gothic ProN', -apple-system, sans-serif"},children:[(0,Ue.jsx)(mt,{mode:"wait",custom:d,children:(0,Ue.jsx)(yc.div,{custom:d,variants:{enter:e=>({x:"left"===e?"100%":"-100%"}),center:{x:0},exit:e=>({x:"left"===e?"-100%":"100%"})},initial:"enter",animate:"center",exit:"exit",transition:mb,className:"flex-1 flex flex-col overflow-hidden",children:"pos"===c?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 flex-shrink-0",style:{height:"48px",paddingTop:"max(4px, env(safe-area-inset-top))"},children:[(0,Ue.jsx)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:bb},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain"})}),(0,Ue.jsx)("span",{className:"font-semibold text-lg",style:{color:"#525252"},children:"Point of Sales"})]}),(0,Ue.jsx)("div",{className:"mx-4 mb-4 flex-shrink-0",children:(0,Ue.jsxs)("div",{className:"bg-white",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)",borderRadius:"12px"},children:[(0,Ue.jsx)("div",{className:"relative overflow-hidden",style:{background:wb,aspectRatio:"16/9",borderRadius:"12px 12px 0 0"},children:v?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("video",{ref:N,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),w&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:wb},children:(0,Ue.jsxs)("div",{className:"text-center",style:{color:"#525252"},children:[(0,Ue.jsxs)("svg",{className:"w-8 h-8 mx-auto mb-2 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),(0,Ue.jsx)("span",{className:"text-sm",children:"Memulai kamera..."})]})}),j&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:wb},children:(0,Ue.jsx)("p",{className:"text-sm px-4 text-center",style:{color:"#525252"},children:j})}),!w&&!j&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"absolute top-3 left-3 w-10 h-10",style:{border:"3px solid ".concat(gb),borderRight:0,borderBottom:0,borderRadius:"4px 0 0 0"}}),(0,Ue.jsx)("div",{className:"absolute top-3 right-3 w-10 h-10",style:{border:"3px solid ".concat(gb),borderLeft:0,borderBottom:0,borderRadius:"0 4px 0 0"}}),(0,Ue.jsx)("div",{className:"absolute bottom-3 left-3 w-10 h-10",style:{border:"3px solid ".concat(gb),borderRight:0,borderTop:0,borderRadius:"0 0 0 4px"}}),(0,Ue.jsx)("div",{className:"absolute bottom-3 right-3 w-10 h-10",style:{border:"3px solid ".concat(gb),borderLeft:0,borderTop:0,borderRadius:"0 0 4px 0"}})]})]}):(0,Ue.jsx)("button",{onClick:()=>b(!0),className:"w-full h-full flex items-center justify-center",style:{color:"#525252"},children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",className:"mx-auto mb-2",style:{width:"40px",height:"40px"}}),(0,Ue.jsx)("span",{className:"text-sm",children:"Tap untuk scan"})]})})}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{ref:R,type:"text",inputMode:S.length>0&&/^\d/.test(S)?"numeric":"text",value:S,onChange:e=>{return t=e.target.value,E(t),void I(t.length>0);var t},onFocus:()=>S&&I(!0),onBlur:()=>setTimeout(()=>I(!1),200),placeholder:"Input barcode atau ketik nama produk",className:"w-full px-4 border-none focus:outline-none",style:{height:"48px",fontSize:"14px",color:"#A3A3A3",borderRadius:"0 0 12px 12px"}}),A&&S&&(0,Ue.jsx)("div",{className:"absolute top-full left-0 right-0 bg-white z-50 overflow-y-auto",style:{border:"1px solid ".concat(wb),borderRadius:"0 0 12px 12px",maxHeight:"240px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:D?(0,Ue.jsx)("div",{className:"px-4 py-3 text-sm",style:{color:vb},children:"Mencari..."}):T.length>0?T.map(e=>(0,Ue.jsxs)("div",{onClick:()=>(e=>{const t=m.findIndex(t=>t.productId===e.id);if(-1!==t)g(e=>e.map((e,n)=>n===t?tt(tt({},e),{},{qty:e.qty+1}):e));else{const t={id:"cart_".concat(Date.now()),productId:e.id,name:e.name,barcode:e.barcode,price:e.price,qty:1};g(e=>[...e,t])}rv.itemAdded(),E(""),I(!1),P([])})(e),className:"px-4 py-3 cursor-pointer transition-colors hover:bg-gray-50",style:{borderBottom:"1px solid ".concat(kb)},children:[(0,Ue.jsx)("div",{className:"text-sm font-medium",style:{color:Cb},children:e.name}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:vb},children:rt(e.price)})]},e.id)):(0,Ue.jsxs)("div",{className:"px-4 py-3 text-sm",style:{color:vb},children:['Tidak ditemukan "',S,'"']})})]})]})}),(0,Ue.jsx)("div",{className:"mx-4 mb-2 flex-1 min-h-0",children:(0,Ue.jsxs)("div",{className:"bg-white overflow-hidden h-full flex flex-col",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)",borderRadius:"12px"},children:[(0,Ue.jsxs)("div",{className:"grid gap-2 px-4",style:{gridTemplateColumns:"1fr 100px 80px",height:"32px",alignItems:"center",background:"#FAFAFA",borderBottom:"1px solid ".concat(wb),fontSize:"11px",fontWeight:600,color:vb,fontFamily:"'Hiragino Kaku Gothic ProN', -apple-system, sans-serif"},children:[(0,Ue.jsx)("div",{children:"Description"}),(0,Ue.jsx)("div",{className:"text-center",children:"Qty"}),(0,Ue.jsx)("div",{className:"text-right",children:"Amount"})]}),(0,Ue.jsx)("div",{ref:Re,className:"flex-1 min-h-0 flex flex-col",style:{overflowY:m.length>5?"auto":"hidden"},children:m.length<=5?(0,Ue.jsxs)(Ue.Fragment,{children:[m.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex-1 grid gap-2 px-4 items-center",style:{gridTemplateColumns:"1fr 100px 80px",background:t%2===0?jb:kb,borderBottom:"1px solid ".concat(kb)},children:[(0,Ue.jsx)("div",{className:"truncate text-left",style:{fontSize:"13px",fontWeight:500,color:Cb},children:e.name}),(0,Ue.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,Ue.jsx)("button",{onClick:()=>Xe(e.id),className:"flex-shrink-0 rounded-full flex items-center justify-center font-semibold text-sm",style:{width:"28px",height:"28px",minWidth:"28px",minHeight:"28px",background:wb,color:"#525252"},children:"\u2212"}),(0,Ue.jsx)("span",{className:"w-8 text-center font-semibold text-sm",style:{color:Cb},children:e.qty}),(0,Ue.jsx)("button",{onClick:()=>Ke(e.id),className:"flex-shrink-0 rounded-full flex items-center justify-center font-semibold text-sm text-white",style:{width:"28px",height:"28px",minWidth:"28px",minHeight:"28px",background:gb},children:"+"})]}),(0,Ue.jsx)("div",{className:"text-right font-semibold text-sm",style:{color:Cb},children:(e.price*e.qty).toLocaleString("id-ID")})]},e.id)),Array.from({length:5-m.length}).map((e,t)=>{const n=m.length+t;return(0,Ue.jsxs)("div",{className:"flex-1 grid gap-2 px-4 items-center",style:{gridTemplateColumns:"1fr 100px 80px",background:n%2===0?jb:kb,borderBottom:t<4-m.length?"1px solid ".concat(kb):"none"},children:[(0,Ue.jsx)("div",{className:"truncate text-left",style:{fontSize:"13px",fontWeight:500,color:wb},children:"-"}),(0,Ue.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,Ue.jsx)("button",{disabled:!0,className:"flex-shrink-0 rounded-full flex items-center justify-center font-semibold text-sm",style:{width:"28px",height:"28px",minWidth:"28px",minHeight:"28px",background:wb,color:"#D1D5DB",cursor:"not-allowed"},children:"\u2212"}),(0,Ue.jsx)("span",{className:"w-8 text-center font-semibold text-sm",style:{color:wb},children:"0"}),(0,Ue.jsx)("button",{disabled:!0,className:"flex-shrink-0 rounded-full flex items-center justify-center font-semibold text-sm",style:{width:"28px",height:"28px",minWidth:"28px",minHeight:"28px",background:wb,color:"#D1D5DB",cursor:"not-allowed"},children:"+"})]}),(0,Ue.jsx)("div",{className:"text-right font-semibold text-sm",style:{color:wb},children:"-"})]},"empty-".concat(t))})]}):(0,Ue.jsx)(Ue.Fragment,{children:m.map((e,t)=>(0,Ue.jsxs)("div",{className:"grid gap-2 px-4 items-center flex-shrink-0",style:{gridTemplateColumns:"1fr 100px 80px",height:"48px",background:t%2===0?jb:kb,borderBottom:"1px solid ".concat(kb)},children:[(0,Ue.jsx)("div",{className:"truncate text-left",style:{fontSize:"13px",fontWeight:500,color:Cb},children:e.name}),(0,Ue.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,Ue.jsx)("button",{onClick:()=>Xe(e.id),className:"flex-shrink-0 rounded-full flex items-center justify-center font-semibold text-sm",style:{width:"28px",height:"28px",minWidth:"28px",minHeight:"28px",background:wb,color:"#525252"},children:"\u2212"}),(0,Ue.jsx)("span",{className:"w-8 text-center font-semibold text-sm",style:{color:Cb},children:e.qty}),(0,Ue.jsx)("button",{onClick:()=>Ke(e.id),className:"flex-shrink-0 rounded-full flex items-center justify-center font-semibold text-sm text-white",style:{width:"28px",height:"28px",minWidth:"28px",minHeight:"28px",background:gb},children:"+"})]}),(0,Ue.jsx)("div",{className:"text-right font-semibold text-sm",style:{color:Cb},children:(e.price*e.qty).toLocaleString("id-ID")})]},e.id))})})]})}),(0,Ue.jsxs)("div",{className:"px-4 grid grid-cols-2 gap-3 flex-shrink-0",style:{background:wb,paddingTop:"8px",paddingBottom:"max(12px, env(safe-area-inset-bottom))"},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-center rounded-xl font-semibold",style:{background:"white",color:"#525252",fontSize:"16px",padding:"14px"},children:[m.length," items"]}),(0,Ue.jsx)("button",{onClick:Qe,disabled:0===m.length,className:"rounded-xl font-semibold transition-colors",style:{background:0===m.length?"white":gb,color:0===m.length?"#525252":"white",fontSize:"16px",padding:"14px",cursor:0===m.length?"not-allowed":"pointer"},children:"Checkout"})]})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 flex-shrink-0",style:{height:"48px",paddingTop:"max(4px, env(safe-area-inset-top))"},children:[(0,Ue.jsx)("button",{onClick:$e,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:bb},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain"})}),(0,Ue.jsx)("span",{className:"font-semibold text-lg",style:{color:"#525252"},children:"Back"})]}),(0,Ue.jsxs)("div",{className:"px-4 mb-3 flex-shrink-0 relative",style:{paddingTop:"4px"},children:[(0,Ue.jsx)("input",{type:"text",value:L,onChange:e=>{return t=e.target.value,z(t),K(t.length>0),void(t.length>0&&W&&t!==W.nama&&V(null));var t},onFocus:()=>L&&K(!0),onBlur:()=>setTimeout(()=>K(!1),200),placeholder:"Cari nama, nomor member atau nomor telepon pelanggan",className:"w-full px-4 rounded-xl border-none focus:outline-none",style:{background:"white",height:"48px",fontSize:"14px",color:"#525252"}}),G&&L&&(0,Ue.jsx)("div",{className:"absolute left-4 right-4 bg-white z-50 overflow-y-auto",style:{top:"52px",border:"1px solid ".concat(wb),borderRadius:"12px",maxHeight:"200px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:X?(0,Ue.jsx)("div",{className:"px-4 py-3 text-sm",style:{color:vb},children:"Mencari..."}):U.length>0?U.map(e=>(0,Ue.jsx)("div",{onClick:()=>(e=>{V(e),z(e.nama),K(!1),H([]),rv.itemAdded()})(e),className:"px-4 py-3 cursor-pointer transition-colors hover:bg-gray-50",style:{borderBottom:"1px solid ".concat(kb)},children:(0,Ue.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-sm font-medium",style:{color:Cb},children:e.nama}),(0,Ue.jsxs)("div",{className:"text-xs",style:{color:vb},children:[e.nomor_member||"No Member ID"," \u2022 ",e.points," pts"]})]}),(0,Ue.jsxs)("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:"#F0FDF4",color:"#22C55E"},children:[e.points," pts"]})]})},e.id)):(0,Ue.jsxs)("div",{className:"px-4 py-3 text-sm",style:{color:vb},children:['Tidak ditemukan "',L,'"']})})]}),(0,Ue.jsxs)("div",{className:"px-4 pb-1 flex-1 min-h-0 grid grid-cols-2 gap-2",style:{gridTemplateRows:"1fr 1fr"},children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #E5E5E5",background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:"#737373",flexShrink:0},children:"Membership"}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:W?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb,lineHeight:1.2},children:W.nama}),(0,Ue.jsx)("div",{className:"text-sm font-bold",style:{color:Cb,lineHeight:1.3},children:W.nomor_member||"-"})]})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#F5F5F5",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb,lineHeight:1.2},children:"Member"}),(0,Ue.jsxs)("div",{className:"text-sm font-bold",style:{color:Nb,lineHeight:1.3},children:[W.points," Points"]})]})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb,lineHeight:1.2},children:"Total Transaksi"}),(0,Ue.jsxs)("div",{className:"text-sm font-bold",style:{color:Cb,lineHeight:1.3},children:[W.total_transaksi,"x"]})]})})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center",style:{background:"#FFFFFF"},children:(0,Ue.jsxs)("div",{className:"text-center px-3",children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Cari nama member"}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:"#D1D5DB"},children:"untuk menambah poin"})]})}),(0,Ue.jsx)("div",{className:"flex-1",style:{background:"#F5F5F5"}}),(0,Ue.jsx)("div",{className:"flex-1",style:{background:"#FFFFFF"}})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #E5E5E5",background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:"#737373",flexShrink:0},children:"Purchase"}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-between",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Sub Total"}),(0,Ue.jsx)("div",{className:"text-base font-bold",style:{color:Cb},children:rt(Oe)})]})}),(0,Ue.jsxs)("div",{className:"flex-1 flex items-center justify-between",style:{background:"#F5F5F5",padding:"0 10px 0 12px"},children:[(0,Ue.jsxs)("div",{className:"cursor-pointer",onClick:qe,style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Discount"}),(0,Ue.jsxs)("div",{className:"text-base font-bold",style:{color:Cb},children:[x,"%"]})]}),(0,Ue.jsx)("button",{onClick:Ye,className:"flex-shrink-0 rounded-full flex items-center justify-center text-white",style:{width:"31px",height:"31px",minWidth:"31px",minHeight:"31px",background:wb,color:yb,border:"none",fontSize:"19px",fontWeight:700,lineHeight:1},children:"+"})]}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-between",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Total"}),(0,Ue.jsx)("div",{className:"text-lg font-bold",style:{color:Cb},children:rt(Le)})]})})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #E5E5E5",background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:"#737373",flexShrink:0},children:"Description"}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:["tunai"===O&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-between",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{className:"cursor-pointer",onClick:Ze,style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Bayar"}),(0,Ue.jsx)("div",{className:"text-base font-bold",style:{color:Cb},children:rt(Z)})]})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#F5F5F5",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Kembalian"}),(0,Ue.jsx)("div",{className:"text-base font-bold",style:{color:ze>=0?Cb:"#EF4444"},children:rt(Math.max(0,ze))})]})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Update Kas Toko"}),(0,Ue.jsx)("div",{className:"text-base font-bold",style:{color:Nb},children:rt(Le)})]})})]}),"qris"===O&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Rek BCA 739203822"}),(0,Ue.jsx)("div",{className:"text-sm font-bold",style:{color:Cb},children:"Toto Sugiharto"})]})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#F5F5F5",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Qris Code"}),(0,Ue.jsx)("div",{className:"text-sm font-bold",style:{color:Cb},children:"Evlogia Apparel"})]})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Update Kas Bank"}),(0,Ue.jsxs)("div",{className:"text-base font-bold",style:{color:Nb},children:["+",rt(Le)]})]})})]}),"hutang"===O&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Hutang"}),(0,Ue.jsx)("div",{className:"text-base font-bold",style:{color:Cb},children:rt(Ne)})]})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#F5F5F5",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Sudah Dibayar"}),(0,Ue.jsx)("div",{className:"text-base font-bold",style:{color:Cb},children:rt(Se)})]})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center",style:{background:"#FFFFFF",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Update Kas Toko"}),(0,Ue.jsx)("div",{className:"text-base font-bold",style:{color:Nb},children:rt(Se)})]})})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",style:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #E5E5E5",background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:"#737373",flexShrink:0},children:"Payment Methods"}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("button",{onClick:()=>{B("qris"),_e(0),Ae(Le)},className:"flex-1 flex items-center justify-between",style:{background:"qris"===O?"#FFF7ED":"#FFFFFF",border:"none",borderBottom:"qris"===O?"2px solid ".concat(gb):"none",cursor:"pointer",textAlign:"left",padding:"0 12px"},children:(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Qris/Transfer"}),(0,Ue.jsx)("div",{className:"text-base font-bold",style:{color:Cb},children:rt(Le)})]})}),(0,Ue.jsxs)("button",{onClick:()=>{B("tunai"),_e(0),Ae(Le)},className:"flex-1 flex items-center justify-between",style:{background:"tunai"===O?"#FFF7ED":"#F5F5F5",border:"none",borderBottom:"tunai"===O?"2px solid ".concat(gb):"none",cursor:"pointer",textAlign:"left",padding:"0 10px 0 12px"},children:[(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Tunai"}),(0,Ue.jsxs)("div",{className:"text-base font-bold",style:{color:Cb},children:[(0,Ue.jsx)("span",{className:"cursor-pointer",onClick:e=>{e.stopPropagation(),Ze()},style:{color:Cb},children:"\u270e Rp"})," ",Z.toLocaleString("id-ID")]})]}),(0,Ue.jsx)("div",{onClick:e=>{e.stopPropagation(),B("tunai"),_e(0),Ae(Le),(()=>{const e=Fe.calculate(Le,10).find(e=>e.total>Z);e?($(e=>[...e,Z||Le]),J(e.total)):($(e=>[...e,Z||Le]),J(Le))})()},className:"flex-shrink-0 rounded-full flex items-center justify-center text-white cursor-pointer",style:{width:"31px",height:"31px",minWidth:"31px",minHeight:"31px",background:wb,color:yb,fontSize:"19px",fontWeight:700,lineHeight:1},children:"+"})]}),(0,Ue.jsxs)("button",{onClick:()=>{B("hutang"),_e(Le),Ae(0)},className:"flex-1 flex items-center justify-between",style:{background:"hutang"===O?"#FFF7ED":"#FFFFFF",border:"none",borderTop:"hutang"===O?"2px solid ".concat(gb):"none",cursor:"pointer",textAlign:"left",padding:"0 10px 0 12px"},children:[(0,Ue.jsxs)("div",{style:{textAlign:"left"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:vb},children:"Hutang"}),(0,Ue.jsxs)("div",{className:"text-base font-bold",style:{color:Cb},children:[(0,Ue.jsx)("span",{className:"cursor-pointer",onClick:e=>{e.stopPropagation(),ke(Ne.toString()),ge(!0)},style:{color:Cb},children:"\u270e Rp"})," ",Ne.toLocaleString("id-ID")]})]}),(0,Ue.jsx)("div",{onClick:e=>{e.stopPropagation(),B("hutang"),_e(e=>0===e?Le:e),(()=>{if(Ne>0){const e=Math.min(Ne,1e3);_e(t=>Math.max(0,t-e)),Ae(t=>t+e)}})()},className:"flex-shrink-0 rounded-full flex items-center justify-center text-white cursor-pointer",style:{width:"31px",height:"31px",minWidth:"31px",minHeight:"31px",background:wb,color:yb,fontSize:"19px",fontWeight:700,lineHeight:1},children:"\u2212"})]})]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 grid grid-cols-2 gap-2 flex-shrink-0",style:{background:"transparent",paddingTop:"4px",paddingBottom:"max(8px, env(safe-area-inset-bottom))"},children:[(0,Ue.jsx)("input",{ref:ne,type:"file",accept:"image/*",capture:"environment",onChange:Je,className:"hidden"}),ee?(0,Ue.jsxs)("div",{className:"relative rounded-xl overflow-hidden cursor-pointer",style:{background:"white",height:"56px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},onClick:()=>Ce(!0),children:[(0,Ue.jsx)("img",{src:ee,alt:"Bukti",className:"w-full h-full object-cover"}),(0,Ue.jsx)("button",{onClick:e=>{e.stopPropagation(),te(null)},className:"absolute top-1 right-1 w-6 h-6 rounded-full flex items-center justify-center text-white text-sm",style:{background:"rgba(0,0,0,0.6)"},children:"\xd7"}),(0,Ue.jsx)("button",{onClick:e=>{var t;e.stopPropagation(),null===(t=ne.current)||void 0===t||t.click()},className:"absolute bottom-1 right-1 px-2 py-0.5 rounded text-xs text-white",style:{background:"rgba(0,0,0,0.6)"},children:"Ganti"})]}):(0,Ue.jsxs)("button",{onClick:()=>{var e;return null===(e=ne.current)||void 0===e?void 0:e.click()},className:"flex items-center justify-center gap-1.5 rounded-xl font-medium",style:{background:"white",color:"#525252",fontSize:"13px",height:"56px",border:"none",cursor:"pointer",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",className:"w-4 h-4"}),"Bukti Transfer"]}),(0,Ue.jsx)("button",{onClick:et,disabled:re||"tunai"===O&&Z<Le||"qris"===O&&!ee,className:"rounded-xl font-semibold text-white transition-colors",style:{background:re?"#D1D5DB":xb,fontSize:"16px",height:"56px",border:"none",cursor:re?"not-allowed":"pointer",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:re?"Memproses...":"Paid"})]})]})},c)}),p&&(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{background:"rgba(0,0,0,0.5)"},onClick:e=>e.target===e.currentTarget&&f(!1),children:(0,Ue.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden",style:{maxHeight:"90vh",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},onClick:e=>e.stopPropagation(),children:[(0,Ue.jsxs)("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 100px)"},children:[(0,Ue.jsxs)("div",{className:"text-center mb-5 pb-4",style:{borderBottom:"1px dashed #E5E5E5"},children:[(0,Ue.jsx)("h2",{className:"font-bold mb-1",style:{fontSize:"18px",color:Cb},children:"Warung Evlogia"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:vb,lineHeight:1.4},children:"Jalan Atput II No.16 Bandung"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:vb,lineHeight:1.4},children:"milkyhoop.com/evlogia"})]}),(0,Ue.jsxs)("table",{className:"w-full mb-4",style:{fontSize:"13px"},children:[(0,Ue.jsx)("thead",{children:(0,Ue.jsxs)("tr",{style:{borderBottom:"1px solid ".concat(wb)},children:[(0,Ue.jsx)("th",{className:"text-left pb-2",style:{fontSize:"11px",fontWeight:600,color:vb},children:"No."}),(0,Ue.jsx)("th",{className:"text-left pb-2",style:{fontSize:"11px",fontWeight:600,color:vb},children:"Item"}),(0,Ue.jsx)("th",{className:"text-right pb-2",style:{fontSize:"11px",fontWeight:600,color:vb},children:"Harga (Rp)"})]})}),(0,Ue.jsx)("tbody",{children:m.map((e,t)=>{var n;return(0,Ue.jsxs)("tr",{style:{borderBottom:"1px solid ".concat(kb)},children:[(0,Ue.jsxs)("td",{className:"py-3 align-top text-left",style:{color:Cb},children:[String(t+1).padStart(2,"0"),"."]}),(0,Ue.jsxs)("td",{className:"py-3 align-top text-left",children:[(0,Ue.jsx)("div",{className:"font-semibold mb-0.5 text-left",style:{color:Cb},children:e.name}),(0,Ue.jsxs)("div",{className:"text-left",style:{fontSize:"11px",color:"#9CA3AF",lineHeight:1.3},children:["Barcode ",null===(n=e.barcode)||void 0===n?void 0:n.slice(0,6),"..."]}),(0,Ue.jsxs)("div",{className:"text-left",style:{fontSize:"11px",color:"#9CA3AF",lineHeight:1.3},children:[e.price.toLocaleString()," x ",e.qty]})]}),(0,Ue.jsx)("td",{className:"py-3 align-top text-right font-semibold",style:{color:Cb},children:(e.price*e.qty).toLocaleString()})]},e.id)})})]}),(0,Ue.jsxs)("div",{className:"py-3 mb-4",style:{borderTop:"2px solid ".concat(wb),borderBottom:"1px dashed #E5E5E5"},children:[(0,Ue.jsxs)("div",{className:"flex justify-between mb-1",style:{fontSize:"14px",fontWeight:600,color:Cb},children:[(0,Ue.jsx)("span",{children:"Total"}),(0,Ue.jsx)("span",{children:Le.toLocaleString()})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",style:{fontSize:"14px",fontWeight:600,color:Cb},children:[(0,Ue.jsx)("span",{children:"tunai"===O?"Tunai":"qris"===O?"Qris/Transfer":"Hutang"}),(0,Ue.jsx)("span",{children:("tunai"===O?Z:"hutang"===O?Ne:Le).toLocaleString()})]})]}),(0,Ue.jsxs)("div",{className:"text-center mb-4",style:{fontSize:"12px",color:"#525252"},children:[(0,Ue.jsxs)("p",{children:[m.length," item pembelian"]}),(0,Ue.jsxs)("p",{children:["ID Transaksi ",(null===ce||void 0===ce?void 0:ce.transaction_id)||"tx_xxxxx"]}),(0,Ue.jsx)("p",{children:"Kasir Indah Sakti"})]}),W&&(0,Ue.jsxs)("div",{className:"text-center mb-4",style:{fontSize:"12px",color:"#525252"},children:[(0,Ue.jsx)("h3",{className:"font-semibold mb-2",style:{fontSize:"14px"},children:"Membership"}),(0,Ue.jsx)("p",{children:W.nama}),(0,Ue.jsxs)("p",{children:["No. Member: ",W.nomor_member||"-"]}),(0,Ue.jsxs)("p",{style:{color:Nb,fontWeight:600},children:["Points: ",W.points]})]}),(0,Ue.jsxs)("div",{className:"text-center p-5 rounded-xl mb-4",style:{background:"#F0FDF4"},children:[(0,Ue.jsx)("div",{className:"font-semibold mb-1",style:{fontSize:"14px",color:Nb},children:"Berhasil"}),(0,Ue.jsx)("div",{className:"font-bold",style:{fontSize:"20px",color:Cb},children:rt(Le)})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3 px-4 py-3 flex-shrink-0",style:{borderTop:"1px solid ".concat(wb),maxHeight:"72px"},children:[(0,Ue.jsx)("button",{onClick:n,className:"rounded-xl font-semibold flex items-center justify-center",style:{height:"48px",background:"white",border:"1px solid ".concat(wb),fontSize:"14px",color:"#525252",cursor:"pointer"},children:"Back to Chat"}),(0,Ue.jsx)("button",{onClick:nt,className:"rounded-xl font-semibold text-white flex items-center justify-center",style:{height:"48px",background:"#22C55E",border:"none",fontSize:"14px",cursor:"pointer"},children:"Transaksi Baru"})]})]})}),se&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm mx-4",style:{boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},children:[(0,Ue.jsx)("div",{className:"text-center mb-4 text-lg font-semibold",style:{color:Cb},children:"Produk tidak ditemukan"}),(0,Ue.jsx)("div",{className:"text-center mb-6 text-sm",style:{color:"#525252"},children:"Coba ketik nama produk"}),(0,Ue.jsx)("button",{onClick:()=>le(!1),className:"w-full py-3 rounded-lg font-semibold text-white transition-colors",style:{background:xb},children:"OK"})]})}),Ie&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-5 mx-4 max-w-sm",style:{boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},children:[(0,Ue.jsx)("h3",{className:"text-base font-semibold mb-2",style:{color:"#262626"},children:"Lanjutkan Belanja?"}),(0,Ue.jsx)("p",{className:"text-sm mb-4",style:{color:"#737373"},children:"Anda memiliki keranjang belanja yang belum selesai. Lanjutkan atau mulai baru?"}),(0,Ue.jsxs)("div",{className:"flex gap-2",children:[(0,Ue.jsx)("button",{onClick:()=>{try{localStorage.removeItem(Pe)}catch(Z_){console.error("Failed to discard POS draft:",Z_)}Te(!1)},className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50",children:"Mulai Baru"}),(0,Ue.jsx)("button",{onClick:()=>{try{const e=localStorage.getItem(Pe);if(e){const t=JSON.parse(e);t.cart&&g(t.cart),t.discount&&y(t.discount)}}catch(Z_){console.error("Failed to resume POS draft:",Z_)}Te(!1)},className:"flex-1 px-4 py-2.5 text-white rounded-lg text-sm font-medium",style:{background:xb},children:"Lanjutkan"})]})]})}),de&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>he(!1),children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm mx-4 w-full",style:{boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:e=>e.stopPropagation(),children:[(0,Ue.jsx)("div",{className:"text-center mb-4 text-lg font-semibold",style:{color:Cb},children:"Input Diskon"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:xe,onChange:e=>ye(e.target.value.replace(/\D/g,"")),placeholder:"0-100%",className:"w-full px-4 py-3 rounded-lg border text-center text-lg font-bold mb-4",style:{borderColor:wb,color:Cb},autoFocus:!0}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsx)("button",{onClick:()=>he(!1),className:"py-3 rounded-lg font-semibold transition-colors",style:{background:wb,color:"#525252"},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{const e=parseInt(xe)||0;y(Math.min(100,Math.max(0,e))),he(!1)},className:"py-3 rounded-lg font-semibold text-white transition-colors",style:{background:xb},children:"OK"})]})]})}),pe&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>fe(!1),children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm mx-4 w-full",style:{boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:e=>e.stopPropagation(),children:[(0,Ue.jsx)("div",{className:"text-center mb-2 text-lg font-semibold",style:{color:Cb},children:"Input Jumlah Bayar"}),(0,Ue.jsxs)("div",{className:"text-center mb-4 text-sm",style:{color:vb},children:["Total: ",rt(Le)]}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:ve,onChange:e=>be(e.target.value.replace(/\D/g,"")),placeholder:"Min: ".concat(rt(Le)),className:"w-full px-4 py-3 rounded-lg border text-center text-lg font-bold mb-4",style:{borderColor:wb,color:Cb},autoFocus:!0}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsx)("button",{onClick:()=>fe(!1),className:"py-3 rounded-lg font-semibold transition-colors",style:{background:wb,color:"#525252"},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{const e=parseInt(ve)||0;e>=Le&&($(e=>[...e,Z||Le]),J(e)),fe(!1)},className:"py-3 rounded-lg font-semibold text-white transition-colors",style:{background:xb},children:"OK"})]})]})}),me&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>ge(!1),children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm mx-4 w-full",style:{boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},onClick:e=>e.stopPropagation(),children:[(0,Ue.jsx)("div",{className:"text-center mb-2 text-lg font-semibold",style:{color:Cb},children:"Input Jumlah Hutang"}),(0,Ue.jsxs)("div",{className:"text-center mb-4 text-sm",style:{color:vb},children:["Total Tagihan: ",rt(Le)]}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:we,onChange:e=>ke(e.target.value.replace(/\D/g,"")),placeholder:"Max: ".concat(rt(Le)),className:"w-full px-4 py-3 rounded-lg border text-center text-lg font-bold mb-4",style:{borderColor:wb,color:Cb},autoFocus:!0}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsx)("button",{onClick:()=>ge(!1),className:"py-3 rounded-lg font-semibold transition-colors",style:{background:wb,color:"#525252"},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{const e=parseInt(we)||0,t=Math.max(0,Math.min(Le,e)),n=Le-t;_e(t),Ae(n),ge(!1)},className:"py-3 rounded-lg font-semibold text-white transition-colors",style:{background:xb},children:"OK"})]})]})}),je&&ee&&(0,Ue.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:()=>Ce(!1),children:[(0,Ue.jsx)("button",{onClick:()=>Ce(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full flex items-center justify-center text-white text-2xl",style:{background:"rgba(255,255,255,0.2)"},children:"\xd7"}),(0,Ue.jsx)("img",{src:ee,alt:"Bukti Transfer",className:"max-w-full max-h-full object-contain p-4",onClick:e=>e.stopPropagation()})]}),oe&&(0,Ue.jsx)("div",{className:"fixed top-20 left-4 right-4 px-4 py-2 rounded-lg text-center text-sm shadow-lg z-50 text-white",style:{background:"#EF4444"},children:oe})]})},Sb=e=>{let{isOpen:t,onClose:n,onBarcodeDetected:r}=e;const[o,i]=(0,a.useState)("idle"),[s,l]=(0,a.useState)(null),c=(0,a.useRef)(null),u=(0,a.useRef)(null),d=(0,a.useCallback)(async()=>{if(c.current)try{l(null),i("scanning"),u.current=new cy(c.current,{desiredWidth:1280,desiredHeight:720}),u.current.onFound(e=>{const t=e.text||e.rawValue||"";var a;t&&(null===(a=u.current)||void 0===a||a.stop(),r(t),n())}),u.current.onProgress(e=>{"camera-ready"===e.phase&&i("scanning")}),u.current.onError(e=>{console.error("[FullscreenBarcodeScanner] Error:",e),l(e.message||"Gagal mengakses kamera"),i("error")}),await u.current.start()}catch(e){console.error("Scanner error:",e),l("NotAllowedError"===e.name?"Izinkan akses kamera untuk scan barcode":"Gagal mengakses kamera"),i("error")}},[r,n]),h=(0,a.useCallback)(()=>{u.current&&(u.current.stop(),u.current=null)},[]);return(0,a.useEffect)(()=>(t?d():(h(),i("idle"),l(null)),()=>{h()}),[t,d,h]),t?(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 bg-black",children:[(0,Ue.jsx)("video",{ref:c,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute inset-0 w-full h-full object-cover"}),(0,Ue.jsx)("button",{onClick:n,className:"absolute top-4 right-4 z-20 w-11 h-11 rounded-full bg-neutral-900/60 backdrop-blur-md flex items-center justify-center active:bg-neutral-800/60 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),"scanning"===o&&!s&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:(0,Ue.jsxs)("div",{className:"w-64 h-64 relative",style:{animation:"scan-breathe 1s ease-in-out infinite"},children:[(0,Ue.jsx)("div",{className:"absolute top-0 left-0 w-12 h-12 border-t-4 border-l-4 border-white rounded-tl-2xl"}),(0,Ue.jsx)("div",{className:"absolute top-0 right-0 w-12 h-12 border-t-4 border-r-4 border-white rounded-tr-2xl"}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-0 w-12 h-12 border-b-4 border-l-4 border-white rounded-bl-2xl"}),(0,Ue.jsx)("div",{className:"absolute bottom-0 right-0 w-12 h-12 border-b-4 border-r-4 border-white rounded-br-2xl"})]})}),(0,Ue.jsx)("style",{children:"\n        @keyframes scan-breathe {\n          0%, 100% { transform: scale(1); }\n          50% { transform: scale(1.08); }\n        }\n      "}),"scanning"===o&&!s&&(0,Ue.jsx)("div",{className:"absolute bottom-8 inset-x-4 flex justify-center z-10",children:(0,Ue.jsx)("div",{className:"px-6 py-4 rounded-full bg-neutral-900/60 backdrop-blur-md",children:(0,Ue.jsx)("span",{className:"text-white font-medium",children:"Find a barcode to scan"})})}),s&&(0,Ue.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/80",children:(0,Ue.jsxs)("div",{className:"text-center px-8",children:[(0,Ue.jsx)("div",{className:"w-20 h-20 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,Ue.jsx)("svg",{className:"w-10 h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),(0,Ue.jsx)("p",{className:"text-white font-medium text-lg mb-2",children:s}),(0,Ue.jsx)("p",{className:"text-neutral-400 text-sm mb-6",children:"Pastikan browser memiliki izin kamera"}),(0,Ue.jsx)("button",{onClick:()=>{l(null),i("idle"),d()},className:"px-6 py-3 rounded-full bg-neutral-900/60 backdrop-blur-md text-white font-medium",children:"Coba Lagi"})]})})]}):null};function Eb(e){const[t,n]=(0,a.useState)(()=>"undefined"!==typeof window&&window.matchMedia(e).matches);return(0,a.useEffect)(()=>{if("undefined"===typeof window)return;const t=window.matchMedia(e),r=e=>{n(e.matches)};return n(t.matches),t.addEventListener("change",r),()=>{t.removeEventListener("change",r)}},[e]),t}function Ab(){return Eb("(min-width: 1024px)")}const Ib="#F97316",Tb="#737373",Pb="#22C55E",Db="#EF4444",Mb="#FFFFFF",Rb=()=>(0,Ue.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,Ue.jsx)("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}),(0,Ue.jsx)("line",{x1:"8",y1:"10",x2:"16",y2:"10",strokeDasharray:"2 2"}),(0,Ue.jsx)("line",{x1:"8",y1:"14",x2:"16",y2:"14",strokeDasharray:"2 2"})]}),Fb=()=>(0,Ue.jsxs)("svg",{className:"animate-spin",width:"22",height:"22",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),Ob=()=>(0,Ue.jsx)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:(0,Ue.jsx)("polyline",{points:"20 6 9 17 4 12"})}),Bb=()=>(0,Ue.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,Ue.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,Ue.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Lb=e=>{let{onBarcodeReceived:t,variant:n="icon-only",className:r=""}=e;const o=Ab(),[i,s]=(0,a.useState)("idle"),[l,c]=(0,a.useState)(""),{state:u,requestScan:d,cancelScan:h,reset:p}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[t,n]=(0,a.useState)("idle"),[r,o]=(0,a.useState)(null),[i,s]=(0,a.useState)(null),l=(0,a.useRef)(e);l.current=e,(0,a.useEffect)(()=>{const e=e=>{var t,r,a,c,u,d;const h=e,{event:p,scan_id:f,barcode:m,error:g}=h.detail;if(!f||!i||f===i)switch(p){case"remote_scan:result":var x,y;m&&(n("success"),o({barcode:m}),s(null),null===(x=(y=l.current).onSuccess)||void 0===x||x.call(y,m));break;case"remote_scan:error":n("error"),o({error:g||"Scan failed"}),s(null),null===(t=(r=l.current).onError)||void 0===t||t.call(r,g||"Scan failed");break;case"remote_scan:cancelled":n("cancelled"),s(null),null===(a=(c=l.current).onCancel)||void 0===a||a.call(c);break;case"remote_scan:timeout":n("timeout"),s(null),null===(u=(d=l.current).onTimeout)||void 0===u||u.call(d)}};return window.addEventListener("remoteScanEvent",e),()=>{window.removeEventListener("remoteScanEvent",e)}},[i]);const c=(0,a.useCallback)(async()=>{try{n("requesting"),o(null);let r=sessionStorage.getItem("tab_id");r||(r="tab_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2)),sessionStorage.setItem("tab_id",r));const a=Ee(),i=await fetch("/api/devices/remote-scan/request",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({tab_id:r})}),c=await i.json();return c.success&&c.scan_id?(s(c.scan_id),n("waiting"),!0):(n("error"),o({error:c.message||"Failed to request scan"}),null===(e=(t=l.current).onError)||void 0===e||e.call(t,c.message||"Failed to request scan"),!1);var e,t}catch(i){var r,a;return n("error"),o({error:"Network error"}),null===(r=(a=l.current).onError)||void 0===r||r.call(a,"Network error"),!1}},[]);return{state:t,result:r,isScanning:"requesting"===t||"waiting"===t,requestScan:c,cancelScan:(0,a.useCallback)(async()=>{if(i){try{const e=Ee();await fetch("/api/devices/remote-scan/cancel",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({scan_id:i})})}catch(e){console.error("[RemoteScanner] Cancel failed:",e)}n("cancelled"),s(null)}},[i]),reset:(0,a.useCallback)(()=>{n("idle"),o(null),s(null)},[])}}({onSuccess:e=>{s("success"),t(e),setTimeout(()=>{s("idle"),p()},1500)},onError:e=>{s("error"),c(e||"HP tidak online"),setTimeout(()=>{s("idle"),c(""),p()},3e3)},onTimeout:()=>{s("error"),c("Timeout, coba lagi"),setTimeout(()=>{s("idle"),c(""),p()},3e3)},onCancel:()=>{s("idle"),p()}});(0,a.useEffect)(()=>{"requesting"!==u&&"waiting"!==u||s("waiting")},[u]);const f=(0,a.useCallback)(async()=>{"waiting"===i?(await h(),s("idle")):"idle"===i&&await d()},[i,d,h]);if(!o)return null;const m=()=>{switch(i){case"waiting":return Ib;case"success":return Pb;case"error":return Db;default:return Tb}},g=()=>{switch(i){case"waiting":return(0,Ue.jsx)(Fb,{});case"success":return(0,Ue.jsx)(Ob,{});case"error":return(0,Ue.jsx)(Bb,{});default:return(0,Ue.jsx)(Rb,{})}},x={shake:{x:[0,-6,6,-4,4,0],transition:{duration:.4}}};if("icon-only"===n)return(0,Ue.jsxs)("div",{style:{position:"relative",display:"inline-flex"},children:[(0,Ue.jsx)(yc.button,{onClick:f,animate:"error"===i?"shake":void 0,variants:x,style:{width:"32px",height:"32px",marginLeft:"8px",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",cursor:"pointer",color:m(),opacity:"idle"===i?.6:1,transition:"opacity 0.2s, color 0.2s",flexShrink:0},whileHover:{opacity:1,scale:1.05},whileTap:{scale:.95},title:"waiting"===i?"Batalkan scan":"Scan via HP","aria-label":"waiting"===i?"Batalkan scan":"Scan barcode via HP",className:r,children:g()}),(0,Ue.jsx)(mt,{children:l&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},style:{position:"absolute",top:"100%",right:0,marginTop:"8px",padding:"6px 10px",borderRadius:"6px",backgroundColor:Db,color:Mb,fontSize:"11px",fontWeight:500,whiteSpace:"nowrap",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",zIndex:100},children:l})})]});if("inline"===n){const e=()=>{switch(i){case"waiting":return"Menunggu HP...";case"success":return"Berhasil!";case"error":return"Gagal";default:return"Scan via HP"}},t=()=>{switch(i){case"waiting":return Ib;case"success":return Pb;case"error":return Db;default:return"#E5E5E5"}},n=()=>"idle"===i?"#262626":Mb;return(0,Ue.jsxs)(yc.button,{onClick:f,animate:"error"===i?"shake":void 0,variants:x,style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",borderRadius:"10px",background:t(),border:"none",fontSize:"14px",fontWeight:500,color:n(),cursor:"pointer",transition:"all 0.2s ease"},whileHover:{scale:1.02},whileTap:{scale:.98},title:"waiting"===i?"Batalkan scan":"Scan via HP",className:r,children:[g(),(0,Ue.jsx)("span",{children:e()})]})}return null},zb="#F97316",Wb="#3B82F6",Vb="#262626",Ub="#737373",Hb="#A3A3A3",Gb="#D4D4D4",Kb="#E5E5E5",Xb="#F5F5F5",Yb="#FFFFFF",qb="#262626",Zb="#22C55E",Jb="#EF4444",Qb={duration:.3,ease:[.4,0,.2,1]},$b=["Karton","Dus","Box","Pack","Lusin","Kodi","Slop","Bal","Koli","Rim"],ew=["pcs","kg","gram","liter","ml","meter","cm","batang","bungkus","sachet","botol","kaleng"],tw=["Makanan Sachet","Minuman","Snack","Sembako","Rokok","Toiletries","Bumbu Dapur","Frozen Food","Susu","Kopi & Teh"],nw=["Indogrosir","Alfamart Grosir","Indomaret Grosir","Toko Sumber Rezeki","CV Maju Jaya","PT Sinar Harapan","Supplier Lokal","Lainnya"],rw=a.memo(e=>{let{checked:t,onChange:n,labelOn:r,labelOff:o}=e;const[i,s]=a.useState(!1),l=Ay(t?42:-42);a.useEffect(()=>{i||tv(l,t?42:-42,{type:"spring",stiffness:500,damping:30})},[t,i,l]);return(0,Ue.jsxs)("button",{onClick:()=>{i||(n(!t),rv.itemAdded())},style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"120px",height:"36px",padding:"4px",background:t?zb:"#E5E5E5",borderRadius:"18px",border:"none",cursor:"pointer",userSelect:"none",touchAction:"pan-y"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",fontWeight:400,color:t?"#FFFFFF":Ub,zIndex:1,paddingLeft:t?"0":"24px",paddingRight:t?"24px":"0",pointerEvents:"none"},children:t?r:o}),(0,Ue.jsx)(yc.span,{drag:"x",dragElastic:.1,dragMomentum:!1,dragConstraints:{left:-42,right:42},onDragStart:()=>s(!0),onDragEnd:(e,r)=>{Math.abs(r.offset.x)>20&&(r.offset.x>0&&!t||r.offset.x<0&&t)?(n(!t),rv.itemAdded()):tv(l,t?42:-42,{type:"spring",stiffness:500,damping:30}),s(!1)},style:{x:l,position:"absolute",width:"28px",height:"28px",borderRadius:"50%",background:"#FFFFFF",boxShadow:"0 2px 4px rgba(0,0,0,0.15)",cursor:"grab",zIndex:2},whileDrag:{cursor:"grabbing",scale:1.05}})]})}),aw=a.memo(e=>{let{value:t,displayValue:n,onChange:r}=e;const[o,i]=a.useState(!1),s=a.useRef(null),[l,c]=a.useState(200);a.useEffect(()=>{s.current&&c(s.current.clientHeight)},[]);const u=Math.max(0,l-36-8),d=Ay((100-t)/100*u);a.useEffect(()=>{!o&&u>0&&tv(d,(100-t)/100*u,{type:"spring",stiffness:500,damping:30})},[t,o,d,u]);return(0,Ue.jsxs)("div",{ref:s,onClick:e=>{if(!o&&s.current){const t=s.current.getBoundingClientRect(),n=e.clientY-t.top,a=Math.round(100-n/l*100);r(Math.max(0,Math.min(100,a))),rv.itemAdded()}},style:{position:"relative",width:"44px",alignSelf:"stretch",minHeight:"150px",background:Gb,borderRadius:"22px",cursor:"pointer",userSelect:"none",touchAction:"pan-x"},children:[(0,Ue.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"".concat(Math.min(l,l-(100-t)/100*u-4),"px"),background:zb,borderRadius:"22px",transition:o?"none":"height 0.1s ease-out",zIndex:2}}),(0,Ue.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-90deg)",color:Ub,fontSize:"9px",fontWeight:600,letterSpacing:"0.5px",textTransform:"uppercase",whiteSpace:"nowrap",pointerEvents:"none",zIndex:1,opacity:.6},children:"margin slider"}),(0,Ue.jsx)("div",{style:{position:"absolute",right:"52px",top:"".concat(Math.max(0,(100-t)/100*u-65),"px"),transition:"top 0.1s ease-out",zIndex:10},children:(0,Ue.jsxs)("span",{style:{background:zb,color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:700,whiteSpace:"nowrap",boxShadow:"0 2px 4px rgba(0,0,0,0.15)"},children:[n,"%"]})}),(0,Ue.jsx)(yc.div,{drag:"y",dragElastic:.1,dragMomentum:!1,dragConstraints:{top:0,bottom:u},onDragStart:()=>i(!0),onDragEnd:()=>{const e=d.get(),t=Math.round(100-e/u*100);r(Math.max(0,Math.min(100,t))),i(!1)},onDrag:()=>{const e=d.get(),n=Math.round(100-e/u*100);n!==t&&r(Math.max(0,Math.min(100,n)))},style:{y:d,position:"absolute",left:"50%",marginLeft:"-18px",width:"36px",height:"36px",borderRadius:"50%",background:"#FFFFFF",boxShadow:"0 2px 4px rgba(0,0,0,0.15)",cursor:"grab",zIndex:2},whileDrag:{cursor:"grabbing",scale:1.05}})]})}),ow=e=>{let{tenantId:t,onClose:n,onTransactionComplete:r}=e;const[o,i]=(0,a.useState)("input"),[s,l]=(0,a.useState)("left"),[c,u]=(0,a.useState)({productName:"",productBarcode:"",quantity:0,unit:"",unitsPerPack:0,contentUnit:"",isWholesale:!0,supplier:"",date:(new Date).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}),pricePerUnit:0,totalPrice:0,hargaPokok:0,hasDiscount:!1,hasPPN:!1,category:""}),d=(0,a.useRef)(null),h=(0,a.useRef)(null),[p,f]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!1),[x,y]=(0,a.useState)(""),v=(0,a.useRef)(null),[b,w]=(0,a.useState)(""),[k,j]=(0,a.useState)(!1),[C,N]=(0,a.useState)([]),[_,S]=(0,a.useState)(!1),[E,A]=(0,a.useState)(!1),I=(0,a.useRef)(null),[T,P]=(0,a.useState)(!1),[D,M]=(0,a.useState)(!1),[R,F]=(0,a.useState)(!1),[O,B]=(0,a.useState)(!1),[L,z]=(0,a.useState)(!1),[W,V]=(0,a.useState)(!1),[U,H]=(0,a.useState)(""),[G,K]=(0,a.useState)(""),[X,Y]=(0,a.useState)(!1),[q,Z]=(0,a.useState)(""),[J,Q]=(0,a.useState)(""),[$,ee]=(0,a.useState)(!1),[te,ne]=(0,a.useState)(""),[re,ae]=(0,a.useState)(""),[oe,ie]=(0,a.useState)(""),[se,le]=(0,a.useState)(""),[ce,ue]=(0,a.useState)(tw),de=(0,a.useRef)(null),he=(0,a.useRef)(null),[pe,fe]=(0,a.useState)("tunai"),[me]=(0,a.useState)(35e5),[ge]=(0,a.useState)(2e6),[xe]=(0,a.useState)(4e6),[ye,ve]=(0,a.useState)(()=>{const e=new Date;return e.setDate(e.getDate()+30),e.toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}),[be,we]=(0,a.useState)(!1),[ke,je]=(0,a.useState)(!1),[Ce,Ne]=(0,a.useState)(10),[_e,Se]=(0,a.useState)(0),[Ee,Ae]=(0,a.useState)(""),[Ie,Te]=(0,a.useState)(!1),[Pe,De]=(0,a.useState)(""),[Me,Re]=(0,a.useState)(!1),[Fe,Oe]=(0,a.useState)(""),[Be,Le]=(0,a.useState)(!1),[ze,We]=(0,a.useState)(null),[Ve,He]=(0,a.useState)(null),[Ge,Ke]=(0,a.useState)(0),[Xe,Ye]=(0,a.useState)(!1),[qe,Ze]=(0,a.useState)(""),[Je,Qe]=(0,a.useState)(""),[$e,et]=(0,a.useState)(""),[nt,rt]=(0,a.useState)(""),[at,ot]=(0,a.useState)(!1),[it,st]=(0,a.useState)(!1),[lt,ct]=(0,a.useState)(!1),[ut,dt]=(0,a.useState)(!1),[ht,pt]=(0,a.useState)(!1),[ft,gt]=(0,a.useState)(!1),[xt,yt]=(0,a.useState)(!1),[vt,bt]=(0,a.useState)(!1),[wt,kt]=(0,a.useState)(""),[jt,Ct]=(0,a.useState)(!1),Nt="pembelian_draft_".concat(t),_t={shake:{x:[0,-8,8,-6,6,-3,3,0],transition:{duration:.5,ease:"easeOut"}}},St=(0,a.useMemo)(()=>c.hargaPokok>0&&_e>0?Math.round((_e-c.hargaPokok)/c.hargaPokok*100):Ce,[c.hargaPokok,_e,Ce]),Et=Math.max(0,Math.min(100,St)),At=($b.filter(e=>e.toLowerCase().includes(G.toLowerCase())),ew.filter(e=>e.toLowerCase().includes(J.toLowerCase()))),It=nw.filter(e=>e.toLowerCase().includes(re.toLowerCase())),Tt=ce.filter(e=>e.toLowerCase().includes(oe.toLowerCase()));(0,a.useEffect)(()=>{let e=c.pricePerUnit*c.quantity,t=e,n=e;c.hasDiscount&&Ge>0&&(t=e-e*Ge/100),n=c.hasPPN?t+11*t/100:t;let r=0;c.quantity>0&&(c.isWholesale&&c.unitsPerPack>0?r=Math.round(n/c.quantity/c.unitsPerPack):c.isWholesale||(r=Math.round(n/c.quantity))),u(e=>tt(tt({},e),{},{totalPrice:Math.round(n),hargaPokok:r}))},[c.pricePerUnit,c.quantity,c.hasDiscount,c.hasPPN,c.unitsPerPack,c.isWholesale,Ge]),(0,a.useEffect)(()=>{if(c.hargaPokok>0){const e=Math.round(c.hargaPokok*(1+Ce/100));Se(e)}},[c.hargaPokok,Ce]),(0,a.useEffect)(()=>{if(c.productName||c.quantity>0||c.pricePerUnit>0)try{const e={formData:c,margin:Ce,hargaJual:_e,catatan:Ee,discountPercent:Ge,kasPaymentMethod:pe,currentPage:o,savedAt:(new Date).toISOString()};localStorage.setItem(Nt,JSON.stringify(e))}catch(Z_){console.error("Failed to save Pembelian draft:",Z_)}},[c,Ce,_e,Ee,Ge,pe,o,Nt]),(0,a.useEffect)(()=>{try{const e=localStorage.getItem(Nt);if(e){const t=JSON.parse(e);t.formData&&(t.formData.productName||t.formData.quantity>0)&&Ct(!0)}}catch(Z_){console.error("Failed to check Pembelian draft:",Z_)}},[Nt]);const Pt=(0,a.useCallback)(()=>{try{const e=localStorage.getItem(Nt);if(e){const t=JSON.parse(e);t.formData&&u(t.formData),void 0!==t.margin&&Ne(t.margin),void 0!==t.hargaJual&&Se(t.hargaJual),t.catatan&&Ae(t.catatan),void 0!==t.discountPercent&&Ke(t.discountPercent),t.kasPaymentMethod&&fe(t.kasPaymentMethod),t.currentPage&&i(t.currentPage)}}catch(Z_){console.error("Failed to resume Pembelian draft:",Z_)}Ct(!1)},[Nt]),Dt=(0,a.useCallback)(()=>{try{localStorage.removeItem(Nt)}catch(Z_){console.error("Failed to discard Pembelian draft:",Z_)}Ct(!1)},[Nt]),Mt=(0,a.useCallback)(()=>{try{localStorage.removeItem(Nt)}catch(Z_){console.error("Failed to clear Pembelian draft:",Z_)}},[Nt]),Rt=(0,a.useCallback)(async e=>{if(e.length<1)N([]);else{S(!0);try{const n=localStorage.getItem("access_token"),r=await fetch("/api/products/search/pos?q=".concat(encodeURIComponent(e),"&limit=10"),{headers:{Authorization:"Bearer ".concat(n)}});if(r.ok){var t;const e=await r.json();N(e.products||[]),A(0===(null===(t=e.products)||void 0===t?void 0:t.length))}else N([]),A(!0)}catch(Z_){console.error("Product search failed:",Z_),N([]),A(!0)}finally{S(!1)}}},[]);(0,a.useEffect)(()=>{I.current&&clearTimeout(I.current);const e=b.replace(/\D/g,"");if(13===e.length)return Ft(e),w(""),void j(!1);if(b&&k){S(!0);const e=b.length>=3?0:80;0===e?Rt(b):I.current=setTimeout(()=>{Rt(b)},e)}else N([]),S(!1);return()=>{I.current&&clearTimeout(I.current)}},[b,k,Rt]);const Ft=async e=>{try{const n=localStorage.getItem("access_token"),r=await fetch("/api/products/barcode/".concat(e,"?tenant_id=").concat(t),{headers:{Authorization:"Bearer ".concat(n)}});if(r.ok){const t=await r.json();rv.scanSuccess(),u(n=>tt(tt({},n),{},{productName:t.nama_produk||t.name,productBarcode:e,unit:t.satuan||n.unit,unitsPerPack:t.units_per_pack||n.unitsPerPack,hargaPokok:t.harga_jual||n.hargaPokok,category:t.category||n.category})),A(!1)}else rv.scanError(),u(t=>tt(tt({},t),{},{productBarcode:e,productName:""})),A(!0)}catch(Z_){rv.scanError(),console.error("Barcode lookup failed:",Z_)}},Ot=()=>{u(e=>tt(tt({},e),{},{productName:b,productBarcode:"",quantity:0,pricePerUnit:0})),w(""),j(!1),A(!0),rv.itemAdded(),setTimeout(()=>{H(""),K(""),Ze(""),Qe(""),P(!0)},100)};(0,a.useEffect)(()=>()=>{h.current&&(h.current.stop(),h.current=null)},[]),(0,a.useEffect)(()=>{if(p){const e=setTimeout(()=>{(async()=>{if(d.current){g(!0),y("");try{h.current=new cy(d.current,{desiredWidth:1280,desiredHeight:720,decodeFPS:15,roiResizeLongSide:600,consensusFrames:2}),h.current.onFound(e=>{var t;Ft(e.text),f(!1),null===(t=h.current)||void 0===t||t.stop()}),h.current.onProgress(e=>{"camera-ready"===e.phase&&g(!1)}),h.current.onError(e=>{y(e.message||"Gagal mengakses kamera"),g(!1)}),await h.current.start()}catch(e){y(e.message||"Gagal memulai scanner"),g(!1)}}})()},100);return()=>clearTimeout(e)}h.current&&(h.current.stop(),h.current=null)},[p]),(0,a.useEffect)(()=>{T&&he.current&&setTimeout(()=>{var e;return null===(e=he.current)||void 0===e?void 0:e.focus()},100)},[T]);const Bt=e=>{u(t=>tt(tt({},t),{},{supplier:e})),B(!1)},Lt=e=>{u(t=>tt(tt({},t),{},{category:e})),z(!1)},zt=()=>{const e=!c.unit||"satuan"===c.unit.toLowerCase(),t=!c.contentUnit||"satuan"===c.contentUnit.toLowerCase();if(!c.productName||c.pricePerUnit<=0||e||t)return pt(!0),gt(!0),e&&st(!0),t&&dt(!0),void setTimeout(()=>{pt(!1),gt(!1),st(!1),dt(!1)},500);l("left"),i("checkout")},Wt=()=>{l("right"),i("input")},Vt=async()=>{if(!Me){Re(!0),Oe("");try{const e=localStorage.getItem("access_token"),t={transaction_type:"pembelian",product_name:c.productName,product_barcode:c.productBarcode,quantity:c.quantity,unit:c.unit,units_per_pack:c.unitsPerPack,content_unit:c.contentUnit,price_per_unit:c.pricePerUnit,total_amount:c.totalPrice,harga_pokok:c.hargaPokok,harga_jual:_e,margin_percent:Ce,supplier_name:c.supplier,category:c.category,is_wholesale:c.isWholesale,has_discount:c.hasDiscount,has_ppn:c.hasPPN,payment_method:"tunai"===pe?"CASH":"transfer"===pe?"TRANSFER":"TEMPO",is_tempo:"tempo"===pe,due_date:ye,catatan:Ee,is_new_product:E},n=await fetch("/api/transactions/purchase",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await n.json();n.ok&&"success"===a.status?(rv.transactionComplete(),Mt(),We(a),Le(!0),r&&a.message&&r(a.message)):(Oe(a.message||a.detail||"Transaksi gagal"),setTimeout(()=>Oe(""),3e3))}catch(Z_){Oe("Transaksi gagal. Silakan coba lagi."),setTimeout(()=>Oe(""),3e3)}finally{Re(!1)}}},Ut=e=>"Rp ".concat(e.toLocaleString("id-ID")),Ht=(0,a.useCallback)(()=>{Le(!1),We(null),u({productName:"",productBarcode:"",quantity:0,unit:"",unitsPerPack:0,contentUnit:"",isWholesale:!0,supplier:"",date:(new Date).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}),pricePerUnit:0,totalPrice:0,hargaPokok:0,hasDiscount:!1,hasPPN:!1,category:""}),Ne(10),Se(0),Ae(""),Ke(0),fe("tunai"),i("input"),A(!1),w("")},[]),Gt=e=>e.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,".");return(0,Ue.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",background:Kb,fontFamily:"'Hiragino Kaku Gothic ProN', -apple-system, BlinkMacSystemFont, sans-serif"},children:[(0,Ue.jsx)(mt,{mode:"wait",children:"input"===o?(0,Ue.jsx)(yc.div,{initial:{x:"right"===s?"-100%":"100%"},animate:{x:0},exit:{x:"left"===s?"-100%":"100%"},transition:Qb,style:{flex:1,display:"flex",flexDirection:"column"},children:(0,Ue.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 flex-shrink-0",style:{height:"56px",paddingTop:"max(8px, env(safe-area-inset-top))"},children:[(0,Ue.jsx)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:Gb},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain"})}),(0,Ue.jsx)("span",{className:"font-semibold text-lg",style:{color:"#525252"},children:"Pembelian"})]}),(0,Ue.jsx)("div",{style:{padding:"0 16px 12px",flexShrink:0},children:(0,Ue.jsxs)("div",{style:{position:"relative"},children:[(0,Ue.jsx)("input",{ref:v,type:"text",value:b,onChange:e=>{w(e.target.value),j(e.target.value.length>0)},onFocus:()=>b&&j(!0),onBlur:()=>setTimeout(()=>j(!1),200),placeholder:"Input barcode atau ketik nama produk",style:{width:"100%",height:"48px",padding:"0 48px 0 16px",background:Yb,border:"none",borderRadius:"12px",fontSize:"14px",color:qb,outline:"none"}}),(0,Ue.jsx)("button",{onClick:()=>f(!0),style:{position:"absolute",right:"44px",top:"50%",transform:"translateY(-50%)",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",cursor:"pointer"},children:(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",style:{width:"22px",height:"22px"}})}),(0,Ue.jsx)("div",{style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)"},children:(0,Ue.jsx)(Lb,{variant:"icon-only",onBarcodeReceived:e=>Ft(e)})}),k&&b&&(0,Ue.jsx)("div",{style:{position:"absolute",top:"52px",left:0,right:0,background:"white",border:"1px solid ".concat(Kb),borderRadius:"12px",maxHeight:"200px",overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:50},children:_?(0,Ue.jsx)("div",{style:{padding:"12px 16px",fontSize:"14px",color:Ub},children:"Mencari..."}):C.length>0?C.map(e=>(0,Ue.jsxs)("div",{onClick:()=>(e=>{rv.itemAdded(),u(t=>tt(tt({},t),{},{productName:e.name,productBarcode:e.barcode||"",hargaPokok:e.harga_jual||t.hargaPokok,unit:e.satuan||t.unit,unitsPerPack:e.units_per_pack||t.unitsPerPack,category:e.category||t.category})),w(""),j(!1),N([]),A(!1)})(e),style:{padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid ".concat(Xb)},children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",fontWeight:500,color:qb},children:e.name}),(0,Ue.jsx)("div",{style:{fontSize:"12px",color:Ub},children:Ut(e.harga_jual||0)})]},e.id)):(0,Ue.jsxs)("div",{onClick:Ot,style:{padding:"12px 16px",cursor:"pointer"},children:[(0,Ue.jsxs)("div",{style:{fontSize:"14px",fontWeight:500,color:zb},children:['+ Tambah "',b,'" sebagai produk baru']}),(0,Ue.jsx)("div",{style:{fontSize:"12px",color:Ub},children:"Produk baru akan didaftarkan"})]})})]})}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",padding:"0 16px",minHeight:0,overflow:"auto"},children:[(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"8px",flex:1,minHeight:0},children:[(0,Ue.jsxs)("div",{style:{background:Yb,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[(0,Ue.jsx)("div",{style:{padding:"8px 8px",borderBottom:"1px solid ".concat(Kb),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:Ub,textAlign:"center"},children:"Rincian Produk"}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:"0 12px",background:Yb,borderBottom:"1px solid ".concat(Xb)},children:[(!c.productName||c.productName.split(" ").length<=2)&&(0,Ue.jsx)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left"},children:"Nama Produk"}),(0,Ue.jsx)(yc.div,{animate:ft&&!c.productName?"shake":"",variants:_t,style:{fontSize:"14px",fontWeight:600,color:c.productName?qb:Ub,textAlign:"left",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.3"},children:c.productName||"Pilih produk"}),E&&c.productName&&(0,Ue.jsx)("div",{style:{fontSize:"11px",color:zb,marginTop:"2px",textAlign:"left"},children:"Produk baru"})]}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center",padding:"0 12px",background:Xb,borderBottom:"1px solid ".concat(Kb)},children:[(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left"},children:"Kuantiti"}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{onClick:()=>{H(c.quantity>0?c.quantity.toString():""),K(c.unit),Ze(""),Qe(""),P(!0)},style:{color:Ub,flexShrink:0,cursor:"pointer",fontSize:"14px"},children:"\u270e"}),(0,Ue.jsx)(yc.span,{animate:ft&&(c.quantity<=0||!c.unit||"satuan"===c.unit.toLowerCase())?"shake":"",variants:_t,onClick:()=>{H(c.quantity>0?c.quantity.toString():""),K(c.unit),Ze(""),Qe(""),P(!0)},style:{fontSize:"14px",fontWeight:600,color:c.quantity>0||c.unit?qb:Ub,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",display:"inline-block"},children:c.quantity>0||c.unit?"".concat(c.quantity," ").concat(c.unit||"satuan"):"0 satuan"})]})]}),(0,Ue.jsx)("span",{onClick:()=>{u(e=>tt(tt({},e),{},{quantity:e.quantity+1})),rv.itemAdded()},style:{width:"31px",height:"31px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",background:Kb,color:Vb,fontSize:"22px",fontWeight:700,cursor:"pointer",flexShrink:0},children:"+"})]}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",padding:"0 12px",background:Yb},children:c.isWholesale?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},children:[(0,Ue.jsxs)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Isi per ",c.unit.toLowerCase()||"satuan"]}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{onClick:()=>{Z(c.unitsPerPack>0?c.unitsPerPack.toString():""),Q(c.contentUnit),et(""),rt(""),M(!0)},style:{color:Ub,flexShrink:0,cursor:"pointer",fontSize:"14px"},children:"\u270e"}),(0,Ue.jsxs)(yc.span,{animate:ft&&(c.unitsPerPack<=0||!c.contentUnit||"satuan"===c.contentUnit.toLowerCase())?"shake":"",variants:_t,onClick:()=>{Z(c.unitsPerPack>0?c.unitsPerPack.toString():""),Q(c.contentUnit),et(""),rt(""),M(!0)},style:{fontSize:"14px",fontWeight:600,color:c.unitsPerPack>0?qb:Ub,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",display:"inline-block"},children:[c.unitsPerPack," ",c.contentUnit||"satuan"]})]})]}),(0,Ue.jsx)("span",{onClick:()=>{u(e=>tt(tt({},e),{},{unitsPerPack:e.unitsPerPack+1})),rv.itemAdded()},style:{width:"31px",height:"31px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",background:Kb,color:Vb,fontSize:"22px",fontWeight:700,cursor:"pointer",flexShrink:0},children:"+"})]}):(0,Ue.jsx)("div",{style:{flex:1}})})]}),(0,Ue.jsxs)("div",{style:{background:Yb,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[(0,Ue.jsx)("div",{style:{padding:"8px 8px",borderBottom:"1px solid ".concat(Kb),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:Ub,textAlign:"center"},children:"Rincian Pembelian"}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"0 12px",background:Yb,borderBottom:"1px solid ".concat(Xb)},children:(0,Ue.jsx)(rw,{checked:c.isWholesale,onChange:e=>u(t=>tt(tt({},t),{},{isWholesale:e})),labelOn:"wholesales",labelOff:"ecer"})}),(0,Ue.jsxs)("div",{onClick:()=>{ae(c.supplier),B(!0)},style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:"0 12px",background:Xb,borderBottom:"1px solid ".concat(Kb),cursor:"pointer"},children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left"},children:"Supplier"}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:Ub,flexShrink:0,fontSize:"14px"},children:"\u270e"}),(0,Ue.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:c.supplier?qb:Ub,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c.supplier||"nama suplier"})]})]}),(0,Ue.jsxs)("div",{onClick:()=>V(!0),style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:"0 12px",background:Yb,cursor:"pointer"},children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left"},children:"Tanggal"}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:Ub,flexShrink:0,fontSize:"14px"},children:"\u270e"}),(0,Ue.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:qb,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c.date})]})]})]})]}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",flex:1,minHeight:0},children:[(0,Ue.jsxs)("div",{style:{background:Yb,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[(0,Ue.jsx)("div",{style:{padding:"8px 8px",borderBottom:"1px solid ".concat(Kb),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:Ub,textAlign:"center"},children:"Pricing"}),(0,Ue.jsxs)("div",{onClick:()=>{ne(c.pricePerUnit>0?c.pricePerUnit.toString():""),F(!0)},style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:"0 12px",background:c.pricePerUnit>0?"#FFF7ED":Yb,borderBottom:"1px solid ".concat(Xb),cursor:"pointer",borderLeft:c.pricePerUnit>0?"3px solid ".concat(zb):"none"},children:[(0,Ue.jsxs)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Harga per ",c.unit||"satuan"]}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:"#9CA3AF",flexShrink:0},children:"\u270e"}),(0,Ue.jsx)(yc.span,{animate:ft&&c.pricePerUnit<=0?"shake":"",variants:_t,style:{fontSize:"15px",fontWeight:700,color:qb,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},children:Ut(c.pricePerUnit)})]})]}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:"0 12px",background:Xb,borderBottom:"1px solid ".concat(Kb)},children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left"},children:"Total Bayar"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:qb,textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Ut(c.totalPrice)})]}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:"0 12px",background:Yb},children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left"},children:"HPP"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:qb,textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Ut(c.hargaPokok)})]})]}),(0,Ue.jsxs)("div",{style:{background:Yb,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[(0,Ue.jsx)("div",{style:{padding:"8px 8px",borderBottom:"1px solid ".concat(Kb),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:Ub,textAlign:"center"},children:"Extra"}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"0 12px",background:Yb,borderBottom:"1px solid ".concat(Xb),gap:"8px"},children:[(0,Ue.jsx)(rw,{checked:c.hasDiscount,onChange:e=>{u(t=>tt(tt({},t),{},{hasDiscount:e})),e&&0===Ge&&Ke(5)},labelOn:"".concat(Ge,"%"),labelOff:"diskon off"}),c.hasDiscount&&(0,Ue.jsx)("span",{onClick:()=>Ye(!0),style:{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",background:zb,color:"white",fontSize:"16px",fontWeight:600,cursor:"pointer",flexShrink:0},children:"+"})]}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"0 12px",background:Xb,borderBottom:"1px solid ".concat(Kb)},children:(0,Ue.jsx)(rw,{checked:c.hasPPN,onChange:e=>u(t=>tt(tt({},t),{},{hasPPN:e})),labelOn:"PPN",labelOff:"PPN off"})}),(0,Ue.jsxs)("div",{onClick:()=>{ie(c.category),z(!0)},style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:"0 12px",background:Yb,cursor:"pointer"},children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",color:Ub,marginBottom:"2px",textAlign:"left"},children:"Kategori Produk"}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:Ub,flexShrink:0,fontSize:"14px"},children:"\u270e"}),(0,Ue.jsx)("span",{style:{fontSize:"14px",fontWeight:600,color:c.category?qb:Ub,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c.category||"Tulis Kategori"})]})]})]})]})]}),Fe&&"input"===o&&(0,Ue.jsx)("div",{style:{padding:"8px 16px",background:"#FEE2E2",color:"#DC2626",textAlign:"center",fontSize:"13px",fontWeight:500},children:Fe}),(0,Ue.jsxs)("div",{style:{flexShrink:0,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",padding:"12px 16px",background:Kb,paddingBottom:"max(12px, env(safe-area-inset-bottom))"},children:[(0,Ue.jsx)("button",{onClick:()=>{c.productBarcode||f(!0)},disabled:!!c.productBarcode,style:{padding:c.productBarcode?"6px 10px":"14px",background:Yb,color:"#525252",border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:600,cursor:c.productBarcode?"default":"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"48px"},children:c.productBarcode?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("span",{style:{fontSize:"10px",fontWeight:400,color:Ub,marginBottom:"1px"},children:"barcode"}),(0,Ue.jsx)("span",{style:{fontSize:"12px",fontWeight:600,color:qb,letterSpacing:"0.5px"},children:c.productBarcode})]}):"Scan Barcode"}),(0,Ue.jsx)(yc.button,{animate:ht?"shake":"",variants:_t,onClick:zt,style:{padding:"14px",background:zb,color:"white",border:"none",borderRadius:"12px",fontSize:"15px",fontWeight:700,cursor:"pointer"},children:"Next"})]})]})},"input"):(0,Ue.jsx)(yc.div,{initial:{x:"right"===s?"-100%":"100%"},animate:{x:0},exit:{x:"left"===s?"-100%":"100%"},transition:Qb,style:{flex:1,display:"flex",flexDirection:"column"},children:(0,Ue.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 flex-shrink-0",style:{height:"56px",paddingTop:"max(8px, env(safe-area-inset-top))"},children:[(0,Ue.jsx)("button",{onClick:Wt,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:Gb},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain"})}),(0,Ue.jsx)("span",{className:"font-semibold text-lg",style:{color:"#525252"},children:"Back"})]}),(0,Ue.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",padding:"0 16px",minHeight:0,overflow:"auto"},children:[(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"10px",flex:1,minHeight:0},children:[(0,Ue.jsxs)("div",{style:{background:Yb,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("div",{style:{flexShrink:0,padding:"10px 12px",borderBottom:"1px solid ".concat(Kb),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:Ub,textAlign:"center"},children:"tempo"===pe?"Hutang":"Kas & Bank"}),"tempo"===pe?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{onClick:()=>we(!0),style:{flex:1,padding:"10px 12px",background:Yb,cursor:"pointer",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"Jatuh Tempo"}),(0,Ue.jsxs)("div",{style:{fontSize:"14px",fontWeight:600,color:qb,textAlign:"left",display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:Ub},children:"\u270e"})," ",ye]})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:Xb,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"Nilai Hutang"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:qb,textAlign:"left"},children:Ut(c.totalPrice)})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:Yb,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"Total Hutang Toko"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:qb,textAlign:"left"},children:Ut(xe+c.totalPrice)})]})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:Yb,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"tunai"===pe?"Kas Toko":"Kas Bank"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:qb,textAlign:"left"},children:Ut("tunai"===pe?ge:me)})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:Xb,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"Total Bayar"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:qb,textAlign:"left"},children:Ut(c.totalPrice)})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:Yb,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"tunai"===pe?"Update Kas Toko":"Update Kas Bank"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:"#EF4444",textAlign:"left"},children:Ut("tunai"===pe?ge-c.totalPrice:me-c.totalPrice)})]})]})]}),(0,Ue.jsxs)("div",{style:{background:Yb,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("div",{style:{flexShrink:0,padding:"10px 12px",borderBottom:"1px solid ".concat(Kb),background:"#FAFAFA",fontSize:"12px",fontWeight:600,color:Ub,textAlign:"center"},children:"Cara Bayar"}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 12px",background:"tunai"===pe?"#FFF7ED":Yb,borderBottom:"1px solid ".concat(Xb)},children:(0,Ue.jsx)(rw,{checked:"tunai"===pe,onChange:()=>fe("tunai"),labelOn:"Tunai",labelOff:"Tunai off"})}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 12px",background:"transfer"===pe?"#FFF7ED":Xb,borderBottom:"1px solid ".concat(Kb)},children:(0,Ue.jsx)(rw,{checked:"transfer"===pe,onChange:()=>fe("transfer"),labelOn:"Transfer",labelOff:"Transfer off"})}),(0,Ue.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 12px",background:"tempo"===pe?"#FFF7ED":Yb},children:(0,Ue.jsx)(rw,{checked:"tempo"===pe,onChange:()=>fe("tempo"),labelOn:"Tempo",labelOff:"Tempo off"})})]})]}),(0,Ue.jsxs)("div",{style:{display:"flex",gap:"10px",flex:1,minHeight:0},children:[(0,Ue.jsxs)("div",{style:{flex:"1 1 75%",background:Yb,borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("div",{style:{flexShrink:0,padding:"10px 12px",borderBottom:"1px solid ".concat(Kb),background:"#FAFAFA",textAlign:"center"},children:(0,Ue.jsx)("span",{style:{fontSize:"12px",fontWeight:600,color:Ub},children:"Sales Pricing"})}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:Yb,borderBottom:"1px solid ".concat(Xb),display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"14px",fontWeight:700,color:qb,textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:c.productName}),(0,Ue.jsxs)("div",{style:{fontSize:"12px",color:Ub,textAlign:"left"},children:["Barcode ",c.productBarcode||"-"]})]}),(0,Ue.jsxs)("div",{style:{flex:1,padding:"10px 12px",background:Xb,borderBottom:"1px solid ".concat(Kb),display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"Harga Pokok Produksi"}),(0,Ue.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:qb,textAlign:"left"},children:Ut(c.hargaPokok)})]}),(0,Ue.jsxs)("div",{onClick:()=>{kt(_e.toString()),bt(!0)},style:{flex:1,padding:"10px 12px",background:Yb,borderBottom:"1px solid ".concat(Xb),cursor:"pointer",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"Harga Jual"}),(0,Ue.jsxs)("div",{style:{fontSize:"15px",fontWeight:700,color:qb,textAlign:"left",display:"flex",alignItems:"center",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:Ub},children:"\u270e"})," ",Ut(_e)]})]}),(0,Ue.jsxs)("div",{onClick:()=>{De(Ee),Te(!0)},style:{flex:1,padding:"10px 12px",background:Yb,cursor:"pointer",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Ub,textAlign:"left"},children:"Catatan"}),(0,Ue.jsxs)("div",{style:{fontSize:"13px",color:qb,textAlign:"left",display:"flex",alignItems:"flex-start",gap:"4px"},children:[(0,Ue.jsx)("span",{style:{color:Ub},children:"\u270e"}),(0,Ue.jsx)("span",{style:{color:Ee?qb:Hb},children:Ee||"Tambah catatan..."})]})]})]}),(0,Ue.jsx)(aw,{value:Et,displayValue:St,onChange:e=>{if(Ne(e),c.hargaPokok>0){const t=Math.round(c.hargaPokok*(1+e/100));Se(t)}}})]})]}),(0,Ue.jsxs)("div",{style:{flexShrink:0,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",padding:"12px 16px",background:Kb,paddingBottom:"max(12px, env(safe-area-inset-bottom))"},children:[(0,Ue.jsx)("button",{onClick:n,style:{padding:"14px",background:Yb,color:"#525252",border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Draft"}),(0,Ue.jsx)("button",{onClick:Vt,disabled:Me,style:{padding:"14px",background:Me?"#94A3B8":Wb,color:"white",border:"none",borderRadius:"12px",fontSize:"15px",fontWeight:700,cursor:Me?"not-allowed":"pointer"},children:Me?"Menyimpan...":"Simpan"})]})]})},"checkout")}),(0,Ue.jsx)(Sb,{isOpen:p,onClose:()=>f(!1),onBarcodeDetected:e=>{Ft(e),f(!1)}}),(0,Ue.jsx)(mt,{children:T&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>P(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"320px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"left"},children:"Kuantiti"}),(0,Ue.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,Ue.jsx)("label",{style:{fontSize:"13px",color:Ub,display:"block",marginBottom:"8px",textAlign:"left"},children:"Jumlah"}),(0,Ue.jsx)(yc.div,{animate:at?"shake":"",variants:_t,style:{position:"relative"},children:(0,Ue.jsx)("input",{ref:he,type:"text",inputMode:"numeric",value:Gt(U),onChange:e=>{H(e.target.value.replace(/\D/g,""))},placeholder:"",style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"18px",border:"1px solid ".concat(Kb),borderRadius:"8px",outline:"none"}})})]}),(0,Ue.jsxs)("div",{style:{position:"relative",marginBottom:"24px"},children:[(0,Ue.jsx)("label",{style:{fontSize:"13px",color:Ub,display:"block",marginBottom:"8px",textAlign:"left"},children:c.isWholesale?"Satuan Wholesales":"Satuan Ecer"}),(0,Ue.jsx)(yc.div,{animate:it?"shake":"",variants:_t,style:{position:"relative"},children:(0,Ue.jsx)("input",{ref:de,type:"text",value:G,onChange:e=>{K(e.target.value),Y(!0)},onFocus:()=>Y(!0),onBlur:()=>setTimeout(()=>Y(!1),200),placeholder:c.isWholesale?"ketik lusin/karton/dus...":"ketik pcs/batang/lembar...",style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"16px",border:"2px solid ".concat(G?zb:Kb),borderRadius:"8px",outline:"none"}})}),X&&(0,Ue.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"white",border:"1px solid ".concat(Kb),borderRadius:"8px",marginTop:"4px",maxHeight:"180px",overflowY:"auto",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",zIndex:10},children:[(()=>{const e=c.isWholesale?$b:ew;return(G?e.filter(e=>e.toLowerCase().includes(G.toLowerCase())):e).map(e=>(0,Ue.jsx)("div",{onClick:()=>{K(e),Y(!1)},style:{padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid ".concat(Xb),fontSize:"14px",background:G.toLowerCase()===e.toLowerCase()?"#FFF7ED":"white"},children:e},e))})(),G&&!(c.isWholesale?$b:ew).some(e=>e.toLowerCase()===G.toLowerCase())&&(0,Ue.jsxs)("div",{onClick:()=>{const e=G.charAt(0).toUpperCase()+G.slice(1).toLowerCase();c.isWholesale?$b.push(e):ew.push(e),K(e),Y(!1)},style:{padding:"12px 16px",cursor:"pointer",fontSize:"14px",color:zb,fontWeight:600,background:"#FFF7ED"},children:['+ Tambah "',G,'" sebagai satuan baru']})]})]}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:()=>{P(!1),Y(!1)},style:{padding:"12px",background:Xb,border:"none",borderRadius:"8px",fontWeight:600},children:"Batal"}),(0,Ue.jsx)(yc.button,{animate:xt?"shake":"",variants:_t,onClick:()=>{let e=!1;!U.trim()||parseInt(U)<=0?(Ze("Input jumlah"),ot(!0),setTimeout(()=>ot(!1),500),e=!0):Ze("");const t=/^\d+$/.test(G.trim());if(!G.trim()||t?(Qe("Input satuan"),st(!0),setTimeout(()=>st(!1),500),e=!0):Qe(""),e)return yt(!0),void setTimeout(()=>yt(!1),500);const n=parseInt(U)||1,r=G.trim();u(e=>tt(tt({},e),{},{quantity:Math.max(1,n),unit:r})),P(!1),Y(!1),Ze(""),Qe("")},style:{padding:"12px",background:zb,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Simpan"})]})]})})}),(0,Ue.jsx)(mt,{children:D&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>M(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"320px"},children:[(0,Ue.jsxs)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"left"},children:["Isi per ",c.unit||"satuan"]}),(0,Ue.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,Ue.jsx)("label",{style:{fontSize:"13px",color:Ub,display:"block",marginBottom:"8px",textAlign:"left"},children:"Jumlah"}),(0,Ue.jsx)(yc.div,{animate:lt?"shake":"",variants:_t,style:{position:"relative"},children:(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:Gt(q),onChange:e=>{Z(e.target.value.replace(/\D/g,""))},autoFocus:!0,style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"18px",border:"1px solid ".concat(Kb),borderRadius:"8px",outline:"none"}})})]}),(0,Ue.jsxs)("div",{style:{position:"relative",marginBottom:"24px"},children:[(0,Ue.jsx)("label",{style:{fontSize:"13px",color:Ub,display:"block",marginBottom:"8px",textAlign:"left"},children:"Satuan"}),(0,Ue.jsx)(yc.div,{animate:ut?"shake":"",variants:_t,style:{position:"relative"},children:(0,Ue.jsx)("input",{type:"text",value:J,onChange:e=>{Q(e.target.value),ee(e.target.value.length>0)},onFocus:()=>ee(!0),placeholder:"ketik pcs/lembar/bungkus...",style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"16px",border:"2px solid ".concat(J?zb:Kb),borderRadius:"8px",outline:"none"}})}),$&&(0,Ue.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"white",border:"1px solid ".concat(Kb),borderRadius:"8px",marginTop:"4px",maxHeight:"150px",overflowY:"auto",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",zIndex:10},children:[(J?At:ew).map(e=>(0,Ue.jsx)("div",{onClick:()=>{Q(e),ee(!1)},style:{padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid ".concat(Xb),fontSize:"14px",background:J.toLowerCase()===e.toLowerCase()?"#FFF7ED":"white"},children:e},e)),J&&!ew.some(e=>e.toLowerCase()===J.toLowerCase())&&(0,Ue.jsxs)("div",{onClick:()=>{const e=J.charAt(0).toUpperCase()+J.slice(1).toLowerCase();Q(e),ee(!1)},style:{padding:"12px 16px",cursor:"pointer",fontSize:"14px",color:zb,fontWeight:600,background:"#FFF7ED"},children:['+ Tambah "',J,'" sebagai satuan baru']})]})]}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:()=>{M(!1),ee(!1)},style:{padding:"12px",background:Xb,border:"none",borderRadius:"8px",fontWeight:600},children:"Batal"}),(0,Ue.jsx)(yc.button,{animate:xt?"shake":"",variants:_t,onClick:()=>{let e=!1;!q.trim()||parseInt(q)<=0?(et("Input jumlah"),ct(!0),setTimeout(()=>ct(!1),500),e=!0):et("");const t=/^\d+$/.test(J.trim());if(!J.trim()||t?(rt("Input satuan"),dt(!0),setTimeout(()=>dt(!1),500),e=!0):rt(""),e)return yt(!0),void setTimeout(()=>yt(!1),500);const n=parseInt(q)||1,r=J.trim();u(e=>tt(tt({},e),{},{unitsPerPack:Math.max(1,n),contentUnit:r})),M(!1),ee(!1),et(""),rt("")},style:{padding:"12px",background:zb,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Simpan"})]})]})})}),(0,Ue.jsx)(mt,{children:R&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>F(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"300px"},children:[(0,Ue.jsxs)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"left"},children:["Harga per ",c.unit||"satuan"]}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:Gt(te),onChange:e=>ne(e.target.value.replace(/\D/g,"")),autoFocus:!0,style:{width:"100%",height:"48px",textAlign:"center",fontSize:"24px",border:"1px solid ".concat(Kb),borderRadius:"8px",marginBottom:"16px"}}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:()=>F(!1),style:{padding:"12px",background:Xb,border:"none",borderRadius:"8px",fontWeight:600},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{const e=parseInt(te.replace(/\D/g,""))||0;u(t=>tt(tt({},t),{},{pricePerUnit:e})),F(!1)},style:{padding:"12px",background:zb,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Simpan"})]})]})})}),(0,Ue.jsx)(mt,{children:O&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>B(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"300px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"left"},children:"Supplier"}),(0,Ue.jsx)("input",{type:"text",value:re,onChange:e=>ae(e.target.value),placeholder:"Ketik nama supplier",autoFocus:!0,style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"14px",border:"2px solid ".concat(zb),borderRadius:"8px",marginBottom:"8px",outline:"none"}}),(0,Ue.jsxs)("div",{style:{maxHeight:"200px",overflowY:"auto",marginBottom:"16px"},children:[It.map(e=>(0,Ue.jsx)("div",{onClick:()=>Bt(e),style:{padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid ".concat(Xb),fontSize:"14px",color:qb,background:c.supplier===e?"#FFF7ED":"white"},children:e},e)),re.trim()&&!nw.some(e=>e.toLowerCase()===re.toLowerCase())&&(0,Ue.jsxs)("div",{onClick:()=>{const e=re.trim();nw.push(e),Bt(e)},style:{padding:"12px 16px",cursor:"pointer",fontSize:"14px",color:zb,fontWeight:600,background:"#FFF7ED"},children:['+ "',re,'" sebagai suplier baru']})]}),(0,Ue.jsx)("button",{onClick:()=>B(!1),style:{width:"100%",padding:"12px",background:Xb,border:"none",borderRadius:"8px",fontWeight:600},children:"Batal"})]})})}),(0,Ue.jsx)(mt,{children:L&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>z(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"320px",maxHeight:"70vh",display:"flex",flexDirection:"column"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"left"},children:"Kategori Produk"}),(0,Ue.jsx)("input",{type:"text",value:oe,onChange:e=>ie(e.target.value),placeholder:"Cari atau tambah kategori...",autoFocus:!0,style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"14px",border:"2px solid ".concat(zb),borderRadius:"8px",marginBottom:"8px",outline:"none"}}),(0,Ue.jsxs)("div",{style:{flex:1,overflowY:"auto"},children:[Tt.map(e=>(0,Ue.jsx)("div",{onClick:()=>Lt(e),style:{padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid ".concat(Xb),fontSize:"14px",color:qb,background:c.category===e?"#FFF7ED":"white"},children:e},e)),oe.trim()&&!ce.some(e=>e.toLowerCase()===oe.toLowerCase())&&(0,Ue.jsxs)("div",{onClick:()=>{const e=oe.trim();ue(t=>[...t,e]),Lt(e)},style:{padding:"12px 16px",cursor:"pointer",fontSize:"14px",color:zb,fontWeight:600,background:"#FFF7ED"},children:['+ "',oe,'" sebagai kategori baru']})]}),(0,Ue.jsx)("button",{onClick:()=>z(!1),style:{width:"100%",padding:"12px",background:Xb,border:"none",borderRadius:"8px",fontWeight:600,marginTop:"12px"},children:"Batal"})]})})}),(0,Ue.jsx)(mt,{children:Xe&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>Ye(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"flex-start",justifyContent:"center",paddingTop:"20vh"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"280px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"center"},children:"Diskon %"}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px",marginBottom:"24px"},children:[(0,Ue.jsx)("button",{onClick:()=>{const e=Math.max(0,Ge-1);Ke(e),0===e&&u(e=>tt(tt({},e),{},{hasDiscount:!1}))},style:{width:"40px",height:"40px",borderRadius:"50%",background:Kb,border:"none",fontSize:"20px",fontWeight:600,cursor:"pointer"},children:"-"}),(0,Ue.jsxs)("span",{style:{fontSize:"32px",fontWeight:700,color:zb,minWidth:"60px",textAlign:"center"},children:[Ge,"%"]}),(0,Ue.jsx)("button",{onClick:()=>Ke(e=>Math.min(100,e+1)),style:{width:"40px",height:"40px",borderRadius:"50%",background:zb,border:"none",color:"white",fontSize:"20px",fontWeight:600,cursor:"pointer"},children:"+"})]}),(0,Ue.jsx)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",justifyContent:"center",marginBottom:"16px"},children:[5,10,15,20,25,50].map(e=>(0,Ue.jsxs)("button",{onClick:()=>Ke(e),style:{padding:"8px 12px",borderRadius:"8px",background:Ge===e?zb:Xb,color:Ge===e?"white":qb,border:"none",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:[e,"%"]},e))}),(0,Ue.jsx)("button",{onClick:()=>{0===Ge&&u(e=>tt(tt({},e),{},{hasDiscount:!1})),Ye(!1)},style:{width:"100%",padding:"12px",background:zb,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Simpan"})]})})}),(0,Ue.jsx)(mt,{children:W&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>V(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"320px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"center"},children:"Pilih Tanggal"}),(0,Ue.jsx)("input",{type:"date",defaultValue:(()=>{const e=c.date.split("/");return 3===e.length?"".concat(e[2],"-").concat(e[1],"-").concat(e[0]):(new Date).toISOString().split("T")[0]})(),onChange:e=>{const t=new Date(e.target.value).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"});u(e=>tt(tt({},e),{},{date:t}))},style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"16px",border:"2px solid ".concat(zb),borderRadius:"8px",outline:"none",marginBottom:"16px"}}),(0,Ue.jsx)("button",{onClick:()=>V(!1),style:{width:"100%",padding:"12px",background:zb,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Pilih"})]})})}),(0,Ue.jsx)(mt,{children:be&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>we(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"320px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"center"},children:"Jatuh Tempo"}),(0,Ue.jsx)("input",{type:"date",defaultValue:(()=>{const e=new Date;return e.setDate(e.getDate()+30),e.toISOString().split("T")[0]})(),onChange:e=>{const t=new Date(e.target.value).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"});ve(t)},style:{width:"100%",height:"48px",padding:"0 16px",fontSize:"16px",border:"2px solid ".concat(zb),borderRadius:"8px",outline:"none",marginBottom:"16px"}}),(0,Ue.jsx)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",justifyContent:"center",marginBottom:"16px"},children:[7,14,30,60,90].map(e=>{const t=new Date;return t.setDate(t.getDate()+e),(0,Ue.jsxs)("button",{onClick:()=>{const e=t.toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"});ve(e),we(!1)},style:{padding:"8px 12px",borderRadius:"8px",background:Xb,color:qb,border:"none",fontSize:"13px",fontWeight:600,cursor:"pointer"},children:[e," hari"]},e)})}),(0,Ue.jsx)("button",{onClick:()=>we(!1),style:{width:"100%",padding:"12px",background:zb,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Pilih"})]})})}),(0,Ue.jsx)(mt,{children:vt&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>bt(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"300px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"left"},children:"Harga Jual"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:Gt(wt),onChange:e=>kt(e.target.value.replace(/\D/g,"")),autoFocus:!0,style:{width:"100%",height:"48px",textAlign:"center",fontSize:"24px",border:"1px solid ".concat(Kb),borderRadius:"8px",marginBottom:"16px"}}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:()=>bt(!1),style:{padding:"12px",background:Xb,border:"none",borderRadius:"8px",fontWeight:600},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{const e=parseInt(wt)||0;Se(e),bt(!1)},style:{padding:"12px",background:zb,color:"white",border:"none",borderRadius:"8px",fontWeight:600},children:"Simpan"})]})]})})}),(0,Ue.jsx)(mt,{children:Ie&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>Te(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},onClick:e=>e.stopPropagation(),style:{background:"white",borderRadius:"12px",padding:"24px",width:"100%",maxWidth:"320px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"16px",color:qb,textAlign:"left"},children:"Catatan"}),(0,Ue.jsx)("textarea",{value:Pe,onChange:e=>De(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Ae(Pe.trim()),Te(!1))},placeholder:"Tambah catatan untuk transaksi ini...",autoFocus:!0,rows:4,style:{width:"100%",padding:"12px",fontSize:"14px",border:"1px solid ".concat(Kb),borderRadius:"8px",marginBottom:"16px",resize:"none",fontFamily:"inherit"}}),(0,Ue.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:()=>Te(!1),style:{padding:"12px",background:Xb,border:"none",borderRadius:"8px",fontWeight:600,cursor:"pointer"},children:"Batal"}),(0,Ue.jsx)("button",{onClick:()=>{Ae(Pe.trim()),Te(!1)},style:{padding:"12px",background:zb,color:"white",border:"none",borderRadius:"8px",fontWeight:600,cursor:"pointer"},children:"Simpan"})]})]})})}),jt&&(0,Ue.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:200},children:(0,Ue.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:"20px",margin:"16px",maxWidth:"320px"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,marginBottom:"8px",color:qb},children:"Lanjutkan Pembelian?"}),(0,Ue.jsx)("p",{style:{fontSize:"14px",marginBottom:"16px",color:Ub},children:"Anda memiliki data pembelian yang belum selesai. Lanjutkan atau mulai baru?"}),(0,Ue.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,Ue.jsx)("button",{onClick:Dt,style:{flex:1,padding:"12px",border:"1px solid ".concat(Kb),background:"white",borderRadius:"8px",fontWeight:600,color:Ub,cursor:"pointer"},children:"Mulai Baru"}),(0,Ue.jsx)("button",{onClick:Pt,style:{flex:1,padding:"12px",border:"none",background:zb,color:"white",borderRadius:"8px",fontWeight:600,cursor:"pointer"},children:"Lanjutkan"})]})]})}),(0,Ue.jsx)(mt,{children:ke&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>je(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.3)",zIndex:99}}),(0,Ue.jsxs)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:30,stiffness:300},style:{position:"fixed",right:0,top:0,bottom:0,width:"85%",maxWidth:"380px",background:Xb,zIndex:100,display:"flex",flexDirection:"column",boxShadow:"-4px 0 8px rgba(0,0,0,0.1)"},children:[(0,Ue.jsxs)("div",{style:{padding:"16px",background:Yb,borderBottom:"1px solid ".concat(Kb),display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:"max(16px, env(safe-area-inset-top))"},children:[(0,Ue.jsx)("h3",{style:{fontSize:"16px",fontWeight:600,color:qb},children:"Sales Pricing"}),(0,Ue.jsx)("button",{onClick:()=>je(!1),style:{width:"32px",height:"32px",border:"none",background:"transparent",fontSize:"20px",cursor:"pointer",color:Ub},children:"\xd7"})]}),(0,Ue.jsxs)("div",{style:{padding:"16px",background:Yb,borderBottom:"1px solid ".concat(Kb)},children:[(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",color:Ub},children:"Margin"}),(0,Ue.jsxs)("span",{style:{fontSize:"16px",fontWeight:700,color:zb,background:"#FFF7ED",padding:"4px 12px",borderRadius:"16px"},children:[Ce,"%"]})]}),(0,Ue.jsx)("input",{type:"range",min:"0",max:"100",value:Ce,onChange:e=>Ne(parseInt(e.target.value)),style:{width:"100%",height:"6px",borderRadius:"3px",background:Kb,outline:"none"}})]}),(0,Ue.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"16px"},children:[(0,Ue.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,Ue.jsx)("h4",{style:{fontSize:"15px",fontWeight:600,color:qb,marginBottom:"4px"},children:c.productName||"Pilih produk"}),(0,Ue.jsxs)("div",{style:{fontSize:"13px",color:Ub},children:["Barcode ",c.productBarcode||"-"]})]}),(0,Ue.jsxs)("div",{style:{background:Yb,borderRadius:"12px",padding:"16px",marginBottom:"16px"},children:[(0,Ue.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",color:Ub},children:"Harga Pokok Produksi"}),(0,Ue.jsx)("span",{style:{fontSize:"14px",fontWeight:600},children:Ut(c.hargaPokok)})]}),(0,Ue.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"12px",borderTop:"1px solid ".concat(Kb)},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",color:Ub},children:"Harga Jual"}),(0,Ue.jsx)("span",{style:{fontSize:"16px",fontWeight:700,color:zb},children:Ut(_e)})]})]}),(0,Ue.jsxs)("div",{style:{background:Yb,borderRadius:"12px",padding:"16px"},children:[(0,Ue.jsx)("div",{style:{fontSize:"13px",color:Ub,marginBottom:"8px"},children:"Catatan"}),(0,Ue.jsx)("textarea",{value:Ee,onChange:e=>Ae(e.target.value),placeholder:"Tambahkan catatan...",style:{width:"100%",minHeight:"80px",padding:"12px",border:"1px solid ".concat(Kb),borderRadius:"8px",fontSize:"14px",resize:"vertical",outline:"none"}})]})]}),(0,Ue.jsx)("div",{style:{padding:"16px",background:Yb,borderTop:"1px solid ".concat(Kb),paddingBottom:"max(16px, env(safe-area-inset-bottom))"},children:(0,Ue.jsx)("button",{onClick:()=>je(!1),style:{width:"100%",padding:"14px",background:zb,color:"white",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:600,cursor:"pointer"},children:"Terapkan"})})]})]})}),(0,Ue.jsx)(mt,{children:Be&&(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:200,display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},style:{background:"white",borderRadius:"16px",maxWidth:"380px",width:"100%",maxHeight:"90vh",overflow:"auto"},children:[(0,Ue.jsxs)("div",{style:{textAlign:"center",padding:"24px 20px 16px",borderBottom:"1px dashed ".concat(Kb)},children:[(0,Ue.jsx)("h2",{style:{fontSize:"18px",fontWeight:700,color:qb,margin:0},children:"Warung Evlogia"}),(0,Ue.jsx)("p",{style:{fontSize:"12px",color:Ub,margin:"4px 0 0"},children:"Jalan Atput II No.16 Bandung"}),(0,Ue.jsxs)("p",{style:{fontSize:"11px",color:Hb,margin:"2px 0 0"},children:[(new Date).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})," \u2022 ",(new Date).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})]})]}),(0,Ue.jsx)("div",{style:{padding:"12px 20px",textAlign:"center"},children:(0,Ue.jsx)("span",{style:{display:"inline-block",padding:"4px 12px",background:"#FFF7ED",color:zb,borderRadius:"20px",fontSize:"12px",fontWeight:600},children:"KULAKAN / PEMBELIAN"})}),(0,Ue.jsx)("div",{style:{padding:"0 20px 16px"},children:(0,Ue.jsx)("table",{style:{width:"100%",borderCollapse:"collapse"},children:(0,Ue.jsxs)("tbody",{children:[(0,Ue.jsxs)("tr",{children:[(0,Ue.jsxs)("td",{style:{padding:"8px 0",fontSize:"14px",color:qb,fontWeight:500},children:[c.productName||"Produk",c.productBarcode&&(0,Ue.jsx)("div",{style:{fontSize:"11px",color:Hb,marginTop:"2px"},children:c.productBarcode})]}),(0,Ue.jsxs)("td",{style:{padding:"8px 0",fontSize:"14px",color:qb,textAlign:"right"},children:[c.quantity," ",c.unit]})]}),(0,Ue.jsxs)("tr",{children:[(0,Ue.jsxs)("td",{style:{padding:"4px 0",fontSize:"13px",color:Ub},children:["@ ",Ut(c.pricePerUnit),"/",c.unit]}),(0,Ue.jsx)("td",{style:{padding:"4px 0",fontSize:"14px",color:qb,textAlign:"right",fontWeight:600},children:Ut(c.totalPrice)})]})]})})}),(0,Ue.jsx)("div",{style:{borderTop:"1px dashed ".concat(Kb),margin:"0 20px"}}),(0,Ue.jsxs)("div",{style:{padding:"16px 20px"},children:[(0,Ue.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",color:Ub},children:"Harga Pokok"}),(0,Ue.jsx)("span",{style:{fontSize:"13px",color:qb},children:Ut(c.hargaPokok)})]}),(0,Ue.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",color:Ub},children:"Harga Jual"}),(0,Ue.jsx)("span",{style:{fontSize:"13px",color:qb},children:Ut(_e)})]}),(0,Ue.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",color:Ub},children:"Margin"}),(0,Ue.jsxs)("span",{style:{fontSize:"13px",color:St>=0?Zb:Jb},children:[St,"%"]})]}),c.supplier&&(0,Ue.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",color:Ub},children:"Supplier"}),(0,Ue.jsx)("span",{style:{fontSize:"13px",color:qb},children:c.supplier})]}),(0,Ue.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Ue.jsx)("span",{style:{fontSize:"13px",color:Ub},children:"Pembayaran"}),(0,Ue.jsx)("span",{style:{fontSize:"13px",color:qb,textTransform:"capitalize"},children:pe})]})]}),(0,Ue.jsx)("div",{style:{borderTop:"1px dashed ".concat(Kb),margin:"0 20px"}}),(0,Ue.jsxs)("div",{style:{padding:"16px 20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Ue.jsx)("span",{style:{fontSize:"16px",fontWeight:600,color:qb},children:"TOTAL"}),(0,Ue.jsx)("span",{style:{fontSize:"20px",fontWeight:700,color:zb},children:Ut(c.totalPrice)})]}),(null===ze||void 0===ze?void 0:ze.transaction_id)&&(0,Ue.jsx)("div",{style:{padding:"0 20px 16px",textAlign:"center"},children:(0,Ue.jsxs)("span",{style:{fontSize:"11px",color:Hb},children:["ID Transaksi: ",ze.transaction_id]})}),(0,Ue.jsxs)("div",{style:{margin:"0 20px 16px",padding:"12px",background:"#F0FDF4",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,Ue.jsx)("svg",{style:{width:"20px",height:"20px",color:Zb},fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,Ue.jsxs)("span",{style:{fontSize:"14px",fontWeight:600,color:Zb},children:["Berhasil - ",Ut(c.totalPrice)]})]}),(0,Ue.jsxs)("div",{style:{padding:"0 20px 20px",display:"flex",gap:"12px"},children:[(0,Ue.jsx)("button",{onClick:n,style:{flex:1,padding:"14px",background:Xb,color:qb,border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Back to Chat"}),(0,Ue.jsx)("button",{onClick:Ht,style:{flex:1,padding:"14px",background:zb,color:"white",border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Transaksi Baru"})]})]})})})]})},iw=[{id:"pcs",label:"pcs"},{id:"kg",label:"kg"},{id:"liter",label:"liter"},{id:"box",label:"box"},{id:"pack",label:"pack"},{id:"custom",label:"Lainnya..."}],sw=[{id:"opname",label:"Opname",description:"Hasil stock opname fisik"},{id:"rusak",label:"Rusak",description:"Barang rusak/cacat"},{id:"hilang",label:"Hilang",description:"Barang hilang/kehilangan"},{id:"koreksi",label:"Koreksi",description:"Koreksi data kesalahan input"},{id:"lainnya",label:"Lainnya",description:"Alasan lainnya"}],lw={nama_produk:"",satuan:"pcs",kategori:"",harga_jual:0},cw=e=>new Intl.NumberFormat("id-ID").format(e),uw=(e,t)=>{const n=e%1===0?e.toString():e.toFixed(2);return"".concat(n," ").concat(t)},dw="#F97316",hw="#3B82F6",pw="#A855F7",fw="#737373",mw="#D4D4D4",gw="#E5E5E5",xw="#F5F5F5",yw="#FFFFFF",vw="#262626",bw="#22C55E",ww="#EF4444",kw=e=>{let{product:t,onClose:n,onEditStock:r,onEditProduct:a,onRetur:o}=e;const i=t.harga_jual&&t.nilai_per_unit?((e,t)=>{if(!t||0===t)return{margin:0,persen:0};const n=e-t,r=n/t*100;return{margin:n,persen:Math.round(10*r)/10}})(t.harga_jual,t.nilai_per_unit):null,s=e=>{let{label:t,value:n,isGray:r=!1,valueColor:a}=e;return(0,Ue.jsxs)("div",{className:"flex justify-between items-center px-3 py-2",style:{backgroundColor:r?xw:yw},children:[(0,Ue.jsx)("span",{className:"text-sm",style:{color:fw},children:t}),(0,Ue.jsx)("span",{className:"text-sm font-medium",style:{color:a||vw},children:null!==n&&void 0!==n?n:"-"})]})};return(0,Ue.jsxs)("div",{className:"h-full flex flex-col",style:{backgroundColor:xw},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between px-4 border-b",style:{height:"60px",backgroundColor:yw,borderColor:gw},children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:mw},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:vw},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsx)("h1",{className:"text-lg font-semibold ml-2 truncate max-w-[200px]",style:{color:vw},children:t.nama_produk})]}),a&&(0,Ue.jsx)("button",{onClick:a,className:"w-10 h-10 flex items-center justify-center rounded-lg transition-colors",style:{color:dw},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),(0,Ue.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[t.is_low_stock&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 rounded-xl flex items-center gap-3",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(ww)},children:[(0,Ue.jsx)("span",{className:"text-2xl",children:"\u26a0\ufe0f"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium text-sm",style:{color:ww},children:"Stok Rendah!"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:ww},children:"Segera lakukan restock"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},className:"rounded-xl overflow-hidden",style:{backgroundColor:yw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:gw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:dw},children:"Stok & Unit"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)(s,{label:"Stok",value:uw(t.stok,t.satuan),valueColor:t.is_low_stock?ww:vw}),(0,Ue.jsx)(s,{label:"Satuan",value:t.satuan,isGray:!0}),(0,Ue.jsx)(s,{label:"Min. Stok",value:t.minimum_stock?uw(t.minimum_stock,t.satuan):"-"})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"rounded-xl overflow-hidden",style:{backgroundColor:yw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:gw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:dw},children:"Harga"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)(s,{label:"Harga Beli",value:t.nilai_per_unit?"Rp ".concat(cw(t.nilai_per_unit)):"-"}),(0,Ue.jsx)(s,{label:"Harga Jual",value:t.harga_jual?"Rp ".concat(cw(t.harga_jual)):"-",isGray:!0,valueColor:dw}),(0,Ue.jsx)(s,{label:"Margin",value:i?"".concat(i.persen,"%"):"-",valueColor:i&&i.margin>0?bw:vw})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"rounded-xl overflow-hidden",style:{backgroundColor:yw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:gw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:dw},children:"Info Produk"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)(s,{label:"Kategori",value:t.kategori||"-"}),(0,Ue.jsx)(s,{label:"Barcode",value:t.barcode||"-",isGray:!0}),(0,Ue.jsx)(s,{label:"Gudang",value:t.lokasi_gudang||"Utama"})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"rounded-xl overflow-hidden",style:{backgroundColor:yw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:gw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:dw},children:"Nilai Aset"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)(s,{label:"Per Unit",value:t.nilai_per_unit?"Rp ".concat(cw(t.nilai_per_unit)):"-"}),(0,Ue.jsx)(s,{label:"Total Nilai",value:t.total_nilai?"Rp ".concat(cw(t.total_nilai)):"-",isGray:!0,valueColor:hw}),(0,Ue.jsx)(s,{label:"Deskripsi",value:t.deskripsi||"-"})]})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:"mt-4 rounded-xl p-4",style:{backgroundColor:yw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"flex gap-3",children:(0,Ue.jsxs)("button",{onClick:r,className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-lg font-medium transition-all active:scale-[0.98]",style:{backgroundColor:dw,color:yw},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Sesuaikan Stok"]})}),o&&(0,Ue.jsxs)("div",{className:"mt-3 pt-3",style:{borderTop:"1px solid ".concat(gw)},children:[(0,Ue.jsx)("p",{className:"text-xs mb-2",style:{color:fw},children:"Catat Retur"}),(0,Ue.jsxs)("div",{className:"flex gap-2",children:[(0,Ue.jsxs)("button",{onClick:()=>o("retur_penjualan"),className:"flex-1 flex items-center justify-center gap-1.5 py-2.5 rounded-lg text-sm font-medium transition-all active:scale-[0.98]",style:{backgroundColor:"#EFF6FF",color:hw},children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),"Retur Penjualan"]}),(0,Ue.jsxs)("button",{onClick:()=>o("retur_pembelian"),className:"flex-1 flex items-center justify-center gap-1.5 py-2.5 rounded-lg text-sm font-medium transition-all active:scale-[0.98]",style:{backgroundColor:"#FAF5FF",color:pw},children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})}),"Retur Pembelian"]})]})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-4 rounded-xl p-4 text-center",style:{backgroundColor:yw,border:"1px dashed ".concat(gw)},children:[(0,Ue.jsx)("span",{className:"text-3xl mb-2 block",children:"\ud83d\udcca"}),(0,Ue.jsx)("h4",{className:"font-medium text-sm",style:{color:vw},children:"Riwayat Pergerakan"}),(0,Ue.jsx)("p",{className:"text-xs mt-1",style:{color:fw},children:"Fitur ini akan tersedia di fase berikutnya"})]})]})]})},jw=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=localStorage.getItem("access_token");return fetch(e,tt(tt({},t),{},{headers:tt(tt({"Content-Type":"application/json"},n?{Authorization:"Bearer ".concat(n)}:{}),t.headers)}))},Cw="#F97316",Nw="#737373",_w="#D4D4D4",Sw="#E5E5E5",Ew="#F5F5F5",Aw="#FFFFFF",Iw="#262626",Tw="#EF4444",Pw={x:[0,-8,8,-6,6,-3,3,0],transition:{duration:.5}},Dw=e=>{let{isOpen:t,onClose:n,onSuccess:r,categories:o}=e;const[i,s]=(0,a.useState)(lw),[l,c]=(0,a.useState)(""),[u,d]=(0,a.useState)(""),[h,p]=(0,a.useState)(!1),[f,m]=(0,a.useState)(null),[g,x]=(0,a.useState)([]),y=(0,a.useRef)(null);(0,a.useEffect)(()=>{t&&(s(lw),c(""),d(""),m(null),x([]),setTimeout(()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.focus()},100))},[t]);const v=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),m(null),x([])},b=(e,t)=>{const n=parseInt(t.replace(/\D/g,""),10)||0;v(e,n)};if(!t)return null;const w=e=>{let{label:t,value:n,onChange:r,placeholder:a,required:o,prefix:i,type:s="text",inputMode:l,fieldKey:c,isGray:u=!1}=e;return(0,Ue.jsxs)(yc.div,{animate:c&&g.includes(c)?Pw:{},className:"flex items-center px-3 py-2.5",style:{backgroundColor:u?Ew:Aw},children:[(0,Ue.jsxs)("span",{className:"text-sm w-24 flex-shrink-0",style:{color:Nw},children:[t,o&&(0,Ue.jsx)("span",{style:{color:Tw},children:" *"})]}),(0,Ue.jsxs)("div",{className:"flex-1 flex items-center",children:[i&&(0,Ue.jsx)("span",{className:"text-sm mr-1",style:{color:Nw},children:i}),(0,Ue.jsx)("input",{type:s,inputMode:l,value:n,onChange:e=>r(e.target.value),placeholder:a,className:"flex-1 text-sm text-right bg-transparent outline-none",style:{color:Iw}})]})]})};return(0,Ue.jsx)(mt,{children:(0,Ue.jsxs)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:Ew},children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:Aw,borderColor:Sw},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:_w},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:Iw},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]}),(0,Ue.jsx)("h1",{className:"text-lg font-semibold ml-2",style:{color:Iw},children:"Tambah Produk"})]}),(0,Ue.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[f&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 rounded-xl flex items-center gap-2",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(Tw)},children:[(0,Ue.jsx)("span",{children:"\u26a0\ufe0f"}),(0,Ue.jsx)("span",{className:"text-sm",style:{color:Tw},children:f})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},className:"col-span-2 rounded-xl overflow-hidden",style:{backgroundColor:Aw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:Sw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Cw},children:"Info Produk"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)(w,{label:"Nama",value:i.nama_produk,onChange:e=>v("nama_produk",e),placeholder:"Indomie Goreng",required:!0,fieldKey:"nama_produk"}),(0,Ue.jsx)(w,{label:"Barcode",value:i.barcode||"",onChange:e=>v("barcode",e),placeholder:"Scan atau ketik",isGray:!0})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"col-span-2 rounded-xl overflow-hidden",style:{backgroundColor:Aw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:Sw},children:(0,Ue.jsxs)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Cw},children:["Satuan ",(0,Ue.jsx)("span",{style:{color:Tw},children:"*"})]})}),(0,Ue.jsx)(yc.div,{animate:g.includes("satuan")?Pw:{},className:"p-3 flex flex-wrap gap-2",children:iw.map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>v("satuan",e.id),className:"px-3 py-1.5 rounded-lg text-sm transition-colors",style:{backgroundColor:i.satuan===e.id?Cw:Ew,color:i.satuan===e.id?Aw:Nw},children:e.label},e.id))}),"custom"===i.satuan&&(0,Ue.jsx)("div",{className:"px-3 pb-3",children:(0,Ue.jsx)("input",{type:"text",value:u,onChange:e=>d(e.target.value),placeholder:"Ketik satuan custom",className:"w-full px-3 py-2 rounded-lg text-sm",style:{backgroundColor:Ew,color:Iw,border:"none",outline:"none"}})})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"rounded-xl overflow-hidden",style:{backgroundColor:Aw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:Sw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Cw},children:"Harga"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)(w,{label:"Beli",value:i.nilai_per_unit?cw(i.nilai_per_unit):"",onChange:e=>b("nilai_per_unit",e),placeholder:"0",prefix:"Rp",inputMode:"numeric"}),(0,Ue.jsx)(w,{label:"Jual",value:i.harga_jual?cw(i.harga_jual):"",onChange:e=>b("harga_jual",e),placeholder:"0",prefix:"Rp",inputMode:"numeric",isGray:!0})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"rounded-xl overflow-hidden",style:{backgroundColor:Aw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:Sw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Cw},children:"Stok"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)(w,{label:"Awal",value:i.stok_awal||"",onChange:e=>v("stok_awal",parseFloat(e)||0),placeholder:"0",inputMode:"numeric"}),(0,Ue.jsx)(w,{label:"Minimum",value:i.minimum_stock||"",onChange:e=>v("minimum_stock",parseFloat(e)||0),placeholder:"0",inputMode:"numeric",isGray:!0})]})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:"mt-3 rounded-xl overflow-hidden",style:{backgroundColor:Aw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:Sw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Cw},children:"Kategori"})}),(0,Ue.jsxs)("div",{className:"p-3 flex flex-wrap gap-2",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>v("kategori",""),className:"px-3 py-1.5 rounded-lg text-sm transition-colors",style:{backgroundColor:""===i.kategori?Cw:Ew,color:""===i.kategori?Aw:Nw},children:"Tanpa Kategori"}),o.map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>v("kategori",e.id),className:"px-3 py-1.5 rounded-lg text-sm transition-colors",style:{backgroundColor:i.kategori===e.id?Cw:Ew,color:i.kategori===e.id?Aw:Nw},children:e.label},e.id)),(0,Ue.jsx)("button",{type:"button",onClick:()=>v("kategori","custom"),className:"px-3 py-1.5 rounded-lg text-sm transition-colors",style:{backgroundColor:"custom"===i.kategori?Cw:Ew,color:"custom"===i.kategori?Aw:Nw},children:"+ Baru"})]}),"custom"===i.kategori&&(0,Ue.jsx)("div",{className:"px-3 pb-3",children:(0,Ue.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Ketik kategori baru",className:"w-full px-3 py-2 rounded-lg text-sm",style:{backgroundColor:Ew,color:Iw,border:"none",outline:"none"}})})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-3 rounded-xl overflow-hidden",style:{backgroundColor:Aw,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-3 py-2 border-b",style:{borderColor:Sw},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Cw},children:"Catatan"})}),(0,Ue.jsx)("div",{className:"p-3",children:(0,Ue.jsx)("textarea",{value:i.deskripsi||"",onChange:e=>v("deskripsi",e.target.value),placeholder:"Catatan tambahan (opsional)",rows:2,className:"w-full text-sm resize-none",style:{backgroundColor:Ew,color:Iw,border:"none",outline:"none",borderRadius:"8px",padding:"12px"}})})]}),(0,Ue.jsx)("div",{className:"h-24"})]}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-0 right-0 px-4 py-4 border-t",style:{backgroundColor:Aw,borderColor:Sw,paddingBottom:"max(16px, env(safe-area-inset-bottom))"},children:(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{const e=[];i.nama_produk.trim()||e.push("nama_produk");const t="custom"===i.satuan?u:i.satuan;if(t.trim()||e.push("satuan"),e.length>0)return x(e),setTimeout(()=>x([]),500),void m("Lengkapi field yang wajib diisi");p(!0),m(null);try{var n,a;const e={nama_produk:i.nama_produk.trim(),satuan:t.trim(),kategori:"custom"===i.kategori?l.trim():i.kategori,barcode:(null===(n=i.barcode)||void 0===n?void 0:n.trim())||null,harga_jual:i.harga_jual||null,stok_awal:i.stok_awal||0,nilai_per_unit:i.nilai_per_unit||null,deskripsi:(null===(a=i.deskripsi)||void 0===a?void 0:a.trim())||null,minimum_stock:i.minimum_stock||null},o=await jw("/api/inventory/products",{method:"POST",body:JSON.stringify(e)});if(401===o.status)return void m("Sesi berakhir. Silakan login ulang.");if(409===o.status){const e=await o.json();return void m(e.detail||"Produk sudah ada")}if(!o.ok){const e=await o.json();throw new Error(e.detail||"Gagal menambah produk")}const s=await o.json();r(s)}catch(o){m(o.message||"Gagal menambah produk. Coba lagi."),console.error("Add product error:",o)}finally{p(!1)}},disabled:h,className:"w-full py-3.5 rounded-xl font-medium transition-colors disabled:opacity-50",style:{backgroundColor:Cw,color:Aw},children:h?"Menyimpan...":"Simpan Produk"})})]})})},Mw="#F97316",Rw="#737373",Fw="#E5E5E5",Ow="#F5F5F5",Bw="#FFFFFF",Lw="#262626",zw="#22C55E",Ww="#EF4444",Vw=e=>{var t;let{isOpen:n,onClose:r,product:o,onSuccess:i}=e;const[s,l]=(0,a.useState)(""),[c,u]=(0,a.useState)("opname"),[d,h]=(0,a.useState)(""),[p,f]=(0,a.useState)(!1),[m,g]=(0,a.useState)(null),[x,y]=(0,a.useState)(null),v=(0,a.useRef)(null);(0,a.useEffect)(()=>{n&&(l(o.stok.toString()),u("opname"),h(""),g(null),y(null),setTimeout(()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.focus()},100))},[n,o]);const b=parseFloat(s)-o.stok,w=!isNaN(b)&&0!==b;return n?x?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"w-full max-w-sm mx-4 rounded-xl shadow-xl p-6 text-center",style:{backgroundColor:Bw},children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)("svg",{className:"w-8 h-8",style:{color:zw},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-2",style:{color:Lw},children:"Stok Berhasil Diubah"}),(0,Ue.jsxs)("p",{className:"mb-4",style:{color:Rw},children:[uw(x.stok_sebelum,o.satuan)," \u2192 ",uw(x.stok_setelah,o.satuan)]}),(0,Ue.jsxs)("p",{className:"text-sm",style:{color:Rw},children:[x.adjustment_amount>0?"+":"",x.adjustment_amount," ",o.satuan]})]})}):(0,Ue.jsx)(mt,{children:(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md mx-4 rounded-xl shadow-xl",style:{backgroundColor:Bw},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:Fw},children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-lg font-semibold",style:{color:Lw},children:"Edit Stok"}),(0,Ue.jsx)("p",{className:"text-sm truncate",style:{color:Rw},children:o.nama_produk})]}),(0,Ue.jsx)("button",{onClick:r,className:"p-2 rounded-lg transition-colors hover:bg-gray-100",style:{color:Rw},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsxs)("div",{className:"p-4 space-y-4",children:[m&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 rounded-lg text-sm",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(Ww),color:Ww},children:m}),(0,Ue.jsxs)("div",{className:"p-4 rounded-lg",style:{backgroundColor:Ow},children:[(0,Ue.jsx)("div",{className:"text-sm mb-1",style:{color:Rw},children:"Stok Saat Ini"}),(0,Ue.jsx)("div",{className:"text-2xl font-bold",style:{color:Lw},children:uw(o.stok,o.satuan)})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:Lw},children:["Stok Baru ",(0,Ue.jsx)("span",{style:{color:Ww},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{ref:v,type:"number",inputMode:"decimal",step:"any",value:s,onChange:e=>{l(e.target.value),g(null)},className:"w-full px-3 py-3 text-lg rounded-lg transition-all",style:{backgroundColor:Bw,border:"1px solid ".concat(Fw),color:Lw,outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor=Mw,e.currentTarget.style.boxShadow="0 0 0 2px ".concat(Mw,"30")},onBlur:e=>{e.currentTarget.style.borderColor=Fw,e.currentTarget.style.boxShadow="none"}}),(0,Ue.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2",style:{color:Rw},children:o.satuan})]}),w&&(0,Ue.jsxs)("div",{className:"mt-1 text-sm",style:{color:b>0?zw:Ww},children:[b>0?"+":"",b," ",o.satuan]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-2",style:{color:Lw},children:["Alasan Penyesuaian ",(0,Ue.jsx)("span",{style:{color:Ww},children:"*"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2",children:sw.map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>u(e.id),className:"px-3 py-2.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:c===e.id?Mw:Ow,color:c===e.id?Bw:Rw},children:e.label},e.id))}),(0,Ue.jsx)("p",{className:"mt-1 text-xs",style:{color:Rw},children:null===(t=sw.find(e=>e.id===c))||void 0===t?void 0:t.description})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Lw},children:"Catatan (opsional)"}),(0,Ue.jsx)("textarea",{value:d,onChange:e=>h(e.target.value),placeholder:"Contoh: Hasil stock opname tanggal 5 Desember",rows:2,className:"w-full px-3 py-2.5 rounded-lg transition-all resize-none",style:{backgroundColor:Bw,border:"1px solid ".concat(Fw),color:Lw,outline:"none"},onFocus:e=>{e.currentTarget.style.borderColor=Mw,e.currentTarget.style.boxShadow="0 0 0 2px ".concat(Mw,"30")},onBlur:e=>{e.currentTarget.style.borderColor=Fw,e.currentTarget.style.boxShadow="none"}})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 border-t flex gap-3",style:{borderColor:Fw},children:[(0,Ue.jsx)("button",{onClick:r,className:"flex-1 py-3 rounded-lg font-medium transition-colors",style:{backgroundColor:Ow,color:Rw},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{const e=parseFloat(s);if(isNaN(e)||e<0)g("Jumlah stok tidak valid");else if(e!==o.stok){f(!0),g(null);try{const t={new_quantity:e,reason:c,notes:d.trim()||null},n=await jw("/api/inventory/products/".concat(o.id,"/adjust"),{method:"POST",body:JSON.stringify(t)});if(401===n.status)return void g("Sesi berakhir. Silakan login ulang.");if(!n.ok){const e=await n.json();throw new Error(e.detail||"Gagal menyesuaikan stok")}const r=await n.json();y(r),setTimeout(()=>{i(r)},1500)}catch(t){g(t.message||"Gagal menyesuaikan stok. Coba lagi."),console.error("Stock adjustment error:",t)}finally{f(!1)}}else g("Stok baru sama dengan stok saat ini")},disabled:p||!w,className:"flex-1 py-3 rounded-lg font-medium transition-colors disabled:opacity-50",style:{backgroundColor:Mw,color:Bw},children:p?"Menyimpan...":"Simpan Perubahan"})]})]})})}):null},Uw=[{id:"rusak",label:"Rusak",description:"Barang rusak/cacat produksi"},{id:"salah_kirim",label:"Salah Kirim",description:"Kesalahan pengiriman"},{id:"tidak_sesuai",label:"Tidak Sesuai",description:"Produk tidak sesuai pesanan"},{id:"kadaluarsa",label:"Kadaluarsa",description:"Masa berlaku habis"},{id:"lainnya",label:"Lainnya",description:"Alasan lain"}],Hw=((new Date).toISOString().split("T")[0],e=>new Intl.NumberFormat("id-ID").format(e)),Gw="#F97316",Kw="#3B82F6",Xw="#A855F7",Yw="#737373",qw="#E5E5E5",Zw="#F5F5F5",Jw="#FFFFFF",Qw="#262626",$w="#22C55E",ek="#EF4444",tk=e=>{let{isOpen:t,onClose:n,product:r,defaultType:o="retur_penjualan",onSuccess:i}=e;const[s,l]=(0,a.useState)(o),[c,u]=(0,a.useState)("1"),[d,h]=(0,a.useState)(""),[p,f]=(0,a.useState)("rusak"),[m,g]=(0,a.useState)(""),[x,y]=(0,a.useState)(""),[v,b]=(0,a.useState)(""),[w,k]=(0,a.useState)(""),[j,C]=(0,a.useState)((new Date).toISOString().split("T")[0]),[N,_]=(0,a.useState)(!1),[S,E]=(0,a.useState)(null),[A,I]=(0,a.useState)(null),[T,P]=(0,a.useState)(!1),D=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(t){l(o),u("1");const e="retur_penjualan"===o?r.harga_jual||r.nilai_per_unit||0:r.nilai_per_unit||0;h(e.toString()),f("rusak"),g(""),y(""),b(""),k(""),C((new Date).toISOString().split("T")[0]),E(null),I(null),P(!1),setTimeout(()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.focus()},100)}},[t,r,o]),(0,a.useEffect)(()=>{const e="retur_penjualan"===s?r.harga_jual||r.nilai_per_unit||0:r.nilai_per_unit||0;h(e.toString())},[s,r]);const M=parseFloat(c)||0,R=parseFloat(d)||0,F=M*R,O=(e=>{switch(e){case"retur_penjualan":return{label:"Retur Penjualan",description:"Pembeli mengembalikan barang ke toko",stockDirection:"increase"};case"retur_pembelian":return{label:"Retur Pembelian",description:"Mengembalikan barang ke supplier",stockDirection:"decrease"}}})(s),B="increase"===O.stockDirection?r.stok+M:r.stok-M,L=M>0&&R>=0&&("lainnya"!==p||m.trim()),z="retur_pembelian"===s&&M>r.stok;return t?A?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"w-full max-w-sm mx-4 rounded-xl shadow-xl p-6 text-center",style:{backgroundColor:Jw},children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)("svg",{className:"w-8 h-8",style:{color:$w},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsxs)("h3",{className:"text-lg font-semibold mb-2",style:{color:Qw},children:[O.label," Berhasil"]}),(0,Ue.jsx)("p",{className:"mb-2",style:{color:Yw},children:r.nama_produk}),(0,Ue.jsxs)("p",{className:"mb-4",style:{color:Yw},children:["Stok: ",uw(A.stok_sebelum,r.satuan)," \u2192 ",uw(A.stok_setelah,r.satuan)]}),(0,Ue.jsxs)("p",{className:"text-sm font-medium",style:{color:Gw},children:["Rp ",Hw(F)]})]})}):(0,Ue.jsx)(mt,{children:(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md mx-4 rounded-xl shadow-xl max-h-[90vh] flex flex-col",style:{backgroundColor:Jw},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:qw},children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-lg font-semibold",style:{color:Qw},children:"Catat Retur"}),(0,Ue.jsx)("p",{className:"text-sm truncate",style:{color:Yw},children:r.nama_produk})]}),(0,Ue.jsx)("button",{onClick:n,className:"p-2 rounded-lg transition-colors hover:bg-gray-100",style:{color:Yw},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:[S&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 rounded-lg text-sm",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(ek),color:ek},children:S}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-2",style:{color:Qw},children:["Jenis Retur ",(0,Ue.jsx)("span",{style:{color:ek},children:"*"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Ue.jsxs)("button",{type:"button",onClick:()=>l("retur_penjualan"),className:"px-3 py-3 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:"retur_penjualan"===s?Kw:Zw,color:"retur_penjualan"===s?Jw:Yw},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),"Retur Penjualan"]}),(0,Ue.jsx)("span",{className:"text-xs opacity-75 mt-1 block",children:"Barang masuk"})]}),(0,Ue.jsxs)("button",{type:"button",onClick:()=>l("retur_pembelian"),className:"px-3 py-3 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:"retur_pembelian"===s?Xw:Zw,color:"retur_pembelian"===s?Jw:Yw},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})}),"Retur Pembelian"]}),(0,Ue.jsx)("span",{className:"text-xs opacity-75 mt-1 block",children:"Barang keluar"})]})]})]}),(0,Ue.jsxs)("div",{className:"p-3 rounded-lg flex justify-between items-center",style:{backgroundColor:Zw},children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:Yw},children:"Stok Saat Ini"}),(0,Ue.jsx)("div",{className:"text-lg font-bold",style:{color:Qw},children:uw(r.stok,r.satuan)})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:Yw},children:"Stok Setelah"}),(0,Ue.jsx)("div",{className:"text-lg font-bold",style:{color:z?ek:Qw},children:uw(B,r.satuan)})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:Qw},children:["Jumlah ",(0,Ue.jsx)("span",{style:{color:ek},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("input",{ref:D,type:"number",inputMode:"decimal",step:"any",min:"0",value:c,onChange:e=>{u(e.target.value),E(null)},className:"w-full px-3 py-3 text-lg rounded-lg",style:{backgroundColor:Jw,border:"1px solid ".concat(qw),color:Qw,outline:"none"}}),(0,Ue.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2",style:{color:Yw},children:r.satuan})]}),z&&(0,Ue.jsxs)("p",{className:"mt-1 text-sm",style:{color:ek},children:["Melebihi stok tersedia (",r.stok," ",r.satuan,")"]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Qw},children:"Harga per Unit"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:Yw},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:R>0?Hw(R):"",onChange:e=>{const t=e.target.value.replace(/\D/g,"");h(t)},className:"w-full pl-10 pr-3 py-2.5 rounded-lg",style:{backgroundColor:Jw,border:"1px solid ".concat(qw),color:Qw,outline:"none"}})]})]}),(0,Ue.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:"#FFF7ED"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:Gw},children:"Total Nilai Retur"}),(0,Ue.jsxs)("div",{className:"text-xl font-bold",style:{color:Gw},children:["Rp ",Hw(F)]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-2",style:{color:Qw},children:["Alasan Retur ",(0,Ue.jsx)("span",{style:{color:ek},children:"*"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Uw.map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>f(e.id),className:"px-3 py-2.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:p===e.id?Gw:Zw,color:p===e.id?Jw:Yw},children:e.label},e.id))})]}),"lainnya"===p&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:Qw},children:["Alasan Lainnya ",(0,Ue.jsx)("span",{style:{color:ek},children:"*"})]}),(0,Ue.jsx)("input",{type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"Contoh: Kesalahan packing",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Jw,border:"1px solid ".concat(qw),color:Qw,outline:"none"}})]}),(0,Ue.jsxs)("button",{type:"button",onClick:()=>P(!T),className:"w-full flex items-center justify-center gap-2 py-2 text-sm",style:{color:Yw},children:[(0,Ue.jsx)("span",{className:"flex-1 h-px",style:{backgroundColor:qw}}),(0,Ue.jsxs)("span",{className:"flex items-center gap-1",children:["Detail Tambahan",(0,Ue.jsx)("svg",{className:"w-4 h-4 transition-transform ".concat(T?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,Ue.jsx)("span",{className:"flex-1 h-px",style:{backgroundColor:qw}})]}),T&&(0,Ue.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Qw},children:"retur_penjualan"===s?"Nama Pembeli":"Nama Supplier"}),(0,Ue.jsx)("input",{type:"text",value:x,onChange:e=>y(e.target.value),placeholder:"retur_penjualan"===s?"Contoh: Pak Budi":"Contoh: PT Sumber Jaya",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Jw,border:"1px solid ".concat(qw),color:Qw,outline:"none"}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Qw},children:"No. Transaksi Asli"}),(0,Ue.jsx)("input",{type:"text",value:v,onChange:e=>b(e.target.value),placeholder:"Contoh: TRX-20231205-001",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Jw,border:"1px solid ".concat(qw),color:Qw,outline:"none"}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Qw},children:"Tanggal"}),(0,Ue.jsx)("input",{type:"date",value:j,onChange:e=>C(e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Jw,border:"1px solid ".concat(qw),color:Qw,outline:"none"}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Qw},children:"Catatan"}),(0,Ue.jsx)("textarea",{value:w,onChange:e=>k(e.target.value),placeholder:"Catatan tambahan...",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:Jw,border:"1px solid ".concat(qw),color:Qw,outline:"none"}})]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 border-t flex gap-3",style:{borderColor:qw},children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3 rounded-lg font-medium transition-colors",style:{backgroundColor:Zw,color:Yw},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(L)if(z)E("Jumlah retur (".concat(M,") melebihi stok tersedia (").concat(r.stok,")"));else{_(!0),E(null);try{const e={transaction_type:s,product_id:r.id,product_name:r.nama_produk,quantity:M,unit:r.satuan,price_per_unit:R,total_amount:F,reason:"lainnya"===p?m:p,pihak_name:x.trim()||null,transaction_ref:v.trim()||null,notes:w.trim()||null,date:j},t=localStorage.getItem("access_token"),n=localStorage.getItem("tenant_id")||"evlogia",a=await fetch("/api/tenant/".concat(n,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] ".concat(O.label),session_id:"retur-".concat(Date.now()),conversation_context:JSON.stringify({form_data:e})})});if(401===a.status)return void E("Sesi berakhir. Silakan login ulang.");if(!a.ok){const e=await a.json();throw new Error(e.detail||e.message||"Gagal menyimpan retur")}const o=await a.json(),l={success:!0,message:o.message||"Retur berhasil dicatat",transaction_id:o.transaction_id||"",stok_sebelum:r.stok,stok_setelah:B,adjustment_amount:"increase"===O.stockDirection?M:-M};I(l),setTimeout(()=>{i(l)},1500)}catch(e){E(e.message||"Gagal menyimpan retur. Coba lagi."),console.error("[ReturForm] Submit error:",e)}finally{_(!1)}}},disabled:N||!L||z,className:"flex-1 py-3 rounded-lg font-medium transition-colors disabled:opacity-50",style:{backgroundColor:Gw,color:Jw},children:N?"Menyimpan...":"Simpan ".concat(O.label)})]})]})})}):null},nk=[{id:"peralatan",label:"Peralatan",description:"Komputer, mesin kasir, AC, kulkas",defaultUmurManfaat:4},{id:"kendaraan",label:"Kendaraan",description:"Motor, mobil, truk",defaultUmurManfaat:8},{id:"bangunan",label:"Bangunan",description:"Ruko, gudang",defaultUmurManfaat:20},{id:"tanah",label:"Tanah",description:"Tanah usaha",defaultUmurManfaat:0},{id:"lainnya",label:"Lainnya",description:"Aset tetap lainnya",defaultUmurManfaat:4}],rk=[{id:"garis_lurus",label:"Garis Lurus",description:"Penyusutan tetap setiap tahun"},{id:"saldo_menurun",label:"Saldo Menurun",description:"Penyusutan lebih besar di awal"}],ak={nama_aset:"",kategori:"peralatan",tanggal_perolehan:(new Date).toISOString().split("T")[0],harga_perolehan:0,umur_manfaat:4,nilai_residu:0,metode_penyusutan:"garis_lurus"},ok=e=>new Intl.NumberFormat("id-ID").format(e),ik=(e,t,n)=>n<=0?0:Math.round((e-t)/n),sk=(e,t,n)=>Math.round(ik(e,t,n)/12),lk="#F97316",ck="#3B82F6",uk="#737373",dk="#E5E5E5",hk="#F5F5F5",pk="#FFFFFF",fk="#262626",mk="#22C55E",gk="#EF4444",xk=e=>{var t;let{isOpen:n,onClose:r,onSuccess:o,editData:i}=e;const[s,l]=(0,a.useState)(ak),[c,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)(null),[p,f]=(0,a.useState)(null),[m,g]=(0,a.useState)(!1),x=(0,a.useRef)(null);(0,a.useEffect)(()=>{n&&(l(i?{nama_aset:i.nama_aset,kategori:i.kategori,tanggal_perolehan:i.tanggal_perolehan,harga_perolehan:i.harga_perolehan,umur_manfaat:i.umur_manfaat,nilai_residu:i.nilai_residu,metode_penyusutan:i.metode_penyusutan,lokasi:i.lokasi,nomor_seri:i.nomor_seri}:ak),h(null),f(null),g(!1),setTimeout(()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.focus()},100))},[n,i]),(0,a.useEffect)(()=>{const e=nk.find(e=>e.id===s.kategori);e&&!i&&l(t=>tt(tt({},t),{},{umur_manfaat:e.defaultUmurManfaat}))},[s.kategori,i]);const y=(e,t)=>{l(n=>tt(tt({},n),{},{[e]:t})),h(null)},v=(e,t)=>{const n=parseInt(t.replace(/\D/g,""),10)||0;y(e,n)},b=ik(s.harga_perolehan,s.nilai_residu,s.umur_manfaat),w=sk(s.harga_perolehan,s.nilai_residu,s.umur_manfaat),k=s.nama_aset.trim()&&s.harga_perolehan>0&&s.tanggal_perolehan;return n?p?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"w-full max-w-sm mx-4 rounded-xl shadow-xl p-6 text-center",style:{backgroundColor:pk},children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)("svg",{className:"w-8 h-8",style:{color:mk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-2",style:{color:fk},children:"Aset Berhasil Dicatat"}),(0,Ue.jsx)("p",{className:"mb-2",style:{color:uk},children:p.nama_aset}),(0,Ue.jsxs)("p",{className:"text-sm",style:{color:uk},children:["Penyusutan/bulan: Rp ",ok(p.penyusutan_per_bulan)]})]})}):(0,Ue.jsx)(mt,{children:(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md mx-4 rounded-xl shadow-xl max-h-[90vh] flex flex-col",style:{backgroundColor:pk},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:dk},children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-lg font-semibold",style:{color:fk},children:i?"Edit Aset Tetap":"Catat Aset Tetap"}),(0,Ue.jsx)("p",{className:"text-sm",style:{color:uk},children:"Peralatan, Kendaraan, dll"})]}),(0,Ue.jsx)("button",{onClick:r,className:"p-2 rounded-lg transition-colors hover:bg-gray-100",style:{color:uk},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:[d&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 rounded-lg text-sm",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(gk),color:gk},children:d}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:fk},children:["Nama Aset ",(0,Ue.jsx)("span",{style:{color:gk},children:"*"})]}),(0,Ue.jsx)("input",{ref:x,type:"text",value:s.nama_aset,onChange:e=>y("nama_aset",e.target.value),placeholder:"Contoh: Komputer Kasir, Motor Vario",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:pk,border:"1px solid ".concat(dk),color:fk,outline:"none"}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-2",style:{color:fk},children:["Kategori ",(0,Ue.jsx)("span",{style:{color:gk},children:"*"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-3 gap-2",children:nk.slice(0,3).map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>y("kategori",e.id),className:"px-3 py-2.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:s.kategori===e.id?lk:hk,color:s.kategori===e.id?pk:uk},children:e.label},e.id))}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:nk.slice(3).map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>y("kategori",e.id),className:"px-3 py-2.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:s.kategori===e.id?lk:hk,color:s.kategori===e.id?pk:uk},children:e.label},e.id))}),(0,Ue.jsx)("p",{className:"mt-1 text-xs",style:{color:uk},children:null===(t=nk.find(e=>e.id===s.kategori))||void 0===t?void 0:t.description})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:fk},children:["Tanggal Perolehan ",(0,Ue.jsx)("span",{style:{color:gk},children:"*"})]}),(0,Ue.jsx)("input",{type:"date",value:s.tanggal_perolehan,onChange:e=>y("tanggal_perolehan",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:pk,border:"1px solid ".concat(dk),color:fk,outline:"none"}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:fk},children:["Harga Perolehan ",(0,Ue.jsx)("span",{style:{color:gk},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:uk},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:s.harga_perolehan>0?ok(s.harga_perolehan):"",onChange:e=>v("harga_perolehan",e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right rounded-lg",style:{backgroundColor:pk,border:"1px solid ".concat(dk),color:fk,outline:"none"}})]})]}),s.harga_perolehan>0&&s.umur_manfaat>0&&(0,Ue.jsxs)("div",{className:"p-3 rounded-lg",style:{backgroundColor:"#EFF6FF"},children:[(0,Ue.jsx)("div",{className:"text-sm font-medium mb-2",style:{color:ck},children:"Penyusutan"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{style:{color:ck},children:"Per Tahun"}),(0,Ue.jsxs)("div",{className:"font-bold",style:{color:fk},children:["Rp ",ok(b)]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{style:{color:ck},children:"Per Bulan"}),(0,Ue.jsxs)("div",{className:"font-bold",style:{color:fk},children:["Rp ",ok(w)]})]})]})]}),(0,Ue.jsxs)("button",{type:"button",onClick:()=>g(!m),className:"w-full flex items-center justify-center gap-2 py-2 text-sm",style:{color:uk},children:[(0,Ue.jsx)("span",{className:"flex-1 h-px",style:{backgroundColor:dk}}),(0,Ue.jsxs)("span",{className:"flex items-center gap-1",children:["Opsi Lanjutan",(0,Ue.jsx)("svg",{className:"w-4 h-4 transition-transform ".concat(m?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,Ue.jsx)("span",{className:"flex-1 h-px",style:{backgroundColor:dk}})]}),m&&(0,Ue.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:fk},children:"Umur Manfaat (tahun)"}),(0,Ue.jsx)("input",{type:"number",min:"0",value:s.umur_manfaat,onChange:e=>y("umur_manfaat",parseInt(e.target.value)||0),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:pk,border:"1px solid ".concat(dk),color:fk,outline:"none"}}),(0,Ue.jsx)("p",{className:"mt-1 text-xs",style:{color:uk},children:"tanah"===s.kategori?"Tanah tidak disusutkan (umur = 0)":"Lama pemakaian hingga habis nilai"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:fk},children:"Nilai Residu"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:uk},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:s.nilai_residu>0?ok(s.nilai_residu):"",onChange:e=>v("nilai_residu",e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-2.5 rounded-lg",style:{backgroundColor:pk,border:"1px solid ".concat(dk),color:fk,outline:"none"}})]}),(0,Ue.jsx)("p",{className:"mt-1 text-xs",style:{color:uk},children:"Nilai aset di akhir masa manfaat"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:fk},children:"Metode Penyusutan"}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2",children:rk.map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>y("metode_penyusutan",e.id),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:s.metode_penyusutan===e.id?lk:hk,color:s.metode_penyusutan===e.id?pk:uk},children:e.label},e.id))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:fk},children:"Lokasi"}),(0,Ue.jsx)("input",{type:"text",value:s.lokasi||"",onChange:e=>y("lokasi",e.target.value),placeholder:"Contoh: Toko utama, Gudang",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:pk,border:"1px solid ".concat(dk),color:fk,outline:"none"}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:fk},children:"Nomor Seri / Plat"}),(0,Ue.jsx)("input",{type:"text",value:s.nomor_seri||"",onChange:e=>y("nomor_seri",e.target.value),placeholder:"Contoh: SN12345, AB 1234 CD",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:pk,border:"1px solid ".concat(dk),color:fk,outline:"none"}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:fk},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:s.keterangan||"",onChange:e=>y("keterangan",e.target.value),placeholder:"Catatan tambahan...",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:pk,border:"1px solid ".concat(dk),color:fk,outline:"none"}})]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 border-t flex gap-3",style:{borderColor:dk},children:[(0,Ue.jsx)("button",{onClick:r,className:"flex-1 py-3 rounded-lg font-medium transition-colors",style:{backgroundColor:hk,color:uk},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(k){u(!0),h(null);try{var e,t,n;const r=localStorage.getItem("access_token"),a=localStorage.getItem("tenant_id")||"evlogia",i={transaction_type:"aset_tetap",jenis_aset:"aset_tetap",nama_aset:s.nama_aset.trim(),kategori_aset:s.kategori,tanggal_perolehan:s.tanggal_perolehan,harga_perolehan:s.harga_perolehan,umur_manfaat:s.umur_manfaat,nilai_residu:s.nilai_residu,metode_penyusutan:s.metode_penyusutan,penyusutan_per_tahun:b,penyusutan_per_bulan:w,lokasi:(null===(e=s.lokasi)||void 0===e?void 0:e.trim())||null,nomor_seri:(null===(t=s.nomor_seri)||void 0===t?void 0:t.trim())||null,keterangan:(null===(n=s.keterangan)||void 0===n?void 0:n.trim())||null},l=await fetch("/api/tenant/".concat(a,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Aset Tetap",session_id:"aset-tetap-".concat(Date.now()),conversation_context:JSON.stringify({form_data:i})})});if(401===l.status)return void h("Sesi berakhir. Silakan login ulang.");if(!l.ok){const e=await l.json();throw new Error(e.detail||e.message||"Gagal menyimpan aset tetap")}const c=await l.json(),u={success:!0,message:c.message||"Aset tetap berhasil dicatat",asset_id:c.asset_id||"",nama_aset:s.nama_aset,penyusutan_per_bulan:w};f(u),setTimeout(()=>{o(u)},1500)}catch(r){h(r.message||"Gagal menyimpan aset tetap. Coba lagi."),console.error("[AsetTetapForm] Submit error:",r)}finally{u(!1)}}else h("Lengkapi nama aset, harga perolehan, dan tanggal perolehan")},disabled:c||!k,className:"flex-1 py-3 rounded-lg font-medium transition-colors disabled:opacity-50",style:{backgroundColor:lk,color:pk},children:c?"Menyimpan...":i?"Simpan Perubahan":"Simpan Aset"})]})]})})}):null},yk="#F97316",vk="#262626",bk="#737373",wk="#A3A3A3",kk="#D4D4D4",jk="#E5E5E5",Ck="#F5F5F5",Nk="#FFFFFF",_k="#262626",Sk="#22C55E",Ek="#EAB308",Ak="#EF4444",Ik=[{id:"semua",title:"Semua",icon:"/icons/INV-ALL.png",count:7349},{id:"melimpah",title:"Melimpah",icon:"/icons/INV-PLENTY.png",count:7349},{id:"menipis",title:"Menipis",icon:"/icons/INV-SHORTAGE.png",count:7349},{id:"habis",title:"Habis",icon:"/icons/INV-OUTOFSTOCK.png",count:7349},{id:"aset",title:"Aset",icon:"/icons/INV-ASET.png",count:7349},{id:"reorder",title:"Reorder List",icon:"/icons/INV-REORDERLIST.png",count:0}],Tk=e=>{const t=e.split(" ");if(t.length<=2)return(0,Ue.jsx)("span",{className:"font-bold",style:{color:vk},children:e});const n=t.slice(0,2).join(" "),r=t.slice(2).join(" ");return(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("span",{className:"font-bold",style:{color:vk},children:n}),(0,Ue.jsxs)("span",{style:{color:bk},children:[" ",r]})]})},Pk=[{id:"1",nama:"Kursi Pelanggan",deskripsi:"Warna Merah",kategori:"Aset Tidak Bergerak",jumlah:8,satuan:"pcs"},{id:"2",nama:"Etalase Produk",deskripsi:"3x0,5x1 meter",kategori:"Aset Tidak Bergerak",jumlah:1,satuan:"unit"},{id:"3",nama:"Motor Bebek",deskripsi:"Vario 125 cc",kategori:"Aset Bergerak",jumlah:1,satuan:"unit"},{id:"4",nama:"Mobil",deskripsi:"Pick Up Daihatzu 2020",kategori:"Aset Bergerak",jumlah:1,satuan:"unit"},{id:"5",nama:"Lemari",deskripsi:"Produk 2x4x5 meter",kategori:"Aset Tidak Bergerak",jumlah:4,satuan:"unit"},{id:"6",nama:"Timbangan",deskripsi:"Tradisional",kategori:"Aset Tidak Bergerak",jumlah:2,satuan:"unit"}],Dk=e=>{var t;let{isOpen:n,onClose:r,isMobile:o=!1,isEmbedded:i=!1}=e;const[s,l]=(0,a.useState)("categories"),[c,u]=(0,a.useState)(null),[d,h]=(0,a.useState)([]),[p,f]=(0,a.useState)(null),[m,g]=(0,a.useState)(!1),[x,y]=(0,a.useState)(null),[v,b]=(0,a.useState)(""),[w,k]=(0,a.useState)(0),[j,C]=(0,a.useState)(!1),[N,_]=(0,a.useState)(0),[S,E]=(0,a.useState)([]),[A,I]=(0,a.useState)(!1),[T,P]=(0,a.useState)(!1),[D,M]=(0,a.useState)(null),[R,F]=(0,a.useState)(!1),[O,B]=(0,a.useState)(null),[L,z]=(0,a.useState)("retur_penjualan"),[W,V]=(0,a.useState)(!1),[U,H]=(0,a.useState)(!1),[G,K]=(0,a.useState)(!1),X=(0,a.useRef)(null),Y=(0,a.useRef)(null),q=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g(!0),y(null);try{const t=e?0:N,n=new URLSearchParams({limit:50..toString(),offset:t.toString()});v&&n.set("search",v);const r=await jw("/api/inventory/products?".concat(n));if(401===r.status)return void y("Sesi berakhir. Silakan login ulang.");if(!r.ok)throw new Error("Failed to fetch products");const a=await r.json();e?(h(a.products),_(50)):(h(e=>[...e,...a.products]),_(e=>e+50)),k(a.total),C(a.has_more)}catch(t){y("Gagal memuat produk. Coba lagi."),console.error("Fetch products error:",t)}finally{g(!1)}},[v,N]),Z=(0,a.useCallback)(async()=>{try{const e=await jw("/api/inventory/categories");if(e.ok){const t=await e.json();E(t.categories||[])}}catch(e){console.error("Fetch categories error:",e)}},[]);(0,a.useEffect)(()=>{n&&(q(!0),Z(),setTimeout(()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.focus()},100))},[n]),(0,a.useEffect)(()=>{v&&g(!0);const e=v.length>=3?0:100,t=setTimeout(()=>{n&&q(!0)},e);return()=>clearTimeout(t)},[v]);const J=()=>{f(null)};if(!n)return null;const Q=i?"h-full flex flex-col":"fixed inset-0 z-50 flex flex-col";if(p)return(0,Ue.jsx)("div",{className:Q,style:{backgroundColor:Nk},children:(0,Ue.jsx)(kw,{product:p,onClose:J,onEditStock:()=>(M(p),void P(!0)),onRetur:e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"retur_penjualan";B(e),z(t),F(!0)}(p,e)})});Pk.filter(e=>e.nama.toLowerCase().includes(v.toLowerCase())||e.deskripsi.toLowerCase().includes(v.toLowerCase()));return(0,Ue.jsxs)("div",{className:Q,style:{backgroundColor:jk},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 flex-shrink-0",style:{height:"56px",paddingTop:"max(8px, env(safe-area-inset-top))"},children:[(0,Ue.jsxs)("button",{onClick:"product-list"===s?()=>{l("categories"),u(null)}:r,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:kk},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:bk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsx)("span",{className:"font-semibold text-lg",style:{color:"#525252"},children:"product-list"===s&&c&&(null===(t=Ik.find(e=>e.id===c))||void 0===t?void 0:t.title)||"Inventory dan Aset"})]}),(0,Ue.jsx)("div",{className:"px-4 pb-3",style:{backgroundColor:jk},children:(0,Ue.jsxs)("div",{className:"flex items-center px-4",style:{backgroundColor:Nk,borderRadius:"12px",height:"48px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,Ue.jsx)("input",{ref:X,type:"text",placeholder:"Ketik barcode, nama produk atau aset",value:v,onChange:e=>b(e.target.value),className:"flex-1 bg-transparent text-sm outline-none",style:{color:_k}}),(0,Ue.jsx)("button",{onClick:()=>H(!U),className:"ml-2 flex-shrink-0",children:(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",style:{width:"24px",height:"24px",opacity:U?1:.6}})}),(0,Ue.jsx)(Lb,{variant:"icon-only",onBarcodeReceived:e=>b(e)})]})}),(0,Ue.jsx)(mt,{mode:"popLayout",initial:!1,children:"categories"===s?(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,ease:[.4,0,.2,1]},style:{flex:1,display:"flex",flexDirection:"column",position:"relative",backgroundColor:jk},children:[(0,Ue.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px",padding:"12px 16px",flex:1,alignContent:"start"},children:Ik.map(e=>(0,Ue.jsxs)("div",{onClick:()=>{return t=e.id,u(t),void l("product-list");var t},style:{backgroundColor:Nk,borderRadius:"16px",padding:"16px",cursor:"pointer",boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},className:"active:scale-[0.98] transition-transform",children:[(0,Ue.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,Ue.jsx)("span",{style:{fontSize:"18px",fontWeight:500,color:vk},children:e.title}),(0,Ue.jsx)("svg",{style:{width:"20px",height:"20px",color:wk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,Ue.jsx)("img",{src:e.icon,alt:"",style:{width:"40px",height:"40px"},onError:e=>{e.currentTarget.style.display="none"}}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("span",{style:{fontSize:"20px",fontWeight:600,color:vk},children:e.count.toLocaleString("id-ID")}),(0,Ue.jsx)("span",{style:{fontSize:"16px",color:bk,marginLeft:"4px"},children:"item"})]})]})]},e.id))}),(0,Ue.jsxs)("div",{style:{position:"absolute",bottom:"24px",right:"24px",display:"flex",flexDirection:"row",gap:"12px",zIndex:10},children:[(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>console.log("Sort clicked - TODO"),style:{width:"56px",height:"56px",borderRadius:"50%",backgroundColor:Nk,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",justifyContent:"center",border:"none",cursor:"pointer"},children:(0,Ue.jsx)("svg",{style:{width:"24px",height:"24px",color:bk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})})}),(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>I(!0),style:{width:"56px",height:"56px",borderRadius:"50%",backgroundColor:wk,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",justifyContent:"center",border:"none",cursor:"pointer"},children:(0,Ue.jsx)("svg",{style:{width:"28px",height:"28px",color:Nk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]})]},"categories-page"):(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,ease:[.4,0,.2,1]},className:"flex-1 flex flex-col min-h-0 relative",style:{backgroundColor:jk},children:[(0,Ue.jsxs)("div",{ref:Y,onScroll:()=>{if(!Y.current||m||!j)return;const{scrollTop:e,scrollHeight:t,clientHeight:n}=Y.current;t-e<=n+100&&q(!1)},className:"flex-1 min-h-0 overflow-y-auto px-4 pb-24 pt-2",style:{backgroundColor:jk},children:[x&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-3 p-4 rounded-xl text-sm",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(Ak),color:Ak},children:[x,(0,Ue.jsx)("button",{onClick:()=>q(!0),className:"ml-2 underline",children:"Coba lagi"})]}),0===d.length&&!m&&!x&&(0,Ue.jsxs)("div",{className:"mt-8 text-center",style:{color:bk},children:[(0,Ue.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4",style:{color:jk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),(0,Ue.jsx)("p",{className:"text-lg font-medium",children:"Belum ada produk"}),(0,Ue.jsx)("p",{className:"mt-1",children:"Tambahkan produk pertama Anda"})]}),m&&0===d.length&&(0,Ue.jsx)("div",{className:"mt-8 text-center",style:{color:bk},children:"Memuat..."}),(0,Ue.jsx)("div",{className:"space-y-2",children:d.map(e=>{return(0,Ue.jsxs)("div",{onClick:()=>(e=>{f(e)})(e),className:"rounded-xl overflow-hidden cursor-pointer active:scale-[0.98] transition-transform",style:{backgroundColor:Nk,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between px-3 py-2",children:[(0,Ue.jsx)("div",{className:"min-w-0 text-left",children:Tk(e.nama_produk)}),(0,Ue.jsx)("svg",{className:"w-5 h-5 flex-shrink-0 ml-2",style:{color:wk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),(0,Ue.jsxs)("div",{className:"flex items-end justify-between px-3 py-2",style:{backgroundColor:Ck},children:[(0,Ue.jsx)("span",{className:"text-sm",style:{color:bk},children:e.kategori?(0,Ue.jsxs)(Ue.Fragment,{children:["Kategori ",(0,Ue.jsx)("span",{className:"font-semibold",style:{color:vk},children:e.kategori})]}):e.barcode?(0,Ue.jsxs)(Ue.Fragment,{children:["Barcode ",(0,Ue.jsx)("span",{className:"font-semibold",style:{color:vk},children:e.barcode})]}):null}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsxs)("div",{className:"flex items-baseline gap-1 justify-end",children:[(0,Ue.jsx)("span",{className:"font-bold text-lg",style:{color:vk},children:e.stok}),(0,Ue.jsx)("span",{className:"text-sm",style:{color:bk},children:e.satuan})]}),(0,Ue.jsx)("div",{className:"h-0.5 mt-1 rounded-full",style:{backgroundColor:(t=e.stok,t<12?Ak:t<24?Ek:Sk),width:"100%",minWidth:"50px"}})]})]})]},e.id);var t})}),m&&d.length>0&&(0,Ue.jsx)("div",{className:"py-4 text-center",style:{color:bk},children:"Memuat lebih banyak..."}),!j&&d.length>0&&(0,Ue.jsx)("div",{className:"py-4 text-center text-sm",style:{color:bk},children:"Semua produk ditampilkan"})]}),(0,Ue.jsxs)("div",{className:"absolute bottom-6 right-6 flex flex-col gap-3 z-10",children:[(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>K(!0),className:"w-14 h-14 rounded-full flex items-center justify-center shadow-lg",style:{backgroundColor:kk},children:(0,Ue.jsx)("svg",{className:"w-7 h-7",style:{color:vk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>I(!0),className:"w-14 h-14 rounded-full flex items-center justify-center shadow-lg",style:{backgroundColor:yk},children:(0,Ue.jsx)("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]})]},"product-list-page")}),(0,Ue.jsx)(Dw,{isOpen:A,onClose:()=>I(!1),onSuccess:()=>{I(!1),q(!0)},categories:S.map(e=>({id:e,label:e}))}),D&&(0,Ue.jsx)(Vw,{isOpen:T,onClose:()=>{P(!1),M(null)},product:D,onSuccess:()=>{if(P(!1),M(null),q(!0),p){const e=d.find(e=>e.id===p.id);e&&f(e)}}}),O&&(0,Ue.jsx)(tk,{isOpen:R,onClose:()=>{F(!1),B(null)},product:O,defaultType:L,onSuccess:()=>{if(F(!1),B(null),q(!0),p){const e=d.find(e=>e.id===p.id);e&&f(e)}}}),(0,Ue.jsx)(xk,{isOpen:W,onClose:()=>V(!1),onSuccess:()=>{V(!1)}}),(0,Ue.jsx)(mt,{children:G&&(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 flex items-end justify-center",onClick:()=>K(!1),children:[(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/30"}),(0,Ue.jsxs)(yc.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"relative w-full max-w-md rounded-t-2xl p-6",style:{backgroundColor:Nk},onClick:e=>e.stopPropagation(),children:[(0,Ue.jsx)("div",{className:"w-12 h-1 rounded-full mx-auto mb-4",style:{backgroundColor:kk}}),(0,Ue.jsx)("h3",{className:"text-lg font-bold mb-4",style:{color:vk},children:"Filter & Sortir"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("div",{className:"text-sm font-medium mb-2",style:{color:bk},children:"Level Stok"}),(0,Ue.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,Ue.jsx)("button",{className:"px-3 py-2 rounded-lg text-sm",style:{backgroundColor:Ck},children:"\ud83d\udd34 Kritis (<12)"}),(0,Ue.jsx)("button",{className:"px-3 py-2 rounded-lg text-sm",style:{backgroundColor:Ck},children:"\ud83d\udfe1 Rendah (12-23)"}),(0,Ue.jsx)("button",{className:"px-3 py-2 rounded-lg text-sm",style:{backgroundColor:Ck},children:"\ud83d\udfe2 Aman (\u226524)"})]})]}),(0,Ue.jsxs)("div",{className:"mb-6",children:[(0,Ue.jsx)("div",{className:"text-sm font-medium mb-2",style:{color:bk},children:"Urutkan"}),(0,Ue.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,Ue.jsx)("button",{className:"px-3 py-2 rounded-lg text-sm",style:{backgroundColor:Ck},children:"A-Z"}),(0,Ue.jsx)("button",{className:"px-3 py-2 rounded-lg text-sm",style:{backgroundColor:Ck},children:"Stok \u2191"}),(0,Ue.jsx)("button",{className:"px-3 py-2 rounded-lg text-sm",style:{backgroundColor:Ck},children:"Stok \u2193"})]})]}),(0,Ue.jsx)("button",{onClick:()=>K(!1),className:"w-full py-3 rounded-xl text-white font-semibold",style:{backgroundColor:yk},children:"Terapkan Filter"})]})]})}),(0,Ue.jsx)(Sb,{isOpen:U,onClose:()=>H(!1),onBarcodeDetected:e=>{b(e),H(!1)}})]})},Mk=e=>new Intl.NumberFormat("id-ID").format(e),Rk=e=>{switch(e){case"kas":return"Kas";case"bank":return"Bank";case"ewallet":return"E-Wallet";default:return e}},Fk=e=>{switch(e){case"kas":return"\ud83d\udcb5";case"bank":return"\ud83c\udfe6";case"ewallet":return"\ud83d\udcf1";default:return"\ud83d\udcb0"}},Ok=[{id:"modal_awal",label:"Modal Awal",description:"Modal pertama kali saat memulai usaha",direction:"masuk"},{id:"setor_modal",label:"Setor Modal",description:"Tambahan modal dari pemilik",direction:"masuk"},{id:"prive",label:"Prive",description:"Pengambilan oleh pemilik untuk keperluan pribadi",direction:"keluar"}],Bk={tipe:"setor_modal",nominal:0,tanggal:(new Date).toISOString().split("T")[0]},Lk=e=>new Intl.NumberFormat("id-ID").format(e),zk=e=>Ok.find(t=>t.id===e),Wk="#F97316",Vk="#737373",Uk="#D4D4D4",Hk="#E5E5E5",Gk="#F5F5F5",Kk="#FFFFFF",Xk="#262626",Yk="#22C55E",qk="#EF4444",Zk=e=>{let{isOpen:t,onClose:n,onSuccess:r,accounts:o=[]}=e;const[i,s]=(0,a.useState)(Bk),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;t&&(s(tt(tt({},Bk),{},{tanggal:(new Date).toISOString().split("T")[0],akun_id:(null===(e=o[0])||void 0===e?void 0:e.id)||""})),d(null),p(null),setTimeout(()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.focus()},100))},[t,o]);const x=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},y=zk(i.tipe),v=i.nominal>0,b=()=>{m(!0),setTimeout(()=>m(!1),500)};if(!t)return null;if(h){const e=zk(h.tipe);return(0,Ue.jsxs)("div",{className:"h-full flex flex-col",style:{backgroundColor:Gk},children:[(0,Ue.jsx)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:Kk,borderColor:Hk},children:(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:Xk},children:null===e||void 0===e?void 0:e.label})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center p-6",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200,damping:15},className:"text-center",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1,type:"spring",stiffness:300},className:"w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.3,duration:.5},className:"w-10 h-10",style:{color:Yk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsxs)(yc.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-xl font-semibold mb-2",style:{color:Xk},children:[null===e||void 0===e?void 0:e.label," Berhasil Dicatat"]}),(0,Ue.jsxs)(yc.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-3xl font-bold mb-3",style:{color:Wk},children:["Rp ",Lk(h.nominal)]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"inline-flex items-center gap-2 px-4 py-2 rounded-full",style:{backgroundColor:"masuk"===(null===e||void 0===e?void 0:e.direction)?"#DCFCE7":"#FEE2E2",color:"masuk"===(null===e||void 0===e?void 0:e.direction)?Yk:qk},children:["masuk"===(null===e||void 0===e?void 0:e.direction)?(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}):(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),(0,Ue.jsxs)("span",{className:"text-sm font-medium",children:["masuk"===(null===e||void 0===e?void 0:e.direction)?"Menambah":"Mengurangi"," Ekuitas"]})]})]})})]})}return(0,Ue.jsxs)("div",{className:"h-full flex flex-col",style:{backgroundColor:Gk},children:[(0,Ue.jsx)("div",{className:"flex items-center justify-between px-4 border-b",style:{height:"60px",backgroundColor:Kk,borderColor:Hk},children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:Uk},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:Xk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:Xk},children:"Modal & Prive"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:Vk},children:"Ekuitas Pemilik"})]})]})}),(0,Ue.jsxs)(yc.div,{className:"flex-1 overflow-y-auto p-4",animate:f?{x:[-10,10,-10,10,0]}:{},transition:{duration:.4},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-3 rounded-xl flex items-center gap-3",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(qk)},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 flex-shrink-0",style:{color:qk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Ue.jsx)("span",{className:"text-sm",style:{color:qk},children:u})]})}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:Kk,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:Hk},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Wk},children:"Jenis Transaksi"})}),(0,Ue.jsx)("div",{className:"p-3 space-y-2",children:Ok.map((e,t)=>(0,Ue.jsx)(yc.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1+.05*t},type:"button",onClick:()=>x("tipe",e.id),className:"w-full px-4 py-3 rounded-xl text-left transition-all active:scale-[0.98]",style:{backgroundColor:i.tipe===e.id?"masuk"===e.direction?Yk:qk:Gk,color:i.tipe===e.id?Kk:Xk},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",children:e.label}),(0,Ue.jsx)("div",{className:"text-sm",style:{opacity:i.tipe===e.id?.9:1,color:i.tipe===e.id?Kk:Vk},children:e.description})]}),(0,Ue.jsx)("div",{className:"text-sm font-medium px-2 py-1 rounded-lg",style:{backgroundColor:i.tipe===e.id?"rgba(255,255,255,0.2)":"masuk"===e.direction?"#DCFCE7":"#FEE2E2",color:i.tipe===e.id?Kk:"masuk"===e.direction?Yk:qk},children:"masuk"===e.direction?"+ Masuk":"- Keluar"})]})},e.id))})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:Kk,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:Hk},children:(0,Ue.jsxs)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Wk},children:["Nominal ",(0,Ue.jsx)("span",{style:{color:qk},children:"*"})]})}),(0,Ue.jsx)("div",{className:"p-4",children:(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-lg font-medium",style:{color:Vk},children:"Rp"}),(0,Ue.jsx)("input",{ref:g,type:"text",inputMode:"numeric",value:i.nominal>0?Lk(i.nominal):"",onChange:e=>(e=>{const t=parseInt(e.replace(/\D/g,""),10)||0;x("nominal",t)})(e.target.value),placeholder:"0",className:"w-full pl-12 pr-4 py-4 text-2xl font-bold text-right rounded-xl border-2 transition-colors",style:{borderColor:i.nominal>0?Wk:Hk,color:Xk,backgroundColor:Gk}})]})})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:Kk,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:Hk},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:Wk},children:"Detail Transaksi"})}),(0,Ue.jsxs)("div",{className:"p-4 space-y-4",children:[o.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:Xk},children:"masuk"===(null===y||void 0===y?void 0:y.direction)?"Masuk ke Akun":"Ambil dari Akun"}),(0,Ue.jsxs)("select",{value:i.akun_id||"",onChange:e=>x("akun_id",e.target.value),className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:Hk,backgroundColor:Gk,color:Xk},children:[(0,Ue.jsx)("option",{value:"",children:"-- Pilih Akun --"}),o.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.nama_akun},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:Xk},children:"Tanggal"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal,onChange:e=>x("tanggal",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:Hk,backgroundColor:Gk,color:Xk}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:Xk},children:"Nama Pemilik"}),(0,Ue.jsx)("input",{type:"text",value:i.nama_pemilik||"",onChange:e=>x("nama_pemilik",e.target.value),placeholder:"Opsional",className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:Hk,backgroundColor:Gk,color:Xk}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:Xk},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>x("keterangan",e.target.value),placeholder:"Contoh: ".concat(null===y||void 0===y?void 0:y.label," bulan Desember"),rows:2,className:"w-full px-4 py-3 rounded-xl border transition-colors resize-none",style:{borderColor:Hk,backgroundColor:Gk,color:Xk}})]})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-4 rounded-xl flex items-start gap-3",style:{backgroundColor:"masuk"===(null===y||void 0===y?void 0:y.direction)?"#DCFCE7":"#FEE2E2"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:"masuk"===(null===y||void 0===y?void 0:y.direction)?Yk:qk},children:"masuk"===(null===y||void 0===y?void 0:y.direction)?(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:Kk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}):(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:Kk},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:"masuk"===(null===y||void 0===y?void 0:y.direction)?Yk:qk},children:"masuk"===(null===y||void 0===y?void 0:y.direction)?"Menambah Modal Pemilik":"Mengurangi Modal Pemilik"}),(0,Ue.jsxs)("div",{className:"text-sm mt-1",style:{color:"masuk"===(null===y||void 0===y?void 0:y.direction)?"#166534":"#991B1B"},children:["modal_awal"===i.tipe&&"Dicatat sebagai modal awal usaha di neraca","setor_modal"===i.tipe&&"Dicatat sebagai penambahan ekuitas","prive"===i.tipe&&"Dicatat sebagai pengurangan ekuitas (bukan beban)"]})]})]})]}),(0,Ue.jsx)("div",{className:"px-4 py-4 border-t",style:{backgroundColor:Kk,borderColor:Hk},children:(0,Ue.jsxs)("div",{className:"flex gap-3",children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium transition-all active:scale-[0.98]",style:{backgroundColor:Gk,color:Xk},children:"Batal"}),(0,Ue.jsx)("button",{onClick:async()=>{if(!v)return d("Masukkan nominal"),void b();c(!0),d(null);try{var e,t;const n=localStorage.getItem("access_token"),a=localStorage.getItem("tenant_id")||"evlogia",o={transaction_type:i.tipe,isModal:"modal_awal"===i.tipe||"setor_modal"===i.tipe,isPrive:"prive"===i.tipe,nominal:i.nominal,total_amount:i.nominal,akun_id:i.akun_id||null,nama_pemilik:(null===(e=i.nama_pemilik)||void 0===e?void 0:e.trim())||null,keterangan:(null===(t=i.keterangan)||void 0===t?void 0:t.trim())||(null===y||void 0===y?void 0:y.label),tanggal:i.tanggal,payment_method:"tunai"},s=await fetch("/api/tenant/".concat(a,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] ".concat(null===y||void 0===y?void 0:y.label),session_id:"modal-prive-".concat(Date.now()),conversation_context:JSON.stringify({form_data:o})})});if(401===s.status)return void d("Sesi berakhir. Silakan login ulang.");if(!s.ok){const e=await s.json();throw new Error(e.detail||e.message||"Gagal menyimpan transaksi")}const l=await s.json(),c={success:!0,message:l.message||"".concat(null===y||void 0===y?void 0:y.label," berhasil dicatat"),transaction_id:l.transaction_id||"",tipe:i.tipe,nominal:i.nominal};p(c),setTimeout(()=>{r(c)},2e3)}catch(n){d(n.message||"Gagal menyimpan. Coba lagi."),b(),console.error("[ModalPriveForm] Submit error:",n)}finally{c(!1)}},disabled:l||!v,className:"flex-1 py-3.5 rounded-xl font-medium transition-all active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",style:{backgroundColor:"masuk"===(null===y||void 0===y?void 0:y.direction)?Yk:qk,color:Kk},children:l?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Menyimpan..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Simpan ",null===y||void 0===y?void 0:y.label]})})]})})]})},Jk=[{id:"sewa",label:"Sewa",description:"Sewa ruko, gudang, atau tempat usaha",icon:"\ud83c\udfe0"},{id:"asuransi",label:"Asuransi",description:"Premi asuransi untuk usaha atau aset",icon:"\ud83d\udee1\ufe0f"},{id:"langganan",label:"Langganan",description:"Software, layanan, atau subscription",icon:"\ud83d\udcf1"},{id:"lainnya",label:"Lainnya",description:"Beban dibayar dimuka lainnya",icon:"\ud83d\udccb"}],Qk={nama_beban:"",kategori:"sewa",nominal_total:0,tanggal_bayar:(new Date).toISOString().split("T")[0],periode_mulai:(new Date).toISOString().split("T")[0],periode_selesai:"",jumlah_bulan:0,amortisasi_per_bulan:0},$k=e=>new Intl.NumberFormat("id-ID").format(e),ej=e=>{let{isOpen:t,onClose:n,onSuccess:r,accounts:o=[]}=e;const[i,s]=(0,a.useState)(Qk),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),f=(0,a.useRef)(null),m=(0,a.useMemo)(()=>{const e=((e,t)=>{if(!e||!t)return 0;const n=new Date(e),r=new Date(t);if(r<=n)return 0;const a=12*(r.getFullYear()-n.getFullYear())+(r.getMonth()-n.getMonth())+1;return Math.max(1,a)})(i.periode_mulai,i.periode_selesai),t=((e,t)=>!e||t<=0?0:Math.round(e/t))(i.nominal_total,e);return{months:e,amortisasi:t}},[i.periode_mulai,i.periode_selesai,i.nominal_total]);(0,a.useEffect)(()=>{s(e=>tt(tt({},e),{},{jumlah_bulan:m.months,amortisasi_per_bulan:m.amortisasi}))},[m]),(0,a.useEffect)(()=>{var e;t&&(s(tt(tt({},Qk),{},{tanggal_bayar:(new Date).toISOString().split("T")[0],periode_mulai:(new Date).toISOString().split("T")[0],akun_id:(null===(e=o[0])||void 0===e?void 0:e.id)||""})),d(null),p(null),setTimeout(()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.focus()},100))},[t,o]);const g=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},x=(y=i.kategori,Jk.find(e=>e.id===y));var y;const v=i.nama_beban.trim()&&i.nominal_total>0&&i.periode_mulai&&i.periode_selesai&&m.months>0;return t?h?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)("div",{className:"bg-white w-full max-w-sm mx-4 rounded-xl shadow-xl p-6 text-center",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Berhasil Dicatat"}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold text-amber-600 mb-2",children:["Rp ",$k(h.nominal_total)]}),(0,Ue.jsx)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg text-left",children:(0,Ue.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Periode:"}),(0,Ue.jsxs)("span",{className:"font-medium",children:[h.jumlah_bulan," bulan"]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,Ue.jsx)("span",{children:"Amortisasi/bulan:"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$k(h.amortisasi_per_bulan)]})]})]})}),(0,Ue.jsxs)("p",{className:"text-xs text-gray-500 mt-3",children:["Akan otomatis dibebankan Rp ",$k(h.amortisasi_per_bulan),"/bulan"]})]})}):(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,Ue.jsxs)("div",{className:"bg-white w-full max-w-md mx-4 rounded-xl shadow-xl max-h-[90vh] flex flex-col",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Beban Dibayar di Muka"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Prepaid Expenses (1105)"})]}),(0,Ue.jsx)("button",{onClick:n,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:[u&&(0,Ue.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:u}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nama Beban ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("input",{ref:f,type:"text",value:i.nama_beban,onChange:e=>g("nama_beban",e.target.value),placeholder:"Contoh: Sewa Ruko 6 Bulan",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kategori"}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Jk.map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>g("kategori",e.id),className:"px-3 py-2.5 rounded-lg text-left transition-colors ".concat(i.kategori===e.id?"bg-amber-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsx)("span",{className:"text-lg",children:e.icon}),(0,Ue.jsx)("span",{className:"font-medium text-sm",children:e.label})]})},e.id))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Total Nominal ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:i.nominal_total>0?$k(i.nominal_total):"",onChange:e=>(e=>{const t=parseInt(e.replace(/\D/g,""),10)||0;g("nominal_total",t)})(e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tanggal Bayar"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal_bayar,onChange:e=>g("tanggal_bayar",e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Periode Mulai ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("input",{type:"date",value:i.periode_mulai,onChange:e=>g("periode_mulai",e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Periode Selesai ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("input",{type:"date",value:i.periode_selesai,onChange:e=>g("periode_selesai",e.target.value),min:i.periode_mulai,className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),m.months>0&&i.nominal_total>0&&(0,Ue.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),(0,Ue.jsx)("span",{className:"font-medium text-blue-700",children:"Perhitungan Amortisasi"})]}),(0,Ue.jsxs)("div",{className:"space-y-1 text-sm text-blue-700",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Jumlah Periode:"}),(0,Ue.jsxs)("span",{className:"font-semibold",children:[m.months," bulan"]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Amortisasi per Bulan:"}),(0,Ue.jsxs)("span",{className:"font-semibold",children:["Rp ",$k(m.amortisasi)]})]})]}),(0,Ue.jsxs)("div",{className:"mt-2 pt-2 border-t border-blue-200 text-xs text-blue-600",children:["Rp ",$k(i.nominal_total)," \xf7 ",m.months," bulan = Rp ",$k(m.amortisasi),"/bulan"]})]}),o.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bayar dari Akun"}),(0,Ue.jsxs)("select",{value:i.akun_id||"",onChange:e=>g("akun_id",e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[(0,Ue.jsx)("option",{value:"",children:"-- Pilih Akun --"}),o.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.nama_akun},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>g("keterangan",e.target.value),placeholder:"Opsional - detail tambahan",rows:2,className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),(0,Ue.jsxs)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,Ue.jsx)("div",{className:"text-sm font-medium text-amber-700",children:"Catatan SAK EMKM"}),(0,Ue.jsx)("div",{className:"text-xs text-amber-600 mt-1",children:"Beban Dibayar di Muka dicatat sebagai Aset Lancar (1105) saat pembayaran. Setiap bulan akan otomatis dibebankan sebagai Beban sesuai amortisasi."})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 border-t border-gray-200 flex gap-3",children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:"Batal"}),(0,Ue.jsx)("button",{onClick:async()=>{if(v){c(!0),d(null);try{var e;const t=localStorage.getItem("access_token"),n=localStorage.getItem("tenant_id")||"evlogia",a={transaction_type:"beban_dibayar_dimuka",jenisAset:"beban_dibayar_dimuka",nama_beban:i.nama_beban.trim(),kategori:i.kategori,nominal:i.nominal_total,total_amount:i.nominal_total,tanggal:i.tanggal_bayar,periode_mulai:i.periode_mulai,periode_selesai:i.periode_selesai,jumlah_bulan:m.months,amortisasi_per_bulan:m.amortisasi,akun_id:i.akun_id||null,keterangan:(null===(e=i.keterangan)||void 0===e?void 0:e.trim())||"".concat(null===x||void 0===x?void 0:x.label,": ").concat(i.nama_beban),payment_method:"tunai"},o=await fetch("/api/tenant/".concat(n,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Beban Dibayar di Muka",session_id:"prepaid-".concat(Date.now()),conversation_context:JSON.stringify({form_data:a})})});if(401===o.status)return void d("Sesi berakhir. Silakan login ulang.");if(!o.ok){const e=await o.json();throw new Error(e.detail||e.message||"Gagal menyimpan transaksi")}const s=await o.json(),l={success:!0,message:s.message||"Beban Dibayar di Muka berhasil dicatat",transaction_id:s.transaction_id||"",nominal_total:i.nominal_total,jumlah_bulan:m.months,amortisasi_per_bulan:m.amortisasi};p(l),setTimeout(()=>{r(l)},2e3)}catch(t){d(t.message||"Gagal menyimpan. Coba lagi."),console.error("[BebanDibayarDiMukaForm] Submit error:",t)}finally{c(!1)}}else i.nama_beban.trim()?i.nominal_total<=0?d("Masukkan nominal"):m.months<=0&&d("Periode tidak valid - tanggal selesai harus setelah tanggal mulai"):d("Masukkan nama beban")},disabled:l||!v,className:"flex-1 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"Menyimpan...":"Simpan"})]})]})}):null},tj=[{id:"komisi",label:"Komisi",description:"Fee/komisi dari referral, affiliate, dll"},{id:"bonus",label:"Bonus",description:"Bonus pencapaian target, insentif"},{id:"jasa_lainnya",label:"Jasa Lainnya",description:"Pendapatan jasa di luar aktivitas utama"},{id:"lainnya",label:"Lainnya",description:"Pendapatan lain yang tidak termasuk kategori di atas"}],nj={tipe:"pendapatan_lain",kategori:"komisi",nominal:0,tanggal:(new Date).toISOString().split("T")[0]},rj={tipe:"pendapatan_bunga",nominal:0,sumber_bank:"",tanggal:(new Date).toISOString().split("T")[0]},aj=["BCA","Mandiri","BRI","BNI","CIMB Niaga","Permata","Danamon","OCBC NISP","Panin","Lainnya"],oj=e=>new Intl.NumberFormat("id-ID").format(e),ij="#F97316",sj="#737373",lj="#D4D4D4",cj="#E5E5E5",uj="#F5F5F5",dj="#FFFFFF",hj="#262626",pj="#22C55E",fj="#EF4444",mj=e=>{let{isOpen:t,onClose:n,onSuccess:r,accounts:o=[]}=e;const[i,s]=(0,a.useState)(nj),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;t&&(s(tt(tt({},nj),{},{tanggal:(new Date).toISOString().split("T")[0],akun_id:(null===(e=o[0])||void 0===e?void 0:e.id)||""})),d(null),p(null),setTimeout(()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.focus()},100))},[t,o]);const x=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},y=(v=i.kategori,tj.find(e=>e.id===v));var v;const b=i.nominal>0,w=()=>{m(!0),setTimeout(()=>m(!1),500)};return t?h?(0,Ue.jsxs)("div",{className:"h-full flex flex-col",style:{backgroundColor:uj},children:[(0,Ue.jsx)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:dj,borderColor:cj},children:(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:hj},children:"Pendapatan Lain-lain"})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center p-6",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200,damping:15},className:"text-center",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1,type:"spring",stiffness:300},className:"w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.3,duration:.5},className:"w-10 h-10",style:{color:pj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)(yc.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-xl font-semibold mb-2",style:{color:hj},children:"Pendapatan Berhasil Dicatat"}),(0,Ue.jsxs)(yc.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-3xl font-bold mb-3",style:{color:pj},children:["+ Rp ",oj(h.nominal)]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"inline-flex items-center gap-2 px-4 py-2 rounded-full",style:{backgroundColor:"#DCFCE7",color:pj},children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Ue.jsx)("span",{className:"text-sm font-medium",children:"Menambah Kas"})]})]})})]}):(0,Ue.jsxs)("div",{className:"h-full flex flex-col",style:{backgroundColor:uj},children:[(0,Ue.jsx)("div",{className:"flex items-center justify-between px-4 border-b",style:{height:"60px",backgroundColor:dj,borderColor:cj},children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:lj},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:hj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:hj},children:"Pendapatan Lain-lain"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:sj},children:"SAK EMKM 4201"})]})]})}),(0,Ue.jsxs)(yc.div,{className:"flex-1 overflow-y-auto p-4",animate:f?{x:[-10,10,-10,10,0]}:{},transition:{duration:.4},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-3 rounded-xl flex items-center gap-3",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(fj)},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 flex-shrink-0",style:{color:fj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Ue.jsx)("span",{className:"text-sm",style:{color:fj},children:u})]})}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:dj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:cj},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:ij},children:"Kategori Pendapatan"})}),(0,Ue.jsx)("div",{className:"p-3 grid grid-cols-2 gap-2",children:tj.map((e,t)=>(0,Ue.jsxs)(yc.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1+.05*t},type:"button",onClick:()=>x("kategori",e.id),className:"px-3 py-3 rounded-xl text-left transition-all active:scale-[0.98]",style:{backgroundColor:i.kategori===e.id?ij:uj,color:i.kategori===e.id?dj:hj},children:[(0,Ue.jsx)("div",{className:"font-medium text-sm",children:e.label}),(0,Ue.jsx)("div",{className:"text-xs mt-0.5",style:{color:i.kategori===e.id?"rgba(255,255,255,0.8)":sj},children:e.description.length>30?e.description.substring(0,30)+"...":e.description})]},e.id))})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:dj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:cj},children:(0,Ue.jsxs)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:ij},children:["Nominal ",(0,Ue.jsx)("span",{style:{color:fj},children:"*"})]})}),(0,Ue.jsx)("div",{className:"p-4",children:(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-lg font-medium",style:{color:sj},children:"Rp"}),(0,Ue.jsx)("input",{ref:g,type:"text",inputMode:"numeric",value:i.nominal>0?oj(i.nominal):"",onChange:e=>(e=>{const t=parseInt(e.replace(/\D/g,""),10)||0;x("nominal",t)})(e.target.value),placeholder:"0",className:"w-full pl-12 pr-4 py-4 text-2xl font-bold text-right rounded-xl border-2 transition-colors",style:{borderColor:i.nominal>0?pj:cj,color:hj,backgroundColor:uj}})]})})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:dj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:cj},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:ij},children:"Detail Pendapatan"})}),(0,Ue.jsxs)("div",{className:"p-4 space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:hj},children:"Sumber Pendapatan"}),(0,Ue.jsx)("input",{type:"text",value:i.sumber||"",onChange:e=>x("sumber",e.target.value),placeholder:"Contoh: Referral Tokopedia, Bonus Supplier",className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:cj,backgroundColor:uj,color:hj}})]}),o.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:hj},children:"Masuk ke Akun"}),(0,Ue.jsxs)("select",{value:i.akun_id||"",onChange:e=>x("akun_id",e.target.value),className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:cj,backgroundColor:uj,color:hj},children:[(0,Ue.jsx)("option",{value:"",children:"-- Pilih Akun --"}),o.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.nama_akun},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:hj},children:"Tanggal"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal,onChange:e=>x("tanggal",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:cj,backgroundColor:uj,color:hj}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:hj},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>x("keterangan",e.target.value),placeholder:"Contoh: ".concat(null===y||void 0===y?void 0:y.label," dari..."),rows:2,className:"w-full px-4 py-3 rounded-xl border transition-colors resize-none",style:{borderColor:cj,backgroundColor:uj,color:hj}})]})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-4 rounded-xl flex items-start gap-3",style:{backgroundColor:"#DCFCE7"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:pj},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:dj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:pj},children:"Menambah Pendapatan Usaha"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#166534"},children:"Dicatat sebagai pendapatan lain-lain dalam Laporan Laba Rugi (4201)"})]})]})]}),(0,Ue.jsx)("div",{className:"px-4 py-4 border-t",style:{backgroundColor:dj,borderColor:cj},children:(0,Ue.jsxs)("div",{className:"flex gap-3",children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium transition-all active:scale-[0.98]",style:{backgroundColor:uj,color:hj},children:"Batal"}),(0,Ue.jsx)("button",{onClick:async()=>{if(!b)return d("Masukkan nominal pendapatan"),void w();c(!0),d(null);try{var e,t;const n=localStorage.getItem("access_token"),a=localStorage.getItem("tenant_id")||"evlogia",o={transaction_type:"pendapatan_lain",kategori:i.kategori,nominal:i.nominal,total_amount:i.nominal,sumber:(null===(e=i.sumber)||void 0===e?void 0:e.trim())||null,akun_id:i.akun_id||null,keterangan:(null===(t=i.keterangan)||void 0===t?void 0:t.trim())||"Pendapatan ".concat(null===y||void 0===y?void 0:y.label),tanggal:i.tanggal,akun_perkiraan:"4201",payment_method:"tunai"},s=await fetch("/api/tenant/".concat(a,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Pendapatan Lain-lain",session_id:"pendapatan-lain-".concat(Date.now()),conversation_context:JSON.stringify({form_data:o})})});if(401===s.status)return void d("Sesi berakhir. Silakan login ulang.");if(!s.ok){const e=await s.json();throw new Error(e.detail||e.message||"Gagal menyimpan transaksi")}const l=await s.json(),c={success:!0,message:l.message||"Pendapatan ".concat(null===y||void 0===y?void 0:y.label," berhasil dicatat"),transaction_id:l.transaction_id||"",tipe:"pendapatan_lain",nominal:i.nominal};p(c),setTimeout(()=>{r(c)},2e3)}catch(n){d(n.message||"Gagal menyimpan. Coba lagi."),w(),console.error("[PendapatanLainForm] Submit error:",n)}finally{c(!1)}},disabled:l||!b,className:"flex-1 py-3.5 rounded-xl font-medium transition-all active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",style:{backgroundColor:pj,color:dj},children:l?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Menyimpan..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Simpan Pendapatan"]})})]})})]}):null},gj="#F97316",xj="#3B82F6",yj="#737373",vj="#D4D4D4",bj="#E5E5E5",wj="#F5F5F5",kj="#FFFFFF",jj="#262626",Cj="#EF4444",Nj=e=>{let{isOpen:t,onClose:n,onSuccess:r,accounts:o=[]}=e;const[i,s]=(0,a.useState)(rj),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;t&&(s(tt(tt({},rj),{},{tanggal:(new Date).toISOString().split("T")[0],akun_id:(null===(e=o[0])||void 0===e?void 0:e.id)||""})),d(null),p(null),setTimeout(()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.focus()},100))},[t,o]);const x=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},y=i.nominal>0&&""!==i.sumber_bank.trim(),v=()=>{m(!0),setTimeout(()=>m(!1),500)};return t?h?(0,Ue.jsxs)("div",{className:"h-full flex flex-col",style:{backgroundColor:wj},children:[(0,Ue.jsx)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:kj,borderColor:bj},children:(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:jj},children:"Pendapatan Bunga"})}),(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center p-6",children:(0,Ue.jsxs)(yc.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200,damping:15},className:"text-center",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1,type:"spring",stiffness:300},className:"w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DBEAFE"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.3,duration:.5},className:"w-10 h-10",style:{color:xj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)(yc.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-xl font-semibold mb-2",style:{color:jj},children:"Bunga Berhasil Dicatat"}),(0,Ue.jsxs)(yc.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-3xl font-bold mb-3",style:{color:xj},children:["+ Rp ",oj(h.nominal)]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"inline-flex items-center gap-2 px-4 py-2 rounded-full",style:{backgroundColor:"#DBEAFE",color:xj},children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),(0,Ue.jsx)("span",{className:"text-sm font-medium",children:"Pendapatan Bunga Bank"})]})]})})]}):(0,Ue.jsxs)("div",{className:"h-full flex flex-col",style:{backgroundColor:wj},children:[(0,Ue.jsx)("div",{className:"flex items-center justify-between px-4 border-b",style:{height:"60px",backgroundColor:kj,borderColor:bj},children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:vj},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:jj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:jj},children:"Pendapatan Bunga"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:yj},children:"SAK EMKM 7101"})]})]})}),(0,Ue.jsxs)(yc.div,{className:"flex-1 overflow-y-auto p-4",animate:f?{x:[-10,10,-10,10,0]}:{},transition:{duration:.4},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-3 rounded-xl flex items-center gap-3",style:{backgroundColor:"#FEF2F2",border:"1px solid ".concat(Cj)},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 flex-shrink-0",style:{color:Cj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Ue.jsx)("span",{className:"text-sm",style:{color:Cj},children:u})]})}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:kj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:bj},children:(0,Ue.jsxs)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:gj},children:["Sumber Bank ",(0,Ue.jsx)("span",{style:{color:Cj},children:"*"})]})}),(0,Ue.jsx)("div",{className:"p-3 grid grid-cols-3 gap-2",children:aj.map((e,t)=>(0,Ue.jsx)(yc.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1+.03*t},type:"button",onClick:()=>x("sumber_bank",e),className:"px-3 py-2.5 rounded-xl text-center transition-all active:scale-[0.98]",style:{backgroundColor:i.sumber_bank===e?xj:wj,color:i.sumber_bank===e?kj:jj},children:(0,Ue.jsx)("span",{className:"font-medium text-sm",children:e})},e))})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:kj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:bj},children:(0,Ue.jsxs)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:gj},children:["Nominal Bunga ",(0,Ue.jsx)("span",{style:{color:Cj},children:"*"})]})}),(0,Ue.jsx)("div",{className:"p-4",children:(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-lg font-medium",style:{color:yj},children:"Rp"}),(0,Ue.jsx)("input",{ref:g,type:"text",inputMode:"numeric",value:i.nominal>0?oj(i.nominal):"",onChange:e=>(e=>{const t=parseInt(e.replace(/\D/g,""),10)||0;x("nominal",t)})(e.target.value),placeholder:"0",className:"w-full pl-12 pr-4 py-4 text-2xl font-bold text-right rounded-xl border-2 transition-colors",style:{borderColor:i.nominal>0?xj:bj,color:jj,backgroundColor:wj}})]})})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"rounded-xl overflow-hidden mb-4",style:{backgroundColor:kj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:bj},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:gj},children:"Detail"})}),(0,Ue.jsxs)("div",{className:"p-4 space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:jj},children:"Periode Bunga"}),(0,Ue.jsx)("input",{type:"text",value:i.periode||"",onChange:e=>x("periode",e.target.value),placeholder:"Contoh: Desember 2024, Q4 2024",className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:bj,backgroundColor:wj,color:jj}})]}),o.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:jj},children:"Dicatat ke Akun"}),(0,Ue.jsxs)("select",{value:i.akun_id||"",onChange:e=>x("akun_id",e.target.value),className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:bj,backgroundColor:wj,color:jj},children:[(0,Ue.jsx)("option",{value:"",children:"-- Pilih Akun --"}),o.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.nama_akun},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:jj},children:"Tanggal"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal,onChange:e=>x("tanggal",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-4 py-3 rounded-xl border transition-colors",style:{borderColor:bj,backgroundColor:wj,color:jj}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:jj},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>x("keterangan",e.target.value),placeholder:"Contoh: Bunga tabungan ".concat(i.sumber_bank||"bank"),rows:2,className:"w-full px-4 py-3 rounded-xl border transition-colors resize-none",style:{borderColor:bj,backgroundColor:wj,color:jj}})]})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-4 rounded-xl flex items-start gap-3",style:{backgroundColor:"#DBEAFE"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:xj},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:kj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:xj},children:"Pendapatan Bunga Bank"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#1E40AF"},children:"Dicatat sebagai pendapatan di luar usaha dalam Laporan Laba Rugi (7101)"})]})]})]}),(0,Ue.jsx)("div",{className:"px-4 py-4 border-t",style:{backgroundColor:kj,borderColor:bj},children:(0,Ue.jsxs)("div",{className:"flex gap-3",children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium transition-all active:scale-[0.98]",style:{backgroundColor:wj,color:jj},children:"Batal"}),(0,Ue.jsx)("button",{onClick:async()=>{if(i.nominal<=0)return d("Masukkan nominal bunga"),void v();if(!i.sumber_bank.trim())return d("Pilih sumber bank"),void v();c(!0),d(null);try{var e,t;const n=localStorage.getItem("access_token"),a=localStorage.getItem("tenant_id")||"evlogia",o={transaction_type:"pendapatan_bunga",nominal:i.nominal,total_amount:i.nominal,sumber_bank:i.sumber_bank.trim(),periode:(null===(e=i.periode)||void 0===e?void 0:e.trim())||null,akun_id:i.akun_id||null,keterangan:(null===(t=i.keterangan)||void 0===t?void 0:t.trim())||"Bunga ".concat(i.sumber_bank),tanggal:i.tanggal,akun_perkiraan:"7101",payment_method:"transfer"},s=await fetch("/api/tenant/".concat(a,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Pendapatan Bunga",session_id:"pendapatan-bunga-".concat(Date.now()),conversation_context:JSON.stringify({form_data:o})})});if(401===s.status)return void d("Sesi berakhir. Silakan login ulang.");if(!s.ok){const e=await s.json();throw new Error(e.detail||e.message||"Gagal menyimpan transaksi")}const l=await s.json(),c={success:!0,message:l.message||"Bunga ".concat(i.sumber_bank," berhasil dicatat"),transaction_id:l.transaction_id||"",tipe:"pendapatan_bunga",nominal:i.nominal};p(c),setTimeout(()=>{r(c)},2e3)}catch(n){d(n.message||"Gagal menyimpan. Coba lagi."),v(),console.error("[PendapatanBungaForm] Submit error:",n)}finally{c(!1)}},disabled:l||!y,className:"flex-1 py-3.5 rounded-xl font-medium transition-all active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",style:{backgroundColor:xj,color:kj},children:l?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Menyimpan..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Simpan Bunga"]})})]})})]}):null},_j="#F97316",Sj="#3B82F6",Ej="#A855F7",Aj="#737373",Ij="#D4D4D4",Tj="#E5E5E5",Pj="#F5F5F5",Dj="#FFFFFF",Mj="#262626",Rj="#22C55E",Fj="#EF4444",Oj=e=>{let{isOpen:t,onClose:n,isMobile:r=!1,isEmbedded:o=!1}=e;const[i,s]=(0,a.useState)("rekening"),[l,c]=(0,a.useState)("list"),[u,d]=(0,a.useState)("left"),[h,p]=(0,a.useState)([]),[f,m]=(0,a.useState)([]),[g,x]=(0,a.useState)(null),[y,v]=(0,a.useState)(0),[b,w]=(0,a.useState)({modal_awal:0,setor_modal:0,prive:0,laba_ditahan:0,laba_periode:0}),[k,j]=(0,a.useState)({pendapatan_lain:0,pendapatan_bunga:0}),[C,N]=(0,a.useState)(!1),[_,S]=(0,a.useState)(null),[E,A]=(0,a.useState)(""),[I,T]=(0,a.useState)("kas"),[P,D]=(0,a.useState)(""),[M,R]=(0,a.useState)(""),[F,O]=(0,a.useState)(""),[B,L]=(0,a.useState)(""),[z,W]=(0,a.useState)(""),[V,U]=(0,a.useState)(""),[H,G]=(0,a.useState)(""),[K,X]=(0,a.useState)(!1),[Y,q]=(0,a.useState)(!1),[Z,J]=(0,a.useState)(!1),[Q,$]=(0,a.useState)(!1),ee=(0,a.useCallback)(async()=>{N(!0),S(null);try{const e=await jw("/api/kasbank/accounts");if(!e.ok)throw new Error("Gagal memuat data");const t=await e.json();p(t.accounts||[]),v(t.total_saldo||0)}catch(e){p([{id:"1",nama_akun:"Kas Toko",tipe:"kas",saldo:5e6,is_default:!0},{id:"2",nama_akun:"BCA",tipe:"bank",saldo:15e6,nama_bank:"BCA",nomor_rekening:"1234567890",is_default:!1},{id:"3",nama_akun:"GoPay",tipe:"ewallet",saldo:5e5,is_default:!1}]),v(205e5)}finally{N(!1)}},[]),te=(0,a.useCallback)(async e=>{N(!0);try{const t=await jw("/api/kasbank/accounts/".concat(e,"/transactions"));if(!t.ok)throw new Error("Gagal memuat transaksi");const n=await t.json();m(n.transactions||[])}catch(t){m([{id:"1",akun_id:e,nama_akun:"Kas Toko",tipe_transaksi:"masuk",nominal:5e5,saldo_sebelum:45e5,saldo_setelah:5e6,keterangan:"Penjualan tunai",created_at:(new Date).toISOString()},{id:"2",akun_id:e,nama_akun:"Kas Toko",tipe_transaksi:"keluar",nominal:15e4,saldo_sebelum:5e6,saldo_setelah:485e4,keterangan:"Beli ATK",created_at:(new Date).toISOString()}])}finally{N(!1)}},[]),ne=(0,a.useCallback)(async()=>{try{const o=(new Date).toISOString().slice(0,7),i=await jw("/api/reports/neraca/".concat(o));if(i.ok){var e,t,n,r,a;const o=await i.json();w({modal_awal:(null===(e=o.ekuitas)||void 0===e?void 0:e.modal_awal)||0,setor_modal:(null===(t=o.ekuitas)||void 0===t?void 0:t.setor_modal)||0,prive:(null===(n=o.ekuitas)||void 0===n?void 0:n.prive)||0,laba_ditahan:(null===(r=o.ekuitas)||void 0===r?void 0:r.laba_ditahan)||0,laba_periode:(null===(a=o.ekuitas)||void 0===a?void 0:a.laba_periode_berjalan)||0})}}catch(o){w({modal_awal:5e7,setor_modal:1e7,prive:2e6,laba_ditahan:85e5,laba_periode:32e5})}},[]);(0,a.useEffect)(()=>{t&&(ee(),ne())},[t,ee,ne]);const re=()=>{A(""),T("kas"),D(""),R(""),O(""),d("left"),c("add")},ae=()=>{L(""),W(""),U(""),G(""),d("left"),c("transfer")},oe=()=>{d("right"),c("list"),x(null)},ie=async()=>{if(E.trim()){N(!0);try{const e={id:Date.now().toString(),nama_akun:E,tipe:I,saldo:parseFloat(P)||0,nama_bank:M||void 0,nomor_rekening:F||void 0,is_default:!1};p(t=>[...t,e]),oe()}catch(e){S(e.message)}finally{N(!1)}}else S("Nama akun wajib diisi")},se=async()=>{if(B&&z&&V)if(B!==z){N(!0);try{const e=parseFloat(V);p(t=>t.map(t=>t.id===B?tt(tt({},t),{},{saldo:t.saldo-e}):t.id===z?tt(tt({},t),{},{saldo:t.saldo+e}):t)),oe()}catch(e){S(e.message)}finally{N(!1)}}else S("Akun asal dan tujuan tidak boleh sama");else S("Lengkapi semua field")},le=o?"h-full bg-neutral-50 flex flex-col":"fixed inset-0 z-50 bg-neutral-50 flex flex-col";if(!t)return null;const ce=b.modal_awal+b.setor_modal-b.prive+b.laba_ditahan+b.laba_periode,ue=()=>(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:-100},className:"flex-1 flex flex-col",children:[(0,Ue.jsxs)("div",{className:"p-4",style:{backgroundColor:_j},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,Ue.jsx)("button",{onClick:oe,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:"rgba(255,255,255,0.2)"},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{e.currentTarget.style.display="none"}})}),(0,Ue.jsxs)("div",{className:"text-white",children:[(0,Ue.jsx)("h2",{className:"text-lg font-bold",children:null===g||void 0===g?void 0:g.nama_akun}),(0,Ue.jsx)("div",{className:"text-sm opacity-80",children:g&&Rk(g.tipe)})]})]}),(0,Ue.jsxs)("div",{className:"text-center text-white",children:[(0,Ue.jsx)("div",{className:"text-sm opacity-80",children:"Saldo"}),(0,Ue.jsxs)("div",{className:"text-3xl font-bold",children:["Rp ",Mk((null===g||void 0===g?void 0:g.saldo)||0)]})]})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4",children:[(0,Ue.jsx)("div",{className:"text-xs font-medium uppercase tracking-wider mb-3",style:{color:Aj},children:"Riwayat Transaksi"}),0===f.length?(0,Ue.jsx)("div",{className:"text-center py-8",style:{color:Aj},children:"Belum ada transaksi"}):(0,Ue.jsx)("div",{className:"space-y-2",children:f.map(e=>(0,Ue.jsx)("div",{className:"rounded-xl p-3",style:{backgroundColor:Dj,boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:Mj},children:e.keterangan||"Transaksi"}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:new Date(e.created_at).toLocaleDateString("id-ID")})]}),(0,Ue.jsxs)("div",{className:"font-bold",style:{color:"masuk"===e.tipe_transaksi?Rj:Fj},children:["masuk"===e.tipe_transaksi?"+":"-","Rp ",Mk(e.nominal)]})]})},e.id))})]})]},"rekening-detail"),de=()=>(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:-100},className:"flex-1 flex flex-col",style:{backgroundColor:Dj},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 border-b",style:{height:"60px",borderColor:Tj},children:[(0,Ue.jsx)("button",{onClick:oe,className:"p-1",children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-6 h-6",onError:e=>{e.currentTarget.style.display="none"}})}),(0,Ue.jsx)("h2",{className:"text-lg font-semibold",style:{color:Mj},children:"Tambah Akun"})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:[_&&(0,Ue.jsx)("div",{className:"p-3 rounded-lg text-sm",style:{backgroundColor:"#FEF2F2",color:Fj},children:_}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:Mj},children:["Nama Akun ",(0,Ue.jsx)("span",{style:{color:Fj},children:"*"})]}),(0,Ue.jsx)("input",{type:"text",value:E,onChange:e=>A(e.target.value),placeholder:"Contoh: Kas Toko Utama",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Dj,border:"1px solid ".concat(Tj),color:Mj}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:Mj},children:"Tipe Akun"}),(0,Ue.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["kas","bank","ewallet"].map(e=>(0,Ue.jsxs)("button",{onClick:()=>T(e),className:"py-2.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:I===e?_j:Pj,color:I===e?Dj:Aj},children:[Fk(e)," ",Rk(e)]},e))})]}),"bank"===I&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Mj},children:"Nama Bank"}),(0,Ue.jsx)("input",{type:"text",value:M,onChange:e=>R(e.target.value),placeholder:"Contoh: BCA",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Dj,border:"1px solid ".concat(Tj),color:Mj}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Mj},children:"Nomor Rekening"}),(0,Ue.jsx)("input",{type:"text",value:F,onChange:e=>O(e.target.value),placeholder:"1234567890",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Dj,border:"1px solid ".concat(Tj),color:Mj}})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Mj},children:"Saldo Awal"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:Aj},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:P,onChange:e=>D(e.target.value.replace(/\D/g,"")),placeholder:"0",className:"w-full pl-10 pr-3 py-2.5 rounded-lg",style:{backgroundColor:Dj,border:"1px solid ".concat(Tj),color:Mj}})]})]})]}),(0,Ue.jsx)("div",{className:"p-4 border-t",style:{borderColor:Tj},children:(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:ie,disabled:C,className:"w-full py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:_j,color:Dj},children:C?"Menyimpan...":"Simpan Akun"})})]},"rekening-add"),he=()=>(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:-100},className:"flex-1 flex flex-col",style:{backgroundColor:Dj},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 border-b",style:{height:"60px",borderColor:Tj},children:[(0,Ue.jsx)("button",{onClick:oe,className:"p-1",children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-6 h-6"})}),(0,Ue.jsx)("h2",{className:"text-lg font-semibold",style:{color:Mj},children:"Transfer Antar Akun"})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:[_&&(0,Ue.jsx)("div",{className:"p-3 rounded-lg text-sm",style:{backgroundColor:"#FEF2F2",color:Fj},children:_}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Mj},children:"Dari Akun"}),(0,Ue.jsxs)("select",{value:B,onChange:e=>L(e.target.value),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Dj,border:"1px solid ".concat(Tj),color:Mj},children:[(0,Ue.jsx)("option",{value:"",children:"Pilih akun asal"}),h.map(e=>(0,Ue.jsxs)("option",{value:e.id,children:[e.nama_akun," (Rp ",Mk(e.saldo),")"]},e.id))]})]}),(0,Ue.jsx)("div",{className:"flex justify-center",children:(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:Pj},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:Aj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Mj},children:"Ke Akun"}),(0,Ue.jsxs)("select",{value:z,onChange:e=>W(e.target.value),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Dj,border:"1px solid ".concat(Tj),color:Mj},children:[(0,Ue.jsx)("option",{value:"",children:"Pilih akun tujuan"}),h.filter(e=>e.id!==B).map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.nama_akun},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Mj},children:"Nominal"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:Aj},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:V,onChange:e=>U(e.target.value.replace(/\D/g,"")),placeholder:"0",className:"w-full pl-10 pr-3 py-2.5 rounded-lg",style:{backgroundColor:Dj,border:"1px solid ".concat(Tj),color:Mj}})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:Mj},children:"Catatan (opsional)"}),(0,Ue.jsx)("input",{type:"text",value:H,onChange:e=>G(e.target.value),placeholder:"Contoh: Setor ke bank",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Dj,border:"1px solid ".concat(Tj),color:Mj}})]})]}),(0,Ue.jsx)("div",{className:"p-4 border-t",style:{borderColor:Tj},children:(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:se,disabled:C,className:"w-full py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:_j,color:Dj},children:C?"Memproses...":"Transfer"})})]},"rekening-transfer");return(0,Ue.jsxs)("div",{className:le,children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:Dj,borderColor:Tj},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:Ij},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:Mj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsx)("h1",{className:"text-lg font-semibold ml-2",style:{color:Mj},children:"Kas & Bank"})]}),(0,Ue.jsx)("div",{className:"flex border-b",style:{backgroundColor:Dj,borderColor:Tj},children:["rekening","ekuitas","pendapatan"].map(e=>(0,Ue.jsxs)("button",{onClick:()=>{s(e),c("list")},className:"flex-1 py-3 text-sm font-medium relative transition-colors",style:{color:i===e?_j:Aj},children:["rekening"===e&&"Rekening","ekuitas"===e&&"Ekuitas","pendapatan"===e&&"Pendapatan",i===e&&(0,Ue.jsx)(yc.div,{layoutId:"kasbankTabIndicator",className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:_j}})]},e))}),(0,Ue.jsxs)(mt,{mode:"wait",children:["rekening"===i&&("detail"===l?ue():"add"===l?de():"transfer"===l?he():(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:"flex-1 flex flex-col min-h-0",children:[(0,Ue.jsx)("div",{className:"px-4 pt-4",children:(0,Ue.jsxs)("div",{className:"p-4 rounded-xl text-center",style:{backgroundColor:_j},children:[(0,Ue.jsx)("div",{className:"text-sm text-white/80",children:"Total Saldo"}),(0,Ue.jsxs)("div",{className:"text-2xl font-bold text-white",children:["Rp ",Mk(y)]})]})}),(0,Ue.jsxs)("div",{className:"px-4 py-3 flex gap-2",children:[(0,Ue.jsx)("button",{onClick:ae,className:"flex-1 py-2.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:Pj,color:Aj},children:"\ud83d\udd04 Transfer"}),(0,Ue.jsx)("button",{onClick:()=>X(!0),className:"flex-1 py-2.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:"#FAF5FF",color:Ej},children:"\ud83d\udcb0 Modal/Prive"})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 pb-24",children:[(0,Ue.jsx)("div",{className:"text-xs font-medium uppercase tracking-wider mb-2",style:{color:Aj},children:"Daftar Rekening"}),(0,Ue.jsx)("div",{className:"space-y-2",children:h.map((e,t)=>(0,Ue.jsxs)(yc.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},onClick:()=>(e=>{x(e),te(e.id),d("left"),c("detail")})(e),className:"w-full rounded-xl p-4 flex items-center justify-between transition-all active:scale-[0.98]",style:{backgroundColor:Dj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-2xl",style:{backgroundColor:"bank"===e.tipe?"#EFF6FF":"ewallet"===e.tipe?"#FAF5FF":"#FFF7ED"},children:Fk(e.tipe)}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("div",{className:"font-semibold",style:{color:Mj},children:e.nama_akun}),(0,Ue.jsx)("div",{className:"text-sm",style:{color:Aj},children:"bank"===e.tipe&&e.nomor_rekening?"".concat(e.nama_bank," \u2022 ").concat(e.nomor_rekening.slice(-4)):Rk(e.tipe)})]})]}),(0,Ue.jsxs)("div",{className:"text-right flex items-center gap-2",children:[(0,Ue.jsxs)("div",{className:"font-bold",style:{color:_j},children:["Rp ",Mk(e.saldo)]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:Tj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},e.id))})]}),(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:re,className:"fixed bottom-6 right-6 w-14 h-14 rounded-full flex items-center justify-center shadow-lg z-10",style:{backgroundColor:_j},children:(0,Ue.jsx)("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]},"rekening-list")),"ekuitas"===i&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"flex-1 flex flex-col min-h-0 overflow-y-auto pb-24",style:{backgroundColor:Pj},children:[(0,Ue.jsx)("div",{className:"p-4",children:(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:Dj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{borderColor:Tj},children:(0,Ue.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:_j},children:"Ringkasan Ekuitas"})}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2",children:[(0,Ue.jsxs)("div",{className:"p-3 border-b border-r",style:{borderColor:Pj},children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:"Modal Awal"}),(0,Ue.jsxs)("div",{className:"font-bold",style:{color:Rj},children:["Rp ",Mk(b.modal_awal)]})]}),(0,Ue.jsxs)("div",{className:"p-3 border-b",style:{borderColor:Pj},children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:"Setor Modal"}),(0,Ue.jsxs)("div",{className:"font-bold",style:{color:Rj},children:["Rp ",Mk(b.setor_modal)]})]}),(0,Ue.jsxs)("div",{className:"p-3 border-r",style:{borderColor:Pj},children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:"Prive"}),(0,Ue.jsxs)("div",{className:"font-bold",style:{color:Fj},children:["-Rp ",Mk(b.prive)]})]}),(0,Ue.jsxs)("div",{className:"p-3",children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:"Laba Ditahan"}),(0,Ue.jsxs)("div",{className:"font-bold",style:{color:Sj},children:["Rp ",Mk(b.laba_ditahan)]})]})]}),(0,Ue.jsxs)("div",{className:"p-4 text-center border-t",style:{borderColor:Tj,backgroundColor:Pj},children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:"Total Ekuitas"}),(0,Ue.jsxs)("div",{className:"text-xl font-bold",style:{color:_j},children:["Rp ",Mk(ce)]})]})]})}),(0,Ue.jsx)("div",{className:"px-4",children:(0,Ue.jsx)("div",{className:"rounded-xl p-4",style:{backgroundColor:"#FFF7ED",border:"1px solid ".concat(_j,"20")},children:(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("span",{className:"text-2xl",children:"\ud83d\udcc8"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:"Laba Periode Berjalan"}),(0,Ue.jsxs)("div",{className:"text-lg font-bold",style:{color:_j},children:["Rp ",Mk(b.laba_periode)]})]})]})})}),(0,Ue.jsx)("div",{className:"p-4 mt-auto",children:(0,Ue.jsx)("button",{onClick:()=>X(!0),className:"w-full py-3 rounded-xl font-medium flex items-center justify-center gap-2",style:{backgroundColor:Ej,color:Dj},children:"\ud83d\udcb0 Catat Modal / Prive"})}),(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>X(!0),className:"fixed bottom-6 right-6 w-14 h-14 rounded-full flex items-center justify-center shadow-lg z-10",style:{backgroundColor:Ej},children:(0,Ue.jsx)("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]},"ekuitas-tab"),"pendapatan"===i&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"flex-1 flex flex-col min-h-0 overflow-y-auto pb-24",style:{backgroundColor:Pj},children:[(0,Ue.jsxs)("div",{className:"p-4 space-y-3",children:[(0,Ue.jsx)(yc.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},onClick:()=>J(!0),className:"w-full rounded-xl p-4 transition-all active:scale-[0.98]",style:{backgroundColor:Dj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("span",{className:"text-3xl",children:"\ud83d\udcb8"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("h3",{className:"font-medium",style:{color:Mj},children:"Pendapatan Lain-lain"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:Aj},children:"Komisi, bonus, jasa lainnya"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsxs)("div",{className:"font-bold",style:{color:Rj},children:["Rp ",Mk(k.pendapatan_lain)]}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:"Bulan ini"})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:Tj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}),(0,Ue.jsx)(yc.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},onClick:()=>$(!0),className:"w-full rounded-xl p-4 transition-all active:scale-[0.98]",style:{backgroundColor:Dj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("span",{className:"text-3xl",children:"\ud83c\udfe6"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("h3",{className:"font-medium",style:{color:Mj},children:"Pendapatan Bunga"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:Aj},children:"Bunga tabungan/deposito bank"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsxs)("div",{className:"font-bold",style:{color:Sj},children:["Rp ",Mk(k.pendapatan_bunga)]}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:Aj},children:"Bulan ini"})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:Tj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})]}),(0,Ue.jsx)("div",{className:"px-4 mt-2",children:(0,Ue.jsxs)("div",{className:"p-4 rounded-xl flex items-start gap-3",style:{backgroundColor:"#DCFCE7"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:Rj},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:Dj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:Rj},children:"Pendapatan di Luar Usaha"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#166534"},children:"Catat pendapatan selain penjualan utama seperti komisi, bonus, atau bunga bank untuk laporan keuangan yang akurat."})]})]})}),(0,Ue.jsxs)("div",{className:"px-4 mt-4 grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)("button",{onClick:()=>J(!0),className:"py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition-all active:scale-[0.98]",style:{backgroundColor:Rj,color:Dj},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Lain-lain"]}),(0,Ue.jsxs)("button",{onClick:()=>$(!0),className:"py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition-all active:scale-[0.98]",style:{backgroundColor:Sj,color:Dj},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Bunga Bank"]})]}),(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>J(!0),className:"fixed bottom-6 right-6 w-14 h-14 rounded-full flex items-center justify-center shadow-lg z-10",style:{backgroundColor:Rj},children:(0,Ue.jsx)("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]},"pendapatan-tab")]}),K&&(0,Ue.jsx)("div",{className:"fixed inset-0 z-50",children:(0,Ue.jsx)(Zk,{isOpen:K,onClose:()=>X(!1),onSuccess:()=>{X(!1),ee(),ne()},accounts:h.map(e=>({id:e.id,nama_akun:e.nama_akun}))})}),(0,Ue.jsx)(ej,{isOpen:Y,onClose:()=>q(!1),onSuccess:()=>{q(!1),ee()},accounts:h.map(e=>({id:e.id,nama_akun:e.nama_akun}))}),Z&&(0,Ue.jsx)("div",{className:"fixed inset-0 z-50",children:(0,Ue.jsx)(mj,{isOpen:Z,onClose:()=>J(!1),onSuccess:()=>{J(!1),ee()},accounts:h.map(e=>({id:e.id,nama_akun:e.nama_akun}))})}),Q&&(0,Ue.jsx)("div",{className:"fixed inset-0 z-50",children:(0,Ue.jsx)(Nj,{isOpen:Q,onClose:()=>$(!1),onSuccess:()=>{$(!1),ee()},accounts:h.map(e=>({id:e.id,nama_akun:e.nama_akun}))})})]})},Bj=e=>new Intl.NumberFormat("id-ID").format(e),Lj=e=>{switch(e){case"belum_lunas":return"Belum Lunas";case"sebagian":return"Sebagian";case"lunas":return"Lunas";default:return e}},zj=e=>!!e&&new Date(e)<new Date,Wj=[{id:"modal_kerja",label:"Modal Kerja",description:"Pinjaman untuk operasional usaha"},{id:"investasi",label:"Investasi",description:"Pinjaman untuk pengembangan usaha"},{id:"kpr",label:"KPR",description:"Kredit Pemilikan Rumah/Ruko"},{id:"kendaraan",label:"Kendaraan",description:"Kredit kendaraan usaha"},{id:"lainnya",label:"Lainnya",description:"Jenis pinjaman lainnya"}],Vj={nama_bank:"",jenis_pinjaman:"modal_kerja",tanggal_pinjaman:(new Date).toISOString().split("T")[0],nominal_pinjaman:0,bunga_per_tahun:12,tenor_bulan:12,angsuran_per_bulan:0},Uj=e=>new Intl.NumberFormat("id-ID").format(e),Hj=(e,t)=>e*t,Gj="#F97316",Kj="#FFF7ED",Xj="#3B82F6",Yj="#737373",qj="#D4D4D4",Zj="#E5E5E5",Jj="#F5F5F5",Qj="#FFFFFF",$j="#262626",eC="#22C55E",tC="#EF4444",nC={x:[0,-10,10,-10,10,0],transition:{duration:.4}},rC=e=>{let{isOpen:t,onClose:n,onSuccess:r,editData:o}=e;const[i,s]=(0,a.useState)(Vj),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),[g,x]=(0,a.useState)(!1),y=(0,a.useRef)(null);(0,a.useEffect)(()=>{t&&(s(o?{nama_bank:o.nama_bank,jenis_pinjaman:o.jenis_pinjaman,nomor_pinjaman:o.nomor_pinjaman,tanggal_pinjaman:o.tanggal_pinjaman,nominal_pinjaman:o.nominal_pinjaman,bunga_per_tahun:o.bunga_per_tahun,tenor_bulan:o.tenor_bulan,angsuran_per_bulan:o.angsuran_per_bulan,sisa_pokok:o.sisa_pokok,tanggal_jatuh_tempo:o.tanggal_jatuh_tempo}:Vj),d(null),p(null),m(!1),x(!1),setTimeout(()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.focus()},100))},[t,o]),(0,a.useEffect)(()=>{const e=((e,t,n)=>{if(e<=0||n<=0)return 0;if(t<=0)return Math.round(e/n);const r=t/100/12,a=r*Math.pow(1+r,n),o=Math.pow(1+r,n)-1;return Math.round(e*(a/o))})(i.nominal_pinjaman,i.bunga_per_tahun,i.tenor_bulan);s(t=>tt(tt({},t),{},{angsuran_per_bulan:e}))},[i.nominal_pinjaman,i.bunga_per_tahun,i.tenor_bulan]);const v=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},b=(e,t)=>{const n=parseInt(t.replace(/\D/g,""),10)||0;v(e,n)},w=Hj(i.angsuran_per_bulan,i.tenor_bulan),k=(j=i.nominal_pinjaman,C=i.angsuran_per_bulan,N=i.tenor_bulan,Hj(C,N)-j);var j,C,N;const _=i.nama_bank.trim()&&i.nominal_pinjaman>0&&i.tenor_bulan>0;return t?h?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:Qj},children:(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,Ue.jsxs)(yc.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:15},className:"text-center px-6",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",damping:10},className:"w-24 h-24 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.4,duration:.5},className:"w-12 h-12",style:{color:eC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)(yc.path,{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold mb-2",style:{color:$j},children:"Hutang Bank Berhasil Dicatat"}),(0,Ue.jsx)("p",{className:"text-lg mb-1",style:{color:Yj},children:h.nama_bank}),(0,Ue.jsxs)("p",{className:"text-sm",style:{color:Yj},children:["Angsuran/bulan: ",(0,Ue.jsxs)("span",{style:{color:Gj},children:["Rp ",Uj(h.angsuran_per_bulan)]})]})]})})}):(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:Jj},children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:Qj,borderColor:Zj},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:qj},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:$j},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:$j},children:o?"Edit Hutang Bank":"Hutang Bank"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:Yj},children:"SAK EMKM 2102"})]})]}),(0,Ue.jsxs)(yc.div,{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",animate:g?nC:{},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 rounded-xl text-sm",style:{backgroundColor:"#FEE2E2",color:tC},children:u})}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:Qj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:Gj},children:"Detail Bank"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:$j},children:["Nama Bank ",(0,Ue.jsx)("span",{style:{color:tC},children:"*"})]}),(0,Ue.jsx)("input",{ref:y,type:"text",value:i.nama_bank,onChange:e=>v("nama_bank",e.target.value),placeholder:"Contoh: BRI, BCA, Mandiri",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Qj,border:"1px solid ".concat(Zj),color:$j}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-2",style:{color:$j},children:["Jenis Pinjaman ",(0,Ue.jsx)("span",{style:{color:tC},children:"*"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Wj.slice(0,4).map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>v("jenis_pinjaman",e.id),className:"px-3 py-2.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:i.jenis_pinjaman===e.id?Gj:Jj,color:i.jenis_pinjaman===e.id?Qj:Yj},children:e.label},e.id))})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:Qj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:Gj},children:"Nominal & Tenor"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:$j},children:["Nominal Pinjaman ",(0,Ue.jsx)("span",{style:{color:tC},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:Yj},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:i.nominal_pinjaman>0?Uj(i.nominal_pinjaman):"",onChange:e=>b("nominal_pinjaman",e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right rounded-lg",style:{backgroundColor:Qj,border:"1px solid ".concat(Zj),color:$j}})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:$j},children:"Bunga/Tahun (%)"}),(0,Ue.jsx)("input",{type:"number",min:"0",step:"0.1",value:i.bunga_per_tahun,onChange:e=>v("bunga_per_tahun",parseFloat(e.target.value)||0),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Qj,border:"1px solid ".concat(Zj),color:$j}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:$j},children:"Tenor (bulan)"}),(0,Ue.jsx)("input",{type:"number",min:"1",value:i.tenor_bulan,onChange:e=>v("tenor_bulan",parseInt(e.target.value)||1),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Qj,border:"1px solid ".concat(Zj),color:$j}})]})]})]}),i.nominal_pinjaman>0&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"rounded-xl p-4",style:{backgroundColor:Kj},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:Gj},children:"Estimasi Pembayaran"}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("div",{className:"flex justify-between py-2",style:{borderBottom:"1px solid ".concat(Gj,"20")},children:[(0,Ue.jsx)("span",{style:{color:Yj},children:"Angsuran/bulan"}),(0,Ue.jsxs)("span",{className:"font-bold text-lg",style:{color:Gj},children:["Rp ",Uj(i.angsuran_per_bulan)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between py-1",children:[(0,Ue.jsx)("span",{className:"text-sm",style:{color:Yj},children:"Total Pembayaran"}),(0,Ue.jsxs)("span",{className:"text-sm",style:{color:$j},children:["Rp ",Uj(w)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between py-1",children:[(0,Ue.jsx)("span",{className:"text-sm",style:{color:Yj},children:"Total Bunga"}),(0,Ue.jsxs)("span",{className:"text-sm",style:{color:tC},children:["Rp ",Uj(k)]})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:Qj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:Gj},children:"Tanggal"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:$j},children:"Tanggal Pinjaman"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal_pinjaman,onChange:e=>v("tanggal_pinjaman",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Qj,border:"1px solid ".concat(Zj),color:$j}})]})]}),(0,Ue.jsxs)("button",{type:"button",onClick:()=>m(!f),className:"w-full flex items-center justify-center gap-2 py-2 text-sm",style:{color:Yj},children:[(0,Ue.jsx)("span",{className:"flex-1 h-px",style:{backgroundColor:Zj}}),(0,Ue.jsxs)("span",{className:"flex items-center gap-1",children:["Detail Tambahan",(0,Ue.jsx)("svg",{className:"w-4 h-4 transition-transform ".concat(f?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,Ue.jsx)("span",{className:"flex-1 h-px",style:{backgroundColor:Zj}})]}),(0,Ue.jsx)(mt,{children:f&&(0,Ue.jsxs)(yc.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"rounded-xl p-4 space-y-4",style:{backgroundColor:Qj,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:$j},children:"Nomor Pinjaman/Kontrak"}),(0,Ue.jsx)("input",{type:"text",value:i.nomor_pinjaman||"",onChange:e=>v("nomor_pinjaman",e.target.value),placeholder:"Contoh: KUR-2024-123456",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:Qj,border:"1px solid ".concat(Zj),color:$j}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:$j},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>v("keterangan",e.target.value),placeholder:"Catatan tambahan...",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:Qj,border:"1px solid ".concat(Zj),color:$j}})]})]})}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{backgroundColor:"#EFF6FF"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:Xj},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:Qj},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:Xj},children:"Dicatat sebagai Hutang Bank"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#1E40AF"},children:"Hutang bank masuk ke kewajiban jangka panjang di neraca. Angsuran bulanan akan terdiri dari pembayaran pokok dan bunga."})]})]}),(0,Ue.jsx)("div",{className:"h-24"})]}),(0,Ue.jsxs)("div",{className:"p-4 border-t flex gap-3",style:{backgroundColor:Qj,borderColor:Zj},children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium",style:{backgroundColor:Jj,color:Yj},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(!_)return d("Lengkapi nama bank, nominal pinjaman, dan tenor"),x(!0),void setTimeout(()=>x(!1),500);c(!0),d(null);try{var e,t;const n=localStorage.getItem("access_token"),a=localStorage.getItem("tenant_id")||"evlogia",o={transaction_type:"hutang_bank",pihak_type:"bank",nama_pihak:i.nama_bank.trim(),jenis_pinjaman:i.jenis_pinjaman,nomor_pinjaman:(null===(e=i.nomor_pinjaman)||void 0===e?void 0:e.trim())||null,tanggal_pinjaman:i.tanggal_pinjaman,nominal_pinjaman:i.nominal_pinjaman,total_amount:i.nominal_pinjaman,bunga_per_tahun:i.bunga_per_tahun,tenor_bulan:i.tenor_bulan,angsuran_per_bulan:i.angsuran_per_bulan,total_pembayaran:w,total_bunga:k,sisa_pokok:i.nominal_pinjaman,keterangan:(null===(t=i.keterangan)||void 0===t?void 0:t.trim())||"Pinjaman ".concat(i.nama_bank)},s=await fetch("/api/tenant/".concat(a,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Hutang Bank",session_id:"hutang-bank-".concat(Date.now()),conversation_context:JSON.stringify({form_data:o})})});if(401===s.status)return void d("Sesi berakhir. Silakan login ulang.");if(!s.ok){const e=await s.json();throw new Error(e.detail||e.message||"Gagal menyimpan hutang bank")}const l=await s.json(),c={success:!0,message:l.message||"Hutang bank berhasil dicatat",loan_id:l.loan_id||"",nama_bank:i.nama_bank,angsuran_per_bulan:i.angsuran_per_bulan};p(c),setTimeout(()=>{r(c)},1500)}catch(n){d(n.message||"Gagal menyimpan. Coba lagi."),console.error("[HutangBankForm] Submit error:",n)}finally{c(!1)}},disabled:l||!_,className:"flex-1 py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:Gj,color:Qj},children:l?"Menyimpan...":o?"Simpan Perubahan":"Simpan Hutang Bank"})]})]}):null},aC={nama_karyawan:"",periode_gaji:function(){const e=new Date;return e.toLocaleDateString("id-ID",{month:"long",year:"numeric"})}(),gaji_pokok:0,tunjangan:0,potongan:0,total_hutang:0,tanggal_jatuh_tempo:iC()},oC=e=>new Intl.NumberFormat("id-ID").format(e);function iC(){const e=new Date;return new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0]}const sC="#F97316",lC="#EA580C",cC="#FFF7ED",uC="#A855F7",dC="#737373",hC="#D4D4D4",pC="#E5E5E5",fC="#F5F5F5",mC="#FFFFFF",gC="#262626",xC="#22C55E",yC="#EF4444",vC={x:[0,-10,10,-10,10,0],transition:{duration:.4}},bC=e=>{let{isOpen:t,onClose:n,onSuccess:r}=e;const[o,i]=(0,a.useState)(aC),[s,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)(null),[d,h]=(0,a.useState)(null),[p,f]=(0,a.useState)(!1),m=(0,a.useRef)(null),g=(0,a.useMemo)(()=>(()=>{const e=[],t=new Date;for(let n=0;n<3;n++){const r=new Date(t.getFullYear(),t.getMonth()-n,1);e.push(r.toLocaleDateString("id-ID",{month:"long",year:"numeric"}))}return e})(),[]),x=(0,a.useMemo)(()=>{return e=o.gaji_pokok,t=o.tunjangan,n=o.potongan,e+t-n;var e,t,n},[o.gaji_pokok,o.tunjangan,o.potongan]);(0,a.useEffect)(()=>{i(e=>tt(tt({},e),{},{total_hutang:x}))},[x]),(0,a.useEffect)(()=>{t&&(i(tt(tt({},aC),{},{periode_gaji:g[0],tanggal_jatuh_tempo:iC()})),u(null),h(null),f(!1),setTimeout(()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.focus()},100))},[t,g]);const y=(e,t)=>{i(n=>tt(tt({},n),{},{[e]:t})),u(null)},v=(e,t)=>{const n=parseInt(t.replace(/\D/g,""),10)||0;y(e,n)},b=o.nama_karyawan.trim()&&o.gaji_pokok>0&&o.periode_gaji&&x>0;return t?d?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:mC},children:(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,Ue.jsxs)(yc.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:15},className:"text-center px-6",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",damping:10},className:"w-24 h-24 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.4,duration:.5},className:"w-12 h-12",style:{color:xC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)(yc.path,{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold mb-2",style:{color:gC},children:"Hutang Gaji Dicatat"}),(0,Ue.jsx)("p",{className:"text-lg mb-2",style:{color:dC},children:d.nama_karyawan}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold mb-2",style:{color:uC},children:["Rp ",oC(d.total_hutang)]}),(0,Ue.jsxs)("p",{className:"text-sm",style:{color:dC},children:["Jatuh tempo: ",new Date(d.tanggal_jatuh_tempo).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})]})]})})}):(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:fC},children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:mC,borderColor:pC},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:hC},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:gC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:gC},children:"Hutang Gaji"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:dC},children:"SAK EMKM 2105"})]})]}),(0,Ue.jsxs)(yc.div,{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",animate:p?vC:{},children:[(0,Ue.jsx)(mt,{children:c&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 rounded-xl text-sm",style:{backgroundColor:"#FEE2E2",color:yC},children:c})}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:mC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:uC},children:"Data Karyawan"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:gC},children:["Nama Karyawan ",(0,Ue.jsx)("span",{style:{color:yC},children:"*"})]}),(0,Ue.jsx)("input",{ref:m,type:"text",value:o.nama_karyawan,onChange:e=>y("nama_karyawan",e.target.value),placeholder:"Contoh: Budi Santoso",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:mC,border:"1px solid ".concat(pC),color:gC}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:gC},children:["Periode Gaji ",(0,Ue.jsx)("span",{style:{color:yC},children:"*"})]}),(0,Ue.jsx)("select",{value:o.periode_gaji,onChange:e=>y("periode_gaji",e.target.value),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:mC,border:"1px solid ".concat(pC),color:gC},children:g.map(e=>(0,Ue.jsx)("option",{value:e,children:e},e))})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:mC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:uC},children:"Komponen Gaji"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:gC},children:["Gaji Pokok ",(0,Ue.jsx)("span",{style:{color:yC},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:dC},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:o.gaji_pokok>0?oC(o.gaji_pokok):"",onChange:e=>v("gaji_pokok",e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right rounded-lg",style:{backgroundColor:mC,border:"1px solid ".concat(pC),color:gC}})]})]}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:gC},children:"Tunjangan"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:dC},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:o.tunjangan>0?oC(o.tunjangan):"",onChange:e=>v("tunjangan",e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-2.5 text-right rounded-lg",style:{backgroundColor:mC,border:"1px solid ".concat(pC),color:gC}})]}),(0,Ue.jsx)("p",{className:"text-xs mt-1",style:{color:dC},children:"Tunjangan makan, transport, dll"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:gC},children:"Potongan"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:dC},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:o.potongan>0?oC(o.potongan):"",onChange:e=>v("potongan",e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-2.5 text-right rounded-lg",style:{backgroundColor:mC,border:"1px solid ".concat(pC),color:gC}})]}),(0,Ue.jsx)("p",{className:"text-xs mt-1",style:{color:dC},children:"Kasbon, BPJS, atau potongan lain"})]})]}),(0,Ue.jsxs)(yc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"rounded-xl p-4",style:{backgroundColor:"#FAF5FF"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:uC},children:"Perhitungan"}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("div",{className:"flex justify-between py-1",style:{borderBottom:"1px solid ".concat(uC,"20")},children:[(0,Ue.jsx)("span",{style:{color:dC},children:"Gaji Pokok"}),(0,Ue.jsxs)("span",{style:{color:gC},children:["Rp ",oC(o.gaji_pokok)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between py-1",style:{borderBottom:"1px solid ".concat(uC,"20")},children:[(0,Ue.jsx)("span",{style:{color:dC},children:"+ Tunjangan"}),(0,Ue.jsxs)("span",{style:{color:xC},children:["Rp ",oC(o.tunjangan)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between py-1",style:{borderBottom:"1px solid ".concat(uC,"20")},children:[(0,Ue.jsx)("span",{style:{color:dC},children:"- Potongan"}),(0,Ue.jsxs)("span",{style:{color:yC},children:["Rp ",oC(o.potongan)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between py-2 mt-2",children:[(0,Ue.jsx)("span",{className:"font-medium",style:{color:gC},children:"Total Hutang Gaji"}),(0,Ue.jsxs)("span",{className:"font-bold text-xl",style:{color:uC},children:["Rp ",oC(x)]})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:mC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:uC},children:"Jatuh Tempo"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:gC},children:"Tanggal Jatuh Tempo"}),(0,Ue.jsx)("input",{type:"date",value:o.tanggal_jatuh_tempo,onChange:e=>y("tanggal_jatuh_tempo",e.target.value),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:mC,border:"1px solid ".concat(pC),color:gC}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:gC},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:o.keterangan||"",onChange:e=>y("keterangan",e.target.value),placeholder:"Opsional - catatan tambahan",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:mC,border:"1px solid ".concat(pC),color:gC}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{backgroundColor:cC},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:sC},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:mC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:sC},children:"Catatan SAK EMKM"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:lC},children:"Hutang Gaji dicatat sebagai Kewajiban Jangka Pendek (2105). Saat gaji dibayar, akan mengurangi Kas dan menghapus hutang ini."})]})]}),(0,Ue.jsx)("div",{className:"h-24"})]}),(0,Ue.jsxs)("div",{className:"p-4 border-t flex gap-3",style:{backgroundColor:mC,borderColor:pC},children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium",style:{backgroundColor:fC,color:dC},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(!b)return o.nama_karyawan.trim()?o.gaji_pokok<=0?u("Masukkan gaji pokok"):x<=0&&u("Total hutang harus lebih dari 0"):u("Masukkan nama karyawan"),f(!0),void setTimeout(()=>f(!1),500);l(!0),u(null);try{var e;const t=localStorage.getItem("access_token"),n=localStorage.getItem("tenant_id")||"evlogia",a={transaction_type:"hutang_gaji",kategori_beban:"beban_gaji",pihak_type:"karyawan",nama_pihak:o.nama_karyawan.trim(),nominal:x,total_amount:x,gaji_pokok:o.gaji_pokok,tunjangan:o.tunjangan,potongan:o.potongan,periode_gaji:o.periode_gaji,jatuh_tempo:o.tanggal_jatuh_tempo,keterangan:(null===(e=o.keterangan)||void 0===e?void 0:e.trim())||"Hutang gaji ".concat(o.nama_karyawan," - ").concat(o.periode_gaji),status_pembayaran:"belum_lunas"},i=await fetch("/api/tenant/".concat(n,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Hutang Gaji",session_id:"hutang-gaji-".concat(Date.now()),conversation_context:JSON.stringify({form_data:a})})});if(401===i.status)return void u("Sesi berakhir. Silakan login ulang.");if(!i.ok){const e=await i.json();throw new Error(e.detail||e.message||"Gagal menyimpan transaksi")}const s=await i.json(),l={success:!0,message:s.message||"Hutang Gaji berhasil dicatat",transaction_id:s.transaction_id||"",nama_karyawan:o.nama_karyawan,total_hutang:x,tanggal_jatuh_tempo:o.tanggal_jatuh_tempo};h(l),setTimeout(()=>{r(l)},1500)}catch(t){u(t.message||"Gagal menyimpan. Coba lagi."),console.error("[HutangGajiForm] Submit error:",t)}finally{l(!1)}},disabled:s||!b,className:"flex-1 py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:uC,color:mC},children:s?"Menyimpan...":"Simpan Hutang Gaji"})]})]}):null},wC={nama_pelanggan:"",nominal:0,tanggal_transaksi:(new Date).toISOString().split("T")[0],jatuh_tempo:new Date(Date.now()+2592e6).toISOString().split("T")[0]},kC=e=>new Intl.NumberFormat("id-ID").format(e),jC=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;const t=new Date;return t.setDate(t.getDate()+e),t.toISOString().split("T")[0]},CC="#737373",NC="#D4D4D4",_C="#E5E5E5",SC="#F5F5F5",EC="#FFFFFF",AC="#262626",IC="#22C55E",TC="#EF4444",PC={x:[0,-10,10,-10,10,0],transition:{duration:.4}},DC=e=>{let{isOpen:t,onClose:n,onSuccess:r,editData:o}=e;const[i,s]=(0,a.useState)(wC),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{t&&(s(o||tt(tt({},wC),{},{tanggal_transaksi:(new Date).toISOString().split("T")[0],jatuh_tempo:jC(30)})),d(null),p(null),m(!1),setTimeout(()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.focus()},100))},[t,o]);const x=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},y=e=>{const t=(e=>parseInt(e.replace(/\D/g,""),10)||0)(e);x("nominal",t)},v=i.nama_pelanggan.trim()&&i.nominal>0;return t?h?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:EC},children:(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,Ue.jsxs)(yc.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:15},className:"text-center px-6",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",damping:10},className:"w-24 h-24 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.4,duration:.5},className:"w-12 h-12",style:{color:IC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)(yc.path,{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold mb-2",style:{color:AC},children:"Piutang Usaha Dicatat"}),(0,Ue.jsx)("p",{className:"text-lg mb-2",style:{color:CC},children:h.nama_pelanggan}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold mb-2",style:{color:IC},children:["Rp ",kC(h.nominal)]}),(0,Ue.jsxs)("p",{className:"text-sm",style:{color:CC},children:["Jatuh tempo: ",new Date(h.jatuh_tempo).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})]})]})})}):(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:SC},children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:EC,borderColor:_C},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:NC},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:AC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:AC},children:o?"Edit Piutang Usaha":"Piutang Usaha"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:CC},children:"SAK EMKM 1104"})]})]}),(0,Ue.jsxs)(yc.div,{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",animate:f?PC:{},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 rounded-xl text-sm",style:{backgroundColor:"#FEE2E2",color:TC},children:u})}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:EC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:IC},children:"Data Pelanggan"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:AC},children:["Nama Pelanggan ",(0,Ue.jsx)("span",{style:{color:TC},children:"*"})]}),(0,Ue.jsx)("input",{ref:g,type:"text",value:i.nama_pelanggan,onChange:e=>x("nama_pelanggan",e.target.value),placeholder:"Contoh: Toko Maju, Bu Siti",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:EC,border:"1px solid ".concat(_C),color:AC}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:AC},children:"No. Telepon/WA"}),(0,Ue.jsx)("input",{type:"tel",value:i.kontak_pelanggan||"",onChange:e=>x("kontak_pelanggan",e.target.value),placeholder:"08xxxxxxxxxx",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:EC,border:"1px solid ".concat(_C),color:AC}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:EC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:IC},children:"Nominal Piutang"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:AC},children:["Jumlah ",(0,Ue.jsx)("span",{style:{color:TC},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:CC},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:i.nominal>0?kC(i.nominal):"",onChange:e=>y(e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right rounded-lg",style:{backgroundColor:EC,border:"1px solid ".concat(_C),color:AC}})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:EC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:IC},children:"Tanggal"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:AC},children:"Tanggal Transaksi"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal_transaksi,onChange:e=>x("tanggal_transaksi",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:EC,border:"1px solid ".concat(_C),color:AC}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:AC},children:"Jatuh Tempo"}),(0,Ue.jsx)("input",{type:"date",value:i.jatuh_tempo,onChange:e=>x("jatuh_tempo",e.target.value),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:EC,border:"1px solid ".concat(_C),color:AC}})]})]}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:AC},children:"No. Invoice/Referensi"}),(0,Ue.jsx)("input",{type:"text",value:i.referensi_transaksi||"",onChange:e=>x("referensi_transaksi",e.target.value),placeholder:"Contoh: INV-001",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:EC,border:"1px solid ".concat(_C),color:AC}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:AC},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>x("keterangan",e.target.value),placeholder:"Catatan tambahan...",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:EC,border:"1px solid ".concat(_C),color:AC}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{backgroundColor:"#DCFCE7"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:IC},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:EC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:"#166534"},children:"Dicatat sebagai Piutang Usaha"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#166534"},children:"Piutang usaha akan menambah aset lancar di neraca. Saat pelanggan membayar, piutang ini akan berkurang dan kas bertambah."})]})]}),(0,Ue.jsx)("div",{className:"h-24"})]}),(0,Ue.jsxs)("div",{className:"p-4 border-t flex gap-3",style:{backgroundColor:EC,borderColor:_C},children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium",style:{backgroundColor:SC,color:CC},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(!v)return i.nama_pelanggan.trim()?i.nominal<=0&&d("Masukkan nominal piutang"):d("Masukkan nama pelanggan"),m(!0),void setTimeout(()=>m(!1),500);c(!0),d(null);try{var e,t,n;const a=localStorage.getItem("access_token"),o=localStorage.getItem("tenant_id")||"evlogia",s={transaction_type:"piutang_usaha",pihak_type:"pelanggan",nama_pihak:i.nama_pelanggan.trim(),kontak_pihak:(null===(e=i.kontak_pelanggan)||void 0===e?void 0:e.trim())||null,nominal:i.nominal,total_amount:i.nominal,tanggal_transaksi:i.tanggal_transaksi,jatuh_tempo:i.jatuh_tempo,referensi_transaksi:(null===(t=i.referensi_transaksi)||void 0===t?void 0:t.trim())||null,keterangan:(null===(n=i.keterangan)||void 0===n?void 0:n.trim())||"Piutang dari ".concat(i.nama_pelanggan),status_pembayaran:"belum_lunas"},l=await fetch("/api/tenant/".concat(o,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Piutang Usaha",session_id:"piutang-usaha-".concat(Date.now()),conversation_context:JSON.stringify({form_data:s})})});if(401===l.status)return void d("Sesi berakhir. Silakan login ulang.");if(!l.ok){const e=await l.json();throw new Error(e.detail||e.message||"Gagal menyimpan piutang")}const c=await l.json(),u={success:!0,message:c.message||"Piutang usaha berhasil dicatat",transaction_id:c.transaction_id||"",nama_pelanggan:i.nama_pelanggan,nominal:i.nominal,jatuh_tempo:i.jatuh_tempo};p(u),setTimeout(()=>{r(u)},1500)}catch(a){d(a.message||"Gagal menyimpan. Coba lagi."),console.error("[PiutangUsahaForm] Submit error:",a)}finally{c(!1)}},disabled:l||!v,className:"flex-1 py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:IC,color:EC},children:l?"Menyimpan...":o?"Simpan Perubahan":"Simpan Piutang"})]})]}):null},MC={nama_supplier:"",nominal:0,tanggal_transaksi:(new Date).toISOString().split("T")[0],jatuh_tempo:new Date(Date.now()+2592e6).toISOString().split("T")[0]},RC=e=>new Intl.NumberFormat("id-ID").format(e),FC=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;const t=new Date;return t.setDate(t.getDate()+e),t.toISOString().split("T")[0]},OC="#737373",BC="#D4D4D4",LC="#E5E5E5",zC="#F5F5F5",WC="#FFFFFF",VC="#262626",UC="#22C55E",HC="#EF4444",GC={x:[0,-10,10,-10,10,0],transition:{duration:.4}},KC=e=>{let{isOpen:t,onClose:n,onSuccess:r,editData:o}=e;const[i,s]=(0,a.useState)(MC),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{t&&(s(o||tt(tt({},MC),{},{tanggal_transaksi:(new Date).toISOString().split("T")[0],jatuh_tempo:FC(30)})),d(null),p(null),m(!1),setTimeout(()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.focus()},100))},[t,o]);const x=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},y=e=>{const t=(e=>parseInt(e.replace(/\D/g,""),10)||0)(e);x("nominal",t)},v=i.nama_supplier.trim()&&i.nominal>0;return t?h?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:WC},children:(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,Ue.jsxs)(yc.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:15},className:"text-center px-6",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",damping:10},className:"w-24 h-24 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.4,duration:.5},className:"w-12 h-12",style:{color:UC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)(yc.path,{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold mb-2",style:{color:VC},children:"Hutang Usaha Dicatat"}),(0,Ue.jsx)("p",{className:"text-lg mb-2",style:{color:OC},children:h.nama_supplier}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold mb-2",style:{color:HC},children:["Rp ",RC(h.nominal)]}),(0,Ue.jsxs)("p",{className:"text-sm",style:{color:OC},children:["Jatuh tempo: ",new Date(h.jatuh_tempo).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})]})]})})}):(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:zC},children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:WC,borderColor:LC},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:BC},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:VC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:VC},children:o?"Edit Hutang Usaha":"Hutang Usaha"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:OC},children:"SAK EMKM 2101"})]})]}),(0,Ue.jsxs)(yc.div,{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",animate:f?GC:{},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 rounded-xl text-sm",style:{backgroundColor:"#FEE2E2",color:HC},children:u})}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:WC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:HC},children:"Data Supplier"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:VC},children:["Nama Supplier ",(0,Ue.jsx)("span",{style:{color:HC},children:"*"})]}),(0,Ue.jsx)("input",{ref:g,type:"text",value:i.nama_supplier,onChange:e=>x("nama_supplier",e.target.value),placeholder:"Contoh: PT ABC, Distributor Utama",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:WC,border:"1px solid ".concat(LC),color:VC}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:VC},children:"No. Telepon/WA"}),(0,Ue.jsx)("input",{type:"tel",value:i.kontak_supplier||"",onChange:e=>x("kontak_supplier",e.target.value),placeholder:"08xxxxxxxxxx",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:WC,border:"1px solid ".concat(LC),color:VC}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:WC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:HC},children:"Nominal Hutang"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:VC},children:["Jumlah ",(0,Ue.jsx)("span",{style:{color:HC},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:OC},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:i.nominal>0?RC(i.nominal):"",onChange:e=>y(e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right rounded-lg",style:{backgroundColor:WC,border:"1px solid ".concat(LC),color:VC}})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:WC,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:HC},children:"Tanggal"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:VC},children:"Tanggal Transaksi"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal_transaksi,onChange:e=>x("tanggal_transaksi",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:WC,border:"1px solid ".concat(LC),color:VC}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:VC},children:"Jatuh Tempo"}),(0,Ue.jsx)("input",{type:"date",value:i.jatuh_tempo,onChange:e=>x("jatuh_tempo",e.target.value),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:WC,border:"1px solid ".concat(LC),color:VC}})]})]}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:VC},children:"No. Faktur Supplier"}),(0,Ue.jsx)("input",{type:"text",value:i.nomor_faktur||"",onChange:e=>x("nomor_faktur",e.target.value),placeholder:"Contoh: FKT-001",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:WC,border:"1px solid ".concat(LC),color:VC}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:VC},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>x("keterangan",e.target.value),placeholder:"Catatan tambahan...",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:WC,border:"1px solid ".concat(LC),color:VC}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{backgroundColor:"#FEE2E2"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:HC},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:WC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:"#991B1B"},children:"Dicatat sebagai Hutang Usaha"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#991B1B"},children:"Hutang usaha akan menambah kewajiban di neraca. Saat Anda membayar ke supplier, hutang ini akan berkurang dan kas berkurang."})]})]}),(0,Ue.jsx)("div",{className:"h-24"})]}),(0,Ue.jsxs)("div",{className:"p-4 border-t flex gap-3",style:{backgroundColor:WC,borderColor:LC},children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium",style:{backgroundColor:zC,color:OC},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(!v)return i.nama_supplier.trim()?i.nominal<=0&&d("Masukkan nominal hutang"):d("Masukkan nama supplier"),m(!0),void setTimeout(()=>m(!1),500);c(!0),d(null);try{var e,t,n;const a=localStorage.getItem("access_token"),o=localStorage.getItem("tenant_id")||"evlogia",s={transaction_type:"hutang_usaha",pihak_type:"supplier",nama_pihak:i.nama_supplier.trim(),kontak_pihak:(null===(e=i.kontak_supplier)||void 0===e?void 0:e.trim())||null,nominal:i.nominal,total_amount:i.nominal,tanggal_transaksi:i.tanggal_transaksi,jatuh_tempo:i.jatuh_tempo,nomor_faktur:(null===(t=i.nomor_faktur)||void 0===t?void 0:t.trim())||null,keterangan:(null===(n=i.keterangan)||void 0===n?void 0:n.trim())||"Hutang ke ".concat(i.nama_supplier),status_pembayaran:"belum_lunas"},l=await fetch("/api/tenant/".concat(o,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Hutang Usaha",session_id:"hutang-usaha-".concat(Date.now()),conversation_context:JSON.stringify({form_data:s})})});if(401===l.status)return void d("Sesi berakhir. Silakan login ulang.");if(!l.ok){const e=await l.json();throw new Error(e.detail||e.message||"Gagal menyimpan hutang")}const c=await l.json(),u={success:!0,message:c.message||"Hutang usaha berhasil dicatat",transaction_id:c.transaction_id||"",nama_supplier:i.nama_supplier,nominal:i.nominal,jatuh_tempo:i.jatuh_tempo};p(u),setTimeout(()=>{r(u)},1500)}catch(a){d(a.message||"Gagal menyimpan. Coba lagi."),console.error("[HutangUsahaForm] Submit error:",a)}finally{c(!1)}},disabled:l||!v,className:"flex-1 py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:HC,color:WC},children:l?"Menyimpan...":o?"Simpan Perubahan":"Simpan Hutang"})]})]}):null},XC={tipe:"pembelian",nama_supplier:"",nominal_dp:0,tanggal_dp:(new Date).toISOString().split("T")[0]},YC={tipe:"pelanggan",nama_pelanggan:"",nominal_dp:0,tanggal_dp:(new Date).toISOString().split("T")[0]},qC=e=>new Intl.NumberFormat("id-ID").format(e),ZC=e=>parseInt(e.replace(/\D/g,""),10)||0,JC="#3B82F6",QC="#737373",$C="#D4D4D4",eN="#E5E5E5",tN="#F5F5F5",nN="#FFFFFF",rN="#262626",aN="#EF4444",oN={x:[0,-10,10,-10,10,0],transition:{duration:.4}},iN=e=>{let{isOpen:t,onClose:n,onSuccess:r,editData:o}=e;const[i,s]=(0,a.useState)(XC),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{t&&(s(o||tt(tt({},XC),{},{tanggal_dp:(new Date).toISOString().split("T")[0]})),d(null),p(null),m(!1),setTimeout(()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.focus()},100))},[t,o]);const x=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},y=i.nama_supplier.trim()&&i.nominal_dp>0;return t?h?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:nN},children:(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,Ue.jsxs)(yc.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:15},className:"text-center px-6",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",damping:10},className:"w-24 h-24 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DBEAFE"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.4,duration:.5},className:"w-12 h-12",style:{color:JC},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)(yc.path,{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold mb-2",style:{color:rN},children:"DP ke Supplier Dicatat"}),(0,Ue.jsx)("p",{className:"text-lg mb-2",style:{color:QC},children:h.nama_pihak}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold",style:{color:JC},children:["Rp ",qC(h.nominal)]})]})})}):(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:tN},children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:nN,borderColor:eN},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:$C},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:rN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:rN},children:"Uang Muka Pembelian"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:QC},children:"SAK EMKM 1106 \u2022 Aset"})]})]}),(0,Ue.jsxs)(yc.div,{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",animate:f?oN:{},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 rounded-xl text-sm",style:{backgroundColor:"#FEE2E2",color:aN},children:u})}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:nN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:JC},children:"Data Supplier"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:rN},children:["Nama Supplier ",(0,Ue.jsx)("span",{style:{color:aN},children:"*"})]}),(0,Ue.jsx)("input",{ref:g,type:"text",value:i.nama_supplier,onChange:e=>x("nama_supplier",e.target.value),placeholder:"Contoh: PT ABC, Distributor Utama",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:nN,border:"1px solid ".concat(eN),color:rN}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:rN},children:"No. Telepon/WA"}),(0,Ue.jsx)("input",{type:"tel",value:i.kontak_supplier||"",onChange:e=>x("kontak_supplier",e.target.value),placeholder:"08xxxxxxxxxx",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:nN,border:"1px solid ".concat(eN),color:rN}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:nN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:JC},children:"Nominal DP"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:rN},children:["Jumlah ",(0,Ue.jsx)("span",{style:{color:aN},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:QC},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:i.nominal_dp>0?qC(i.nominal_dp):"",onChange:e=>(e=>{const t=ZC(e);x("nominal_dp",t)})(e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right rounded-lg",style:{backgroundColor:nN,border:"1px solid ".concat(eN),color:rN}})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:nN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:JC},children:"Detail"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:rN},children:"Tanggal DP"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal_dp,onChange:e=>x("tanggal_dp",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:nN,border:"1px solid ".concat(eN),color:rN}})]}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:rN},children:"Tujuan Pembelian"}),(0,Ue.jsx)("input",{type:"text",value:i.tujuan_pembelian||"",onChange:e=>x("tujuan_pembelian",e.target.value),placeholder:"Contoh: Stok minyak goreng",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:nN,border:"1px solid ".concat(eN),color:rN}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:rN},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>x("keterangan",e.target.value),placeholder:"Catatan tambahan...",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:nN,border:"1px solid ".concat(eN),color:rN}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{backgroundColor:"#DBEAFE"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:JC},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:nN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:"#1E40AF"},children:"Dicatat sebagai Aset"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#1E40AF"},children:"Uang muka pembelian adalah DP yang dibayar ke supplier sebelum barang diterima. Saat barang diterima, uang muka ini akan dipotong dari hutang usaha."})]})]}),(0,Ue.jsx)("div",{className:"h-24"})]}),(0,Ue.jsxs)("div",{className:"p-4 border-t flex gap-3",style:{backgroundColor:nN,borderColor:eN},children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium",style:{backgroundColor:tN,color:QC},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(!y)return i.nama_supplier.trim()?i.nominal_dp<=0&&d("Masukkan nominal DP"):d("Masukkan nama supplier"),m(!0),void setTimeout(()=>m(!1),500);c(!0),d(null);try{var e,t,n;const a=localStorage.getItem("access_token"),o=localStorage.getItem("tenant_id")||"evlogia",s={transaction_type:"uang_muka_pembelian",pihak_type:"supplier",nama_pihak:i.nama_supplier.trim(),kontak_pihak:(null===(e=i.kontak_supplier)||void 0===e?void 0:e.trim())||null,nominal:i.nominal_dp,total_amount:i.nominal_dp,tanggal_dp:i.tanggal_dp,tujuan_pembelian:(null===(t=i.tujuan_pembelian)||void 0===t?void 0:t.trim())||null,keterangan:(null===(n=i.keterangan)||void 0===n?void 0:n.trim())||"DP ke ".concat(i.nama_supplier)},l=await fetch("/api/tenant/".concat(o,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Uang Muka Pembelian",session_id:"uang-muka-pembelian-".concat(Date.now()),conversation_context:JSON.stringify({form_data:s})})});if(401===l.status)return void d("Sesi berakhir. Silakan login ulang.");if(!l.ok){const e=await l.json();throw new Error(e.detail||e.message||"Gagal menyimpan uang muka")}const c=await l.json(),u={success:!0,message:c.message||"Uang muka pembelian berhasil dicatat",transaction_id:c.transaction_id||"",tipe:"pembelian",nama_pihak:i.nama_supplier,nominal:i.nominal_dp};p(u),setTimeout(()=>{r(u)},1500)}catch(a){d(a.message||"Gagal menyimpan. Coba lagi."),console.error("[UangMukaPembelianForm] Submit error:",a)}finally{c(!1)}},disabled:l||!y,className:"flex-1 py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:JC,color:nN},children:l?"Menyimpan...":"Simpan DP Supplier"})]})]}):null},sN="#A855F7",lN="#737373",cN="#D4D4D4",uN="#E5E5E5",dN="#F5F5F5",hN="#FFFFFF",pN="#262626",fN="#EF4444",mN={x:[0,-10,10,-10,10,0],transition:{duration:.4}},gN=e=>{let{isOpen:t,onClose:n,onSuccess:r,editData:o}=e;const[i,s]=(0,a.useState)(YC),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{t&&(s(o||tt(tt({},YC),{},{tanggal_dp:(new Date).toISOString().split("T")[0]})),d(null),p(null),m(!1),setTimeout(()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.focus()},100))},[t,o]);const x=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},y=i.nama_pelanggan.trim()&&i.nominal_dp>0;return t?h?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:hN},children:(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,Ue.jsxs)(yc.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:15},className:"text-center px-6",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",damping:10},className:"w-24 h-24 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#F3E8FF"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.4,duration:.5},className:"w-12 h-12",style:{color:sN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)(yc.path,{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold mb-2",style:{color:pN},children:"DP dari Pelanggan Dicatat"}),(0,Ue.jsx)("p",{className:"text-lg mb-2",style:{color:lN},children:h.nama_pihak}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold",style:{color:sN},children:["Rp ",qC(h.nominal)]})]})})}):(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:dN},children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:hN,borderColor:uN},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:cN},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:pN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:pN},children:"Uang Muka dari Pelanggan"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:lN},children:"SAK EMKM 2103 \u2022 Kewajiban"})]})]}),(0,Ue.jsxs)(yc.div,{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",animate:f?mN:{},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 rounded-xl text-sm",style:{backgroundColor:"#FEE2E2",color:fN},children:u})}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:hN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:sN},children:"Data Pelanggan"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:pN},children:["Nama Pelanggan ",(0,Ue.jsx)("span",{style:{color:fN},children:"*"})]}),(0,Ue.jsx)("input",{ref:g,type:"text",value:i.nama_pelanggan,onChange:e=>x("nama_pelanggan",e.target.value),placeholder:"Contoh: Toko Maju, Bu Siti",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:hN,border:"1px solid ".concat(uN),color:pN}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:pN},children:"No. Telepon/WA"}),(0,Ue.jsx)("input",{type:"tel",value:i.kontak_pelanggan||"",onChange:e=>x("kontak_pelanggan",e.target.value),placeholder:"08xxxxxxxxxx",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:hN,border:"1px solid ".concat(uN),color:pN}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:hN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:sN},children:"Nominal DP"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:pN},children:["Jumlah ",(0,Ue.jsx)("span",{style:{color:fN},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:lN},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:i.nominal_dp>0?qC(i.nominal_dp):"",onChange:e=>(e=>{const t=ZC(e);x("nominal_dp",t)})(e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right rounded-lg",style:{backgroundColor:hN,border:"1px solid ".concat(uN),color:pN}})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:hN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:sN},children:"Detail"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:pN},children:"Tanggal DP"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal_dp,onChange:e=>x("tanggal_dp",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:hN,border:"1px solid ".concat(uN),color:pN}})]}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:pN},children:"Barang/Jasa yang Dipesan"}),(0,Ue.jsx)("input",{type:"text",value:i.barang_pesanan||"",onChange:e=>x("barang_pesanan",e.target.value),placeholder:"Contoh: 10 dus minyak goreng",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:hN,border:"1px solid ".concat(uN),color:pN}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:pN},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>x("keterangan",e.target.value),placeholder:"Catatan tambahan...",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:hN,border:"1px solid ".concat(uN),color:pN}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{backgroundColor:"#F3E8FF"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:sN},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:hN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:"#6B21A8"},children:"Dicatat sebagai Kewajiban"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#6B21A8"},children:"Uang muka dari pelanggan adalah DP yang diterima sebelum barang dikirim. Ini menambah kas tetapi juga menambah kewajiban. Saat barang dikirim, kewajiban ini berubah menjadi pendapatan."})]})]}),(0,Ue.jsx)("div",{className:"h-24"})]}),(0,Ue.jsxs)("div",{className:"p-4 border-t flex gap-3",style:{backgroundColor:hN,borderColor:uN},children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium",style:{backgroundColor:dN,color:lN},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(!y)return i.nama_pelanggan.trim()?i.nominal_dp<=0&&d("Masukkan nominal DP"):d("Masukkan nama pelanggan"),m(!0),void setTimeout(()=>m(!1),500);c(!0),d(null);try{var e,t,n;const a=localStorage.getItem("access_token"),o=localStorage.getItem("tenant_id")||"evlogia",s={transaction_type:"uang_muka_pelanggan",pihak_type:"pelanggan",nama_pihak:i.nama_pelanggan.trim(),kontak_pihak:(null===(e=i.kontak_pelanggan)||void 0===e?void 0:e.trim())||null,nominal:i.nominal_dp,total_amount:i.nominal_dp,tanggal_dp:i.tanggal_dp,barang_pesanan:(null===(t=i.barang_pesanan)||void 0===t?void 0:t.trim())||null,keterangan:(null===(n=i.keterangan)||void 0===n?void 0:n.trim())||"DP dari ".concat(i.nama_pelanggan)},l=await fetch("/api/tenant/".concat(o,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Uang Muka Pelanggan",session_id:"uang-muka-pelanggan-".concat(Date.now()),conversation_context:JSON.stringify({form_data:s})})});if(401===l.status)return void d("Sesi berakhir. Silakan login ulang.");if(!l.ok){const e=await l.json();throw new Error(e.detail||e.message||"Gagal menyimpan uang muka")}const c=await l.json(),u={success:!0,message:c.message||"Uang muka dari pelanggan berhasil dicatat",transaction_id:c.transaction_id||"",tipe:"pelanggan",nama_pihak:i.nama_pelanggan,nominal:i.nominal_dp};p(u),setTimeout(()=>{r(u)},1500)}catch(a){d(a.message||"Gagal menyimpan. Coba lagi."),console.error("[UangMukaPelangganForm] Submit error:",a)}finally{c(!1)}},disabled:l||!y,className:"flex-1 py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:sN,color:hN},children:l?"Menyimpan...":"Simpan DP Pelanggan"})]})]}):null},xN=[{id:"ppn",label:"PPN",description:"Pajak Pertambahan Nilai"},{id:"pph21",label:"PPh 21",description:"Pajak Penghasilan Pasal 21 (Gaji)"},{id:"pph23",label:"PPh 23",description:"Pajak Penghasilan Pasal 23 (Jasa)"},{id:"pph_final",label:"PPh Final",description:"PPh Final UMKM 0.5%"},{id:"lainnya",label:"Lainnya",description:"Jenis pajak lainnya"}],yN={jenis_pajak:"ppn",masa_pajak:"",nominal:0,tanggal_terutang:(new Date).toISOString().split("T")[0],jatuh_tempo:new Date(Date.now()+2592e6).toISOString().split("T")[0]},vN=e=>new Intl.NumberFormat("id-ID").format(e),bN=e=>{const t=new Date;return t.setMonth(t.getMonth()+1),t.setDate(15),t.toISOString().split("T")[0]},wN=e=>{const t=xN.find(t=>t.id===e);return(null===t||void 0===t?void 0:t.label)||e},kN="#737373",jN="#D4D4D4",CN="#E5E5E5",NN="#F5F5F5",_N="#FFFFFF",SN="#262626",EN="#22C55E",AN="#EF4444",IN={x:[0,-10,10,-10,10,0],transition:{duration:.4}},TN=e=>{let{isOpen:t,onClose:n,onSuccess:r,editData:o}=e;const[i,s]=(0,a.useState)(yN),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1),g=(0,a.useMemo)(()=>(()=>{const e=[],t=new Date,n=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];for(let r=0;r<12;r++){const a=new Date(t.getFullYear(),t.getMonth()-r,1),o=n[a.getMonth()],i=a.getFullYear();e.push("".concat(o," ").concat(i))}return e})(),[]);(0,a.useEffect)(()=>{t&&(s(o||tt(tt({},yN),{},{masa_pajak:g[0]||"",tanggal_terutang:(new Date).toISOString().split("T")[0],jatuh_tempo:bN()})),d(null),p(null),m(!1))},[t,o,g]),(0,a.useEffect)(()=>{o||s(e=>tt(tt({},e),{},{jatuh_tempo:bN(e.jenis_pajak)}))},[i.jenis_pajak,o]);const x=(e,t)=>{s(n=>tt(tt({},n),{},{[e]:t})),d(null)},y=e=>{const t=(e=>parseInt(e.replace(/\D/g,""),10)||0)(e);x("nominal",t)},v=i.masa_pajak.trim()&&i.nominal>0;return t?h?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:_N},children:(0,Ue.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,Ue.jsxs)(yc.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:15},className:"text-center px-6",children:[(0,Ue.jsx)(yc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",damping:10},className:"w-24 h-24 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"#DCFCE7"},children:(0,Ue.jsx)(yc.svg,{initial:{pathLength:0},animate:{pathLength:1},transition:{delay:.4,duration:.5},className:"w-12 h-12",style:{color:EN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)(yc.path,{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("h2",{className:"text-xl font-bold mb-2",style:{color:SN},children:"Hutang Pajak Dicatat"}),(0,Ue.jsx)("p",{className:"text-lg mb-1",style:{color:kN},children:wN(h.jenis_pajak)}),(0,Ue.jsx)("p",{className:"text-sm mb-2",style:{color:kN},children:h.masa_pajak}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold",style:{color:AN},children:["Rp ",vN(h.nominal)]})]})})}):(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:NN},children:[(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:_N,borderColor:CN},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:jN},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:SN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsxs)("div",{className:"ml-2",children:[(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:SN},children:"Hutang Pajak"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:kN},children:"SAK EMKM 2104"})]})]}),(0,Ue.jsxs)(yc.div,{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",animate:f?IN:{},children:[(0,Ue.jsx)(mt,{children:u&&(0,Ue.jsx)(yc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 rounded-xl text-sm",style:{backgroundColor:"#FEE2E2",color:AN},children:u})}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:_N,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:AN},children:"Jenis Pajak"}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2",children:xN.slice(0,4).map(e=>(0,Ue.jsxs)("button",{type:"button",onClick:()=>x("jenis_pajak",e.id),className:"px-3 py-3 rounded-lg text-left transition-colors",style:{backgroundColor:i.jenis_pajak===e.id?AN:NN,color:i.jenis_pajak===e.id?_N:SN},children:[(0,Ue.jsx)("div",{className:"font-medium text-sm",children:e.label}),(0,Ue.jsx)("div",{className:"text-xs mt-0.5",style:{color:i.jenis_pajak===e.id?"rgba(255,255,255,0.8)":kN},children:e.description})]},e.id))})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:_N,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:AN},children:"Periode & Nominal"}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:SN},children:["Masa Pajak ",(0,Ue.jsx)("span",{style:{color:AN},children:"*"})]}),(0,Ue.jsx)("select",{value:i.masa_pajak,onChange:e=>x("masa_pajak",e.target.value),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:_N,border:"1px solid ".concat(CN),color:SN},children:g.map(e=>(0,Ue.jsx)("option",{value:e,children:e},e))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:SN},children:["Nominal Pajak ",(0,Ue.jsx)("span",{style:{color:AN},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:kN},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:i.nominal>0?vN(i.nominal):"",onChange:e=>y(e.target.value),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg font-semibold text-right rounded-lg",style:{backgroundColor:_N,border:"1px solid ".concat(CN),color:SN}})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:_N,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider mb-3",style:{color:AN},children:"Tanggal"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:SN},children:"Tanggal Terutang"}),(0,Ue.jsx)("input",{type:"date",value:i.tanggal_terutang,onChange:e=>x("tanggal_terutang",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:_N,border:"1px solid ".concat(CN),color:SN}})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:SN},children:"Jatuh Tempo"}),(0,Ue.jsx)("input",{type:"date",value:i.jatuh_tempo,onChange:e=>x("jatuh_tempo",e.target.value),className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:_N,border:"1px solid ".concat(CN),color:SN}})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:SN},children:"Keterangan"}),(0,Ue.jsx)("textarea",{value:i.keterangan||"",onChange:e=>x("keterangan",e.target.value),placeholder:"Catatan tambahan...",rows:2,className:"w-full px-3 py-2.5 rounded-lg resize-none",style:{backgroundColor:_N,border:"1px solid ".concat(CN),color:SN}})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4 flex items-start gap-3",style:{backgroundColor:"#FEE2E2"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:AN},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:_N},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:"#991B1B"},children:"Penting: Pembayaran Pajak"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#991B1B"},children:"Pastikan pajak dibayar sebelum jatuh tempo untuk menghindari sanksi administrasi dan denda."})]})]}),(0,Ue.jsx)("div",{className:"h-24"})]}),(0,Ue.jsxs)("div",{className:"p-4 border-t flex gap-3",style:{backgroundColor:_N,borderColor:CN},children:[(0,Ue.jsx)("button",{onClick:n,className:"flex-1 py-3.5 rounded-xl font-medium",style:{backgroundColor:NN,color:kN},children:"Batal"}),(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:async()=>{if(!v)return i.masa_pajak.trim()?i.nominal<=0&&d("Masukkan nominal pajak"):d("Pilih masa pajak"),m(!0),void setTimeout(()=>m(!1),500);c(!0),d(null);try{var e;const t=localStorage.getItem("access_token"),n=localStorage.getItem("tenant_id")||"evlogia",a={transaction_type:"hutang_pajak",jenis_pajak:i.jenis_pajak,masa_pajak:i.masa_pajak,nominal:i.nominal,total_amount:i.nominal,tanggal_terutang:i.tanggal_terutang,jatuh_tempo:i.jatuh_tempo,keterangan:(null===(e=i.keterangan)||void 0===e?void 0:e.trim())||"Hutang ".concat(wN(i.jenis_pajak)," ").concat(i.masa_pajak),status_pembayaran:"belum_lunas"},o=await fetch("/api/tenant/".concat(n,"/chat"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({message:"[FORM] Hutang Pajak",session_id:"hutang-pajak-".concat(Date.now()),conversation_context:JSON.stringify({form_data:a})})});if(401===o.status)return void d("Sesi berakhir. Silakan login ulang.");if(!o.ok){const e=await o.json();throw new Error(e.detail||e.message||"Gagal menyimpan hutang pajak")}const s=await o.json(),l={success:!0,message:s.message||"Hutang pajak berhasil dicatat",transaction_id:s.transaction_id||"",jenis_pajak:i.jenis_pajak,masa_pajak:i.masa_pajak,nominal:i.nominal};p(l),setTimeout(()=>{r(l)},1500)}catch(t){d(t.message||"Gagal menyimpan. Coba lagi."),console.error("[HutangPajakForm] Submit error:",t)}finally{c(!1)}},disabled:l||!v,className:"flex-1 py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:AN,color:_N},children:l?"Menyimpan...":"Simpan Hutang Pajak"})]})]}):null},PN="#F97316",DN="#FFF7ED",MN="#3B82F6",RN="#A855F7",FN="#737373",ON="#D4D4D4",BN="#E5E5E5",LN="#F5F5F5",zN="#FFFFFF",WN="#262626",VN="#22C55E",UN="#EF4444",HN=e=>{let{isOpen:t,onClose:n,isMobile:r=!1,isEmbedded:o=!1}=e;const[i,s]=(0,a.useState)("piutang"),[l,c]=(0,a.useState)("list"),[u,d]=(0,a.useState)("left"),[h,p]=(0,a.useState)([]),[f,m]=(0,a.useState)({total_hutang:0,total_piutang:0,hutang_count:0,piutang_count:0,hutang_jatuh_tempo:0,piutang_jatuh_tempo:0}),[g,x]=(0,a.useState)(null),[y,v]=(0,a.useState)(!1),[b,w]=(0,a.useState)(null),[k,j]=(0,a.useState)(""),[C,N]=(0,a.useState)("tunai"),[_,S]=(0,a.useState)(""),[E,A]=(0,a.useState)(!1),[I,T]=(0,a.useState)(!1),[P,D]=(0,a.useState)(!1),[M,R]=(0,a.useState)(!1),[F,O]=(0,a.useState)(!1),[B,L]=(0,a.useState)(!1),[z,W]=(0,a.useState)(!1),V=(0,a.useCallback)(async()=>{v(!0),w(null);try{const e=await jw("/api/debt/list");if(!e.ok)throw new Error("Gagal memuat data");const t=await e.json();p(t.debts||[]),m(t.summary||f)}catch(e){const t=[{id:"1",transaksi_id:"tx-001",tipe:"piutang",nama_pihak:"Toko Maju",kontak_pihak:"08123456789",nominal_awal:5e5,nominal_dibayar:2e5,sisa:3e5,status:"sebagian",jatuh_tempo:new Date(Date.now()+6048e5).toISOString(),keterangan:"Penjualan kredit",created_at:(new Date).toISOString()},{id:"2",transaksi_id:"tx-002",tipe:"hutang",nama_pihak:"Supplier ABC",kontak_pihak:"08987654321",nominal_awal:2e6,nominal_dibayar:0,sisa:2e6,status:"belum_lunas",jatuh_tempo:new Date(Date.now()-1728e5).toISOString(),keterangan:"Pembelian barang",created_at:(new Date).toISOString()},{id:"3",transaksi_id:"tx-003",tipe:"piutang",nama_pihak:"Bu Siti",nominal_awal:15e4,nominal_dibayar:15e4,sisa:0,status:"lunas",created_at:(new Date).toISOString()}];p(t),m({total_hutang:2e6,total_piutang:5e5,hutang_count:1,piutang_count:2,hutang_jatuh_tempo:1,piutang_jatuh_tempo:0})}finally{v(!1)}},[]);(0,a.useEffect)(()=>{t&&V()},[t,V]);const U=()=>{switch(i){case"piutang":return h.filter(e=>"piutang"===e.tipe&&"lunas"!==e.status);case"hutang":return h.filter(e=>"hutang"===e.tipe&&"lunas"!==e.status);default:return[]}},H=e=>{x(e),d("left"),c("detail")},G=()=>{j(""),N("tunai"),S(""),d("left"),c("payment")},K=()=>{d("right"),"payment"===l?c("detail"):(c("list"),x(null))},X=()=>{d("right"),c("list"),x(null)},Y=async()=>{if(!k||parseFloat(k)<=0)return void w("Masukkan nominal pembayaran");if(!g)return;const e=parseFloat(k);if(e>g.sisa)w("Nominal melebihi sisa tagihan");else{v(!0);try{const t=g.sisa-e,n=0===t?"lunas":"sebagian";p(r=>r.map(r=>r.id===g.id?tt(tt({},r),{},{nominal_dibayar:r.nominal_dibayar+e,sisa:t,status:n}):r)),x(r=>r?tt(tt({},r),{},{nominal_dibayar:r.nominal_dibayar+e,sisa:t,status:n}):null),K()}catch(t){w(t.message)}finally{v(!1)}}},q=o?"h-full flex flex-col":"fixed inset-0 z-50 flex flex-col";if(!t)return null;const Z=()=>{const e=U();return(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"flex-1 flex flex-col min-h-0",style:{backgroundColor:LN},children:[(0,Ue.jsx)("div",{className:"p-4",children:(0,Ue.jsxs)("div",{className:"rounded-xl p-4 text-center",style:{backgroundColor:VN},children:[(0,Ue.jsx)("div",{className:"text-sm text-white/80",children:"Total Piutang Aktif"}),(0,Ue.jsxs)("div",{className:"text-2xl font-bold text-white",children:["Rp ",Bj(f.total_piutang)]}),(0,Ue.jsxs)("div",{className:"text-xs text-white/70 mt-1",children:[f.piutang_count," transaksi \u2022 ",f.piutang_jatuh_tempo," jatuh tempo"]})]})}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 pb-24",children:[(0,Ue.jsx)("div",{className:"text-xs font-medium uppercase tracking-wider mb-2",style:{color:FN},children:"Daftar Piutang"}),0===e.length?(0,Ue.jsx)("div",{className:"text-center py-8",style:{color:FN},children:"Tidak ada piutang aktif"}):(0,Ue.jsx)("div",{className:"space-y-2",children:e.map((e,t)=>(0,Ue.jsxs)(yc.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},onClick:()=>H(e),className:"w-full rounded-xl p-4 flex items-center justify-between transition-all active:scale-[0.98]",style:{backgroundColor:zN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-lg",style:{backgroundColor:"#DCFCE7"},children:"\ud83d\udcb0"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("div",{className:"font-semibold",style:{color:WN},children:e.nama_pihak}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:FN},children:e.keterangan||"Piutang usaha"}),zj(e.jatuh_tempo)&&(0,Ue.jsx)("span",{className:"inline-block px-2 py-0.5 rounded text-xs font-medium mt-1",style:{backgroundColor:DN,color:PN},children:"Jatuh Tempo!"})]})]}),(0,Ue.jsxs)("div",{className:"text-right flex items-center gap-2",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"font-bold",style:{color:VN},children:["Rp ",Bj(e.sisa)]}),(0,Ue.jsx)("div",{className:"text-xs px-2 py-0.5 rounded mt-1",style:{backgroundColor:"sebagian"===e.status?"#FEF3C7":"#FEE2E2",color:"sebagian"===e.status?"#92400E":"#991B1B"},children:Lj(e.status)})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:BN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},e.id))})]}),(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>D(!0),className:"fixed bottom-6 right-6 w-14 h-14 rounded-full flex items-center justify-center shadow-lg z-10",style:{backgroundColor:VN},children:(0,Ue.jsx)("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]},"piutang-tab")};return(0,Ue.jsxs)("div",{className:q,style:{backgroundColor:LN},children:["list"===l&&(0,Ue.jsxs)("div",{className:"flex items-center px-4 border-b",style:{height:"60px",backgroundColor:zN,borderColor:BN},children:[(0,Ue.jsxs)("button",{onClick:n,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:ON},children:[(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{var t;e.currentTarget.style.display="none",null===(t=e.currentTarget.nextElementSibling)||void 0===t||t.classList.remove("hidden")}}),(0,Ue.jsx)("svg",{className:"w-5 h-5 hidden",style:{color:WN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]}),(0,Ue.jsx)("h1",{className:"text-lg font-semibold ml-2",style:{color:WN},children:"Hutang & Piutang"})]}),"list"===l&&(0,Ue.jsx)("div",{className:"flex border-b",style:{backgroundColor:zN,borderColor:BN},children:["piutang","hutang","uang_muka"].map(e=>(0,Ue.jsxs)("button",{onClick:()=>{s(e),c("list")},className:"flex-1 py-3 text-sm font-medium relative transition-colors",style:{color:i===e?PN:FN},children:["piutang"===e&&"Piutang","hutang"===e&&"Hutang","uang_muka"===e&&"Uang Muka",i===e&&(0,Ue.jsx)(yc.div,{layoutId:"debtTabIndicator",className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:PN}})]},e))}),(0,Ue.jsx)(mt,{mode:"wait",children:(()=>{if("detail"===l)return(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:-100},className:"flex-1 flex flex-col",style:{backgroundColor:LN},children:[(0,Ue.jsxs)("div",{className:"p-4",style:{backgroundColor:"piutang"===(null===g||void 0===g?void 0:g.tipe)?VN:UN},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,Ue.jsx)("button",{onClick:X,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:"rgba(255,255,255,0.2)"},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{e.currentTarget.style.display="none"}})}),(0,Ue.jsxs)("div",{className:"text-white",children:[(0,Ue.jsx)("h2",{className:"text-lg font-bold",children:null===g||void 0===g?void 0:g.nama_pihak}),(0,Ue.jsx)("div",{className:"text-sm opacity-80",children:"piutang"===(null===g||void 0===g?void 0:g.tipe)?"Piutang Usaha":"Hutang Usaha"})]})]}),(0,Ue.jsxs)("div",{className:"text-center text-white",children:[(0,Ue.jsx)("div",{className:"text-sm opacity-80",children:"Sisa Tagihan"}),(0,Ue.jsxs)("div",{className:"text-3xl font-bold",children:["Rp ",Bj((null===g||void 0===g?void 0:g.sisa)||0)]})]})]}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4",children:g&&(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:zN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Ue.jsx)("span",{style:{color:FN},children:"Status"}),(0,Ue.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:"lunas"===g.status?"#DCFCE7":"sebagian"===g.status?"#FEF3C7":"#FEE2E2",color:"lunas"===g.status?"#166534":"sebagian"===g.status?"#92400E":"#991B1B"},children:Lj(g.status)})]}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("div",{className:"flex justify-between py-2 border-b",style:{borderColor:LN},children:[(0,Ue.jsx)("span",{style:{color:FN},children:"Nominal Awal"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:WN},children:["Rp ",Bj(g.nominal_awal)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between py-2 border-b",style:{borderColor:LN},children:[(0,Ue.jsx)("span",{style:{color:FN},children:"Sudah Dibayar"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:VN},children:["Rp ",Bj(g.nominal_dibayar)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between py-2",children:[(0,Ue.jsx)("span",{className:"font-medium",style:{color:WN},children:"Sisa"}),(0,Ue.jsxs)("span",{className:"font-bold text-lg",style:{color:"piutang"===g.tipe?VN:UN},children:["Rp ",Bj(g.sisa)]})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4 space-y-3",style:{backgroundColor:zN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[g.kontak_pihak&&(0,Ue.jsxs)("div",{className:"flex justify-between py-2",style:{borderBottom:"1px solid ".concat(LN)},children:[(0,Ue.jsx)("span",{style:{color:FN},children:"Kontak"}),(0,Ue.jsx)("a",{href:"tel:".concat(g.kontak_pihak),className:"font-medium",style:{color:MN},children:g.kontak_pihak})]}),g.jatuh_tempo&&(0,Ue.jsxs)("div",{className:"flex justify-between py-2",style:{borderBottom:"1px solid ".concat(LN)},children:[(0,Ue.jsx)("span",{style:{color:FN},children:"Jatuh Tempo"}),(0,Ue.jsx)("span",{className:"font-medium",style:{color:zj(g.jatuh_tempo)?UN:WN},children:new Date(g.jatuh_tempo).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})})]}),(0,Ue.jsxs)("div",{className:"flex justify-between py-2",style:{borderBottom:"1px solid ".concat(LN)},children:[(0,Ue.jsx)("span",{style:{color:FN},children:"Tanggal"}),(0,Ue.jsx)("span",{className:"font-medium",style:{color:WN},children:new Date(g.created_at).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})})]}),g.keterangan&&(0,Ue.jsxs)("div",{className:"flex justify-between py-2",children:[(0,Ue.jsx)("span",{style:{color:FN},children:"Keterangan"}),(0,Ue.jsx)("span",{className:"font-medium text-right",style:{color:WN},children:g.keterangan})]})]})]})}),g&&"lunas"!==g.status&&(0,Ue.jsx)("div",{className:"p-4 border-t",style:{backgroundColor:zN,borderColor:BN},children:(0,Ue.jsxs)(yc.button,{whileTap:{scale:.98},onClick:G,className:"w-full py-3.5 rounded-xl font-semibold flex items-center justify-center gap-2",style:{backgroundColor:PN,color:zN},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Catat Pembayaran"]})})]},"detail-page");if("payment"===l)return(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:-100},className:"flex-1 flex flex-col",style:{backgroundColor:zN},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 border-b",style:{height:"60px",borderColor:BN},children:[(0,Ue.jsx)("button",{onClick:K,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:ON},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",onError:e=>{e.currentTarget.style.display="none"}})}),(0,Ue.jsx)("h1",{className:"text-lg font-semibold",style:{color:WN},children:"Catat Pembayaran"})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:[b&&(0,Ue.jsx)("div",{className:"p-3 rounded-lg text-sm",style:{backgroundColor:"#FEF2F2",color:UN},children:b}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:"piutang"===(null===g||void 0===g?void 0:g.tipe)?"#DCFCE7":"#FEE2E2"},children:[(0,Ue.jsxs)("div",{className:"text-sm",style:{color:"piutang"===(null===g||void 0===g?void 0:g.tipe)?VN:UN},children:["Sisa tagihan untuk ",null===g||void 0===g?void 0:g.nama_pihak]}),(0,Ue.jsxs)("div",{className:"text-2xl font-bold",style:{color:"piutang"===(null===g||void 0===g?void 0:g.tipe)?"#166534":"#991B1B"},children:["Rp ",Bj((null===g||void 0===g?void 0:g.sisa)||0)]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium mb-1",style:{color:WN},children:["Nominal Pembayaran ",(0,Ue.jsx)("span",{style:{color:UN},children:"*"})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",style:{color:FN},children:"Rp"}),(0,Ue.jsx)("input",{type:"text",inputMode:"numeric",value:k,onChange:e=>j(e.target.value.replace(/\D/g,"")),placeholder:"0",className:"w-full pl-10 pr-3 py-3 text-lg rounded-lg",style:{backgroundColor:zN,border:"1px solid ".concat(BN),color:WN}})]}),g&&(0,Ue.jsxs)("button",{onClick:()=>j(g.sisa.toString()),className:"mt-2 text-sm font-medium",style:{color:PN},children:["Lunasi semua (Rp ",Bj(g.sisa),")"]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:WN},children:"Metode Pembayaran"}),(0,Ue.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["tunai","transfer","ewallet"].map(e=>(0,Ue.jsx)("button",{onClick:()=>N(e),className:"py-2.5 rounded-lg text-sm font-medium transition-colors capitalize",style:{backgroundColor:C===e?PN:LN,color:C===e?zN:FN},children:"ewallet"===e?"E-Wallet":e},e))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:WN},children:"Catatan (opsional)"}),(0,Ue.jsx)("input",{type:"text",value:_,onChange:e=>S(e.target.value),placeholder:"Keterangan pembayaran",className:"w-full px-3 py-2.5 rounded-lg",style:{backgroundColor:zN,border:"1px solid ".concat(BN),color:WN}})]})]}),(0,Ue.jsx)("div",{className:"p-4 border-t",style:{borderColor:BN},children:(0,Ue.jsx)(yc.button,{whileTap:{scale:.98},onClick:Y,disabled:y,className:"w-full py-3.5 rounded-xl font-semibold disabled:opacity-50",style:{backgroundColor:PN,color:zN},children:y?"Memproses...":"Simpan Pembayaran"})})]},"payment-page");switch(i){case"piutang":default:return Z();case"hutang":return(()=>{const e=U();return(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"flex-1 flex flex-col min-h-0",style:{backgroundColor:LN},children:[(0,Ue.jsx)("div",{className:"p-4",children:(0,Ue.jsxs)("div",{className:"rounded-xl p-4 text-center",style:{backgroundColor:UN},children:[(0,Ue.jsx)("div",{className:"text-sm text-white/80",children:"Total Hutang Aktif"}),(0,Ue.jsxs)("div",{className:"text-2xl font-bold text-white",children:["Rp ",Bj(f.total_hutang)]}),(0,Ue.jsxs)("div",{className:"text-xs text-white/70 mt-1",children:[f.hutang_count," transaksi \u2022 ",f.hutang_jatuh_tempo," jatuh tempo"]})]})}),(0,Ue.jsxs)("div",{className:"px-4 grid grid-cols-2 gap-2 mb-3",children:[(0,Ue.jsx)("button",{onClick:()=>A(!0),className:"flex items-center justify-center gap-2 px-3 py-2.5 rounded-lg font-medium transition-colors text-sm",style:{backgroundColor:DN,color:PN},children:"\ud83c\udfe6 Hutang Bank"}),(0,Ue.jsx)("button",{onClick:()=>T(!0),className:"flex items-center justify-center gap-2 px-3 py-2.5 rounded-lg font-medium transition-colors text-sm",style:{backgroundColor:"#FAF5FF",color:RN},children:"\ud83d\udc65 Hutang Gaji"})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 pb-24",children:[(0,Ue.jsx)("div",{className:"text-xs font-medium uppercase tracking-wider mb-2",style:{color:FN},children:"Daftar Hutang"}),0===e.length?(0,Ue.jsx)("div",{className:"text-center py-8",style:{color:FN},children:"Tidak ada hutang aktif"}):(0,Ue.jsx)("div",{className:"space-y-2",children:e.map((e,t)=>(0,Ue.jsxs)(yc.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},onClick:()=>H(e),className:"w-full rounded-xl p-4 flex items-center justify-between transition-all active:scale-[0.98]",style:{backgroundColor:zN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-lg",style:{backgroundColor:"#FEE2E2"},children:"\ud83d\udccb"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("div",{className:"font-semibold",style:{color:WN},children:e.nama_pihak}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:FN},children:e.keterangan||"Hutang usaha"}),zj(e.jatuh_tempo)&&(0,Ue.jsx)("span",{className:"inline-block px-2 py-0.5 rounded text-xs font-medium mt-1",style:{backgroundColor:DN,color:PN},children:"Jatuh Tempo!"})]})]}),(0,Ue.jsxs)("div",{className:"text-right flex items-center gap-2",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"font-bold",style:{color:UN},children:["Rp ",Bj(e.sisa)]}),(0,Ue.jsx)("div",{className:"text-xs px-2 py-0.5 rounded mt-1",style:{backgroundColor:"sebagian"===e.status?"#FEF3C7":"#FEE2E2",color:"sebagian"===e.status?"#92400E":"#991B1B"},children:Lj(e.status)})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:BN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},e.id))})]}),(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>R(!0),className:"fixed bottom-6 right-6 w-14 h-14 rounded-full flex items-center justify-center shadow-lg z-10",style:{backgroundColor:UN},children:(0,Ue.jsx)("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]},"hutang-tab")})();case"uang_muka":return(0,Ue.jsxs)(yc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"flex-1 flex flex-col min-h-0",style:{backgroundColor:LN},children:[(0,Ue.jsxs)("div",{className:"p-4 space-y-3",children:[(0,Ue.jsx)(yc.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05},onClick:()=>L(!0),className:"w-full rounded-xl p-4 transition-all active:scale-[0.98]",style:{backgroundColor:zN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("span",{className:"text-3xl",children:"\ud83d\udce6"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("h3",{className:"font-medium",style:{color:WN},children:"Uang Muka Pembelian"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:FN},children:"DP ke supplier (SAK 1106)"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("div",{className:"font-bold",style:{color:MN},children:"Rp 0"}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:FN},children:"Aset"})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:BN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}),(0,Ue.jsx)(yc.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},onClick:()=>W(!0),className:"w-full rounded-xl p-4 transition-all active:scale-[0.98]",style:{backgroundColor:zN,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("span",{className:"text-3xl",children:"\ud83e\uddfe"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("h3",{className:"font-medium",style:{color:WN},children:"Uang Muka dari Pelanggan"}),(0,Ue.jsx)("p",{className:"text-xs",style:{color:FN},children:"DP dari customer (SAK 2103)"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("div",{className:"font-bold",style:{color:RN},children:"Rp 0"}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:FN},children:"Kewajiban"})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:BN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})]}),(0,Ue.jsx)("div",{className:"px-4 mt-2",children:(0,Ue.jsxs)("div",{className:"p-4 rounded-xl flex items-start gap-3",style:{backgroundColor:"#EFF6FF"},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:MN},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",style:{color:zN},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium",style:{color:MN},children:"Tentang Uang Muka"}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:"#1E40AF"},children:"Uang muka pembelian adalah DP yang dibayar ke supplier (aset). Uang muka pelanggan adalah DP yang diterima dari customer sebelum barang dikirim (kewajiban)."})]})]})}),(0,Ue.jsxs)("div",{className:"px-4 mt-4 grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)("button",{onClick:()=>L(!0),className:"py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition-all active:scale-[0.98]",style:{backgroundColor:MN,color:zN},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"DP Supplier"]}),(0,Ue.jsxs)("button",{onClick:()=>W(!0),className:"py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition-all active:scale-[0.98]",style:{backgroundColor:RN,color:zN},children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"DP Customer"]})]}),(0,Ue.jsx)(yc.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:()=>L(!0),className:"fixed bottom-6 right-6 w-14 h-14 rounded-full flex items-center justify-center shadow-lg z-10",style:{backgroundColor:MN},children:(0,Ue.jsx)("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]},"uang-muka-tab")}})()}),(0,Ue.jsx)(rC,{isOpen:E,onClose:()=>A(!1),onSuccess:()=>{A(!1),V()}}),(0,Ue.jsx)(bC,{isOpen:I,onClose:()=>T(!1),onSuccess:()=>{T(!1),V()}}),(0,Ue.jsx)(DC,{isOpen:P,onClose:()=>D(!1),onSuccess:()=>{D(!1),V()}}),(0,Ue.jsx)(KC,{isOpen:M,onClose:()=>R(!1),onSuccess:()=>{R(!1),V()}}),(0,Ue.jsx)(TN,{isOpen:F,onClose:()=>O(!1),onSuccess:()=>{O(!1),V()}}),(0,Ue.jsx)(iN,{isOpen:B,onClose:()=>L(!1),onSuccess:()=>{L(!1),V()}}),(0,Ue.jsx)(gN,{isOpen:z,onClose:()=>W(!1),onSuccess:()=>{W(!1),V()}})]})},GN=e=>new Intl.NumberFormat("id-ID").format(e),KN=e=>e?e.startsWith("08")?e.replace(/(\d{4})(\d{4})(\d+)/,"$1-$2-$3"):e:"-",XN=e=>"pelanggan"===e?"Pelanggan":"Supplier",YN={duration:.3,ease:[.4,0,.2,1]},qN=e=>{let{isOpen:t,onClose:n,isMobile:r=!1,isEmbedded:o=!1}=e;const[i,s]=(0,a.useState)("list"),[l,c]=(0,a.useState)("left"),[u,d]=(0,a.useState)("all"),[h,p]=(0,a.useState)(""),[f,m]=(0,a.useState)([]),[g,x]=(0,a.useState)(null),[y,v]=(0,a.useState)([]),[b,w]=(0,a.useState)({total_pelanggan:0,total_supplier:0,total_piutang:0,total_hutang:0}),[k,j]=(0,a.useState)(!1),[C,N]=(0,a.useState)(null),[_,S]=(0,a.useState)({nama:"",tipe:"pelanggan",telepon:"",alamat:"",email:""}),E=(0,a.useCallback)(async()=>{j(!0),N(null);try{const e=await jw("/api/members/list?limit=100");if(!e.ok)throw new Error("Gagal memuat data");const t=await e.json(),n=(t.members||[]).map(e=>({id:e.id,nama:e.nama,tipe:e.tipe,telepon:e.telepon,alamat:e.alamat,email:e.email,nomor_member:e.nomor_member,points:e.points||0,total_transaksi:e.total_transaksi||0,total_nilai:e.total_nilai||0,saldo_hutang:e.saldo_hutang||0,last_transaction_at:e.last_transaction_at,created_at:e.created_at||(new Date).toISOString()}));m(n),t.summary&&w({total_pelanggan:t.summary.total_pelanggan||0,total_supplier:t.summary.total_supplier||0,total_piutang:t.summary.total_piutang||0,total_hutang:t.summary.total_hutang||0})}catch(e){console.error("Error fetching customers:",e),N("Gagal memuat data pelanggan"),m([]),w({total_pelanggan:0,total_supplier:0,total_piutang:0,total_hutang:0})}finally{j(!1)}},[]),A=(0,a.useCallback)(async e=>{j(!0);try{const t=await jw("/api/customer/".concat(e,"/transactions"));if(!t.ok)throw new Error("Gagal memuat transaksi");const n=await t.json();v(n.transactions||[])}catch(t){v([{id:"1",jenis_transaksi:"penjualan",total_nominal:25e4,status_pembayaran:"lunas",created_at:(new Date).toISOString()},{id:"2",jenis_transaksi:"penjualan",total_nominal:15e4,status_pembayaran:"kredit",sisa_hutang:15e4,created_at:new Date(Date.now()-864e5).toISOString()}])}finally{j(!1)}},[]);(0,a.useEffect)(()=>{t&&E()},[t,E]);const I=(0,a.useMemo)(()=>f.filter(e=>{if("all"!==u&&e.tipe!==u)return!1;if(h){const t=[e.nama,e.telepon||"",e.alamat||"",e.email||""].join(" ");return((e,t)=>{if(!e)return!0;const n=e.toLowerCase(),r=t.toLowerCase();if(r.includes(n))return!0;let a=0;for(let o=0;o<r.length&&a<n.length;o++)r[o]===n[a]&&a++;return a===n.length})(h,t)}return!0}),[f,u,h]),T=()=>{S({nama:"",tipe:"pelanggan",telepon:"",alamat:"",email:""}),c("left"),s("add")},P=()=>{g&&S({nama:g.nama,tipe:g.tipe,telepon:g.telepon||"",alamat:g.alamat||"",email:g.email||""}),c("left"),s("edit")},D=()=>{c("right"),"edit"===i?s("detail"):(s("list"),x(null))},M=()=>{c("right"),s("list"),x(null)},R=async()=>{if(_.nama.trim())if(_.telepon&&_.telepon.trim()){j(!0),N(null);try{if("add"===i){const e={id:Date.now().toString(),nama:_.nama,tipe:_.tipe,telepon:_.telepon,alamat:_.alamat||void 0,email:_.email||void 0,total_transaksi:0,total_nilai:0,saldo_hutang:0,created_at:(new Date).toISOString()};m(t=>[e,...t]),M()}else if("edit"===i&&g){const e=tt(tt({},g),{},{nama:_.nama,tipe:_.tipe,telepon:_.telepon,alamat:_.alamat||void 0,email:_.email||void 0});m(t=>t.map(t=>t.id===g.id?e:t)),x(e),D()}}catch(e){N(e.message)}finally{j(!1)}}else N("Nomor telepon wajib diisi");else N("Nama wajib diisi")},F=o?"h-full bg-gray-50 flex flex-col":"fixed inset-0 z-50 bg-gray-50 flex flex-col";if(!t)return null;const O=()=>(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,Ue.jsxs)("div",{className:"bg-purple-600 text-white px-4 py-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[o&&(0,Ue.jsx)("button",{onClick:n,className:"p-1 hover:bg-white/20 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:"Pelanggan & Supplier"})]}),(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsx)("button",{onClick:T,className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),!o&&(0,Ue.jsx)("button",{onClick:n,className:"p-1 hover:bg-white/20 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,Ue.jsxs)("div",{className:"mt-4 relative",children:[(0,Ue.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-purple-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,Ue.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"Cari nama, telepon, alamat...",className:"w-full pl-10 pr-4 py-2.5 bg-white/10 border border-white/20 rounded-lg text-white placeholder-purple-200 focus:outline-none focus:ring-2 focus:ring-white/30"})]}),(0,Ue.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)("div",{className:"bg-white/10 rounded-lg p-3",children:[(0,Ue.jsx)("div",{className:"text-xs opacity-80",children:"Total Pelanggan"}),(0,Ue.jsx)("div",{className:"text-2xl font-bold",children:b.total_pelanggan}),(0,Ue.jsxs)("div",{className:"text-xs opacity-70",children:["Piutang: Rp ",GN(b.total_piutang)]})]}),(0,Ue.jsxs)("div",{className:"bg-white/10 rounded-lg p-3",children:[(0,Ue.jsx)("div",{className:"text-xs opacity-80",children:"Total Supplier"}),(0,Ue.jsx)("div",{className:"text-2xl font-bold",children:b.total_supplier}),(0,Ue.jsxs)("div",{className:"text-xs opacity-70",children:["Hutang: Rp ",GN(b.total_hutang)]})]})]})]}),(0,Ue.jsx)("div",{className:"bg-white border-b px-4 py-2",children:(0,Ue.jsx)("div",{className:"flex gap-2",children:["all","pelanggan","supplier"].map(e=>(0,Ue.jsx)("button",{onClick:()=>d(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(u===e?"bg-purple-600 text-white":"bg-gray-100 text-gray-600"),children:"all"===e?"Semua":XN(e)},e))})}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4",children:k?(0,Ue.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Memuat data..."}):0===I.length?(0,Ue.jsx)("div",{className:"text-center text-gray-500 py-8",children:h?"Tidak ditemukan":"Belum ada data"}):(0,Ue.jsx)("div",{className:"space-y-3",children:I.map(e=>(0,Ue.jsx)("button",{onClick:()=>(e=>{x(e),A(e.id),c("left"),s("detail")})(e),className:"w-full bg-white rounded-xl p-4 shadow-sm text-left hover:shadow-md transition-shadow",children:(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold ".concat("pelanggan"===e.tipe?"bg-purple-100 text-purple-600":"bg-orange-100 text-orange-600"),children:e.nama.charAt(0).toUpperCase()}),(0,Ue.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ue.jsx)("div",{className:"font-semibold text-gray-900 truncate",children:e.nama}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:KN(e.telepon)}),e.saldo_hutang>0&&(0,Ue.jsxs)("div",{className:"text-xs mt-1 ".concat("pelanggan"===e.tipe?"text-green-600":"text-red-600"),children:["pelanggan"===e.tipe?"Piutang":"Hutang",": Rp ",GN(e.saldo_hutang)]})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("div",{className:"text-xs px-2 py-1 rounded ".concat("pelanggan"===e.tipe?"bg-purple-100 text-purple-700":"bg-orange-100 text-orange-700"),children:XN(e.tipe)}),(0,Ue.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[e.total_transaksi," transaksi"]})]})]})},e.id))})})]});return(0,Ue.jsx)("div",{className:F,children:(0,Ue.jsx)(mt,{mode:"wait",custom:l,children:(0,Ue.jsx)(yc.div,{custom:l,variants:{enter:e=>({x:"left"===e?"100%":"-100%"}),center:{x:0},exit:e=>({x:"left"===e?"-100%":"100%"})},initial:"enter",animate:"center",exit:"exit",transition:YN,className:"flex-1 flex flex-col overflow-hidden",children:(()=>{switch(i){case"list":default:return O();case"detail":return(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,Ue.jsx)("div",{className:"bg-purple-600 text-white px-4 py-4",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("button",{onClick:M,className:"p-1",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:null===g||void 0===g?void 0:g.nama}),(0,Ue.jsx)("div",{className:"text-sm opacity-80",children:g&&XN(g.tipe)})]})]}),(0,Ue.jsx)("button",{onClick:P,className:"p-2 bg-white/20 rounded-lg",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]})}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:g&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm space-y-3",children:[g.telepon&&(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Telepon"}),(0,Ue.jsxs)("a",{href:"tel:".concat(g.telepon),className:"text-purple-600 font-medium flex items-center gap-2",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),KN(g.telepon)]})]}),g.alamat&&(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Alamat"}),(0,Ue.jsx)("span",{className:"text-right font-medium text-gray-900",children:g.alamat})]}),g.email&&(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Email"}),(0,Ue.jsx)("a",{href:"mailto:".concat(g.email),className:"text-purple-600 font-medium",children:g.email})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"Total Transaksi"}),(0,Ue.jsx)("div",{className:"text-xl font-bold text-gray-900",children:g.total_transaksi})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"Total Nilai"}),(0,Ue.jsxs)("div",{className:"text-xl font-bold text-gray-900",children:["Rp ",GN(g.total_nilai)]})]})]}),g.saldo_hutang>0&&(0,Ue.jsx)("div",{className:"mt-3 pt-3 border-t",children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"pelanggan"===g.tipe?"Piutang":"Hutang"}),(0,Ue.jsxs)("span",{className:"font-bold text-lg ".concat("pelanggan"===g.tipe?"text-green-600":"text-red-600"),children:["Rp ",GN(g.saldo_hutang)]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-xl shadow-sm",children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",children:(0,Ue.jsx)("h3",{className:"font-semibold text-gray-900",children:"Transaksi Terakhir"})}),0===y.length?(0,Ue.jsx)("div",{className:"p-4 text-center text-gray-500 text-sm",children:"Belum ada transaksi"}):(0,Ue.jsx)("div",{className:"divide-y",children:y.slice(0,5).map(e=>(0,Ue.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-medium text-gray-900 capitalize",children:e.jenis_transaksi}),(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString("id-ID")})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsxs)("div",{className:"font-medium",children:["Rp ",GN(e.total_nominal)]}),e.sisa_hutang&&e.sisa_hutang>0&&(0,Ue.jsxs)("div",{className:"text-xs text-orange-600",children:["Sisa: Rp ",GN(e.sisa_hutang)]})]})]},e.id))})]})]})}),g&&g.telepon&&(0,Ue.jsx)("div",{className:"p-4 border-t bg-white",children:(0,Ue.jsxs)("a",{href:"https://wa.me/".concat(g.telepon.replace(/^0/,"62").replace(/\D/g,"")),target:"_blank",rel:"noopener noreferrer",className:"w-full py-3 bg-green-500 text-white rounded-xl font-semibold flex items-center justify-center gap-2 hover:bg-green-600 transition-colors",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:(0,Ue.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"Hubungi via WhatsApp"]})})]});case"add":case"edit":return(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col bg-white",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 py-4 border-b",children:[(0,Ue.jsx)("button",{onClick:D,className:"p-1",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"add"===i?"Tambah Kontak":"Edit Kontak"})]}),(0,Ue.jsxs)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:[C&&(0,Ue.jsx)("div",{className:"p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:C}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipe"}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2",children:["pelanggan","supplier"].map(e=>(0,Ue.jsx)("button",{onClick:()=>S(t=>tt(tt({},t),{},{tipe:e})),className:"py-3 rounded-lg text-sm font-medium transition-colors ".concat(_.tipe===e?"bg-purple-600 text-white":"bg-gray-100 text-gray-700"),children:XN(e)},e))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nama ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("input",{type:"text",value:_.nama,onChange:e=>S(t=>tt(tt({},t),{},{nama:e.target.value})),placeholder:"Nama pelanggan/supplier",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nomor Telepon ",(0,Ue.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ue.jsx)("input",{type:"tel",value:_.telepon,onChange:e=>S(t=>tt(tt({},t),{},{telepon:e.target.value})),placeholder:"081234567890",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alamat"}),(0,Ue.jsx)("textarea",{value:_.alamat,onChange:e=>S(t=>tt(tt({},t),{},{alamat:e.target.value})),placeholder:"Alamat lengkap (opsional)",rows:2,className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,Ue.jsx)("input",{type:"email",value:_.email,onChange:e=>S(t=>tt(tt({},t),{},{email:e.target.value})),placeholder:"email@example.com (opsional)",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})]}),(0,Ue.jsx)("div",{className:"p-4 border-t",children:(0,Ue.jsx)("button",{onClick:R,disabled:k,className:"w-full py-3 bg-purple-600 text-white rounded-xl font-semibold hover:bg-purple-700 disabled:opacity-50 transition-colors",children:k?"Menyimpan...":"Simpan"})})]})}})()},i)})})},ZN=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"jt":Math.abs(e)>=1e3?(e/1e3).toFixed(0)+"rb":new Intl.NumberFormat("id-ID").format(e),JN=e=>new Intl.NumberFormat("id-ID").format(e),QN=e=>{switch(e){case"today":return"Hari Ini";case"week":return"Minggu Ini";case"month":return"Bulan Ini";case"year":return"Tahun Ini";default:return e}},$N=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Intl.NumberFormat("id-ID").format(Math.abs(e));return t&&0!==e?e>=0?"+".concat(n):"(".concat(n,")"):e<0?"(".concat(n,")"):n},e_=e=>{const t=new Intl.NumberFormat("id-ID").format(Math.abs(e));return e<0?"(".concat(t,")"):t},t_="#F97316",n_="#FFF7ED",r_="#3B82F6",a_="#A855F7",o_="#737373",i_="#D4D4D4",s_="#F5F5F5",l_="#FFFFFF",c_="#262626",u_="#22C55E",d_="#EF4444",h_={duration:.3,ease:[.4,0,.2,1]},p_=e=>{let{isOpen:t,onClose:n,isEmbedded:r=!1}=e;const[o,i]=(0,a.useState)("overview"),[s,l]=(0,a.useState)("left"),[c,u]=(0,a.useState)("month"),[d,h]=(0,a.useState)(null),[p,f]=(0,a.useState)(null),[m,g]=(0,a.useState)(null),[x,y]=(0,a.useState)(null),[v,b]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),j=e=>{let{onClick:t,light:n=!1}=e;const[r,o]=(0,a.useState)(!1);return r?(0,Ue.jsx)("button",{onClick:t,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:n?"rgba(255,255,255,0.2)":i_},children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:n?"white":c_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}):(0,Ue.jsx)("button",{onClick:t,className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",style:{backgroundColor:n?"rgba(255,255,255,0.2)":i_},children:(0,Ue.jsx)("img",{src:"/icons/backbutton-v2.png",alt:"Back",className:"w-9 h-9 object-contain",style:{filter:n?"none":"invert(1)"},onError:()=>o(!0)})})},C=e=>{const t=[],n="today"===e?8:"week"===e?7:"month"===e?30:12;for(let r=0;r<n;r++)t.push({date:new Date(Date.now()-24*(n-r-1)*60*60*1e3/("today"===e?8:1)).toISOString(),label:"today"===e?"".concat(8+2*r,":00"):"week"===e?["Sen","Sel","Rab","Kam","Jum","Sab","Min"][r]:"".concat(r+1),penjualan:Math.floor(8e5+7e5*Math.random())/("today"===e?8:1),pembelian:Math.floor(4e5+4e5*Math.random())/("today"===e?8:1),laba_kotor:Math.floor(3e5+3e5*Math.random())/("today"===e?8:1)});return t},N=(0,a.useCallback)(async e=>{b(!0);try{const t=await jw("/api/insight?period=".concat(e));if(!t.ok)throw new Error("Gagal memuat data");const n=await t.json();h(n.data)}catch(J_){const n={period:e,period_label:QN(e),summary:{total_penjualan:"today"===e?15e5:"week"===e?85e5:"month"===e?35e6:42e7,total_pembelian:"today"===e?8e5:"week"===e?45e5:"month"===e?18e6:21e7,total_beban:"today"===e?2e5:"week"===e?1e6:"month"===e?5e6:6e7,laba_kotor:"today"===e?7e5:"week"===e?4e6:"month"===e?17e6:21e7,laba_bersih:"today"===e?5e5:"week"===e?3e6:"month"===e?12e6:15e7,transaksi_count:"today"===e?15:"week"===e?85:"month"===e?350:4200},trends:C(e),top_products:[{id:"1",nama_produk:"Indomie Goreng",qty_terjual:120,total_penjualan:36e4,margin_persen:25},{id:"2",nama_produk:"Aqua 600ml",qty_terjual:95,total_penjualan:285e3,margin_persen:20},{id:"3",nama_produk:"Teh Pucuk 350ml",qty_terjual:80,total_penjualan:24e4,margin_persen:22},{id:"4",nama_produk:"Minyak Goreng 1L",qty_terjual:45,total_penjualan:81e4,margin_persen:15},{id:"5",nama_produk:"Gula Pasir 1kg",qty_terjual:35,total_penjualan:525e3,margin_persen:18}],transaction_breakdown:[{jenis:"penjualan",count:250,total:35e6,percentage:65},{jenis:"pembelian",count:45,total:18e6,percentage:25},{jenis:"beban",count:30,total:5e6,percentage:10}],cash_flow:{kas_masuk:"month"===e?35e6:85e5,kas_keluar:"month"===e?23e6:55e5,net_flow:"month"===e?12e6:3e6,by_category:[{category:"Penjualan Tunai",amount:28e6,type:"masuk"},{category:"Terima Piutang",amount:7e6,type:"masuk"},{category:"Pembelian",amount:18e6,type:"keluar"},{category:"Operasional",amount:5e6,type:"keluar"}]}};h(n)}finally{b(!1)}},[]),_=(0,a.useCallback)(async e=>{k(!0);try{const t=await jw("/api/reports/laba-rugi/".concat(e));if(!t.ok)throw new Error("Gagal memuat laporan");const n=await t.json();y(n)}catch(t){y((e=>{const t={penjualan:85e6,diskon_penjualan:25e5,retur_penjualan:15e5,pendapatan_lainnya:5e5,total_pendapatan_bersih:815e5},n={persediaan_awal:3e7,pembelian:45e6,diskon_pembelian:15e5,retur_pembelian:5e5,ongkos_angkut:5e5,barang_tersedia_dijual:735e5,persediaan_akhir:35e6,total_hpp:385e5},r=t.total_pendapatan_bersih-n.total_hpp,a={beban_gaji:12e6,beban_sewa:5e6,beban_listrik_air:15e5,beban_telepon_internet:5e5,beban_perlengkapan:8e5,beban_penyusutan:15e5,beban_transportasi:2e6,beban_administrasi:5e5,beban_lainnya:7e5,total_beban_operasional:245e5},o=r-a.total_beban_operasional,i={pendapatan_bunga:25e4,pendapatan_lainnya:0,beban_bunga:15e5,beban_pajak:0,total_non_operasional:-125e4},s=o+i.total_non_operasional;return{periode:e,tanggal_awal:"1 Desember 2024",tanggal_akhir:"31 Desember 2024",pendapatan:t,hpp:n,laba_kotor:r,beban_operasional:a,laba_operasi:o,non_operasional:i,laba_sebelum_pajak:s,pajak_penghasilan:0,laba_bersih:s-0}})(QN(c)))}finally{k(!1)}},[c]),S=(0,a.useCallback)(async e=>{k(!0);try{const t=await jw("/api/reports/neraca/".concat(e));if(!t.ok)throw new Error("Gagal memuat laporan");const n=await t.json(),r={periode:n.periode,tanggal:n.tanggal,aset:{aset_lancar:{kas:n.aset_lancar.kas,bank:n.aset_lancar.bank,persediaan:n.aset_lancar.persediaan,piutang_usaha:n.aset_lancar.piutang_usaha,beban_dibayar_dimuka:n.aset_lancar.beban_dibayar_dimuka,uang_muka_pembelian:n.aset_lancar.uang_muka_pembelian,total:n.aset_lancar.total},aset_tetap:{peralatan:n.aset_tetap.peralatan,akum_penyusutan_peralatan:n.aset_tetap.akum_penyusutan_peralatan,kendaraan:n.aset_tetap.kendaraan,akum_penyusutan_kendaraan:n.aset_tetap.akum_penyusutan_kendaraan,bangunan:n.aset_tetap.bangunan,akum_penyusutan_bangunan:n.aset_tetap.akum_penyusutan_bangunan,tanah:n.aset_tetap.tanah,total:n.aset_tetap.total,total_neto:n.aset_tetap.total_neto},total:n.total_aset},kewajiban:{jangka_pendek:{hutang_usaha:n.kewajiban_jangka_pendek.hutang_usaha,hutang_bank_jangka_pendek:n.kewajiban_jangka_pendek.hutang_bank_jangka_pendek,uang_muka_pelanggan:n.kewajiban_jangka_pendek.uang_muka_pelanggan,hutang_pajak:n.kewajiban_jangka_pendek.hutang_pajak,hutang_gaji:n.kewajiban_jangka_pendek.hutang_gaji,total:n.kewajiban_jangka_pendek.total},jangka_panjang:{hutang_bank:n.kewajiban_jangka_panjang.hutang_bank,total:n.kewajiban_jangka_panjang.total},total:n.total_kewajiban},ekuitas:{modal_awal:n.ekuitas.modal_awal,setor_modal:n.ekuitas.setor_modal,prive:n.ekuitas.prive,laba_ditahan:n.ekuitas.laba_ditahan,laba_periode_berjalan:n.ekuitas.laba_periode_berjalan,total:n.ekuitas.total},is_balanced:n.is_balanced};f(r)}catch(t){f((e=>{const t={kas:15e6,bank:25e6,persediaan:35e6,piutang_usaha:85e5,beban_dibayar_dimuka:2e6,uang_muka_pembelian:15e5,total:87e6},n={peralatan:2e7,akum_penyusutan_peralatan:4e6,kendaraan:75e6,akum_penyusutan_kendaraan:15e6,bangunan:0,akum_penyusutan_bangunan:0,tanah:0,total:95e6,total_neto:76e6},r={hutang_usaha:12e6,hutang_bank_jangka_pendek:5e6,uang_muka_pelanggan:25e5,hutang_pajak:15e5,hutang_gaji:3e6,total:24e6},a={hutang_bank:3e7,total:3e7},o={modal_awal:8e7,setor_modal:1e7,prive:5e6,laba_ditahan:12e6,laba_periode_berjalan:12e6,total:109e6},i=t.total+n.total_neto,s=r.total+a.total;return{periode:e,tanggal:(new Date).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),aset:{aset_lancar:t,aset_tetap:n,total:i},kewajiban:{jangka_pendek:r,jangka_panjang:a,total:s},ekuitas:o,is_balanced:Math.abs(i-(s+o.total))<1e3}})(QN(c)))}finally{k(!1)}},[c]),E=(0,a.useCallback)(async e=>{k(!0);try{const t=await jw("/api/reports/arus-kas/".concat(e));if(!t.ok)throw new Error("Gagal memuat laporan");const n=await t.json(),r={periode:n.periode,tanggal_awal:n.tanggal_awal,tanggal_akhir:n.tanggal_akhir,operasi:{penerimaan_penjualan:n.operasi.penerimaan_penjualan,penerimaan_piutang:n.operasi.penerimaan_piutang,penerimaan_lainnya:n.operasi.penerimaan_lainnya,total_penerimaan:n.operasi.total_penerimaan,pembayaran_kulakan:n.operasi.pembayaran_kulakan,pembayaran_beban_operasi:n.operasi.pembayaran_beban_operasi,pembayaran_gaji:n.operasi.pembayaran_gaji,pembayaran_pajak:n.operasi.pembayaran_pajak,pembayaran_lainnya:n.operasi.pembayaran_lainnya,total_pengeluaran:n.operasi.total_pengeluaran,net_arus_kas_operasi:n.operasi.net_arus_kas_operasi},investasi:{penjualan_aset_tetap:n.investasi.penjualan_aset_tetap,penerimaan_investasi:n.investasi.penerimaan_investasi,total_penerimaan:n.investasi.total_penerimaan,pembelian_aset_tetap:n.investasi.pembelian_aset_tetap,pengeluaran_investasi:n.investasi.pengeluaran_investasi,total_pengeluaran:n.investasi.total_pengeluaran,net_arus_kas_investasi:n.investasi.net_arus_kas_investasi},pendanaan:{setor_modal:n.pendanaan.setor_modal,penerimaan_pinjaman:n.pendanaan.penerimaan_pinjaman,total_penerimaan:n.pendanaan.total_penerimaan,prive:n.pendanaan.prive,pembayaran_pinjaman:n.pendanaan.pembayaran_pinjaman,pembayaran_bunga:n.pendanaan.pembayaran_bunga,total_pengeluaran:n.pendanaan.total_pengeluaran,net_arus_kas_pendanaan:n.pendanaan.net_arus_kas_pendanaan},kenaikan_bersih_kas:n.kenaikan_bersih_kas,kas_awal_periode:n.kas_awal_periode,kas_akhir_periode:n.kas_akhir_periode};g(r)}catch(t){g((e=>{const t={penerimaan_penjualan:85e6,penerimaan_piutang:12e6,penerimaan_lainnya:5e5,total_penerimaan:975e5,pembayaran_kulakan:45e6,pembayaran_beban_operasi:15e6,pembayaran_gaji:8e6,pembayaran_pajak:25e5,pembayaran_lainnya:1e6,total_pengeluaran:715e5,net_arus_kas_operasi:26e6},n={penjualan_aset_tetap:0,penerimaan_investasi:0,total_penerimaan:0,pembelian_aset_tetap:5e6,pengeluaran_investasi:0,total_pengeluaran:5e6,net_arus_kas_investasi:-5e6},r={setor_modal:0,penerimaan_pinjaman:0,total_penerimaan:0,prive:5e6,pembayaran_pinjaman:3e6,pembayaran_bunga:15e5,total_pengeluaran:95e5,net_arus_kas_pendanaan:-95e5},a=t.net_arus_kas_operasi+n.net_arus_kas_investasi+r.net_arus_kas_pendanaan;return{periode:e,tanggal_awal:"1 Desember 2024",tanggal_akhir:"31 Desember 2024",operasi:t,investasi:n,pendanaan:r,kenaikan_bersih_kas:a,kas_awal_periode:285e5,kas_akhir_periode:285e5+a}})(QN(c)))}finally{k(!1)}},[c]),A=e=>{const t=new Date;return"year"===e?"".concat(t.getFullYear()):"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"))};(0,a.useEffect)(()=>{t&&N(c)},[t,c,N]);const I=e=>{l("left"),i(e)},T=()=>{l("right"),i("overview")},P=r?"h-full bg-gray-50 flex flex-col":"fixed inset-0 z-50 bg-gray-50 flex flex-col";if(!t)return null;const D=(e,t)=>{const n=Math.max(...e.map(e=>e[t]));return(0,Ue.jsx)("div",{className:"flex items-end gap-1 h-32",children:e.slice(-7).map((e,r)=>(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,Ue.jsx)("div",{className:"w-full rounded-t",style:{height:"".concat(e[t]/n*100,"%"),minHeight:"4px",backgroundColor:"penjualan"===t?t_:u_}}),(0,Ue.jsx)("span",{className:"text-xs mt-1",style:{color:o_},children:e.label})]},r))})},M=()=>(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,Ue.jsxs)("div",{style:{backgroundColor:t_},className:"text-white px-4 py-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[r&&(0,Ue.jsx)(j,{onClick:n,light:!0}),(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:"Insight Bisnis"})]}),!r&&(0,Ue.jsx)("button",{onClick:n,className:"p-1 hover:bg-white/20 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsx)("div",{className:"mt-4 flex gap-2 overflow-x-auto pb-2",children:["today","week","month","year"].map(e=>(0,Ue.jsx)("button",{onClick:()=>u(e),className:"px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition-colors",style:{backgroundColor:c===e?l_:"rgba(255,255,255,0.2)",color:c===e?t_:l_},children:QN(e)},e))})]}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:v?(0,Ue.jsx)("div",{className:"text-center py-8",style:{color:o_},children:"Memuat data..."}):d?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:o_},children:"Penjualan"}),(0,Ue.jsxs)("div",{className:"text-xl font-bold",style:{color:c_},children:["Rp ",ZN(d.summary.total_penjualan)]}),(0,Ue.jsx)("div",{className:"text-xs mt-1",style:{color:u_},children:"+12% dari periode lalu"})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:o_},children:"Laba Bersih"}),(0,Ue.jsxs)("div",{className:"text-xl font-bold",style:{color:u_},children:["Rp ",ZN(d.summary.laba_bersih)]}),(0,Ue.jsx)("div",{className:"text-xs mt-1",style:{color:u_},children:"+8% dari periode lalu"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,Ue.jsxs)("div",{className:"rounded-xl p-3 text-center",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"text-2xl font-bold",style:{color:c_},children:d.summary.transaksi_count}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:o_},children:"Transaksi"})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-3 text-center",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"text-lg font-bold",style:{color:d_},children:["-Rp ",ZN(d.summary.total_pembelian)]}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:o_},children:"Pembelian"})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-3 text-center",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"text-lg font-bold",style:{color:t_},children:["-Rp ",ZN(d.summary.total_beban)]}),(0,Ue.jsx)("div",{className:"text-xs",style:{color:o_},children:"Beban"})]})]}),(0,Ue.jsxs)("button",{onClick:()=>I("sales"),className:"w-full rounded-xl p-4 text-left hover:shadow-md transition-shadow",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Ue.jsx)("h3",{className:"font-semibold",style:{color:c_},children:"Tren Penjualan"}),(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:o_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),d.trends.length>0&&D(d.trends,"penjualan")]}),(0,Ue.jsxs)("button",{onClick:()=>I("products"),className:"w-full rounded-xl p-4 text-left hover:shadow-md transition-shadow",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Ue.jsx)("h3",{className:"font-semibold",style:{color:c_},children:"Produk Terlaris"}),(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:o_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),(0,Ue.jsx)("div",{className:"space-y-2",children:d.top_products.slice(0,3).map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsx)("span",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",style:{backgroundColor:0===t?n_:s_,color:0===t?t_:o_},children:t+1}),(0,Ue.jsx)("span",{className:"text-sm",style:{color:c_},children:e.nama_produk})]}),(0,Ue.jsxs)("span",{className:"text-sm font-medium",children:[e.qty_terjual," terjual"]})]},e.id))})]}),(0,Ue.jsxs)("button",{onClick:()=>I("cashflow"),className:"w-full rounded-xl p-4 text-left hover:shadow-md transition-shadow",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Ue.jsx)("h3",{className:"font-semibold",style:{color:c_},children:"Arus Kas"}),(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:o_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:o_},children:"Masuk"}),(0,Ue.jsxs)("div",{className:"text-sm font-bold",style:{color:u_},children:["+",ZN(d.cash_flow.kas_masuk)]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:o_},children:"Keluar"}),(0,Ue.jsxs)("div",{className:"text-sm font-bold",style:{color:d_},children:["-",ZN(d.cash_flow.kas_keluar)]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-xs",style:{color:o_},children:"Net"}),(0,Ue.jsxs)("div",{className:"text-sm font-bold",style:{color:d.cash_flow.net_flow>=0?u_:d_},children:[d.cash_flow.net_flow>=0?"+":"",ZN(d.cash_flow.net_flow)]})]})]})]}),(0,Ue.jsxs)("div",{className:"pt-4",children:[(0,Ue.jsx)("h3",{className:"text-sm font-semibold uppercase tracking-wide mb-3",style:{color:o_},children:"Laporan Keuangan SAK EMKM"}),(0,Ue.jsx)("button",{onClick:async()=>{await _(A(c)),I("labarugi")},disabled:w,className:"w-full rounded-xl p-4 mb-3 text-left hover:shadow-md transition-shadow disabled:opacity-50",style:{backgroundColor:n_,border:"1px solid ".concat(t_,"20")},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:t_+"20"},children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:t_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-semibold",style:{color:c_},children:"Laporan Laba Rugi"}),(0,Ue.jsx)("p",{className:"text-sm",style:{color:o_},children:"Income Statement (4xxx-7xxx)"})]})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:o_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),(0,Ue.jsx)("button",{onClick:async()=>{await S(A(c)),I("neraca")},disabled:w,className:"w-full rounded-xl p-4 mb-3 text-left hover:shadow-md transition-shadow disabled:opacity-50",style:{backgroundColor:r_+"10",border:"1px solid ".concat(r_,"20")},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:r_+"20"},children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:r_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-semibold",style:{color:c_},children:"Laporan Posisi Keuangan"}),(0,Ue.jsx)("p",{className:"text-sm",style:{color:o_},children:"Balance Sheet (1xxx-3xxx)"})]})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:o_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),(0,Ue.jsx)("button",{onClick:async()=>{await E(A(c)),I("aruskas")},disabled:w,className:"w-full rounded-xl p-4 text-left hover:shadow-md transition-shadow disabled:opacity-50",style:{backgroundColor:u_+"10",border:"1px solid ".concat(u_,"20")},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:u_+"20"},children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:u_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-semibold",style:{color:c_},children:"Laporan Arus Kas"}),(0,Ue.jsx)("p",{className:"text-sm",style:{color:o_},children:"Cash Flow (1101, 1102)"})]})]}),(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:o_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]}):(0,Ue.jsx)("div",{className:"text-center py-8",style:{color:o_},children:"Tidak ada data"})})]});return(0,Ue.jsx)("div",{className:P,children:(0,Ue.jsx)(mt,{mode:"wait",custom:s,children:(0,Ue.jsx)(yc.div,{custom:s,variants:{enter:e=>({x:"left"===e?"100%":"-100%"}),center:{x:0},exit:e=>({x:"left"===e?"-100%":"100%"})},initial:"enter",animate:"center",exit:"exit",transition:h_,className:"flex-1 flex flex-col overflow-hidden",children:(()=>{switch(o){case"overview":default:return M();case"sales":return(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 py-4 border-b",style:{backgroundColor:l_},children:[(0,Ue.jsx)(j,{onClick:T}),(0,Ue.jsx)("h1",{className:"text-xl font-bold",style:{color:c_},children:"Detail Penjualan"})]}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:d&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsxs)("div",{className:"text-sm mb-1",style:{color:o_},children:["Total Penjualan (",QN(c),")"]}),(0,Ue.jsxs)("div",{className:"text-3xl font-bold",style:{color:c_},children:["Rp ",JN(d.summary.total_penjualan)]}),(0,Ue.jsx)("div",{className:"text-sm mt-1",style:{color:u_},children:"+12.5% dari periode sebelumnya"})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("h3",{className:"font-semibold mb-4",style:{color:c_},children:"Grafik Penjualan"}),D(d.trends,"penjualan")]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("h3",{className:"font-semibold mb-3",style:{color:c_},children:"Breakdown"}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{style:{color:o_},children:"Penjualan Tunai"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",JN(.8*d.summary.total_penjualan)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{style:{color:o_},children:"Penjualan Kredit"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",JN(.2*d.summary.total_penjualan)]})]}),(0,Ue.jsxs)("div",{className:"border-t pt-2 flex justify-between",children:[(0,Ue.jsx)("span",{style:{color:o_},children:"Jumlah Transaksi"}),(0,Ue.jsx)("span",{className:"font-medium",children:d.summary.transaksi_count})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{style:{color:o_},children:"Rata-rata per Transaksi"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",JN(Math.floor(d.summary.total_penjualan/d.summary.transaksi_count))]})]})]})]})]})})]});case"products":return(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 py-4 border-b",style:{backgroundColor:l_},children:[(0,Ue.jsx)(j,{onClick:T}),(0,Ue.jsx)("h1",{className:"text-xl font-bold",style:{color:c_},children:"Produk Terlaris"})]}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto",children:d&&(0,Ue.jsx)("div",{className:"divide-y",children:d.top_products.map((e,t)=>(0,Ue.jsxs)("div",{className:"px-4 py-4 flex items-center gap-4",style:{backgroundColor:l_},children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold",style:{backgroundColor:0===t?n_:s_,color:0===t?t_:o_},children:t+1}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("div",{className:"font-semibold",style:{color:c_},children:e.nama_produk}),(0,Ue.jsxs)("div",{className:"text-sm",style:{color:o_},children:[e.qty_terjual," terjual"]})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsxs)("div",{className:"font-bold",style:{color:c_},children:["Rp ",ZN(e.total_penjualan)]}),e.margin_persen&&(0,Ue.jsxs)("div",{className:"text-xs",style:{color:u_},children:["Margin ",e.margin_persen,"%"]})]})]},e.id))})})]});case"cashflow":return(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3 px-4 py-4 border-b",style:{backgroundColor:l_},children:[(0,Ue.jsx)(j,{onClick:T}),(0,Ue.jsx)("h1",{className:"text-xl font-bold",style:{color:c_},children:"Arus Kas"})]}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:d&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:u_+"10"},children:[(0,Ue.jsx)("div",{className:"text-xs mb-1",style:{color:u_},children:"Kas Masuk"}),(0,Ue.jsxs)("div",{className:"text-lg font-bold",style:{color:u_},children:["+Rp ",ZN(d.cash_flow.kas_masuk)]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:d_+"10"},children:[(0,Ue.jsx)("div",{className:"text-xs mb-1",style:{color:d_},children:"Kas Keluar"}),(0,Ue.jsxs)("div",{className:"text-lg font-bold",style:{color:d_},children:["-Rp ",ZN(d.cash_flow.kas_keluar)]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:d.cash_flow.net_flow>=0?u_+"10":d_+"10"},children:[(0,Ue.jsx)("div",{className:"text-xs mb-1",style:{color:d.cash_flow.net_flow>=0?u_:d_},children:"Net Flow"}),(0,Ue.jsxs)("div",{className:"text-lg font-bold",style:{color:d.cash_flow.net_flow>=0?u_:d_},children:[d.cash_flow.net_flow>=0?"+":"","Rp ",ZN(d.cash_flow.net_flow)]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:u_+"10"},children:(0,Ue.jsx)("h3",{className:"font-semibold",style:{color:u_},children:"Kas Masuk"})}),(0,Ue.jsx)("div",{className:"divide-y",children:d.cash_flow.by_category.filter(e=>"masuk"===e.type).map((e,t)=>(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between items-center",children:[(0,Ue.jsx)("span",{style:{color:o_},children:e.category}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["+Rp ",ZN(e.amount)]})]},t))})]}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:d_+"10"},children:(0,Ue.jsx)("h3",{className:"font-semibold",style:{color:d_},children:"Kas Keluar"})}),(0,Ue.jsx)("div",{className:"divide-y",children:d.cash_flow.by_category.filter(e=>"keluar"===e.type).map((e,t)=>(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between items-center",children:[(0,Ue.jsx)("span",{style:{color:o_},children:e.category}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["-Rp ",ZN(e.amount)]})]},t))})]})]})})]});case"labarugi":return(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,Ue.jsx)("div",{style:{backgroundColor:t_},className:"text-white px-4 py-4",children:(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)(j,{onClick:T,light:!0}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:"Laporan Laba Rugi"}),(0,Ue.jsxs)("p",{className:"text-sm opacity-80",children:[null===x||void 0===x?void 0:x.tanggal_awal," - ",null===x||void 0===x?void 0:x.tanggal_akhir]})]})]})}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:x&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:u_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:u_},children:"PENDAPATAN (4xxx)"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Penjualan (4101)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.pendapatan.penjualan)]})]}),x.pendapatan.diskon_penjualan>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Diskon Penjualan (4102)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(x.pendapatan.diskon_penjualan),")"]})]}),x.pendapatan.retur_penjualan>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Retur Penjualan (4103)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(x.pendapatan.retur_penjualan),")"]})]}),x.pendapatan.pendapatan_lainnya>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pendapatan Lainnya (4104)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.pendapatan.pendapatan_lainnya)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:u_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Pendapatan Bersih"}),(0,Ue.jsxs)("span",{className:"font-bold",children:["Rp ",$N(x.pendapatan.total_pendapatan_bersih)]})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:d_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:d_},children:"HARGA POKOK PENJUALAN (5xxx)"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Persediaan Awal"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.hpp.persediaan_awal)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pembelian (5101)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.hpp.pembelian)]})]}),x.hpp.diskon_pembelian>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Diskon Pembelian (5102)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["(",$N(x.hpp.diskon_pembelian),")"]})]}),x.hpp.retur_pembelian>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Retur Pembelian (5103)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["(",$N(x.hpp.retur_pembelian),")"]})]}),x.hpp.ongkos_angkut>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Ongkos Angkut (5104)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.hpp.ongkos_angkut)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:s_},children:[(0,Ue.jsx)("span",{className:"pl-4 font-medium",style:{color:c_},children:"Barang Tersedia Dijual"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.hpp.barang_tersedia_dijual)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Persediaan Akhir"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["(",$N(x.hpp.persediaan_akhir),")"]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:d_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total HPP"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:d_},children:["(",$N(x.hpp.total_hpp),")"]})]})]})]}),(0,Ue.jsx)("div",{className:"rounded-xl p-4",style:{backgroundColor:u_+"20",border:"1px solid ".concat(u_,"40")},children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsx)("span",{className:"font-bold text-lg",style:{color:c_},children:"LABA KOTOR"}),(0,Ue.jsxs)("span",{className:"font-bold text-xl",style:{color:u_},children:["Rp ",$N(x.laba_kotor)]})]})}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:t_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:t_},children:"BEBAN OPERASIONAL (6xxx)"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[x.beban_operasional.beban_gaji>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Gaji (6101)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_gaji)]})]}),x.beban_operasional.beban_sewa>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Sewa (6102)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_sewa)]})]}),x.beban_operasional.beban_listrik_air>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Listrik & Air (6103)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_listrik_air)]})]}),x.beban_operasional.beban_telepon_internet>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Telepon & Internet (6104)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_telepon_internet)]})]}),x.beban_operasional.beban_perlengkapan>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Perlengkapan (6105)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_perlengkapan)]})]}),x.beban_operasional.beban_penyusutan>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Penyusutan (6106)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_penyusutan)]})]}),x.beban_operasional.beban_transportasi>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Transportasi (6107)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_transportasi)]})]}),x.beban_operasional.beban_administrasi>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Administrasi (6108)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_administrasi)]})]}),x.beban_operasional.beban_lainnya>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Lainnya (6109)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(x.beban_operasional.beban_lainnya)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:t_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total Beban Operasional"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:t_},children:["(",$N(x.beban_operasional.total_beban_operasional),")"]})]})]})]}),(0,Ue.jsx)("div",{className:"rounded-xl p-4",style:{backgroundColor:r_+"10",border:"1px solid ".concat(r_,"40")},children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsx)("span",{className:"font-bold",style:{color:c_},children:"LABA OPERASI"}),(0,Ue.jsxs)("span",{className:"font-bold text-lg",style:{color:r_},children:["Rp ",$N(x.laba_operasi)]})]})}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:a_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:a_},children:"PENDAPATAN & BEBAN LAIN (7xxx)"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[x.non_operasional.pendapatan_bunga>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pendapatan Bunga (7101)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["Rp ",$N(x.non_operasional.pendapatan_bunga)]})]}),x.non_operasional.pendapatan_lainnya>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pendapatan Lainnya (7102)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["Rp ",$N(x.non_operasional.pendapatan_lainnya)]})]}),x.non_operasional.beban_bunga>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Bunga (7201)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(x.non_operasional.beban_bunga),")"]})]}),x.non_operasional.beban_pajak>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Pajak (7202)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(x.non_operasional.beban_pajak),")"]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:a_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total Non-Operasional"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:x.non_operasional.total_non_operasional>=0?u_:d_},children:["Rp ",e_(x.non_operasional.total_non_operasional)]})]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:x.laba_bersih>=0?u_:d_},children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsx)("span",{className:"font-bold text-lg text-white",children:"LABA BERSIH"}),(0,Ue.jsxs)("span",{className:"font-bold text-2xl text-white",children:["Rp ",$N(x.laba_bersih)]})]}),(0,Ue.jsxs)("div",{className:"text-sm text-white/80 mt-1",children:["Margin: ",(x.laba_bersih/x.pendapatan.total_pendapatan_bersih*100).toFixed(1),"%"]})]})]})})]});case"neraca":return(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,Ue.jsx)("div",{style:{backgroundColor:r_},className:"text-white px-4 py-4",children:(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)(j,{onClick:T,light:!0}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:"Laporan Posisi Keuangan"}),(0,Ue.jsxs)("p",{className:"text-sm opacity-80",children:["Per ",(null===p||void 0===p?void 0:p.tanggal)||"-"]})]})]})}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:p&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:r_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:r_},children:"ASET (1xxx)"})}),(0,Ue.jsxs)("div",{className:"border-b",children:[(0,Ue.jsx)("div",{className:"px-4 py-2",style:{backgroundColor:s_},children:(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Aset Lancar"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Kas (1101)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.aset.aset_lancar.kas)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Bank (1102)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.aset.aset_lancar.bank)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Persediaan (1103)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.aset.aset_lancar.persediaan)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Piutang Usaha (1104)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.aset.aset_lancar.piutang_usaha)]})]}),p.aset.aset_lancar.beban_dibayar_dimuka>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Dibayar di Muka (1105)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.aset.aset_lancar.beban_dibayar_dimuka)]})]}),p.aset.aset_lancar.uang_muka_pembelian>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Uang Muka Pembelian (1106)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.aset.aset_lancar.uang_muka_pembelian)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:r_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total Aset Lancar"}),(0,Ue.jsxs)("span",{className:"font-bold",children:["Rp ",$N(p.aset.aset_lancar.total)]})]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"px-4 py-2",style:{backgroundColor:s_},children:(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Aset Tetap"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[p.aset.aset_tetap.peralatan>0&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Peralatan (1201)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.aset.aset_tetap.peralatan)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-8 text-sm",style:{color:o_},children:"Akum. Penyusutan"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(p.aset.aset_tetap.akum_penyusutan_peralatan),")"]})]})]}),p.aset.aset_tetap.kendaraan>0&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Kendaraan (1202)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.aset.aset_tetap.kendaraan)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-8 text-sm",style:{color:o_},children:"Akum. Penyusutan"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(p.aset.aset_tetap.akum_penyusutan_kendaraan),")"]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:r_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total Aset Tetap (Neto)"}),(0,Ue.jsxs)("span",{className:"font-bold",children:["Rp ",$N(p.aset.aset_tetap.total_neto)]})]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between",style:{backgroundColor:r_+"20"},children:[(0,Ue.jsx)("span",{className:"font-bold",style:{color:r_},children:"TOTAL ASET"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:r_},children:["Rp ",$N(p.aset.total)]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:d_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:d_},children:"KEWAJIBAN (2xxx)"})}),(0,Ue.jsxs)("div",{className:"border-b",children:[(0,Ue.jsx)("div",{className:"px-4 py-2",style:{backgroundColor:s_},children:(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Kewajiban Jangka Pendek"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Hutang Usaha (2101)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.kewajiban.jangka_pendek.hutang_usaha)]})]}),p.kewajiban.jangka_pendek.hutang_bank_jangka_pendek>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Hutang Bank JK Pendek (2102)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.kewajiban.jangka_pendek.hutang_bank_jangka_pendek)]})]}),p.kewajiban.jangka_pendek.uang_muka_pelanggan>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Uang Muka Pelanggan (2103)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.kewajiban.jangka_pendek.uang_muka_pelanggan)]})]}),p.kewajiban.jangka_pendek.hutang_pajak>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Hutang Pajak (2104)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.kewajiban.jangka_pendek.hutang_pajak)]})]}),p.kewajiban.jangka_pendek.hutang_gaji>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Hutang Gaji (2105)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.kewajiban.jangka_pendek.hutang_gaji)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:d_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total Kewajiban JK Pendek"}),(0,Ue.jsxs)("span",{className:"font-bold",children:["Rp ",$N(p.kewajiban.jangka_pendek.total)]})]})]})]}),p.kewajiban.jangka_panjang.total>0&&(0,Ue.jsxs)("div",{className:"border-b",children:[(0,Ue.jsx)("div",{className:"px-4 py-2",style:{backgroundColor:s_},children:(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Kewajiban Jangka Panjang"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Hutang Bank (2201)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.kewajiban.jangka_panjang.hutang_bank)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:d_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total Kewajiban JK Panjang"}),(0,Ue.jsxs)("span",{className:"font-bold",children:["Rp ",$N(p.kewajiban.jangka_panjang.total)]})]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between",style:{backgroundColor:d_+"20"},children:[(0,Ue.jsx)("span",{className:"font-bold",style:{color:d_},children:"TOTAL KEWAJIBAN"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:d_},children:["Rp ",$N(p.kewajiban.total)]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:a_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:a_},children:"EKUITAS (3xxx)"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Modal Awal (3101)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.ekuitas.modal_awal)]})]}),p.ekuitas.setor_modal>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Setor Modal (3102)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.ekuitas.setor_modal)]})]}),p.ekuitas.prive>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Prive (3103)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(p.ekuitas.prive),")"]})]}),p.ekuitas.laba_ditahan>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Laba Ditahan (3104)"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(p.ekuitas.laba_ditahan)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Laba Periode Berjalan (3105)"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:p.ekuitas.laba_periode_berjalan>=0?u_:d_},children:["Rp ",$N(p.ekuitas.laba_periode_berjalan)]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between",style:{backgroundColor:a_+"20"},children:[(0,Ue.jsx)("span",{className:"font-bold",style:{color:a_},children:"TOTAL EKUITAS"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:a_},children:["Rp ",$N(p.ekuitas.total)]})]})]}),(0,Ue.jsx)("div",{className:"rounded-xl p-4",style:{backgroundColor:p.is_balanced?u_+"10":d_+"10",border:"1px solid ".concat(p.is_balanced?u_:d_,"40")},children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[p.is_balanced?(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:u_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:d_,viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Ue.jsx)("span",{className:"font-semibold",style:{color:p.is_balanced?u_:d_},children:p.is_balanced?"Balance OK":"Tidak Balance"})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("div",{className:"text-sm",style:{color:o_},children:"Kewajiban + Ekuitas"}),(0,Ue.jsxs)("div",{className:"font-bold",children:["Rp ",$N(p.kewajiban.total+p.ekuitas.total)]})]})]})})]})})]});case"aruskas":return(0,Ue.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,Ue.jsx)("div",{style:{backgroundColor:u_},className:"text-white px-4 py-4",children:(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)(j,{onClick:T,light:!0}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:"Laporan Arus Kas"}),(0,Ue.jsxs)("p",{className:"text-sm opacity-80",children:[null===m||void 0===m?void 0:m.tanggal_awal," - ",null===m||void 0===m?void 0:m.tanggal_akhir]})]})]})}),(0,Ue.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 space-y-4",children:m&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:r_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:r_},children:"ARUS KAS AKTIVITAS OPERASI"})}),(0,Ue.jsxs)("div",{className:"border-b",children:[(0,Ue.jsx)("div",{className:"px-4 py-2",style:{backgroundColor:s_},children:(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Penerimaan Kas"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Penerimaan dari Penjualan"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["Rp ",$N(m.operasi.penerimaan_penjualan)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Penerimaan Piutang"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["Rp ",$N(m.operasi.penerimaan_piutang)]})]}),m.operasi.penerimaan_lainnya>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Penerimaan Lainnya"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["Rp ",$N(m.operasi.penerimaan_lainnya)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:u_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total Penerimaan"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:u_},children:["Rp ",$N(m.operasi.total_penerimaan)]})]})]})]}),(0,Ue.jsxs)("div",{className:"border-b",children:[(0,Ue.jsx)("div",{className:"px-4 py-2",style:{backgroundColor:s_},children:(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Pengeluaran Kas"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pembayaran ke Supplier"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(m.operasi.pembayaran_kulakan),")"]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Beban Operasional"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(m.operasi.pembayaran_beban_operasi),")"]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pembayaran Gaji"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(m.operasi.pembayaran_gaji),")"]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pembayaran Pajak"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(m.operasi.pembayaran_pajak),")"]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",style:{backgroundColor:d_+"10"},children:[(0,Ue.jsx)("span",{className:"font-semibold",style:{color:c_},children:"Total Pengeluaran"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:d_},children:["(",$N(m.operasi.total_pengeluaran),")"]})]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between",style:{backgroundColor:m.operasi.net_arus_kas_operasi>=0?r_+"20":t_+"20"},children:[(0,Ue.jsx)("span",{className:"font-bold",style:{color:c_},children:"Arus Kas Bersih - Operasi"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:m.operasi.net_arus_kas_operasi>=0?r_:t_},children:["Rp ",e_(m.operasi.net_arus_kas_operasi)]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:a_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:a_},children:"ARUS KAS AKTIVITAS INVESTASI"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[m.investasi.penjualan_aset_tetap>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Penjualan Aset Tetap"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["Rp ",$N(m.investasi.penjualan_aset_tetap)]})]}),m.investasi.pembelian_aset_tetap>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pembelian Aset Tetap"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(m.investasi.pembelian_aset_tetap),")"]})]}),0===m.investasi.total_penerimaan&&0===m.investasi.total_pengeluaran&&(0,Ue.jsx)("div",{className:"px-4 py-3 text-center",style:{color:o_},children:"Tidak ada aktivitas investasi"})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between",style:{backgroundColor:a_+"20"},children:[(0,Ue.jsx)("span",{className:"font-bold",style:{color:c_},children:"Arus Kas Bersih - Investasi"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:m.investasi.net_arus_kas_investasi>=0?u_:d_},children:["Rp ",e_(m.investasi.net_arus_kas_investasi)]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:t_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:t_},children:"ARUS KAS AKTIVITAS PENDANAAN"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[m.pendanaan.setor_modal>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Setoran Modal"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["Rp ",$N(m.pendanaan.setor_modal)]})]}),m.pendanaan.penerimaan_pinjaman>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Penerimaan Pinjaman"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:u_},children:["Rp ",$N(m.pendanaan.penerimaan_pinjaman)]})]}),m.pendanaan.prive>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Prive / Penarikan"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(m.pendanaan.prive),")"]})]}),m.pendanaan.pembayaran_pinjaman>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pembayaran Pinjaman"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(m.pendanaan.pembayaran_pinjaman),")"]})]}),m.pendanaan.pembayaran_bunga>0&&(0,Ue.jsxs)("div",{className:"px-4 py-2 flex justify-between",children:[(0,Ue.jsx)("span",{className:"pl-4",style:{color:o_},children:"Pembayaran Bunga"}),(0,Ue.jsxs)("span",{className:"font-medium",style:{color:d_},children:["(",$N(m.pendanaan.pembayaran_bunga),")"]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between",style:{backgroundColor:t_+"20"},children:[(0,Ue.jsx)("span",{className:"font-bold",style:{color:c_},children:"Arus Kas Bersih - Pendanaan"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:m.pendanaan.net_arus_kas_pendanaan>=0?u_:d_},children:["Rp ",e_(m.pendanaan.net_arus_kas_pendanaan)]})]})]}),(0,Ue.jsxs)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:l_,boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 border-b",style:{backgroundColor:u_+"10"},children:(0,Ue.jsx)("h3",{className:"font-bold",style:{color:u_},children:"RINGKASAN"})}),(0,Ue.jsxs)("div",{className:"divide-y",children:[(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between",children:[(0,Ue.jsx)("span",{style:{color:o_},children:"Kenaikan (Penurunan) Bersih Kas"}),(0,Ue.jsxs)("span",{className:"font-bold",style:{color:m.kenaikan_bersih_kas>=0?u_:d_},children:["Rp ",e_(m.kenaikan_bersih_kas)]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-3 flex justify-between",children:[(0,Ue.jsx)("span",{style:{color:o_},children:"Kas Awal Periode"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["Rp ",$N(m.kas_awal_periode)]})]})]}),(0,Ue.jsxs)("div",{className:"px-4 py-4 flex justify-between",style:{backgroundColor:u_},children:[(0,Ue.jsx)("span",{className:"font-bold text-white",children:"KAS AKHIR PERIODE"}),(0,Ue.jsxs)("span",{className:"font-bold text-white text-lg",children:["Rp ",$N(m.kas_akhir_periode)]})]})]})]})})]})}})()},o)})})},f_={duration:.3,ease:[.4,0,.2,1]},m_=()=>(0,Ue.jsxs)("div",{className:"flex gap-1",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms",animationDuration:"1.4s"}}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"200ms",animationDuration:"1.4s"}}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"400ms",animationDuration:"1.4s"}})]}),g_=e=>{let{activeTenant:t,onBack:n,isMobile:r=!1,onPanelToggle:o,activePanel:i="none",externalTransactionMessage:s,onPOSPrefillData:l}=e;const c=ee(),u=Q(),d=Ab(),[h,p]=(0,a.useState)(""),[f,m]=(0,a.useState)([]),[g,x]=(0,a.useState)(!1),[y,v]=(0,a.useState)(!1),[b,w]=(0,a.useState)(!1),[k,j]=(0,a.useState)(!1),[C,N]=(0,a.useState)(!1),[_,S]=(0,a.useState)(!1),[E,A]=(0,a.useState)(""),[I,T]=(0,a.useState)(""),[P,D]=(0,a.useState)(null),[M,R]=(0,a.useState)(!1),[F,O]=(0,a.useState)(!1),[B,L]=(0,a.useState)(!1),[z,W]=(0,a.useState)(!1),[V,U]=(0,a.useState)(!1),[H,G]=(0,a.useState)(!1),[K,X]=(0,a.useState)(!1),[Y,q]=(0,a.useState)(!1),[Z,J]=(0,a.useState)(null);(0,a.useEffect)(()=>{const e=new URLSearchParams(u.search);if("openPurchaseForm"===e.get("action")){const t=u.state;console.log("[ChatPanel] openPurchaseForm action, state:",t),"purchase"===(null===t||void 0===t?void 0:t.action)&&null!==t&&void 0!==t&&t.productData&&(console.log("[ChatPanel] Setting scannedProductData:",t.productData),D(t.productData)),d&&o?o("purchase"):j(!0),e.delete("action");const n=e.toString();c(u.pathname+(n?"?"+n:""),{replace:!0,state:{}})}},[u.search,u.pathname,c,u.state]);const[$,te]=(0,a.useState)(!1),[ne,re]=(0,a.useState)(!1),[ae,oe]=(0,a.useState)(!1),[ie,se]=(0,a.useState)(!1),[le,ce]=(0,a.useState)(""),[ue,de]=(0,a.useState)(""),[he,pe]=(0,a.useState)(""),fe=(0,a.useRef)(""),me=(0,a.useRef)(null),ge=(0,a.useRef)(null),xe=(0,a.useRef)(null),{handleTouchStart:ye,handleTouchMove:ve,handleTouchEnd:be}=ru({onSwipe:()=>q(!0),enabled:r&&!d,edgeThreshold:30,swipeThreshold:50});(0,a.useEffect)(()=>{const e=e=>{const t=e.target;if(console.log("[ChatPanel] Click detected on:",t.tagName,t.className),t.classList.contains("barcode-register-btn")){e.preventDefault(),e.stopPropagation();const n=t.getAttribute("data-product-id"),r=t.getAttribute("data-product-name");console.log("[ChatPanel] Barcode button clicked! ProductId:",n,"ProductName:",r),n&&r&&""!==n.trim()&&"None"!==n&&""!==r.trim()?(console.log("[ChatPanel] Opening barcode modal..."),A(n),T(r),S(!0)):(console.error("[ChatPanel] Missing or invalid productId/productName:",{productId:n,productName:r}),alert("\u26a0\ufe0f Product ID tidak tersedia.\n\nFitur registrasi barcode hanya tersedia untuk produk yang sudah terdaftar di sistem.\n\nSaran: Produk ini kemungkinan baru pertama kali dibeli. Lakukan pembelian lagi untuk produk yang sama, maka barcode bisa didaftarkan."))}},t=ge.current;return t?(console.log("[ChatPanel] Adding barcode click listener to container"),t.addEventListener("click",e)):console.warn("[ChatPanel] Messages container ref not available"),()=>{t&&(console.log("[ChatPanel] Removing barcode click listener"),t.removeEventListener("click",e))}},[]);const we=["pembelian","kulak","beli","belanja"],ke=["karton","dus","box","slop","bal","koli","pack","lusin"],je=["pcs","unit","buah","biji","butir","lembar","batang","bungkus","sachet","botol"],Ce=e=>{var t;const n="".concat(h.trim()," ").concat(e," harga ");p(n),pe(e),oe(!1),fe.current=n,null===(t=xe.current)||void 0===t||t.focus()},Ne=e=>{console.log("[ChatPanel] Transaction completed, adding to chat:",e);const t={id:"tx-".concat(Date.now()),sender:"assistant",content:e,timestamp:(new Date).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",hour12:!1})};m(e=>[...e,t]),setTimeout(()=>{Ee()},100)};(0,a.useEffect)(()=>{s&&Ne(s)},[s]),(0,a.useEffect)(()=>{(async()=>{if(console.log("[ChatPanel] \ud83d\udccb loadChatHistory called, activeTenant:",null===t||void 0===t?void 0:t.id),!t||"milky-assistant"===t.id)return console.log("[ChatPanel] \u23ed\ufe0f Skipping: no tenant or milky-assistant"),void m([]);const e=Pe(),n=De();if(console.log("[ChatPanel] \ud83d\udd11 Auth check:",{userId:e,isAuth:n,hasToken:!!localStorage.getItem("access_token")}),!e||!n)return console.log("[ChatPanel] \u26a0\ufe0f Not authenticated, skipping history load"),void m([]);v(!0),console.log("[ChatPanel] \ud83d\udd04 Loading history for:",{userId:e,tenantId:t.id});try{var r,a,o,i,s,l;const n=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a=await Jc("/chat/history?user_id=".concat(e,"&tenant_id=").concat(t,"&limit=").concat(n,"&offset=").concat(r),{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok){let e="Failed to fetch chat history: ".concat(a.status);try{const t=await a.text();t&&(e+=" - ".concat(t.substring(0,200)))}catch(Z_){}throw new Error(e)}const o=await a.text();let i;console.log("[fetchChatHistory] Raw response text:",o.substring(0,500));try{i=JSON.parse(o)}catch(Z_){throw console.error("[fetchChatHistory] Failed to parse JSON:",Z_),console.error("[fetchChatHistory] Response text:",o),new Error("Invalid JSON response: ".concat(o.substring(0,200)))}return console.log("[fetchChatHistory] Parsed response:",i),"success"===i.status&&i.data?i.data:i.messages?{messages:i.messages,total_count:i.total_count||i.messages.length,has_more:i.has_more||!1,limit:n,offset:r}:i.messages||i.data?i:(console.warn("[fetchChatHistory] No messages in response:",i),{messages:[],total_count:0,has_more:!1,limit:n,offset:r})}(e,t.id,50,0);console.log("[ChatPanel] \u2705 History response:",{messageCount:(null===n||void 0===n||null===(r=n.messages)||void 0===r?void 0:r.length)||0,totalCount:null===n||void 0===n?void 0:n.total_count,hasMore:null===n||void 0===n?void 0:n.has_more,firstMsgId:null===n||void 0===n||null===(a=n.messages)||void 0===a||null===(o=a[0])||void 0===o?void 0:o.id,lastMsgId:null===n||void 0===n||null===(i=n.messages)||void 0===i||null===(s=i[(null===n||void 0===n||null===(l=n.messages)||void 0===l?void 0:l.length)-1])||void 0===s?void 0:s.id});const c=[];[...n.messages||[]].reverse().forEach(e=>{let t="Now";if(e.created_at)try{const n="number"===typeof e.created_at?e.created_at:parseInt(e.created_at,10);if(!isNaN(n)&&n>0){t=(n<1e10?new Date(1e3*n):new Date(n)).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",hour12:!1})}}catch(Z_){console.warn("[ChatPanel] Failed to parse timestamp:",e.created_at,Z_)}c.push({id:"".concat(e.id,"-user"),sender:"user",content:e.message||"",timestamp:t}),e.response&&c.push({id:"".concat(e.id,"-assistant"),sender:"assistant",content:e.response,timestamp:t})}),console.log("[ChatPanel] Transformed messages:",c.length),m(c)}catch(c){console.error("[ChatPanel] \u274c Failed to load chat history:",c),console.error("[ChatPanel] Error details:",c.message,c.stack),console.error("[ChatPanel] Auth state:",{hasToken:!!localStorage.getItem("access_token"),userId:Pe(),isAuth:De()}),m([])}finally{v(!1)}})()},[null===t||void 0===t?void 0:t.id]);const[_e,Se]=(0,a.useState)(!1),Ee=()=>{ge.current&&setTimeout(()=>{var e;null===(e=ge.current)||void 0===e||e.scrollTo({top:ge.current.scrollHeight,behavior:"smooth"}),Se(!1)},100)};(0,a.useEffect)(()=>{Ee()},[f]),(0,a.useEffect)(()=>{if(xe.current){xe.current.style.height="auto";const e=xe.current.scrollHeight,t=120,n=Math.min(e,t);xe.current.style.height="".concat(n,"px"),xe.current.style.overflowY=e>t?"auto":"hidden"}},[h]);const Ae=async()=>{if(!h.trim()||!t||g)return;const e=h.trim();p("");const n={id:Date.now().toString(),sender:"user",content:e,timestamp:(new Date).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",hour12:!1})};m(e=>[...e,n]),w(!0),x(!0);try{if(De()){var r,a;const n=await $c(t.id,e);w(!1);const i={id:Date.now().toString(),sender:"assistant",content:n.milky_response||n.message||"Maaf, terjadi kesalahan.",timestamp:(new Date).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",hour12:!1})};if(m(e=>[...e,i]),"open_pos"===(null===(r=n.action)||void 0===r?void 0:r.type)&&null!==(a=n.action)&&void 0!==a&&a.payload){const{items:e,paymentMethod:t}=n.action.payload;console.log("[ChatPanel] Detected sales intent action:",{items:e,paymentMethod:t}),d&&o?(null===l||void 0===l||l({items:e,paymentMethod:t}),o("pos")):(J({items:e,paymentMethod:t}),R(!0))}}else{w(!1);const e={id:Date.now().toString(),sender:"assistant",content:"Silakan login terlebih dahulu.",timestamp:(new Date).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",hour12:!1})};m(t=>[...t,e])}}catch(i){console.error("Error sending message:",i),w(!1),m(e=>[...e,{id:Date.now().toString(),sender:"assistant",content:"Maaf, terjadi kesalahan. Silakan coba lagi.",timestamp:"Now"}])}finally{x(!1)}};return t?(0,Ue.jsxs)("div",{className:"flex flex-col w-full ".concat(r?"h-screen":"h-full"),onTouchStart:ye,onTouchMove:ve,onTouchEnd:be,style:{height:r?"100dvh":"100%",width:r?"100vw":"100%",maxWidth:r?"100vw":"100%",overflow:"hidden",position:r?"fixed":"relative",top:r?0:void 0,left:r?0:void 0,right:r?0:void 0,bottom:r?0:void 0,backgroundColor:"#E5E5E5",isolation:"isolate"},children:[(0,Ue.jsx)("div",{className:"px-4 py-3 ".concat(r?"fixed":"absolute"," top-0 left-0 right-0 z-50"),style:{backgroundColor:"transparent",paddingTop:r?"calc(12px + env(safe-area-inset-top))":"12px"},children:(0,Ue.jsxs)("div",{className:"bg-white/65 backdrop-blur-md rounded-xl flex items-center border border-neutral-200/60 py-3",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("button",{onClick:n,className:"md:hidden flex items-center justify-center pl-4 pr-5","aria-label":"Back to workspace",children:(0,Ue.jsx)("span",{className:"text-neutral-400 text-4xl font-light leading-none",children:"\u2039"})}),(0,Ue.jsxs)("div",{onClick:()=>null===o||void 0===o?void 0:o("settings"),className:"flex items-center gap-3 flex-1 pr-4 md:pl-4 cursor-pointer",children:[(0,Ue.jsx)("div",{className:"w-9 h-9 bg-red-400 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:t.name.charAt(0).toUpperCase()}),(0,Ue.jsx)("span",{className:"font-semibold text-neutral-800",children:t.name})]})]})}),(0,Ue.jsxs)("div",{ref:ge,onScroll:()=>{if(ge.current){const{scrollTop:e,scrollHeight:t,clientHeight:n}=ge.current;Se(t-e-n>150)}},className:"flex-1 min-h-0 overflow-y-auto space-y-3",style:{position:"absolute",top:0,bottom:0,left:0,right:0,paddingTop:r?"calc(76px + env(safe-area-inset-top))":"76px",paddingBottom:r?"calc(76px + env(safe-area-inset-bottom))":"76px",paddingLeft:"16px",paddingRight:"16px",width:"100%",maxWidth:"100%",overflowX:"hidden",overflowY:"auto",backgroundColor:"transparent",WebkitOverflowScrolling:"touch",overscrollBehavior:"contain"},children:[y&&(0,Ue.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,Ue.jsxs)("div",{className:"flex gap-3 animate-pulse",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex-shrink-0"}),(0,Ue.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,Ue.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,Ue.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]},e))}),!y&&0===f.length&&t&&"milky-assistant"!==t.id&&(0,Ue.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 py-12",children:[(0,Ue.jsx)("svg",{className:"w-16 h-16 mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Belum ada pesan"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Mulai percakapan dengan mengirim pesan"})]}),!y&&f.map(e=>(0,Ue.jsx)("div",{className:"flex ".concat("user"===e.sender?"justify-end":"justify-start"," ").concat("user"===e.sender?"pr-2":"pl-2"),children:e.content.includes("<table")||e.content.includes("<div")||e.content.includes("milky-receipt")?(0,Ue.jsxs)("div",{className:"max-w-[90%]",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-2xl px-4 py-3",style:{boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[(0,Ue.jsx)("div",{dangerouslySetInnerHTML:{__html:e.content},className:"receipt-card text-sm text-left"}),(0,Ue.jsx)("div",{className:"text-xs text-neutral-400 mt-1 text-right",children:e.timestamp})]}),(0,Ue.jsx)("div",{className:"mt-4 flex justify-end",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-xl px-4 py-3 flex items-center gap-3 w-full",style:{boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[(0,Ue.jsx)("div",{className:"w-10 h-10 flex-shrink-0",children:(0,Ue.jsx)("img",{src:"/icons/insight.png",alt:"Insight",className:"w-full h-full object-contain",onError:e=>{e.target.style.display="none"}})}),(0,Ue.jsx)("span",{className:"flex-1 text-sm text-neutral-700",children:"Cek produk paling laris 30 hari terakhir"}),(0,Ue.jsx)("span",{className:"text-neutral-400 text-3xl font-light leading-none",children:"\u203a"})]})})]}):(0,Ue.jsxs)("div",{className:"max-w-[80%] px-3 py-2 rounded-2xl ".concat("user"===e.sender?"bg-amber-100 text-gray-900":"bg-white text-gray-900 border border-gray-200"),style:{boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[(0,Ue.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words text-left",children:e.content}),(0,Ue.jsx)("p",{className:"text-xs mt-1 text-left ".concat("user"===e.sender?"text-gray-600":"text-gray-500"),children:e.timestamp})]})},e.id)),b&&(0,Ue.jsx)("div",{className:"flex justify-start pl-2",children:(0,Ue.jsx)("div",{className:"max-w-[80%] px-4 py-3 rounded-lg bg-white shadow-sm border border-gray-200",children:(0,Ue.jsx)(m_,{})})}),(0,Ue.jsx)("div",{ref:me,style:{height:"1px"}})]}),_e&&(0,Ue.jsx)("div",{className:"absolute z-40 left-0 right-0 flex justify-center pointer-events-none ".concat(r?"bottom-[calc(76px+env(safe-area-inset-bottom))]":"bottom-20"),children:(0,Ue.jsx)("button",{onClick:Ee,className:"pointer-events-auto bg-white/80 backdrop-blur-md rounded-full p-2 shadow-md border border-neutral-200/60 hover:bg-white/90 transition-all duration-200",style:{animation:"fadeInUp 0.2s ease-out"},"aria-label":"Scroll to bottom",children:(0,Ue.jsx)("svg",{className:"w-5 h-5 text-neutral-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})}),(0,Ue.jsxs)("div",{className:"px-4 py-3 ".concat(r?"fixed":"absolute"," bottom-0 left-0 right-0 z-50"),style:{backgroundColor:"transparent",paddingBottom:r?"max(12px, env(safe-area-inset-bottom))":"12px"},children:[(0,Ue.jsxs)("div",{className:"relative",children:[$&&(0,Ue.jsx)("div",{className:"absolute bottom-full left-0 right-0 mb-2 max-h-60 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:(0,Ue.jsx)(ub,{value:le,onChange:(e,t)=>{t&&(e=>{var t;const n=h.toLowerCase(),r=we.find(e=>n.startsWith(e))||"Pembelian",a="".concat(r.charAt(0).toUpperCase()+r.slice(1)," ").concat(e," sejumlah ");p(a),te(!1),null===(t=xe.current)||void 0===t||t.focus()})(t.name)},placeholder:"",disabled:!1})}),ae&&(0,Ue.jsxs)("div",{className:"absolute bottom-full left-0 right-0 mb-2 max-h-48 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg z-50 p-2",children:[(0,Ue.jsx)("div",{className:"text-xs text-gray-500 mb-2 px-2",children:"Pilih Satuan:"}),(0,Ue.jsx)("div",{className:"text-xs font-semibold text-gray-600 px-2 py-1",children:"Wholesales:"}),ke.map(e=>(0,Ue.jsx)("button",{onClick:()=>Ce(e),className:"w-full text-left px-3 py-2 hover:bg-purple-50 rounded text-sm",children:e},e)),(0,Ue.jsx)("div",{className:"text-xs font-semibold text-gray-600 px-2 py-1 mt-2",children:"Retail:"}),je.map(e=>(0,Ue.jsx)("button",{onClick:()=>Ce(e),className:"w-full text-left px-3 py-2 hover:bg-purple-50 rounded text-sm",children:e},e))]}),ie&&(0,Ue.jsxs)("div",{className:"absolute bottom-full left-0 right-0 mb-2 max-h-48 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg z-50 p-2",children:[(0,Ue.jsx)("div",{className:"text-xs text-gray-500 mb-2 px-2",children:"Metode Pembayaran:"}),["tunai","transfer","kredit","debit","qris"].map(e=>(0,Ue.jsx)("button",{onClick:()=>(e=>{var t;const n="".concat(h.trim()," ").concat(e," dari ");p(n),se(!1),null===(t=xe.current)||void 0===t||t.focus()})(e),className:"w-full text-left px-3 py-2 hover:bg-purple-50 rounded text-sm capitalize",children:e},e))]}),ne&&(0,Ue.jsx)("div",{className:"absolute bottom-full left-0 right-0 mb-2 max-h-60 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:(0,Ue.jsx)(db,{value:ue,onChange:e=>{(e=>{var t;const n=h.substring(0,h.toLowerCase().lastIndexOf("dari")+4),r="".concat(n," ").concat(e);p(r),re(!1),null===(t=xe.current)||void 0===t||t.focus()})(e)},placeholder:"",disabled:!1})}),(0,Ue.jsxs)("div",{className:"bg-white/65 backdrop-blur-md rounded-xl px-4 py-3 flex items-end gap-3 border border-neutral-200/60",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[(0,Ue.jsx)("div",{className:"flex-shrink-0 mb-1",children:(0,Ue.jsx)(nu,{isMobile:r,onMenuItemClick:e=>{console.log("[ChatPanel] Action menu item clicked:",e),"purchase_goods"===e?d&&o?o("pembelian"):O(!0):"sales_product"===e?d&&o?o("pos"):R(!0):"expense"===e?d&&o?o("expense"):N(!0):"inventory_update"===e?d&&o?o("inventory"):L(!0):"cash_bank"===e?d&&o?o("kasbank"):W(!0):"debt_receivable"===e?d&&o?o("debt"):U(!0):"customer"===e?d&&o?o("customer"):G(!0):"insight"===e&&(d&&o?o("insight"):X(!0))},useIconImage:!0,isOpen:Y,onOpenChange:q})}),(0,Ue.jsx)("textarea",{ref:xe,value:h,onChange:e=>{p(e.target.value),(e=>{const t=e.toLowerCase(),n=we.some(e=>t.startsWith(e));if(!n)return te(!1),re(!1),oe(!1),void se(!1);if(we.find(e=>t==="".concat(e," "))&&e!==fe.current)return ce(""),te(!0),re(!1),oe(!1),se(!1),void(fe.current=e);if(n&&!t.includes("sejumlah")){const n=we.find(e=>t.startsWith(e));if(n){const t=e.substring(n.length).trim();if(t.length>=2)return ce(t),te(!0),re(!1),oe(!1),void se(!1)}}if(t.match(/sejumlah\s+(\d+)\s+$/)&&e!==fe.current)return oe(!0),te(!1),re(!1),se(!1),void(fe.current=e);const r=e.match(/sejumlah\s+\d+\s+(\w+)\s+$/i);if(r&&!t.includes("harga")&&e!==fe.current){const t=r[1].toLowerCase();if([...ke,...je].includes(t)){const n="".concat(e.trim()," harga ");return p(n),pe(t),oe(!1),void(fe.current=n)}}const a=e.match(/harga\s+(\d+(?:\.\d+)?)\s*(r|ri|rb|rib|ribu|k|jt|juta)?\s+$/i);if(a&&e!==fe.current){var o;const t=parseFloat(a[1].replace(/\./g,"")),n=(null===(o=a[2])||void 0===o?void 0:o.toLowerCase())||"";let r=t;n.includes("jt")||n.includes("juta")?r=1e6*t:n.match(/^(r|ri|rb|rib|ribu|k)$/)&&(r=1e3*t);const i=new Intl.NumberFormat("id-ID").format(r),s=he||"unit",l=e.substring(0,e.toLowerCase().lastIndexOf("harga")),c="".concat(l,"harga Rp").concat(i," per ").concat(s," isi ");return p(c),fe.current=c,oe(!1),void te(!1)}if(e.match(/isi\s+(\d+)\s+$/i)&&!t.includes("dari")&&e!==fe.current){const t="".concat(e.trim()," per pcs dari ");return p(t),fe.current=t,re(!0),te(!1),oe(!1),void se(!1)}const i=t.match(/dari\s+(.*)$/);if(i){if(0===i[1].length&&e!==fe.current)return de(""),re(!0),te(!1),oe(!1),se(!1),void(fe.current=e);if(i[1].length>=2)return de(i[1]),re(!0),te(!1),oe(!1),void se(!1)}te(!1),re(!1),oe(!1),se(!1)})(e.target.value)},onKeyPress:e=>{/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768||"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Ae())},placeholder:"Ketik pesan...",rows:1,className:"flex-1 bg-transparent border-none outline-none focus:ring-0 focus:outline-none resize-none text-sm text-neutral-800 placeholder-neutral-400",style:{minHeight:"24px",maxHeight:"120px",border:"none",outline:"none",boxShadow:"none",lineHeight:"1.5"}}),(0,Ue.jsx)("button",{onClick:h.trim()?Ae:()=>{d&&o?o("pos"):R(!0)},disabled:!!h.trim()&&g,className:"flex-shrink-0 flex items-center justify-center disabled:opacity-50 transition-all",style:{width:"29px",height:"29px",marginBottom:"0px"},"aria-label":h.trim()?"Send message":"Scan product",children:(0,Ue.jsx)("img",{src:h.trim()?"/icons/sendbutton.png":"/icons/CAM.png",alt:h.trim()?"Send":"Camera",style:{width:"29px",height:"29px",objectFit:"contain"}})})]})]}),(0,Ue.jsx)("style",{children:'\n          @keyframes fadeInScale {\n            from {\n              opacity: 0;\n              transform: scale(0.8);\n            }\n            to {\n              opacity: 1;\n              transform: scale(1);\n            }\n          }\n\n          @keyframes fadeInUp {\n            from {\n              opacity: 0;\n              transform: translateY(8px);\n            }\n            to {\n              opacity: 1;\n              transform: translateY(0);\n            }\n          }\n\n          /* Receipt card styling - labels left, values right */\n          .receipt-card table {\n            width: 100%;\n            text-align: left;\n          }\n          .receipt-card td:first-child {\n            text-align: left;\n            color: #666;\n          }\n          .receipt-card td:last-child {\n            text-align: right;\n            font-weight: 500;\n          }\n          .receipt-card tr {\n            border-bottom: 1px solid #e5e7eb;\n          }\n          .receipt-card tr td {\n            padding: 6px 0;\n          }\n          /* GRAND TOTAL with lime underline */\n          .receipt-card div[style*="GRAND TOTAL"],\n          .receipt-card span:contains("GRAND TOTAL"),\n          .receipt-card td:contains("GRAND TOTAL") {\n            border-bottom: 2px solid #65a30d;\n            padding-bottom: 8px;\n          }\n          /* Force milky-receipt to be transparent with no padding */\n          .milky-receipt {\n            background: transparent !important;\n            padding: 0 !important;\n            border-radius: 0 !important;\n          }\n          /* Compact receipt header */\n          .milky-receipt > div:first-child {\n            margin-bottom: 12px !important;\n            padding-bottom: 12px !important;\n          }\n        '})]}),(0,Ue.jsx)(mt,{children:k&&!d&&(0,Ue.jsx)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:f_,className:"fixed inset-0 z-50",children:(0,Ue.jsx)(Ey,{isOpen:!0,onClose:()=>{j(!1),D(null)},isMobile:r,isEmbedded:!0,onTransactionComplete:Ne,scannedProductData:P})},"purchase-modal")}),(0,Ue.jsx)(mt,{children:C&&!d&&(0,Ue.jsx)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:f_,className:"fixed inset-0 z-50",children:(0,Ue.jsx)(yv,{tenantId:(null===t||void 0===t?void 0:t.id)||"",onClose:()=>N(!1),onTransactionComplete:Ne})},"beban-modal")}),!d&&(0,Ue.jsx)(Dk,{isOpen:B,onClose:()=>L(!1),isMobile:r}),(0,Ue.jsx)(mt,{children:z&&!d&&(0,Ue.jsx)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:f_,className:"fixed inset-0 z-50",children:(0,Ue.jsx)(Oj,{isOpen:z,onClose:()=>W(!1),isMobile:r})},"kasbank-modal")}),(0,Ue.jsx)(mt,{children:V&&!d&&(0,Ue.jsx)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:f_,className:"fixed inset-0 z-50",children:(0,Ue.jsx)(HN,{isOpen:V,onClose:()=>U(!1),isMobile:r})},"debt-modal")}),(0,Ue.jsx)(mt,{children:H&&!d&&(0,Ue.jsx)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:f_,className:"fixed inset-0 z-50",children:(0,Ue.jsx)(qN,{isOpen:H,onClose:()=>G(!1),isMobile:r})},"customer-modal")}),(0,Ue.jsx)(mt,{children:K&&!d&&(0,Ue.jsx)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:f_,className:"fixed inset-0 z-50",children:(0,Ue.jsx)(p_,{isOpen:K,onClose:()=>X(!1),isMobile:r})},"insight-modal")}),(0,Ue.jsx)(pb,{isOpen:_,productId:E,productName:I,onClose:()=>S(!1),onSuccess:e=>{console.log("[ChatPanel] Barcode registered:",e),m(t=>t.map(t=>{if(t.content.includes('data-product-id="'.concat(E,'"'))){const n=t.content.replace(/<div data-product-id="[^"]*" data-product-name="[^"]*"[^>]*class="barcode-register-btn"[^>]*>\u274e Daftarkan Barcode<\/div>/,'<div style="font-size:12px;color:#10b981;margin-top:4px">\u2705 Barcode: '.concat(e,"</div>"));return tt(tt({},t),{},{content:n})}return t})),S(!1)}}),(0,Ue.jsx)(mt,{children:M&&t&&!d&&(0,Ue.jsx)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:f_,className:"fixed inset-0 z-50 bg-white",children:(0,Ue.jsx)(_b,{tenantId:t.id,onClose:()=>{R(!1),J(null)},onTransactionComplete:Ne,initialItems:null===Z||void 0===Z?void 0:Z.items,initialPaymentMethod:null===Z||void 0===Z?void 0:Z.paymentMethod,onPrefillProcessed:()=>J(null)})},"pos-mobile")}),(0,Ue.jsx)(mt,{children:F&&t&&(0,Ue.jsx)(yc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:f_,className:"fixed inset-0 z-50 bg-white",children:(0,Ue.jsx)(ow,{tenantId:t.id,onClose:()=>O(!1),onTransactionComplete:Ne})},"pembelian-mobile")})]}):(0,Ue.jsxs)("div",{className:"flex flex-col items-center justify-center h-full bg-white text-gray-400",children:[(0,Ue.jsx)("svg",{className:"w-16 h-16 mb-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,Ue.jsx)("p",{className:"text-sm",children:"Select a tenant to start chatting"})]})},x_={profile:["Owner","Manager","Kasir","Staff","Bendahara"],team:["Owner","Manager"],settings:["Owner","Manager"],data:["Owner","Manager","Bendahara"],billing:["Owner"],dangerZone:["Owner"]},y_=e=>{let{tenantId:t,tenantName:n,userRole:r,onClose:a,isEmbedded:o=!1}=e;const i=e=>{var t,n;return null!==(t=null===(n=x_[e])||void 0===n?void 0:n.includes(r))&&void 0!==t&&t},s=[{id:"leave",icon:"\ud83d\udeaa",label:"Keluar Tenant",description:"Lepas akses dari tenant ini",show:"Owner"!==r},{id:"delete",icon:"\ud83d\uddd1\ufe0f",label:"Hapus Tenant",description:"Hapus permanen tenant ini",show:"Owner"===r}];return(0,Ue.jsxs)("div",{className:"flex flex-col bg-white h-full ".concat(o?"rounded-l-2xl shadow-xl":""),style:{minWidth:o?"320px":"100%"},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between px-4 py-4 border-b border-neutral-100",children:[(0,Ue.jsx)("h2",{className:"text-lg font-semibold text-neutral-800",children:"Settings"}),(0,Ue.jsx)("button",{onClick:a,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-neutral-100 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5 text-neutral-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsx)("div",{className:"px-4 py-4",children:(0,Ue.jsxs)("div",{className:"bg-neutral-50 rounded-xl p-4 flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-400 to-orange-500 rounded-xl flex items-center justify-center text-white text-xl font-bold shadow-sm",children:n.charAt(0).toUpperCase()}),(0,Ue.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ue.jsx)("div",{className:"font-semibold text-neutral-800 truncate",children:n}),(0,Ue.jsxs)("div",{className:"text-sm text-neutral-500 flex items-center gap-1",children:[(0,Ue.jsx)("span",{className:"text-yellow-500",children:"\u2b50"}),(0,Ue.jsx)("span",{children:r})]})]})]})}),(0,Ue.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:[(0,Ue.jsx)("div",{className:"space-y-1",children:[{id:"profile",icon:"\ud83d\udc64",label:"Profil Toko",description:"Nama, logo, alamat"},{id:"team",icon:"\ud83d\udc65",label:"Tim & Akses",description:"Kelola collaborator"},{id:"settings",icon:"\u2699\ufe0f",label:"Pengaturan",description:"Notifikasi, format"},{id:"data",icon:"\ud83d\udcca",label:"Data & Laporan",description:"Export, backup"},{id:"billing",icon:"\ud83d\udcb3",label:"Langganan",description:"Plan & billing"}].map(e=>i(e.id)?(0,Ue.jsxs)("button",{className:"w-full flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-neutral-50 transition-colors text-left group",children:[(0,Ue.jsx)("span",{className:"text-xl",children:e.icon}),(0,Ue.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ue.jsx)("div",{className:"font-medium text-neutral-800 group-hover:text-orange-600 transition-colors",children:e.label}),(0,Ue.jsx)("div",{className:"text-xs text-neutral-400",children:e.description})]}),(0,Ue.jsx)("svg",{className:"w-4 h-4 text-neutral-300 group-hover:text-neutral-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]},e.id):null)}),i("dangerZone")&&(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"my-4 border-t border-neutral-100"}),(0,Ue.jsx)("div",{className:"space-y-1",children:s.map(e=>e.show?(0,Ue.jsxs)("button",{className:"w-full flex items-center gap-3 px-3 py-3 rounded-xl hover:bg-red-50 transition-colors text-left group",children:[(0,Ue.jsx)("span",{className:"text-xl",children:e.icon}),(0,Ue.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ue.jsx)("div",{className:"font-medium text-red-600",children:e.label}),(0,Ue.jsx)("div",{className:"text-xs text-neutral-400",children:e.description})]})]},e.id):null)})]})]}),(0,Ue.jsx)("div",{className:"px-4 py-3 border-t border-neutral-100",children:(0,Ue.jsxs)("div",{className:"text-xs text-neutral-400 text-center",children:["Tenant ID: ",(0,Ue.jsx)("span",{className:"font-mono",children:t})]})})]})},v_=e=>{let{active:t}=e;return(0,Ue.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:t?"#262626":"#737373",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{opacity:t?1:.6},children:(0,Ue.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})},b_=[{id:"promo",icon:"/icons/PROMO.png",iconActive:"/icons/PROMO_HOVER.png",label:"Promo"},{id:"tautan",icon:"/icons/TAUTAN.png",iconActive:"/icons/TAUTA_HOVER.png",label:"Tautan"},{id:"chat",icon:"",iconActive:"",label:"Chat",isSvg:!0},{id:"setting",icon:"/icons/SETTING.png",iconActive:"/icons/SETTING_HOVER.png",label:"Setting"}],w_=e=>{let{activeTab:t,onTabChange:n}=e;return(0,Ue.jsx)("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 py-3",style:{backgroundColor:"transparent",paddingBottom:"max(12px, env(safe-area-inset-bottom))"},children:(0,Ue.jsx)("div",{className:"bg-white/65 backdrop-blur-md rounded-xl flex items-center justify-around border border-neutral-200/60",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.08)",height:"56px"},children:b_.map(e=>{const r=t===e.id;return(0,Ue.jsxs)("button",{onClick:()=>n(e.id),className:"flex flex-col items-center justify-center flex-1 h-full relative transition-all",children:[e.isSvg?(0,Ue.jsx)(v_,{active:r}):(0,Ue.jsx)("img",{src:r?e.iconActive:e.icon,alt:e.label,className:"w-6 h-6",style:{opacity:r?1:.6}}),(0,Ue.jsx)("span",{className:"text-xs mt-0.5",style:{color:r?"#262626":wc},children:e.label})]},e.id)})})})},k_=e=>{let{isOpen:t,onClose:n,onScanSuccess:r}=e;const[o,i]=(0,a.useState)("idle"),[s,l]=(0,a.useState)(""),[c,u]=(0,a.useState)(null),[d,h]=(0,a.useState)(null),p=(0,a.useRef)(null),f=(0,a.useRef)(null),m=(0,a.useCallback)(async()=>{if(p.current)try{h(null),f.current=new cy(p.current,{formats:[sd.QR_CODE],desiredWidth:1280,desiredHeight:720}),f.current.onFound(e=>{const t=e.text||e.rawValue||"";t&&x(t)}),f.current.onProgress(e=>{"camera-ready"===e.phase&&(i("scanning"),l("Find a QR code to Scan"))}),f.current.onError(e=>{var t;console.error("[QRScanner] Error:",e),h(null!==(t=e.message)&&void 0!==t&&t.includes("NotAllowed")||"NotAllowedError"===e.name?"Izinkan akses kamera untuk scan QR code":e.message||"Gagal mengakses kamera"),i("error")}),await f.current.start()}catch(e){console.error("Scanner error:",e),h("NotAllowedError"===e.name?"Izinkan akses kamera untuk scan QR code":"Gagal mengakses kamera"),i("error")}},[]),g=(0,a.useCallback)(()=>{f.current&&(f.current.stop(),f.current=null)},[]),x=async e=>{f.current&&f.current.stop(),i("scanned"),l("QR code terdeteksi! Memproses...");const t=e.match(/milkyhoop:\/\/login\?token=([^&]+)/);if(!t)return i("error"),void l("QR code tidak valid. Silakan scan QR dari halaman login desktop.");const n=t[1];try{const e=Ee(),t=await fetch("/api/auth/qr/scan",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({token:n})}),r=await t.json();t.ok&&r.success?(u({token:n}),i("scanned"),l("QR berhasil di-scan. Konfirmasi login?")):(i("error"),l(r.detail||"Gagal memproses QR code"))}catch(r){console.error("Scan error:",r),i("error"),l("Terjadi kesalahan. Silakan coba lagi.")}};return(0,a.useEffect)(()=>(t?m():(g(),i("idle"),l(""),u(null),h(null)),()=>{g()}),[t,m,g]),t?(0,Ue.jsxs)("div",{className:"fixed inset-0 z-50 bg-black",children:[(0,Ue.jsx)("video",{ref:p,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute inset-0 w-full h-full object-cover"}),(0,Ue.jsx)("button",{onClick:n,className:"absolute top-4 right-4 z-20 w-11 h-11 rounded-full bg-neutral-900/60 backdrop-blur-md flex items-center justify-center active:bg-neutral-800/60 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),"scanning"===o&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:(0,Ue.jsxs)("div",{className:"w-64 h-64 relative",style:{animation:"scan-breathe 1s ease-in-out infinite"},children:[(0,Ue.jsx)("div",{className:"absolute top-0 left-0 w-12 h-12 border-t-4 border-l-4 border-white rounded-tl-2xl"}),(0,Ue.jsx)("div",{className:"absolute top-0 right-0 w-12 h-12 border-t-4 border-r-4 border-white rounded-tr-2xl"}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-0 w-12 h-12 border-b-4 border-l-4 border-white rounded-bl-2xl"}),(0,Ue.jsx)("div",{className:"absolute bottom-0 right-0 w-12 h-12 border-b-4 border-r-4 border-white rounded-br-2xl"})]})}),(0,Ue.jsx)("style",{children:"\n        @keyframes scan-breathe {\n          0%, 100% { transform: scale(1); }\n          50% { transform: scale(1.08); }\n        }\n      "}),"scanning"===o&&(0,Ue.jsx)("div",{className:"absolute bottom-8 inset-x-4 flex justify-center z-10",children:(0,Ue.jsx)("div",{className:"px-6 py-4 rounded-full bg-neutral-900/60 backdrop-blur-md",children:(0,Ue.jsx)("span",{className:"text-white font-medium",children:"Find a QR code to Scan"})})}),d&&(0,Ue.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/80",children:(0,Ue.jsxs)("div",{className:"text-center px-8",children:[(0,Ue.jsx)("div",{className:"w-20 h-20 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,Ue.jsx)("svg",{className:"w-10 h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),(0,Ue.jsx)("p",{className:"text-white font-medium text-lg mb-2",children:d}),(0,Ue.jsx)("p",{className:"text-neutral-400 text-sm mb-6",children:"Pastikan browser memiliki izin kamera"}),(0,Ue.jsx)("button",{onClick:m,className:"px-6 py-3 rounded-full bg-neutral-900/60 backdrop-blur-md text-white font-medium",children:"Coba Lagi"})]})}),"scanned"===o&&c&&(0,Ue.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,Ue.jsx)("div",{className:"bg-white rounded-2xl shadow-xl max-w-sm w-full mx-4 overflow-hidden",children:(0,Ue.jsxs)("div",{className:"p-6 text-center",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ue.jsx)("svg",{className:"w-8 h-8 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,Ue.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Login ke Desktop?"}),(0,Ue.jsx)("p",{className:"text-gray-600 text-sm mb-6",children:"Anda akan login ke MilkyHoop di browser desktop. Pastikan ini adalah perangkat Anda."}),(0,Ue.jsxs)("div",{className:"flex gap-3",children:[(0,Ue.jsx)("button",{onClick:async()=>{if(c){i("approving"),l("Memproses penolakan...");try{const e=Ee(),t=await fetch("/api/auth/qr/approve",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({token:c.token,approved:!1})}),r=await t.json();t.ok&&r.success?(i("rejected"),l("Login ditolak"),setTimeout(()=>n(),1500)):(i("error"),l(r.detail||"Gagal menolak login"))}catch(e){console.error("Reject error:",e),i("error"),l("Terjadi kesalahan. Silakan coba lagi.")}}},className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl font-medium active:bg-gray-200",children:"Batal"}),(0,Ue.jsx)("button",{onClick:async()=>{if(c){i("approving"),l("Memproses persetujuan...");try{const e=Ee(),t=await fetch("/api/auth/qr/approve",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({token:c.token,approved:!0})}),a=await t.json();t.ok&&a.success?(i("approved"),l("Login berhasil disetujui!"),null===r||void 0===r||r(),setTimeout(()=>n(),2e3)):(i("error"),l(a.detail||"Gagal menyetujui login"))}catch(e){console.error("Approve error:",e),i("error"),l("Terjadi kesalahan. Silakan coba lagi.")}}},className:"flex-1 px-4 py-3 bg-purple-600 text-white rounded-xl font-medium active:bg-purple-700",children:"Setuju"})]})]})})}),"approving"===o&&(0,Ue.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-white/30 border-t-white rounded-full mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-white font-medium",children:s})]})}),"approved"===o&&(0,Ue.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ue.jsx)("svg",{className:"w-10 h-10 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,Ue.jsx)("p",{className:"text-white font-medium text-lg",children:s})]})}),"rejected"===o&&(0,Ue.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-20 h-20 bg-neutral-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ue.jsx)("svg",{className:"w-10 h-10 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,Ue.jsx)("p",{className:"text-white font-medium text-lg",children:s})]})}),"error"===o&&!d&&(0,Ue.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,Ue.jsxs)("div",{className:"text-center px-8",children:[(0,Ue.jsx)("div",{className:"w-20 h-20 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ue.jsx)("svg",{className:"w-10 h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ue.jsx)("p",{className:"text-white font-medium text-lg mb-6",children:s}),(0,Ue.jsx)("button",{onClick:()=>{i("idle"),u(null),h(null),m()},className:"px-6 py-3 rounded-full bg-neutral-900/60 backdrop-blur-md text-white font-medium",children:"Scan Ulang"})]})})]}):null},j_=e=>{let{isOpen:t,onClose:n}=e;const[r,o]=(0,a.useState)([]),[i,s]=(0,a.useState)(!0),[l,c]=(0,a.useState)(null),[u,d]=(0,a.useState)(!1),[h,p]=(0,a.useState)(null),f=(0,a.useCallback)(async()=>{s(!0),c(null);try{const e=Ee(),t=await fetch("/api/devices",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("Failed to fetch devices");const n=await t.json();if(!n.success)throw new Error(n.detail||"Failed to fetch devices");o(n.devices)}catch(e){console.error("Fetch devices error:",e),c(e.message||"Gagal memuat daftar perangkat")}finally{s(!1)}},[]),m=e=>{const t=new Date(e),n=(new Date).getTime()-t.getTime(),r=Math.floor(n/6e4),a=Math.floor(n/36e5),o=Math.floor(n/864e5);return r<1?"Baru saja":r<60?"".concat(r," menit lalu"):a<24?"".concat(a," jam lalu"):o<7?"".concat(o," hari lalu"):t.toLocaleDateString("id-ID")};if((0,a.useEffect)(()=>{t&&f()},[t,f]),!t)return null;const g=r.filter(e=>"mobile"===e.device_type),x=r.filter(e=>"web"===e.device_type);return(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center p-4",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 border-b flex-shrink-0",children:[(0,Ue.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:"Perangkat Terhubung"}),(0,Ue.jsx)("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:i?(0,Ue.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Ue.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-purple-200 border-t-purple-600 rounded-full"})}):l?(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("p",{className:"text-red-600 mb-4",children:l}),(0,Ue.jsx)("button",{onClick:f,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Coba Lagi"})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("button",{onClick:()=>d(!0),className:"w-full flex items-center justify-center gap-2 p-4 bg-purple-50 text-purple-600 rounded-xl hover:bg-purple-100 transition-colors mb-6",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,Ue.jsx)("span",{className:"font-medium",children:"Hubungkan Perangkat Baru"})]}),(0,Ue.jsxs)("div",{className:"mb-6",children:[(0,Ue.jsx)("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Perangkat Utama"}),0===g.length?(0,Ue.jsx)("p",{className:"text-gray-500 text-sm py-4 text-center",children:"Tidak ada perangkat mobile"}):(0,Ue.jsx)("div",{className:"space-y-2",children:g.map(e=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("p",{className:"font-medium text-gray-900",children:[e.device_name||"Mobile",e.is_current&&(0,Ue.jsx)("span",{className:"ml-2 text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"Perangkat ini"})]}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-500",children:["Aktif ",m(e.last_active_at)]})]})]}),e.is_primary&&(0,Ue.jsx)("span",{className:"text-xs text-purple-600 bg-purple-50 px-2 py-1 rounded",children:"Primary"})]},e.id))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Ue.jsxs)("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:["Perangkat Web (",x.length,")"]}),x.length>0&&(0,Ue.jsx)("button",{onClick:async()=>{if(window.confirm("Logout semua perangkat web? Semua sesi desktop akan diakhiri.")){p("all-web");try{const e=Ee(),t=await fetch("/api/devices/logout-all-web",{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}),n=await t.json();t.ok&&n.success?(await f(),alert("".concat(n.count," perangkat web berhasil di-logout"))):alert(n.detail||"Gagal logout perangkat web")}catch(e){console.error("Logout all web error:",e),alert("Terjadi kesalahan")}finally{p(null)}}},disabled:"all-web"===h,className:"text-sm text-red-600 hover:text-red-700 font-medium disabled:opacity-50",children:"all-web"===h?"Loading...":"Logout Semua"})]}),0===x.length?(0,Ue.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,Ue.jsx)("p",{className:"text-gray-500 text-sm",children:"Tidak ada sesi web aktif"}),(0,Ue.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:"Scan QR di desktop untuk menghubungkan"})]}):(0,Ue.jsx)("div",{className:"space-y-2",children:x.map(e=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:e.device_name||"Web Browser"}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-500",children:["Aktif ",m(e.last_active_at)]})]})]}),(0,Ue.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Logout perangkat ini?")){p(e);try{const t=Ee(),n=await fetch("/api/devices/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}});if(n.ok)await f();else{const e=await n.json();alert(e.detail||"Gagal logout perangkat")}}catch(t){console.error("Logout device error:",t),alert("Terjadi kesalahan")}finally{p(null)}}})(e.id),disabled:h===e.id,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",children:h===e.id?(0,Ue.jsx)("div",{className:"animate-spin w-5 h-5 border-2 border-red-200 border-t-red-600 rounded-full"}):(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]},e.id))})]})]})}),(0,Ue.jsx)("div",{className:"p-4 border-t bg-gray-50 flex-shrink-0",children:(0,Ue.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Perangkat web akan otomatis logout setelah 30 hari tidak aktif"})})]})}),(0,Ue.jsx)(k_,{isOpen:u,onClose:()=>d(!1),onScanSuccess:()=>{d(!1),f()}})]})};function C_(){const[e,t]=(0,a.useState)(!1),n=(0,a.useRef)(null),r=(0,a.useRef)("tab_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))),o=(0,a.useRef)(!0);const i=(0,a.useCallback)(()=>{if(n.current){const e={type:"SESSION_ACTIVE",tabId:r.current,timestamp:Date.now()};n.current.postMessage(e),o.current=!0,t(!1)}},[]),s=(0,a.useCallback)(()=>{i()},[i]),l=(0,a.useCallback)(()=>{window.location.href="/blog"},[]);return(0,a.useEffect)(()=>{if("undefined"===typeof BroadcastChannel)return void console.warn("[SessionSync] BroadcastChannel not supported");const e=new BroadcastChannel("milkyhoop_session");n.current=e,e.onmessage=e=>{const n=e.data;"SESSION_ACTIVE"===n.type&&n.tabId!==r.current&&(console.log("[SessionSync] Session taken by another tab:",n.tabId),o.current=!1,t(!0)),"SESSION_RECLAIM"===n.type&&n.tabId!==r.current&&(console.log("[SessionSync] Session reclaimed by another tab:",n.tabId),o.current=!1,t(!0))};const a=setTimeout(()=>{i()},100),s=()=>{"visible"===document.visibilityState&&o.current};return document.addEventListener("visibilitychange",s),()=>{clearTimeout(a),document.removeEventListener("visibilitychange",s),e.close(),n.current=null}},[i]),{isSessionTakenOver:e,handleStayHere:s,handleGoToBlog:l}}const N_={duration:.3,ease:[.4,0,.2,1]},__=()=>{const e=Q(),[t,n]=(0,a.useState)([]),[r,o]=(0,a.useState)(!0),[i,s]=(0,a.useState)("none"),l="pos"===i,c="inventory"===i,u="kasbank"===i,d="debt"===i,h="customer"===i,p="insight"===i,f="purchase"===i,m="expense"===i,g="pembelian"===i,x="settings"===i,y="none"!==i,[v,b]=(0,a.useState)(null),[w,k]=(0,a.useState)(null),[j,C]=(0,a.useState)("chat"),[N,_]=(0,a.useState)(!1),[S,E]=(0,a.useState)(!1),A=window.innerWidth<768,I=window.innerWidth>=1024,{isSessionTakenOver:T,handleStayHere:P,handleGoToBlog:D}=C_(),M=!!I&&T,{showForceLogoutModal:R,handleStayHere:F,handleGoToBlog:O}=function(){const[e,t]=(0,a.useState)(!1),[n,r]=(0,a.useState)(""),o=(0,a.useCallback)(()=>{console.log("[ForceLogout] Performing logout"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_timestamp"),localStorage.removeItem("user_info"),localStorage.removeItem("device_id"),window.location.reload()},[]),i=(0,a.useCallback)(()=>{console.log("[ForceLogout] User chose to stay here - clearing and reloading"),o()},[o]),s=(0,a.useCallback)(()=>{console.log("[ForceLogout] User chose to go to blog"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_timestamp"),localStorage.removeItem("user_info"),localStorage.removeItem("device_id"),window.location.href="/blog"},[]);return(0,a.useEffect)(()=>{const e=e=>{var n;const a=e;console.log("[ForceLogout] Received force_logout event from App root"),r((null===(n=a.detail)||void 0===n?void 0:n.reason)||"Session digantikan oleh login baru"),t(!0)};return window.addEventListener("deviceForceLogout",e),()=>{window.removeEventListener("deviceForceLogout",e)}},[]),{showForceLogoutModal:e,forceLogoutReason:n,handleStayHere:i,handleGoToBlog:s}}(),B=R?"ws":M?"sync":null,L=null!==B,z="ws"===B?F:"sync"===B?P:()=>{},W="ws"===B?O:"sync"===B?D:()=>{},[V,U]=(0,a.useState)(()=>{if(!A){const e=localStorage.getItem("activeTenantId");return e?{id:e,name:"Loading..."}:null}const e=new URLSearchParams(window.location.search).get("tenant"),t=localStorage.getItem("mobile_active_tenant");return e?{id:e,name:"Loading..."}:t?{id:t,name:"Loading..."}:null}),[H,G]=(0,a.useState)(()=>{if(!A)return!1;const e=new URLSearchParams(window.location.search),t=e.get("tenant"),n=e.get("action"),r=localStorage.getItem("mobile_chat_state");return!(!t&&!n)||"chat"===r});(0,a.useEffect)(()=>{if(!A)return;const t=new URLSearchParams(e.search),n=t.get("tenant"),r=t.get("action");r&&n&&(console.log("[Dashboard] Detected action parameter, ensuring chat is shown:",r),G(!0),localStorage.setItem("mobile_chat_state","chat"),localStorage.setItem("mobile_active_tenant",n))},[e.search,A]),(0,a.useEffect)(()=>{(async()=>{try{o(!0);const e=await(async()=>{try{var e;const t=await Jc("/api/user/tenants",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)return t.status,await eu();const n=await t.json();console.log("[getUserTenants] API response:",n);const r=(null===(e=n.tenants)||void 0===e?void 0:e.map(e=>{var t,n;return{id:e.tenant_id||e.id,name:e.display_name||e.name||e.tenant_id,avatar:e.avatar,status:e.status||"offline",lastMessage:(null===(t=e.last_message)||void 0===t?void 0:t.content)||"",lastMessageTime:(null===(n=e.last_message)||void 0===n?void 0:n.timestamp)||"Now",role:e.role||"Owner",isPrivate:e.is_private}}))||[];return console.log("[getUserTenants] Mapped tenants:",r),r}catch(t){return await eu()}})();console.log("[Dashboard] Fetched tenants from API:",e);const t=[{id:"milky-assistant",name:"Milky Assistant",avatar:"\ud83e\udd16",status:"online",lastMessage:"Siap membantu Anda!",lastMessageTime:"Now"},...e];if(console.log("[Dashboard] All tenants (with Milky Assistant):",t.map(e=>({id:e.id,name:e.name}))),n(t),A){const e=new URLSearchParams(window.location.search),n=e.get("tenant"),r=e.get("action"),a=localStorage.getItem("mobile_active_tenant");if(n){const e=t.find(e=>e.id===n);if(e)U(e),G(!0),localStorage.setItem("mobile_chat_state","chat"),localStorage.setItem("mobile_active_tenant",n),console.log("[Dashboard] Set active tenant from URL:",e.id,"action:",r);else{console.log("[Dashboard] Tenant not in list, creating temp:",n);U({id:n,name:"Loading..."}),G(!0),localStorage.setItem("mobile_chat_state","chat"),localStorage.setItem("mobile_active_tenant",n)}}else if(a){const e=t.find(e=>e.id===a);if(e){U(e);const t=localStorage.getItem("mobile_chat_state");G("chat"===t)}}}else{const e=localStorage.getItem("activeTenantId");if(e){const n=t.find(t=>t.id===e);U(n||t[0])}else U(t[0])}}catch(e){console.error("Failed to fetch tenants:",e);const t={id:"milky-assistant",name:"Milky Assistant",avatar:"\ud83e\udd16",status:"online"};n([t]),A||U(t)}finally{o(!1)}})()},[]),(0,a.useEffect)(()=>{V&&(A||localStorage.setItem("activeTenantId",V.id))},[V,A]);const K=e=>{let n=t.find(t=>t.id===e);n||(console.log("[handleTenantSelect] Creating temp tenant for:",e),n={id:e,name:e}),U(n),G(!0),A&&(localStorage.setItem("mobile_chat_state","chat"),localStorage.setItem("mobile_active_tenant",e))},X=()=>{G(!1),A&&(localStorage.setItem("mobile_chat_state","list"),localStorage.removeItem("mobile_active_tenant"))};return(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"md:hidden h-screen flex flex-col overflow-hidden",children:[(0,Ue.jsx)("div",{className:"flex-1 overflow-hidden",children:"profile"===j?(0,Ue.jsx)(y_,{tenantId:(null===V||void 0===V?void 0:V.id)||"",tenantName:(null===V||void 0===V?void 0:V.name)||"",userRole:(null===V||void 0===V?void 0:V.role)||"Owner",onClose:()=>C("chat"),isEmbedded:!1}):H?x?(0,Ue.jsx)(y_,{tenantId:(null===V||void 0===V?void 0:V.id)||"",tenantName:(null===V||void 0===V?void 0:V.name)||"",userRole:(null===V||void 0===V?void 0:V.role)||"Owner",onClose:()=>s("none"),isEmbedded:!1}):(0,Ue.jsx)(g_,{activeTenant:V,onBack:X,onPanelToggle:e=>s(e),activePanel:i,isMobile:!0}):(0,Ue.jsx)(Yc,{tenants:t,activeTenant:V,onSelectTenant:K,isLoading:r})}),!H&&(0,Ue.jsx)(w_,{activeTab:j,onTabChange:e=>{C(e),"devices"===e&&_(!0),"tautan"===e&&E(!0)}})]}),(0,Ue.jsxs)("div",{className:"hidden md:block",style:{position:"relative",height:"100vh",width:"100vw",overflow:"hidden"},children:[(0,Ue.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"64px",height:"100%",overflow:"hidden"},children:(0,Ue.jsx)(Hc,{})}),!(y&&I)&&(0,Ue.jsx)("div",{style:{position:"absolute",left:"64px",top:0,width:"400px",height:"100%",overflow:"hidden"},children:(0,Ue.jsx)(Yc,{tenants:t,activeTenant:V,onSelectTenant:K,isLoading:r})}),(0,Ue.jsx)(mt,{mode:"wait",children:y&&I?(0,Ue.jsxs)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},style:{position:"absolute",left:"64px",right:0,top:0,height:"100%",overflow:"hidden",display:"flex"},children:[(0,Ue.jsxs)(yc.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:N_,style:{width:"50%",height:"100%",borderRight:"1px solid #e5e7eb"},children:[l&&(0,Ue.jsx)(_b,{tenantId:(null===V||void 0===V?void 0:V.id)||"",onClose:()=>{s("none"),k(null)},isEmbedded:!0,onTransactionComplete:e=>{b(e),setTimeout(()=>b(null),100)},initialItems:null===w||void 0===w?void 0:w.items,initialPaymentMethod:null===w||void 0===w?void 0:w.paymentMethod,onPrefillProcessed:()=>k(null)}),c&&(0,Ue.jsx)(Dk,{isOpen:!0,onClose:()=>s("none"),isEmbedded:!0}),u&&(0,Ue.jsx)(Oj,{isOpen:!0,onClose:()=>s("none"),isEmbedded:!0}),d&&(0,Ue.jsx)(HN,{isOpen:!0,onClose:()=>s("none"),isEmbedded:!0}),h&&(0,Ue.jsx)(qN,{isOpen:!0,onClose:()=>s("none"),isEmbedded:!0}),p&&(0,Ue.jsx)(p_,{isOpen:!0,onClose:()=>s("none"),isEmbedded:!0}),f&&(0,Ue.jsx)(Ey,{isOpen:!0,onClose:()=>s("none"),isEmbedded:!0,onTransactionComplete:e=>{b(e),setTimeout(()=>b(null),100)}}),m&&(0,Ue.jsx)(yv,{tenantId:(null===V||void 0===V?void 0:V.id)||"",onClose:()=>s("none"),onTransactionComplete:e=>{b(e),setTimeout(()=>b(null),100)}}),g&&(0,Ue.jsx)(ow,{tenantId:(null===V||void 0===V?void 0:V.id)||"",onClose:()=>s("none"),onTransactionComplete:e=>{b(e),setTimeout(()=>b(null),100)}}),x&&(0,Ue.jsx)(y_,{tenantId:(null===V||void 0===V?void 0:V.id)||"",tenantName:(null===V||void 0===V?void 0:V.name)||"",userRole:(null===V||void 0===V?void 0:V.role)||"Owner",onClose:()=>s("none"),isEmbedded:!0})]}),(0,Ue.jsx)("div",{style:{width:"50%",height:"100%"},children:(0,Ue.jsx)(g_,{activeTenant:V,onBack:X,onPanelToggle:e=>s(e),activePanel:i,externalTransactionMessage:v,onPOSPrefillData:k})})]},"".concat(i,"-layout")):(0,Ue.jsx)(yc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},style:{position:"absolute",left:"464px",right:0,top:0,height:"100%",overflow:"hidden"},children:(0,Ue.jsx)(g_,{activeTenant:V,onBack:X,onPanelToggle:e=>s(e),activePanel:i,onPOSPrefillData:k})},"normal-layout")})]}),(0,Ue.jsx)(j_,{isOpen:"devices"===j,onClose:()=>C("chat")}),(0,Ue.jsx)(k_,{isOpen:S,onClose:()=>{E(!1),C("chat")},onScanSuccess:()=>{console.log("[Dashboard] QR scan successful - desktop should be logged in")}}),(0,Ue.jsx)(He,{isOpen:L,onStayHere:z,onGoToBlog:W})]})},S_=()=>{const[e,t]=(0,a.useState)(0);return(0,a.useEffect)(()=>{const e=setInterval(()=>{t(e=>(e+1)%4)},400);return()=>clearInterval(e)},[]),(0,Ue.jsxs)("span",{children:["Scanning",".".repeat(e)]})},E_=()=>{const e=ee(),t=Q(),n=(0,a.useRef)(!0),r=(0,a.useRef)(!1),o=(0,a.useRef)(null),i=(0,a.useRef)(null),s=(0,a.useRef)(null),l=t.state,c=new URLSearchParams(t.search),u=(null===l||void 0===l?void 0:l.context)||c.get("context")||"sale",d=(null===l||void 0===l?void 0:l.tenantId)||c.get("tenant"),h=(null===l||void 0===l?void 0:l.returnTo)||"/app?tenant=".concat(d,"&action=openPurchaseForm"),[p,f]=(0,a.useState)(null),[m,g]=(0,a.useState)(""),[x,y]=(0,a.useState)(!0),[v,b]=(0,a.useState)(!1),[w,k]=(0,a.useState)(null),[j,C]=(0,a.useState)(!1),[N,_]=(0,a.useState)(""),[S,E]=(0,a.useState)(!1),[A,I]=(0,a.useState)(""),T=(0,a.useCallback)(async e=>{if(!n.current||r.current||w)return;const t=e.text;console.log("[Scanner] Barcode detected:",t,"format:",e.format),r.current=!0,k(t),b(!1),o.current&&o.current.stop(),navigator.vibrate&&navigator.vibrate(200),await M(t)},[w]),P=(0,a.useCallback)(async()=>{console.log("[Scanner] Initializing BarcodeScanner..."),y(!0),g("");try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return g("Browser tidak mendukung akses kamera."),f(!1),void y(!1);if(await new Promise(e=>setTimeout(e,100)),!n.current||!i.current)return;const e=new cy(i.current,{desiredWidth:1280,desiredHeight:720,decodeFPS:12,roiResizeLongSide:800,consensusFrames:2});e.onFound(T),e.onProgress(e=>{console.log("[Scanner] Progress:",e.phase),"camera-ready"===e.phase&&(f(!0),b(!0),y(!1))}),e.onError(e=>{console.error("[Scanner] Error:",e),e.message.includes("Permission")||"NotAllowedError"===e.name?g("Akses kamera ditolak. Mohon izinkan akses kamera di pengaturan browser."):"NotFoundError"===e.name?g("Kamera tidak ditemukan. Pastikan perangkat memiliki kamera."):g("Gagal mengakses kamera: ".concat(e.message)),f(!1),y(!1)}),o.current=e,await e.start()}catch(e){if(console.error("[Scanner] Initialization error:",e),!n.current)return;f(!1),y(!1),"NotAllowedError"===e.name?g("Akses kamera ditolak. Mohon izinkan akses kamera di pengaturan browser."):"NotFoundError"===e.name?g("Kamera tidak ditemukan. Pastikan perangkat memiliki kamera."):g("Gagal mengakses kamera: ".concat(e.message||"Unknown error"))}},[T]),D=(0,a.useCallback)(()=>{o.current&&(o.current.stop(),o.current=null),console.log("[Scanner] Cleanup completed")},[]);(0,a.useEffect)(()=>(n.current=!0,r.current=!1,P(),()=>{n.current=!1,D()}),[P,D]);const M=async t=>{C(!0),_("");try{const r=localStorage.getItem("access_token"),a=await fetch("/api/products/barcode/".concat(t,"?tenant_id=").concat(d),{headers:{Authorization:"Bearer ".concat(r)}});if(a.ok){const r=await a.json();if(console.log("[Scanner] Product found:",r),E(!0),C(!1),await new Promise(e=>setTimeout(e,800)),!n.current)return;e(h,{state:{action:"purchase",productData:{name:r.nama_produk||r.name,barcode:t,unit:r.satuan||r.unit,units_per_pack:r.units_per_pack,harga_jual:r.harga_jual,last_price:r.last_price}},replace:!0})}else 404===a.status?(_("Produk tidak ditemukan untuk barcode: ".concat(t)),C(!1)):(_("Gagal mencari produk. Silakan coba lagi."),C(!1))}catch(r){console.error("[Scanner] Product lookup error:",r),_("Gagal mencari produk. Silakan coba lagi."),C(!1)}},R=()=>{A.length>=8&&(r.current=!0,k(A),b(!1),o.current&&o.current.stop(),M(A))};(0,a.useEffect)(()=>{13===A.length&&R()},[A]);const F=()=>{"purchase"===u&&d?e("/app?tenant=".concat(d,"&action=openPurchaseForm"),{replace:!0}):d?e("/app?tenant=".concat(d),{replace:!0}):e(-1)};return(0,Ue.jsxs)("div",{className:"fixed inset-0 bg-gray-900 flex flex-col",children:[(0,Ue.jsxs)("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center gap-3 flex-shrink-0",children:[(0,Ue.jsx)("button",{onClick:F,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors active:bg-gray-200",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsx)("div",{className:"flex-1",children:(0,Ue.jsx)("h1",{className:"font-semibold text-base",children:"Scan Produk"})})]}),(0,Ue.jsxs)("div",{className:"flex-1 relative bg-black",children:[(0,Ue.jsx)("video",{ref:i,className:"absolute inset-0 w-full h-full object-cover",playsInline:!0,muted:!0,autoPlay:!0}),v&&!w&&(0,Ue.jsx)("div",{className:"absolute inset-0 pointer-events-none z-10",children:(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"relative transition-all duration-200",style:{width:"85vw",height:"50vh",maxWidth:"400px",maxHeight:"300px",boxShadow:"0 0 20px ".concat("rgba(255, 255, 255, 0.3)")},children:[(0,Ue.jsx)("div",{className:"absolute top-0 left-0 w-10 h-10 border-t-4 border-l-4 ".concat("border-white/70"," transition-colors")}),(0,Ue.jsx)("div",{className:"absolute top-0 right-0 w-10 h-10 border-t-4 border-r-4 ".concat("border-white/70"," transition-colors")}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-0 w-10 h-10 border-b-4 border-l-4 ".concat("border-white/70"," transition-colors")}),(0,Ue.jsx)("div",{className:"absolute bottom-0 right-0 w-10 h-10 border-b-4 border-r-4 ".concat("border-white/70"," transition-colors")}),(0,Ue.jsx)("div",{className:"absolute left-2 right-2 h-0.5 bg-white/80",style:{boxShadow:"0 0 10px rgba(255, 255, 255, 0.6)",animation:"scanLine 1.5s ease-in-out infinite"}})]})})}),x&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white z-10 bg-black",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("img",{src:"/icons/CAM.png",alt:"Camera",className:"mx-auto mb-3 animate-pulse",style:{width:"48px",height:"48px"}}),(0,Ue.jsx)("p",{children:"Memulai scanner..."})]})}),!x&&!1===p&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white p-6 z-10 bg-black",children:(0,Ue.jsxs)("div",{className:"text-center max-w-md",children:[(0,Ue.jsx)("svg",{className:"w-12 h-12 mx-auto mb-3 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,Ue.jsx)("p",{className:"mb-4",children:m}),(0,Ue.jsxs)("button",{onClick:P,className:"px-6 py-3 bg-amber-500 text-white rounded-lg hover:bg-amber-600 active:bg-amber-700 transition-colors flex items-center gap-2 mx-auto",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Coba Lagi"]}),(0,Ue.jsx)("button",{onClick:F,className:"mt-3 px-6 py-2 text-sm text-gray-400 hover:text-white transition-colors block mx-auto",children:"Kembali"})]})}),w&&(0,Ue.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-30 bg-black/80",children:(0,Ue.jsx)("div",{className:"bg-white rounded-xl p-6 mx-4 max-w-sm w-full shadow-2xl",children:j?(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsxs)("svg",{className:"animate-spin w-8 h-8 mx-auto mb-3 text-gray-600",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Mencari produk..."}),(0,Ue.jsx)("p",{className:"text-xs text-gray-400 mt-1 font-mono",children:w})]}):S?(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("svg",{className:"w-10 h-10 mx-auto mb-3 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,Ue.jsx)("p",{className:"text-sm text-gray-700 font-medium",children:"Produk ditemukan!"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-400 font-mono",children:w})]}):N?(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("svg",{className:"w-10 h-10 mx-auto mb-3 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,Ue.jsx)("p",{className:"text-sm text-gray-700 mb-1",children:N}),(0,Ue.jsx)("p",{className:"text-xs text-gray-400 mb-4 font-mono",children:w}),(0,Ue.jsx)("button",{onClick:async()=>{k(null),_(""),E(!1),I(""),r.current=!1,await P()},className:"w-full px-4 py-2.5 bg-gray-800 text-white rounded-lg text-sm font-medium hover:bg-gray-700",children:"Scan Ulang"})]}):(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("svg",{className:"w-10 h-10 mx-auto mb-3 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,Ue.jsx)("p",{className:"text-sm text-gray-700",children:"Barcode terdeteksi!"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-400 font-mono",children:w})]})})}),(0,Ue.jsx)("style",{children:"\n          @keyframes scanLine {\n            0% { top: 10%; }\n            50% { top: 90%; }\n            100% { top: 10%; }\n          }\n        "}),v&&!w&&(0,Ue.jsx)("div",{className:"absolute bottom-40 left-0 right-0 text-center text-white z-20",children:(0,Ue.jsx)("div",{className:"inline-block px-6 py-3 rounded-full backdrop-blur-sm bg-black/60",children:(0,Ue.jsx)("p",{className:"text-sm font-medium",children:(0,Ue.jsx)(S_,{})})})})]}),!w&&(0,Ue.jsxs)("div",{className:"bg-gray-900 px-4 py-4 flex-shrink-0 border-t border-gray-700",children:[(0,Ue.jsxs)("div",{className:"flex gap-2",children:[(0,Ue.jsx)("input",{ref:s,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:A,onChange:e=>I(e.target.value.replace(/\D/g,"").slice(0,13)),placeholder:"Input barcode manual",className:"flex-1 px-4 py-3 text-center font-mono text-lg bg-gray-800 text-white border border-gray-600 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 placeholder:text-gray-500 placeholder:font-sans placeholder:text-sm",maxLength:13}),(0,Ue.jsx)("button",{onClick:R,disabled:A.length<8,className:"px-5 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 active:bg-amber-700 disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),(0,Ue.jsx)("p",{className:"text-center text-gray-500 text-xs mt-2",children:"Ketik barcode jika kamera tidak terbaca"})]})]})},A_=e=>{let{children:t,className:n="",columns:r=2,rows:a=2,gap:o}=e;const i=a>1?"repeat(".concat(a,", 1fr)"):void 0,s=r>1?"repeat(".concat(r,", 1fr)"):"1fr";return(0,Ue.jsx)("div",{className:"card-grid ".concat(n),style:{display:"grid",gridTemplateColumns:s,gridTemplateRows:i,gap:o||Pc,padding:"0 ".concat(Dc," 4px"),flex:1,minHeight:0},children:t})},I_=e=>{let{title:t,children:n,className:r="",style:a}=e;return(0,Ue.jsxs)("div",{className:"card ".concat(r),style:tt({background:kc,borderRadius:Vc,overflow:"hidden",boxShadow:Uc,display:"flex",flexDirection:"column"},a),children:[(0,Ue.jsx)("div",{className:"card-header",style:{padding:Tc,borderBottom:"1px solid ".concat(bc),background:_c,fontSize:Mc,fontWeight:Bc,color:wc,flexShrink:0},children:t}),(0,Ue.jsx)("div",{className:"card-content",style:{flex:1,display:"flex",flexDirection:"column"},children:n})]})},T_=e=>{let{variant:t="white",children:n,onClick:r,rightElement:a,selected:o=!1,style:i}=e;const s=o?Sc:"white"===t?Ec:Ac;return(0,Ue.jsxs)("div",{className:"card-row",onClick:r,style:tt({flex:1,display:"flex",alignItems:"center",justifyContent:a?"space-between":"flex-start",background:s,padding:Ic,cursor:r?"pointer":"default",borderBottom:o?"2px solid ".concat(vc):"none"},i),children:[(0,Ue.jsx)("div",{style:{flex:1},children:n}),a&&(0,Ue.jsx)("div",{className:"card-row-right",style:{flexShrink:0,marginLeft:"8px"},children:a})]})},P_=e=>{let{label:t,value:n,prefix:r,suffix:a,color:o,showEditIcon:i=!1,onEdit:s,large:l=!1,labelColor:c,clickable:u=!1}=e;const d="number"===typeof n?(e=>e.toLocaleString("id-ID"))(n):n,h=u||s;return(0,Ue.jsxs)("div",{className:"editable-value",onClick:h?()=>{s&&s()}:void 0,style:{textAlign:"left",cursor:h?"pointer":"default"},children:[(0,Ue.jsx)("div",{className:"editable-value-label",style:{fontSize:Rc,color:c||wc,lineHeight:Wc},children:t}),(0,Ue.jsxs)("div",{className:"editable-value-content",style:{fontSize:l?Oc:Fc,fontWeight:Lc,color:o||jc,lineHeight:zc},children:[i&&(0,Ue.jsxs)("span",{className:"edit-icon",onClick:e=>{e.stopPropagation(),s&&s()},style:{cursor:"pointer",marginRight:"2px"},children:["\u270e"," "]}),r&&(0,Ue.jsxs)("span",{children:[r," "]}),(0,Ue.jsx)("span",{children:d}),a&&(0,Ue.jsxs)("span",{children:[" ",a]})]})]})},D_=()=>{const e=ee(),[t,n]=(0,a.useState)(15e4),[r,o]=(0,a.useState)(5),[i,s]=(0,a.useState)(3),[l,c]=(0,a.useState)("tunai"),u=15e4,d=u-Math.round(u*(r/100)),h=t-d,p=d;return(0,Ue.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100vh",background:"#E5E5E5",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif"},children:[(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#E5E5E5",flexShrink:0},children:[(0,Ue.jsx)("button",{onClick:()=>e(-1),style:{width:"40px",height:"40px",borderRadius:"8px",border:"none",background:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,Ue.jsx)("svg",{width:"20",height:"20",fill:"none",stroke:"#262626",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsx)("span",{style:{fontSize:"18px",fontWeight:600,color:"#262626"},children:"UI Components Test"})]}),(0,Ue.jsxs)(A_,{children:[(0,Ue.jsxs)(I_,{title:"Membership",children:[(0,Ue.jsx)(T_,{variant:"white",children:(0,Ue.jsx)(P_,{label:"Member",value:"Budi Santoso"})}),(0,Ue.jsx)(T_,{variant:"gray",children:(0,Ue.jsx)(P_,{label:"Points",value:150,suffix:"pts",color:Cc})}),(0,Ue.jsx)(T_,{variant:"white",children:(0,Ue.jsx)(P_,{label:"Total Transaksi",value:"25x"})})]}),(0,Ue.jsxs)(I_,{title:"Purchase",children:[(0,Ue.jsx)(T_,{variant:"white",children:(0,Ue.jsx)(P_,{label:"Sub Total",value:u,prefix:"Rp"})}),(0,Ue.jsx)(T_,{variant:"gray",rightElement:(0,Ue.jsx)("button",{onClick:()=>o(e=>Math.min(100,e+5)),style:{width:"28px",height:"28px",borderRadius:"50%",background:"#6B7280",color:"white",border:"none",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),children:(0,Ue.jsx)(P_,{label:"Discount",value:"".concat(r,"%"),clickable:!0,onEdit:()=>alert("Edit discount: ".concat(r,"%"))})}),(0,Ue.jsx)(T_,{variant:"white",children:(0,Ue.jsx)(P_,{label:"Total",value:d,prefix:"Rp",large:!0})})]}),(0,Ue.jsxs)(I_,{title:"Description",children:[(0,Ue.jsx)(T_,{variant:"white",children:(0,Ue.jsx)(P_,{label:"Bayar",value:t,prefix:"Rp",showEditIcon:!0,onEdit:()=>{const e=prompt("Masukkan jumlah bayar:",t.toString());e&&n(parseInt(e)||t)}})}),(0,Ue.jsx)(T_,{variant:"gray",children:(0,Ue.jsx)(P_,{label:"Kembalian",value:Math.max(0,h),prefix:"Rp",color:h>=0?jc:Nc})}),(0,Ue.jsx)(T_,{variant:"white",children:(0,Ue.jsx)(P_,{label:"Update Kas Toko",value:d,prefix:"Rp",color:Cc})})]}),(0,Ue.jsxs)(I_,{title:"Payment Methods",children:[(0,Ue.jsx)(T_,{variant:"white",selected:"qris"===l,onClick:()=>c("qris"),children:(0,Ue.jsx)(P_,{label:"Qris/Transfer",value:d,prefix:"Rp"})}),(0,Ue.jsx)(T_,{variant:"gray",selected:"tunai"===l,onClick:()=>c("tunai"),rightElement:(0,Ue.jsx)("button",{onClick:e=>{e.stopPropagation(),n(e=>e+1e4)},style:{width:"28px",height:"28px",borderRadius:"50%",background:"#6B7280",color:"white",border:"none",fontSize:"16px",cursor:"pointer"},children:"+"}),children:(0,Ue.jsx)(P_,{label:"Tunai",value:t,prefix:"Rp",showEditIcon:!0,onEdit:()=>{const e=prompt("Masukkan jumlah tunai:",t.toString());e&&n(parseInt(e)||t)}})}),(0,Ue.jsx)(T_,{variant:"white",selected:"hutang"===l,onClick:()=>c("hutang"),children:(0,Ue.jsx)(P_,{label:"Hutang",value:p,prefix:"Rp",showEditIcon:!0,onEdit:()=>alert("Edit hutang")})})]})]}),(0,Ue.jsx)("div",{style:{padding:"16px",background:"#E5E5E5",flexShrink:0},children:(0,Ue.jsxs)("button",{onClick:()=>alert("Bayar clicked!"),style:{width:"100%",padding:"16px",background:vc,color:"white",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:700,cursor:"pointer"},children:["Bayar - Rp ",d.toLocaleString("id-ID")]})})]})};class M_{constructor(e,t){this.ws=null,this.token=void 0,this.onEvent=void 0,this.reconnectAttempts=0,this.maxReconnectAttempts=3,this.pingInterval=null,this.token=e,this.onEvent=t}connect(){const e="https:"===window.location.protocol?"wss:":"ws:",t="".concat(e,"//").concat(window.location.host,"/api/auth/qr/ws/").concat(this.token);console.log("[QRWebSocket] Connecting to:",t),this.ws=new WebSocket(t),this.ws.onopen=()=>{console.log("[QRWebSocket] Connected"),this.reconnectAttempts=0,this.startPing()},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);console.log("[QRWebSocket] Event received:",t.event),this.onEvent(t),"approved"!==t.event&&"rejected"!==t.event&&"expired"!==t.event||this.disconnect()}catch(Z_){console.error("[QRWebSocket] Failed to parse message:",Z_)}},this.ws.onerror=e=>{console.error("[QRWebSocket] Error:",e),this.onEvent({event:"error",message:"WebSocket connection error"})},this.ws.onclose=e=>{console.log("[QRWebSocket] Closed:",e.code,e.reason),this.stopPing(),1e3!==e.code&&this.reconnectAttempts<this.maxReconnectAttempts&&(this.reconnectAttempts++,console.log("[QRWebSocket] Reconnecting... attempt ".concat(this.reconnectAttempts)),setTimeout(()=>this.connect(),2e3))}}startPing(){this.pingInterval=setInterval(()=>{var e;(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&this.ws.send(JSON.stringify({event:"ping"}))},3e4)}stopPing(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=null)}disconnect(){this.stopPing(),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null)}isConnected(){var e;return(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN}}const R_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return"https://api.qrserver.com/v1/create-qr-code/?size=".concat(t,"x").concat(t,"&data=").concat(encodeURIComponent(e))},F_=()=>{const e=ee(),[t]=Se(),[n,r]=(0,a.useState)("loading"),[o,i]=(0,a.useState)(null),[s,l]=(0,a.useState)("Memuat QR code..."),[c,u]=(0,a.useState)(120),d=(0,a.useRef)(null),h=(0,a.useRef)(null),p=t.get("reason"),f=(0,a.useCallback)(async()=>{r("loading"),l("Memuat QR code...");try{const e=Fe(),t=Oe(),n=await fetch("/api/auth/qr/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fingerprint:e,browser_id:t})});if(!n.ok)throw new Error("Failed to generate QR code");const a=await n.json();if(a.success)return i({token:a.token,qr_url:a.qr_url,expires_at:a.expires_at,ttl_seconds:a.ttl_seconds}),u(a.ttl_seconds),r("ready"),l("Scan QR code dengan perangkat mobile Anda"),a.token;throw new Error(a.detail||"Failed to generate QR code")}catch(e){return console.error("QR generation error:",e),r("error"),l("Gagal memuat QR code. Klik untuk coba lagi."),null}},[]),m=(0,a.useCallback)(t=>{switch(t.event){case"connected":console.log("WebSocket connected");break;case"scanned":r("scanned"),l("QR code di-scan! Menunggu konfirmasi dari mobile...");break;case"approved":r("approved"),l("Login berhasil! Mengalihkan..."),Ie(t.access_token,t.refresh_token),t.device_id&&localStorage.setItem("device_id",t.device_id),t.user&&localStorage.setItem("user_info",JSON.stringify(t.user)),setTimeout(()=>{e("/")},500);break;case"rejected":r("rejected"),l("Login ditolak oleh pengguna mobile"),setTimeout(()=>f(),3e3);break;case"expired":r("expired"),l("QR code kadaluarsa. Klik untuk generate baru.");break;case"error":r("error"),l("Terjadi kesalahan koneksi")}},[e,f]);(0,a.useEffect)(()=>{let e=!0;return(async()=>{const t=await f();t&&e&&(d.current=new M_(t,m),d.current.connect())})(),()=>{var t;e=!1,null===(t=d.current)||void 0===t||t.disconnect(),h.current&&clearInterval(h.current)}},[f,m]),(0,a.useEffect)(()=>("ready"===n&&c>0&&(h.current=setInterval(()=>{u(e=>e<=1?(r("expired"),l("QR code kadaluarsa. Klik untuk generate baru."),0):e-1)},1e3)),()=>{h.current&&clearInterval(h.current)}),[n]);const g=async()=>{if("expired"===n||"error"===n||"rejected"===n){var e;null===(e=d.current)||void 0===e||e.disconnect();const t=await f();t&&(d.current=new M_(t,m),d.current.connect())}};return(0,Ue.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-white flex items-center justify-center p-4",children:(0,Ue.jsxs)("div",{className:"max-w-md w-full",children:[(0,Ue.jsxs)("div",{className:"text-center mb-8",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-700 rounded-2xl mx-auto flex items-center justify-center shadow-lg mb-4",children:(0,Ue.jsx)("span",{className:"text-white text-3xl font-bold",children:"m"})}),(0,Ue.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"MilkyHoop"}),(0,Ue.jsx)("p",{className:"text-gray-500 mt-1",children:"Login dengan QR Code"})]}),p&&(0,Ue.jsxs)("div",{className:"mb-6 p-3 bg-amber-50 border border-amber-200 rounded-lg text-amber-800 text-sm text-center",children:["logged_out_remotely"===p&&"Sesi Anda telah diakhiri dari perangkat lain.","session_expired"===p&&"Sesi Anda telah berakhir. Silakan login kembali."]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-6",children:[(0,Ue.jsx)("div",{className:"relative",children:"ready"===n&&o?(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("img",{src:R_(o.qr_url,250),alt:"QR Code",className:"w-full max-w-[250px] mx-auto rounded-lg"}),(0,Ue.jsx)("div",{className:"absolute top-2 right-2 bg-white/90 px-2 py-1 rounded-full text-sm font-medium text-gray-600",children:(e=>{const t=Math.floor(e/60),n=e%60;return"".concat(t,":").concat(n.toString().padStart(2,"0"))})(c)})]}):(0,Ue.jsx)("div",{className:"w-full aspect-square max-w-[250px] mx-auto rounded-lg bg-gray-100 flex items-center justify-center ".concat("expired"===n||"error"===n?"cursor-pointer hover:bg-gray-200":""),onClick:g,children:(()=>{switch(n){case"loading":return(0,Ue.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-purple-200 border-t-purple-600 rounded-full"});case"scanned":return(0,Ue.jsx)("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-yellow-600 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})});case"approved":return(0,Ue.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})});case"rejected":return(0,Ue.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})});case"expired":case"error":return(0,Ue.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center cursor-pointer hover:bg-gray-200",onClick:g,children:(0,Ue.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})});default:return null}})()})}),(0,Ue.jsx)("div",{className:"mt-6 text-center",children:(0,Ue.jsx)("p",{className:"font-medium ".concat("approved"===n?"text-green-600":"rejected"===n||"error"===n?"text-red-600":"text-gray-700"),children:s})}),(0,Ue.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[(0,Ue.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Cara login:"}),(0,Ue.jsxs)("ol",{className:"text-sm text-gray-600 space-y-2",children:[(0,Ue.jsxs)("li",{className:"flex items-start",children:[(0,Ue.jsx)("span",{className:"w-5 h-5 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 text-xs font-medium mr-2 mt-0.5",children:"1"}),(0,Ue.jsx)("span",{children:"Buka MilkyHoop di HP Anda"})]}),(0,Ue.jsxs)("li",{className:"flex items-start",children:[(0,Ue.jsx)("span",{className:"w-5 h-5 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 text-xs font-medium mr-2 mt-0.5",children:"2"}),(0,Ue.jsx)("span",{children:'Tap menu "Hubungkan Perangkat"'})]}),(0,Ue.jsxs)("li",{className:"flex items-start",children:[(0,Ue.jsx)("span",{className:"w-5 h-5 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 text-xs font-medium mr-2 mt-0.5",children:"3"}),(0,Ue.jsx)("span",{children:"Scan QR code ini dengan kamera HP"})]}),(0,Ue.jsxs)("li",{className:"flex items-start",children:[(0,Ue.jsx)("span",{className:"w-5 h-5 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 text-xs font-medium mr-2 mt-0.5",children:"4"}),(0,Ue.jsx)("span",{children:"Konfirmasi login di HP Anda"})]})]})]})]}),(0,Ue.jsxs)("p",{className:"text-center text-sm text-gray-500 mt-6",children:["Belum punya akun?"," ",(0,Ue.jsx)("a",{href:"https://milkyhoop.com",className:"text-purple-600 hover:underline",children:"Daftar di HP"})]})]})})},O_=()=>{var e;const t=ee(),n=(null===(e=Q().state)||void 0===e?void 0:e.initialMessage)||"",[r,o]=(0,a.useState)([]),[i,s]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1);(0,a.useEffect)(()=>{n&&u(n)},[]);const u=async e=>{if(!e.trim())return;const t={id:Date.now().toString(),text:e,sender:"user",timestamp:new Date};o(e=>[...e,t]),s(""),c(!0);try{await new Promise(e=>setTimeout(e,1e3));const e={id:(Date.now()+1).toString(),text:"Hai! Saya Milky \ud83d\ude0a Saya sedang dalam tahap development untuk setup mode. Fitur ini akan segera hadir untuk membantu kamu membuat akun dan generate URL unik untuk bisnis kamu!",sender:"milky",timestamp:new Date};o(t=>[...t,e])}catch(n){console.error("Error:",n)}finally{c(!1)}};return(0,Ue.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[(0,Ue.jsxs)("header",{className:"bg-white shadow-sm border-b px-4 py-3 flex items-center space-x-3",children:[(0,Ue.jsx)("button",{onClick:()=>t("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-purple-700 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-white font-bold",children:"m"})}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h1",{className:"font-semibold text-gray-900",children:"Milky - Setup Assistant"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500",children:"Bantu kamu setup bisnis"})]})]}),(0,Ue.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 py-6 space-y-4",children:[0===r.length&&(0,Ue.jsxs)("div",{className:"text-center text-gray-500 mt-8",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-purple-100 rounded-full mx-auto mb-4 flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-3xl",children:"\ud83d\udc4b"})}),(0,Ue.jsx)("p",{className:"text-sm",children:"Hai! Ada yang bisa Milky bantu?"})]}),r.map(e=>(0,Ue.jsx)("div",{className:"flex ".concat("user"===e.sender?"justify-end":"justify-start"),children:(0,Ue.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-3 rounded-2xl ".concat("user"===e.sender?"bg-purple-600 text-white":"bg-white text-gray-800 shadow-sm"),children:[(0,Ue.jsx)("p",{className:"text-sm leading-relaxed",children:e.text}),(0,Ue.jsx)("p",{className:"text-xs mt-1 ".concat("user"===e.sender?"text-purple-200":"text-gray-400"),children:e.timestamp.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})})]})},e.id)),l&&(0,Ue.jsx)("div",{className:"flex justify-start",children:(0,Ue.jsx)("div",{className:"bg-white rounded-2xl px-4 py-3 shadow-sm",children:(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce"}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})})]}),(0,Ue.jsx)("div",{className:"bg-white border-t px-4 py-3",children:(0,Ue.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,Ue.jsx)("div",{className:"flex items-center space-x-3",children:(0,Ue.jsxs)("div",{className:"flex-1 relative",children:[(0,Ue.jsx)("input",{value:i,onChange:e=>s(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u(i))},placeholder:"Ketik pesan...",disabled:l,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-purple-500 disabled:bg-gray-100"}),(0,Ue.jsx)("button",{onClick:()=>u(i),disabled:!i.trim()||l,className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})})})]})},B_=()=>{const e=ee(),[t,n]=a.useState(""),r=t=>{t.trim()&&e("/konsultanpsikologi/chat",{state:{initialMessage:t.trim()}})};return(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,Ue.jsx)("button",{onClick:()=>e("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:"Konsultan Psikologi"}),(0,Ue.jsx)("div",{className:"w-8 h-8 bg-purple-400 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"})})})]}),(0,Ue.jsx)("div",{className:"w-6"})]})}),(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 pb-24",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-purple-600 rounded-xl flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-purple-600 font-bold text-sm",children:"KP"})})}),(0,Ue.jsx)("div",{children:(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Konsultan Psikologi"})})]}),(0,Ue.jsx)("div",{className:"relative mb-6",children:(0,Ue.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-purple-800 rounded-lg p-8 text-white",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Layanan Konseling Profesional"}),(0,Ue.jsx)("p",{className:"text-purple-100",children:"Solusi kesehatan mental terpercaya"})]}),(0,Ue.jsx)("div",{className:"w-32 h-20 bg-white/20 rounded-lg flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-16 h-10 bg-white/30 rounded mb-2"}),(0,Ue.jsx)("div",{className:"text-xs",children:"Konseling"})]})})]})})})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[{title:"Konseling Individu",desc:"Rp 150.000/sesi"},{title:"Konseling Pasangan",desc:"Rp 250.000/sesi"},{title:"Konseling Keluarga",desc:"Rp 300.000/sesi"},{title:"Konseling Online",desc:"Fleksibel"}].map((e,t)=>(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,Ue.jsx)("div",{className:"w-full h-24 bg-gradient-to-br from-purple-500 to-purple-700 rounded-lg mb-3 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-white text-sm font-medium text-center",children:e.title})}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:e.desc})]},t))})]}),(0,Ue.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 shadow-lg",children:(0,Ue.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-purple-400 rounded-full flex items-center justify-center flex-shrink-0",children:(0,Ue.jsx)("span",{className:"text-white font-bold text-sm",children:"m"})}),(0,Ue.jsxs)("div",{className:"flex-1 relative",children:[(0,Ue.jsx)("input",{value:t,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),r(t))},placeholder:"Chat dengan konsultan...",className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),(0,Ue.jsx)("button",{onClick:()=>r(t),disabled:!t.trim(),className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})})})]})},L_=()=>{const e=ee(),t=Q(),[n,r]=(0,a.useState)([]),[o,i]=(0,a.useState)(""),[s,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)(!0),[p,f]=(0,a.useState)(!1),m=(0,a.useRef)(null);(0,a.useEffect)(()=>{(()=>{var e;null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[n]),(0,a.useEffect)(()=>{(async()=>{if(De())try{const e=await Qc("konsultanpsikologi");u(e)}catch(e){console.error("Access check failed:",e),u(!1)}else u(!1);h(!1)})()},[]),(0,a.useEffect)(()=>{var e;const n=null===(e=t.state)||void 0===e?void 0:e.initialMessage;n&&!d&&g(n)},[t.state,d]);const g=async e=>{if(!e.trim()||s)return;const t={id:Date.now().toString(),text:e,isUser:!0,timestamp:new Date};r(e=>[...e,t]),i(""),l(!0);try{let t;if(c)t=await $c("konsultanpsikologi",e);else{const n=await fetch("/tenant/konsultanpsikologi/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});t=await n.json()}const n={id:(Date.now()+1).toString(),text:t.milky_response||t.message||"Maaf, terjadi kesalahan.",isUser:!1,timestamp:new Date};r(e=>[...e,n])}catch(n){console.error("Error sending message:",n);const e={id:(Date.now()+1).toString(),text:"Maaf, terjadi kesalahan. Silakan coba lagi.",isUser:!1,timestamp:new Date};r(t=>[...t,e])}finally{l(!1)}};return d?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):(0,Ue.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[(0,Ue.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,Ue.jsx)("button",{onClick:()=>e("/konsultanpsikologi"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:"Konsultan Psikologi"}),c&&(0,Ue.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded-full",children:"Tenant Mode"})]}),c?(0,Ue.jsx)("button",{onClick:()=>{Me(),window.location.reload()},className:"px-4 py-2 bg-gray-600 text-white rounded-lg text-sm font-medium hover:bg-gray-700",children:"Logout"}):(0,Ue.jsx)("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700",children:"Login"})]})}),c&&(0,Ue.jsx)("div",{className:"bg-purple-50 border-b border-purple-100 px-4 py-3",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center space-x-2 overflow-x-auto",children:[(0,Ue.jsx)("button",{onClick:()=>g("produk apa yang paling laku?"),className:"px-4 py-2 bg-white border border-purple-200 rounded-lg text-sm font-medium text-purple-700 hover:bg-purple-50 whitespace-nowrap",children:"\ud83d\udcca Top Products"}),(0,Ue.jsx)("button",{onClick:()=>g("produk mana yang kurang laku?"),className:"px-4 py-2 bg-white border border-purple-200 rounded-lg text-sm font-medium text-purple-700 hover:bg-purple-50 whitespace-nowrap",children:"\u26a0\ufe0f Low Sellers"}),(0,Ue.jsx)("button",{onClick:()=>g("cek stok ballpoint"),className:"px-4 py-2 bg-white border border-purple-200 rounded-lg text-sm font-medium text-purple-700 hover:bg-purple-50 whitespace-nowrap",children:"\ud83d\udce6 Check Stock"}),(0,Ue.jsx)("button",{onClick:()=>g("untung bulan ini berapa?"),className:"px-4 py-2 bg-white border border-purple-200 rounded-lg text-sm font-medium text-purple-700 hover:bg-purple-50 whitespace-nowrap",children:"\ud83d\udcb0 Monthly Profit"})]})}),(0,Ue.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto space-y-4",children:[n.map(e=>(0,Ue.jsx)("div",{className:"flex ".concat(e.isUser?"justify-end":"justify-start"),children:(0,Ue.jsxs)("div",{className:"max-w-[80%] rounded-2xl px-4 py-3 ".concat(e.isUser?"bg-purple-600 text-white":"bg-white text-gray-800 shadow-sm"),children:[(0,Ue.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.text}),(0,Ue.jsx)("p",{className:"text-xs mt-1 ".concat(e.isUser?"text-purple-200":"text-gray-400"),children:e.timestamp.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})})]})},e.id)),s&&(0,Ue.jsx)("div",{className:"flex justify-start",children:(0,Ue.jsx)("div",{className:"bg-white rounded-2xl px-4 py-3 shadow-sm",children:(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),(0,Ue.jsx)("div",{ref:m})]})}),(0,Ue.jsx)("div",{className:"bg-white border-t p-4",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto flex items-end space-x-3",children:[(0,Ue.jsx)("div",{className:"flex-1",children:(0,Ue.jsx)("textarea",{value:o,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g(o))},placeholder:"Ketik pesan Anda...",className:"w-full px-4 py-3 border border-gray-300 rounded-2xl resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:1,disabled:s})}),(0,Ue.jsx)("button",{onClick:()=>g(o),disabled:!o.trim()||s,className:"w-12 h-12 bg-purple-400 text-white rounded-full flex items-center justify-center hover:bg-purple-500 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})}),(0,Ue.jsx)(Ge,{isOpen:p,onClose:()=>f(!1),onLoginSuccess:async()=>{f(!1),h(!0);try{const e=await Qc("konsultanpsikologi");u(e)}catch(e){console.error("Access check failed:",e),u(!1)}h(!1)}})]})},z_=()=>{const e=ee(),{tenantId:t}=te(),[n,r]=(0,a.useState)(""),[o,i]=(0,a.useState)(null),[s,l]=(0,a.useState)(!0),[c,u]=(0,a.useState)("");(0,a.useEffect)(()=>{console.log("[DEBUG] useEffect triggered, tenantId:",t);(async()=>{if(t){console.log("[DEBUG] Starting fetch for tenant:",t);try{const e=await fetch("".concat("https://dev.milkyhoop.com","/api/tenant/").concat(t,"/info"));if(console.log("[DEBUG] Response status:",e.status,"ok:",e.ok),!e.ok)throw new Error("Tenant not found");const n=await e.json();console.log("[DEBUG] Data received:",n);let r=n.data.menu_items;if("string"===typeof r)try{r=JSON.parse(r)}catch(Z_){console.log("[DEBUG] Failed to parse menu_items, using empty array"),r=[]}const a=tt(tt({},n.data),{},{menu_items:Array.isArray(r)?r:[]});console.log("[DEBUG] Setting tenant info:",a),i(a)}catch(e){console.error("[DEBUG] Error in fetchTenantInfo:",e),u("Tenant not found")}finally{console.log("[DEBUG] Fetch complete, setting loading to false"),l(!1)}}else console.log("[DEBUG] No tenantId provided")})()},[t]);const d=n=>{n.trim()&&e("/".concat(t,"/chat"),{state:{initialMessage:n.trim()}})};return s?(console.log("[DEBUG] Rendering loading state"),(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})})):c||!o?(console.log("[DEBUG] Rendering error state. error:",c,"tenantInfo:",o),(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"404"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Tenant not found"}),(0,Ue.jsx)("button",{onClick:()=>e("/"),className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Go Home"})]})})):(console.log("[DEBUG] Rendering main content with tenant:",o),(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,Ue.jsx)("button",{onClick:()=>e("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:o.display_name}),(0,Ue.jsx)("div",{className:"w-8 h-8 bg-purple-400 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-white font-bold text-sm",children:o.display_name.substring(0,2).toUpperCase()})})]}),(0,Ue.jsx)("div",{className:"w-6"})]})}),(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 pb-24",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-purple-600 rounded-xl flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-purple-600 font-bold text-sm",children:o.display_name.substring(0,2).toUpperCase()})})}),(0,Ue.jsx)("div",{children:(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:o.display_name})})]}),(0,Ue.jsx)("div",{className:"relative mb-6",children:(0,Ue.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-purple-800 rounded-lg p-8 text-white",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsxs)("h3",{className:"text-xl font-semibold mb-2",children:["Welcome to ",o.display_name]}),(0,Ue.jsx)("p",{className:"text-purple-100",children:"Chat with us to get started"})]}),(0,Ue.jsx)("div",{className:"w-32 h-20 bg-white/20 rounded-lg flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-16 h-10 bg-white/30 rounded mb-2"}),(0,Ue.jsx)("div",{className:"text-xs",children:"Chat Now"})]})})]})})})]}),o.menu_items&&o.menu_items.length>0?(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-4 mb-8",children:o.menu_items.map((e,t)=>(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,Ue.jsx)("div",{className:"w-full h-24 bg-gradient-to-br from-purple-500 to-purple-700 rounded-lg mb-3 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-white text-sm font-medium text-center",children:e.name||e.service||"Item"})}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:e.price?"Rp ".concat(e.price.toLocaleString()):e.desc||"Available"})]},t))}):(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[{title:"Product 1",desc:"Available"},{title:"Product 2",desc:"Available"},{title:"Product 3",desc:"Available"},{title:"Product 4",desc:"Available"}].map((e,t)=>(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,Ue.jsx)("div",{className:"w-full h-24 bg-gradient-to-br from-purple-500 to-purple-700 rounded-lg mb-3 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-white text-sm font-medium text-center",children:e.title})}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:e.desc})]},t))})]}),(0,Ue.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 shadow-lg",children:(0,Ue.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-purple-400 rounded-full flex items-center justify-center flex-shrink-0",children:(0,Ue.jsx)("span",{className:"text-white font-bold text-sm",children:"m"})}),(0,Ue.jsxs)("div",{className:"flex-1 relative",children:[(0,Ue.jsx)("input",{value:n,onChange:e=>r(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d(n))},placeholder:"Chat dengan ".concat(o.display_name,"..."),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),(0,Ue.jsx)("button",{onClick:()=>d(n),disabled:!n.trim(),className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})})})]}))};function W_(e){let{content:t}=e;return(0,Ue.jsx)("p",{className:"text-sm whitespace-pre-wrap",style:{fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:t})}function V_(e){let{content:t}=e;return(0,Ue.jsx)("div",{className:"text-sm text-left whitespace-pre-wrap",style:{fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',fontVariantNumeric:"tabular-nums"},children:t})}function U_(e){let{message:t}=e;const n=t.isFromUser,r="financial_report"===t.type||t.text.includes("\u251c\u2500")||t.text.includes("\u2514\u2500"),a=t.text.includes("<table")||t.text.includes("<div")||t.text.includes("<br");return(0,Ue.jsxs)("div",{className:"flex flex-col mb-4 ".concat(n?"items-end":"items-start"),children:[(0,Ue.jsx)("div",{className:"rounded-2xl px-4 py-2 max-w-[80%] ".concat(n?"bg-purple-600 text-white ml-auto":"bg-gray-100 text-gray-900 mr-auto"),children:a?(0,Ue.jsx)("div",{dangerouslySetInnerHTML:{__html:t.text},className:"text-sm leading-relaxed"}):r?(0,Ue.jsx)(V_,{content:t.text}):(0,Ue.jsx)(W_,{content:t.text})}),t.timestamp&&(0,Ue.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:t.timestamp})]})}const H_=()=>{const e=ee(),t=Q(),{tenantId:n}=te(),[r,o]=(0,a.useState)([]),[i,s]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!0),[f,m]=(0,a.useState)(!1),[g,x]=(0,a.useState)(null),y=(0,a.useRef)(null);(0,a.useEffect)(()=>{(()=>{var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[r]),(0,a.useEffect)(()=>{(async()=>{if(n)try{const e=await fetch("/api/tenant/".concat(n,"/info"));if(e.ok){const t=await e.json();x(t.data)}}catch(e){console.error("Failed to fetch tenant info:",e)}})()},[n]),(0,a.useEffect)(()=>{(async()=>{if(n){if(De())try{const e=await Qc(n);d(e)}catch(e){console.error("Access check failed:",e),d(!1)}else d(!1);p(!1)}else p(!1)})()},[n]),(0,a.useEffect)(()=>{var e;const n=null===(e=t.state)||void 0===e?void 0:e.initialMessage;n&&!h&&v(n)},[t.state,h]);const v=async e=>{if(!e.trim()||l||!n)return;const t={id:Date.now().toString(),text:e,isUser:!0,timestamp:new Date};o(e=>[...e,t]),s(""),c(!0);try{let t;if(u)t=await $c(n,e);else{const r=await fetch("/tenant/".concat(n,"/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});t=await r.json()}const r={id:(Date.now()+1).toString(),text:t.milky_response||t.message||"Maaf, terjadi kesalahan.",isUser:!1,timestamp:new Date};o(e=>[...e,r])}catch(r){console.error("Error sending message:",r);const e={id:(Date.now()+1).toString(),text:"Maaf, terjadi kesalahan. Silakan coba lagi.",isUser:!1,timestamp:new Date};o(t=>[...t,e])}finally{c(!1)}};return h?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):(0,Ue.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[(0,Ue.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,Ue.jsx)("button",{onClick:()=>e("/".concat(n)),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("h1",{className:"text-xl font-bold",children:(null===g||void 0===g?void 0:g.display_name)||"Chat"}),u&&(0,Ue.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded-full",children:"Tenant Mode"})]}),u?(0,Ue.jsx)("button",{onClick:()=>{Me(),window.location.reload()},className:"px-4 py-2 bg-gray-600 text-white rounded-lg text-sm font-medium hover:bg-gray-700",children:"Logout"}):(0,Ue.jsx)("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700",children:"Login"})]})}),u&&(0,Ue.jsx)("div",{className:"bg-purple-50 border-b border-purple-100 px-4 py-3",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center space-x-2 overflow-x-auto",children:[(0,Ue.jsx)("button",{onClick:()=>v("produk apa yang paling laku?"),className:"px-4 py-2 bg-white border border-purple-200 rounded-lg text-sm font-medium text-purple-700 hover:bg-purple-50 whitespace-nowrap",children:"\ud83d\udcca Top Products"}),(0,Ue.jsx)("button",{onClick:()=>v("produk mana yang kurang laku?"),className:"px-4 py-2 bg-white border border-purple-200 rounded-lg text-sm font-medium text-purple-700 hover:bg-purple-50 whitespace-nowrap",children:"\u26a0\ufe0f Low Sellers"}),(0,Ue.jsx)("button",{onClick:()=>v("cek stok ballpoint"),className:"px-4 py-2 bg-white border border-purple-200 rounded-lg text-sm font-medium text-purple-700 hover:bg-purple-50 whitespace-nowrap",children:"\ud83d\udce6 Check Stock"}),(0,Ue.jsx)("button",{onClick:()=>v("untung bulan ini berapa?"),className:"px-4 py-2 bg-white border border-purple-200 rounded-lg text-sm font-medium text-purple-700 hover:bg-purple-50 whitespace-nowrap",children:"\ud83d\udcb0 Monthly Profit"})]})}),(0,Ue.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto space-y-4",children:[r.map(e=>(0,Ue.jsx)(U_,{message:{text:e.text,isFromUser:e.isUser,timestamp:e.timestamp.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}},e.id)),l&&(0,Ue.jsx)("div",{className:"flex justify-start",children:(0,Ue.jsx)("div",{className:"bg-white rounded-2xl px-4 py-3 shadow-sm",children:(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),(0,Ue.jsx)("div",{ref:y})]})}),(0,Ue.jsx)("div",{className:"bg-white border-t p-4",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto flex items-end space-x-3",children:[(0,Ue.jsx)("div",{className:"flex-1",children:(0,Ue.jsx)("textarea",{value:i,onChange:e=>s(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v(i))},placeholder:"Ketik pesan Anda...",className:"w-full px-4 py-3 border border-gray-300 rounded-2xl resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:1,disabled:l})}),(0,Ue.jsx)("button",{onClick:()=>v(i),disabled:!i.trim()||l,className:"w-12 h-12 bg-purple-400 text-white rounded-full flex items-center justify-center hover:bg-purple-500 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})}),(0,Ue.jsx)(Ge,{isOpen:f,onClose:()=>m(!1),onLoginSuccess:async()=>{if(m(!1),p(!0),n)try{const e=await Qc(n);d(e)}catch(e){console.error("Access check failed:",e),d(!1)}p(!1)}})]})},G_=e=>{let{children:t}=e;return Re()&&!De()?(0,Ue.jsx)(me,{to:"/login",replace:!0}):(0,Ue.jsx)(Ue.Fragment,{children:t})},K_=e=>{let{children:t}=e;return De()?(0,Ue.jsx)(me,{to:"/",replace:!0}):Re()?(0,Ue.jsx)(Ue.Fragment,{children:t}):(0,Ue.jsx)(me,{to:"/",replace:!0})},X_=()=>Re()&&De()?(0,Ue.jsx)(__,{}):Re()&&!De()?(0,Ue.jsx)(me,{to:"/login",replace:!0}):De()?(0,Ue.jsx)(__,{}):(0,Ue.jsx)(Ke,{});const Y_=function(){const e=We();Ve();const t=(0,a.useRef)(null),n=(0,a.useRef)(!1),[r,o]=(0,a.useState)(!1),[i,s]=(0,a.useState)(""),l=(0,a.useCallback)(()=>{console.log("[App] Force logout - stay here (re-login)"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_timestamp"),localStorage.removeItem("device_id"),window.location.reload()},[]),c=(0,a.useCallback)(()=>{console.log("[App] Force logout - go to blog"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_timestamp"),localStorage.removeItem("device_id"),window.location.href="/blog"},[]);(0,a.useEffect)(()=>{const e=e=>{var t,n;const r=e;console.log("[App] deviceForceLogout event received:",null===(t=r.detail)||void 0===t?void 0:t.reason),s((null===(n=r.detail)||void 0===n?void 0:n.reason)||"Session digantikan oleh login baru"),o(!0)};return window.addEventListener("deviceForceLogout",e),()=>window.removeEventListener("deviceForceLogout",e)},[]);const u=(0,a.useCallback)(async e=>{if(n.current)return;if(!De())return;const t=Ee();if(t){n.current=!0;try{console.log("[App] Verifying session (".concat(e,")..."));const n=await fetch("/api/auth/verify",{headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"});if(401===n.status){const t=await n.json();"SESSION_REPLACED"===t.code&&(console.warn("[App] SESSION_REPLACED detected (".concat(e,")")),window.dispatchEvent(new CustomEvent("deviceForceLogout",{detail:{reason:t.error||"Session digantikan oleh login baru"}})))}else(204===n.status||n.ok)&&console.log("[App] Session valid (".concat(e,")"))}catch(Z_){console.error("[App] Session verify error (".concat(e,"):"),Z_)}finally{n.current=!1}}},[]);(0,a.useEffect)(()=>{const e=setTimeout(()=>{u("mount")},500);return()=>clearTimeout(e)},[u]),(0,a.useEffect)(()=>{const e=()=>{"visible"===document.visibilityState&&u("focus")};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[u]),(0,a.useEffect)(()=>{const e=setInterval(()=>{"visible"===document.visibilityState&&De()&&u("poll")},3e4);return()=>clearInterval(e)},[u]);const d=(0,a.useCallback)(e=>{var t;return"force_logout"===e.event?(console.log("[App] Force logout received from WebSocket:",e.reason),s(e.reason||"Session digantikan oleh login baru"),void o(!0)):null!==(t=e.event)&&void 0!==t&&t.startsWith("remote_scan:")?(console.log("[App] Remote scan event:",e.event,e),void window.dispatchEvent(new CustomEvent("remoteScanEvent",{detail:e}))):void 0},[]);return(0,a.useEffect)(()=>{const n=Be.getInstance(e);n.setHandler(d);const r=()=>{const e=localStorage.getItem("device_id");e&&e!==t.current&&(t.current=e,n.connect(e))};r();const a=e=>{"device_id"===e.key&&e.newValue&&(console.log("[App] device_id changed (storage event):",e.newValue.slice(0,8)),t.current=e.newValue,n.connect(e.newValue))};window.addEventListener("storage",a);const o=setInterval(r,500),i=()=>{console.log("[App] Tab unloading, closing WebSocket"),n.close()};return window.addEventListener("beforeunload",i),()=>{window.removeEventListener("storage",a),window.removeEventListener("beforeunload",i),clearInterval(o)}},[e,d]),(0,Ue.jsx)(Ce,{children:(0,Ue.jsxs)("div",{className:"App",children:[(0,Ue.jsxs)(ye,{children:[(0,Ue.jsx)(ge,{path:"/login",element:(0,Ue.jsx)(K_,{children:(0,Ue.jsx)(F_,{})})}),(0,Ue.jsx)(ge,{path:"/",element:(0,Ue.jsx)(X_,{})}),(0,Ue.jsx)(ge,{path:"/sales/scan",element:(0,Ue.jsx)(E_,{})}),(0,Ue.jsx)(ge,{path:"/ui-test",element:(0,Ue.jsx)(D_,{})}),(0,Ue.jsx)(ge,{path:"/chat",element:(0,Ue.jsx)(G_,{children:(0,Ue.jsx)(O_,{})})}),(0,Ue.jsx)(ge,{path:"/konsultanpsikologi",element:(0,Ue.jsx)(B_,{})}),(0,Ue.jsx)(ge,{path:"/konsultanpsikologi/chat",element:(0,Ue.jsx)(L_,{})}),(0,Ue.jsx)(ge,{path:"/:tenantId",element:(0,Ue.jsx)(z_,{})}),(0,Ue.jsx)(ge,{path:"/:tenantId/chat",element:(0,Ue.jsx)(H_,{})})]}),(0,Ue.jsx)(He,{isOpen:r,onStayHere:l,onGoToBlog:c})]})})},q_=window.fetch;window.fetch=async function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const a=await q_.apply(this,n),o="string"===typeof n[0]?n[0]:n[0]instanceof Request?n[0].url:(null===(e=n[0])||void 0===e?void 0:e.toString())||"";if((o.includes("/api/")||o.includes("/chat/"))&&401===a.status)try{const e=a.clone(),t=await e.json();("SESSION_REPLACED"===t.code||t.force_logout)&&(console.warn("[GlobalFetchInterceptor] SESSION_REPLACED detected!"),window.dispatchEvent(new CustomEvent("deviceForceLogout",{detail:{reason:t.error||"Session digantikan oleh login baru"}})),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_timestamp"),localStorage.removeItem("device_id"))}catch(Z_){}return a},We(),Ve();i.createRoot(document.getElementById("root")).render((0,Ue.jsx)(a.StrictMode,{children:(0,Ue.jsx)(Y_,{})})),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(e=>{for(const t of e)t.unregister(),console.log("[PWA] Service Worker unregistered")})})();
//# sourceMappingURL=main.6a02fcc0.js.map
