# ============================================
# MilkyHoop AIDE Configuration
# ISO 27001:2022 - A.8.9 Configuration Management
# ============================================

# Database locations
database_in=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new

# Report settings
report_url=file:/var/log/aide/aide.log
report_url=stdout

# Gzip database
gzip_dbout=yes

# ============================================
# Rule definitions
# ============================================

# Full monitoring (permissions, ownership, timestamps, content)
FULL = p+u+g+s+m+c+i+n+md5+sha256

# Content monitoring only
CONTENT = sha256

# Permissions and ownership only
PERMS = p+u+g

# Logs (only check existence)
LOG = p+u+g+n

# ============================================
# Critical System Files
# ============================================

# System configuration
/etc/passwd FULL
/etc/shadow FULL
/etc/group FULL
/etc/sudoers FULL
/etc/ssh/sshd_config FULL

# System binaries
/usr/bin FULL
/usr/sbin FULL
/bin FULL
/sbin FULL

# ============================================
# MilkyHoop Application
# ============================================

# Backend services
/root/milkyhoop-dev/backend/api_gateway/app CONTENT
/root/milkyhoop-dev/backend/services/auth_service/app CONTENT

# Configuration files
/root/milkyhoop-dev/docker-compose.yml FULL
/root/milkyhoop-dev/.env FULL
/root/milkyhoop-dev/secrets FULL

# Security configurations
/root/milkyhoop-dev/.gitleaks.toml FULL
/root/milkyhoop-dev/.sops.yaml FULL

# Nginx configuration
/etc/nginx/sites-available FULL
/etc/nginx/nginx.conf FULL

# ============================================
# Directories to exclude
# ============================================

!/root/milkyhoop-dev/node_modules
!/root/milkyhoop-dev/backups
!/root/milkyhoop-dev/.git
!/var/log
!/proc
!/sys
!/dev
!/tmp
!/run
!/var/cache
!/var/tmp
